!function(c){var b,d,a;b=function(){function e(h,f,g){var i;this.row=h,this.tree=f,this.settings=g,this.id=this.row.data(this.settings.nodeIdAttr),i=this.row.data(this.settings.parentIdAttr),null!=i&&""!==i&&(this.parentId=i),this.treeCell=c(this.row.children(this.settings.columnElType)[this.settings.column]),this.expander=c(this.settings.expanderTemplate),this.indenter=c(this.settings.indenterTemplate),this.children=[],this.initialized=!1,this.treeCell.prepend(this.indenter)}return e.prototype.addChild=function(f){return this.children.push(f)},e.prototype.ancestors=function(){var f,g;for(g=this,f=[];g=g.parentNode();){f.push(g)}return f},e.prototype.collapse=function(){return this.collapsed()?this:(this.row.removeClass("expanded").addClass("collapsed"),this._hideChildren(),this.expander.attr("title",this.settings.stringExpand),this.initialized&&null!=this.settings.onNodeCollapse&&this.settings.onNodeCollapse.apply(this),this)},e.prototype.collapsed=function(){return this.row.hasClass("collapsed")},e.prototype.expand=function(){return this.expanded()?this:(this.row.removeClass("collapsed").addClass("expanded"),this.initialized&&null!=this.settings.onNodeExpand&&this.settings.onNodeExpand.apply(this),c(this.row).is(":visible")&&this._showChildren(),this.expander.attr("title",this.settings.stringCollapse),this)},e.prototype.expanded=function(){return this.row.hasClass("expanded")},e.prototype.hide=function(){return this._hideChildren(),this.row.hide(),this},e.prototype.isBranchNode=function(){return this.children.length>0||this.row.data(this.settings.branchAttr)===!0?!0:!1},e.prototype.updateBranchLeafClass=function(){this.row.removeClass("branch"),this.row.removeClass("leaf"),this.row.addClass(this.isBranchNode()?"branch":"leaf")},e.prototype.level=function(){return this.ancestors().length},e.prototype.parentNode=function(){return null!=this.parentId?this.tree[this.parentId]:null},e.prototype.removeChild=function(g){var f=c.inArray(g,this.children);return this.children.splice(f,1)},e.prototype.render=function(){var g,h,f=this.settings;return f.expandable===!0&&this.isBranchNode()&&(g=function(i){return c(this).parents("table").treetable("node",c(this).parents("tr").data(f.nodeIdAttr)).toggle(),i.preventDefault()},this.indenter.html(this.expander),h=f.clickableNodeNames===!0?this.treeCell:this.expander,h.off("click.treetable").on("click.treetable",g),h.off("keydown.treetable").on("keydown.treetable",function(i){13==i.keyCode&&g.apply(this,[i])})),this.indenter[0].style.paddingLeft=""+this.level()*f.indent+"px",this},e.prototype.reveal=function(){return null!=this.parentId&&this.parentNode().reveal(),this.expand()},e.prototype.setParent=function(f){return null!=this.parentId&&this.tree[this.parentId].removeChild(this),this.parentId=f.id,this.row.data(this.settings.parentIdAttr,f.id),f.addChild(this)},e.prototype.show=function(){return this.initialized||this._initialize(),this.row.show(),this.expanded()&&this._showChildren(),this},e.prototype.toggle=function(){return this.expanded()?this.collapse():this.expand(),this},e.prototype._hideChildren=function(){var j,i,g,h,f;for(h=this.children,f=[],i=0,g=h.length;g>i;i++){j=h[i],f.push(j.hide())}return f},e.prototype._initialize=function(){var f=this.settings;return this.render(),f.expandable===!0&&"collapsed"===f.initialState?this.collapse():this.expand(),null!=f.onNodeInitialized&&f.onNodeInitialized.apply(this),this.initialized=!0},e.prototype._showChildren=function(){var j,i,g,h,f;for(h=this.children,f=[],i=0,g=h.length;g>i;i++){j=h[i],f.push(j.show())}return f},e}(),d=function(){function e(g,f){this.table=g,this.settings=f,this.tree={},this.nodes=[],this.roots=[]}return e.prototype.collapseAll=function(){var h,j,g,i,f;for(i=this.nodes,f=[],j=0,g=i.length;g>j;j++){h=i[j],f.push(h.collapse())}return f},e.prototype.expandAll=function(){var h,j,g,i,f;for(i=this.nodes,f=[],j=0,g=i.length;g>j;j++){h=i[j],f.push(h.expand())}return f},e.prototype.findLastNode=function(f){return f.children.length>0?this.findLastNode(f.children[f.children.length-1]):f},e.prototype.loadRows=function(h){var g,j,f;if(null!=h){for(f=0;f<h.length;f++){j=c(h[f]),null!=j.data(this.settings.nodeIdAttr)&&(g=new b(j,this.tree,this.settings),this.nodes.push(g),this.tree[g.id]=g,null!=g.parentId&&this.tree[g.parentId]?this.tree[g.parentId].addChild(g):this.roots.push(g))}}for(f=0;f<this.nodes.length;f++){g=this.nodes[f].updateBranchLeafClass()}return this},e.prototype.move=function(h,f){var g=h.parentNode();return h!==f&&f.id!==h.parentId&&-1===c.inArray(h,f.ancestors())&&(h.setParent(f),this._moveRows(h,f),1===h.parentNode().children.length&&h.parentNode().render()),g&&g.updateBranchLeafClass(),h.parentNode()&&h.parentNode().updateBranchLeafClass(),h.updateBranchLeafClass(),this},e.prototype.removeNode=function(f){return this.unloadBranch(f),f.row.remove(),null!=f.parentId&&f.parentNode().removeChild(f),delete this.tree[f.id],this.nodes.splice(c.inArray(f,this.nodes),1),this},e.prototype.render=function(){var g,i,f,h;for(h=this.roots,i=0,f=h.length;f>i;i++){g=h[i],g.show()}return this},e.prototype.sortBranch=function(g,f){return g.children.sort(f),this._sortChildRows(g),this},e.prototype.unloadBranch=function(h){var g,f=h.children.slice(0);for(g=0;g<f.length;g++){this.removeNode(f[g])}return h.children=[],h.updateBranchLeafClass(),this},e.prototype._moveRows=function(j,f){var h,g=j.children;for(j.row.insertAfter(f.row),j.render(),h=g.length-1;h>=0;h--){this._moveRows(g[h],j)}},e.prototype._sortChildRows=function(f){return this._moveRows(f,f)},e}(),a={init:function(e,g){var f;return f=c.extend({branchAttr:"ttBranch",clickableNodeNames:!1,column:0,columnElType:"td",expandable:!1,expanderTemplate:"<a href='#'>&nbsp;</a>",indent:19,indenterTemplate:"<span class='indenter'></span>",initialState:"collapsed",nodeIdAttr:"ttId",parentIdAttr:"ttParentId",stringExpand:"Expand",stringCollapse:"Collapse",onInitialized:null,onNodeCollapse:null,onNodeExpand:null,onNodeInitialized:null},e),this.each(function(){var h,i=c(this);return(g||void 0===i.data("treetable"))&&(h=new d(this,f),h.loadRows(this.rows).render(),i.addClass("treetable").data("treetable",h),null!=f.onInitialized&&f.onInitialized.apply(h)),i})},destroy:function(){return this.each(function(){return c(this).removeData("treetable").removeClass("treetable")})},collapseAll:function(){return this.data("treetable").collapseAll(),this},collapseNode:function(f){var e=this.data("treetable").tree[f];if(!e){throw new Error("Unknown node '"+f+"'")}return e.collapse(),this},expandAll:function(){return this.data("treetable").expandAll(),this},expandNode:function(f){var e=this.data("treetable").tree[f];if(!e){throw new Error("Unknown node '"+f+"'")}return e.initialized||e._initialize(),e.expand(),this},loadBranch:function(h,i){var f=this.data("treetable").settings,e=this.data("treetable").tree;if(i=c(i),null==h){this.append(i)}else{var g=this.data("treetable").findLastNode(h);i.insertAfter(g.row)}return this.data("treetable").loadRows(i),i.filter("tr").each(function(){e[c(this).data(f.nodeIdAttr)].show()}),null!=h&&h.render().expand(),this},move:function(h,g){var e,f;return f=this.data("treetable").tree[h],e=this.data("treetable").tree[g],this.data("treetable").move(f,e),this},node:function(e){return this.data("treetable").tree[e]},removeNode:function(f){var e=this.data("treetable").tree[f];if(!e){throw new Error("Unknown node '"+f+"'")}return this.data("treetable").removeNode(e),this},reveal:function(f){var e=this.data("treetable").tree[f];if(!e){throw new Error("Unknown node '"+f+"'")}return e.reveal(),this},sortBranch:function(h,f){var e,g=this.data("treetable").settings;return f=f||g.column,e=f,c.isNumeric(f)&&(e=function(k,i){var m,l,j;return m=function(n){var o=n.row.find("td:eq("+f+")").text();return c.trim(o).toUpperCase()},l=m(k),j=m(i),j>l?-1:l>j?1:0}),this.data("treetable").sortBranch(h,e),this},unloadBranch:function(e){return this.data("treetable").unloadBranch(e),this}},c.fn.treetable=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?c.error("Method "+e+" does not exist on jQuery.treetable"):a.init.apply(this,arguments)},this.TreeTable||(this.TreeTable={}),this.TreeTable.Node=b,this.TreeTable.Tree=d}(jQuery);