/*
 * Copyright ï¿½ 2015 BMC Software, Inc.
 * All rights reserved.
 *
 * This software is the confidential and proprietary information of 
 * BMC Software, Inc ("Confidential Information"). You shall not 
 * disclose such Confidential Information and shall use it only in
 * accordance with the terms of the license agreement between 
 * you and BMC Software, Inc. 
 */
function WindowManager(){this.nextWindowID=0;this.topWinWindowID=0;this.windowHandles={};this.weOpenerWindowIDs={};this.weChildrenWindowIDs={};this.weChildrenNameToWindowID={};this.weWindowModes={};this.weWindowTypes={};this.windowArgs={};this.weChildArrived={};this.continuationFuncs={};this.currentWindowIDStack=new Array();this.inlineIntervalsStack={};this.lasttimeCookieUpdated=null;this.registerWindow=function(b,g){var f=this.windowHandles[""+b];var d=new WindowHandle(b,false,g,null);this.windowHandles[""+b]=d};this.report=function(){var d=0;var b=0;for(b in this.windowHandles){this.reportTxt+="WindowID["+b+"] = "+this.windowHandles[b].windowID+"\n";d++}alert(this.reportTxt);this.reportTxt=d+" total windows.\n";alert(this.reportTxt)};this.unregisterWindow=function(d){if(isLogicalWindow(d)){this.unregisterLogicalWindow(d);return}unregisterTbRefreshIntervals_NS(d);var f=getOpenerWindowID(d);if(f!=null){var b=f.windowID;var g=f.windowObj;removeOpenerWindowID(d)}removeChildWindowIDs(d);delete this.windowHandles[""+d];fc.unregisterContext(d)};this.unregisterLogicalWindow=function(b){var f=getLogicalChildWindowIDs(b);for(var d in f){this.unregisterLogicalWindow(f[d])}unregisterTbRefreshIntervals_NS(b);delete this.windowHandles[""+b];fc.unregisterContext(b)};this.allocWindow=function(){return this.nextWindowID++};this.getTopWinWindowID=function(){return this.topWinWindowID};this.getParentWindowID=function(b){var d=this.windowHandles[""+b];return d.parentWindowID};this.pushCurrentWindowID=function(b){this.currentWindowIDStack.push(b)};this.popCurrentWindowID=function(b){var f=null;if(this.currentWindowIDStack.length>0){f=this.currentWindowIDStack.pop();if(f!=b){this.currentWindowIDStack.push(f);for(var d=this.currentWindowIDStack.length-1;d>0;d--){if(this.currentWindowIDStack[d]==b){this.currentWindowIDStack.splice(d,1);break}}}}return(f)};this.getCurrentWindowID=function(){var b=null;if(this.currentWindowIDStack.length>0){b=this.currentWindowIDStack[this.currentWindowIDStack.length-1]}return(b)};this.pushInlineInterval=function(b,f,d){if(typeof this.inlineIntervalsStack[b]=="undefined"){this.inlineIntervalsStack[b]=new Array()}this.inlineIntervalsStack[b].push({func:f,interval:d})}}var wm=new WindowManager();var resizeWindow=false;function WindowHandle(b,f,g,d){this.windowID=b;this.isDialogue=f;this.parentWindowID=g;this.children=d;this.close=function(){};this.cleanup=function(){}}function FormContextManager(){this.formContexts={};this.Templates={};this.formWorkflows={};this.formDatas={};this.udds={};this.sfvsnippets={};this.sfmap={};this.registerContext=function(f,g,h,b,w,s,k,o,v){var u=this.formContexts[""+f];var d=new FormContext(f,g,h,b,w,s,k,o,v);this.formContexts[""+f]=d};this.getContext=function(b){return this.formContexts[""+b]};this.unregisterContext=function(b){delete this.formContexts[""+b]}}function getFormContext(b){return fc.getContext(b)}function FormContext(d,f,g,b,u,v,h,k,o){this.windowID=d;this.weChildren=[];this.currentWorkflowCtx=null;this.StateMgr=null;this.userDataDynamic=f;this.server=g;this.formName=b;this.view=u;this.fieldsID=v;this.URLParams=(h==null)?[]:h;this.fields=new Array;this.FieldListInfo={};this.LayoutParentFields=[];this.FieldChanged=0;this.Field_LastCleared=1;this.VUILayoutModel=new FillLayoutPolicy();this.ARKWValues=getARKWValuesInstance();this.ARKWNameLookup=new Array(this.ARKWValues.length);for(var s=0;s<this.ARKWValues.length;++s){this.ARKWNameLookup[this.ARKWValues[s].n]=s}this.TbRefreshIntervals={};this.OpenDIVPopup=new Array();this.statusPopup=new Array();this.CharEditPopups=[];this.WFThreadsList=[];this.AsyncFields=[];this.AsyncPH=[];this.IsInInterruptMode=0;this.ARStateCurrent=-1;this.TemplateFields={};this.DBSnapshot=null;this.ARMenuCache={};this.DiaryFields=[];this.ViewFields=[];this.ARFieldROBg="#DEE0E0";this.FormPaneMPanes=[];this.FormElements=[];this.ToolBarPane=null;this.FormContainerPane=null;this.FormContainerPaneSH=null;this.FormContainerPaneSW=null;this.SplitterPane=null;this.ResultsListPane=null;this.PromptBarPane=null;this.QBPane=null;this.ARProcessEventMIncomingQ=[];this.TableFields=[];this.currencyCodes=null;this.currencyMenu=null;this.AttachPoolFields=[];this.PageDirty=false;this.nextZIndex=100001;this.WDECurrentDrag=null;this.qbe=null;this.ARInitPane=null;this.ARMaps={};this.ARArrays={};this.FormJSHolder=null;this.flipper=null;this.rightimg=null;this.downimg=null;this.tbopen=true;this.tbmaxheight=40;this.inlineIntervalHandles=[];this.windowName=(typeof o!="undefined"&&o!=null)?o:window.name}function BuildDummyLoadingMenu(b){new ARMenu(b,"DummyLoadingMenu",{r:1,s:"@",mval:[{l:getLocalizedMessage("Loading..."),v:null}],novals:false,t:0,tItems:1})}var fc=new FormContextManager;function getWindowName_NS(b){return getFormContext(b).windowName}function setWindowName_NS(b,d){getFormContext(b).windowName=d}function getARInitPane_NS(b){return getFormContext(b).ARInitPane}function setARInitPane_NS(b,d){return getFormContext(b).ARInitPane=d}function getweChildren_NS(b){return getFormContext(b).weChildren}function setweChildren_NS(b,d){getFormContext(b).weChildren=d}function getWindowMgr_NS(){return wm}function getSFV_NS(d){var b=getFormContext(d);return{s:b.server,f:b.formName,v:b.view}}function getDefaults_NS(b){return getFormDataHolderById(b).Defaults}function getFields_NS(b){return getFormContext(b).fields}function getARMaps_NS(b){return getFormContext(b).ARMaps}function getARArrays_NS(b){return getFormContext(b).ARArrays}function getVUILayoutModel_NS(b){return getFormContext(b).VUILayoutModel}function getFieldListInfo_NS(b){return getFormContext(b).FieldListInfo}function getFieldChanged_NS(b){return getFormContext(b).FieldChanged}function setFieldChanged_NS(b,d){getFormContext(b).FieldChanged=d}function getField_LastCleared_NS(b){return getFormContext(b).Field_LastCleared}function setField_LastCleared_NS(b,d){getFormContext(b).Field_LastCleared=d}function getARKWNameLookup_NS(b){return getFormContext(b).ARKWNameLookup}function getCurWFC_NS(b){var d=getFormContext(b);if(typeof d=="undefined"||d==null){return null}return d.currentWorkflowCtx}function setCurWFC_NS(b,d){getFormContext(b).currentWorkflowCtx=d}function getForm_NS(b){return getFormDataHolderById(b).Form}function getTbRefreshIntervals_NS(b){return getFormContext(b).TbRefreshIntervals}function unregisterTbRefreshIntervals_NS(d){var g=getTbRefreshIntervals_NS(d);if(g!=null){for(var b in g){var f=g[b];if(typeof f!="undefined"){clearInterval(f)}delete g[b]}}}function getOpenDIVPopup_NS(b){if(getFormContext(b).OpenDIVPopup.length<=0){return null}return getFormContext(b).OpenDIVPopup[getFormContext(b).OpenDIVPopup.length-1]}function setOpenDIVPopup_NS(b,d){getFormContext(b).OpenDIVPopup.push(d)}function clearOpenDIVPopup_NS(b){return getFormContext(b).OpenDIVPopup.pop()}function getCharEditPopups_NS(b){return getFormContext(b).CharEditPopups}function getWFThreadsList_NS(b){return getFormContext(b).WFThreadsList}function getAsyncFields_NS(b){return getFormContext(b).AsyncFields}function getAsyncPH_NS(b){return getFormContext(b).AsyncPH}function getIsInInterruptMode_NS(b){return getFormContext(b).IsInInterruptMode}function setIsInInterruptMode_NS(b,d){getFormContext(b).IsInInterruptMode=d}function getStateMgr_NS(b){return getFormContext(b).StateMgr}function setStateMgr_NS(b,d){getFormContext(b).StateMgr=d}function getARStateCurrent_NS(b){return getFormContext(b).ARStateCurrent}function setARStateCurrent_NS(b,d){getFormContext(b).ARStateCurrent=d}function getuserSearches_NS(b){return getUDDHolderById(b).userSearches}function gettablePrefs_NS(b){return getUDDHolderById(b).tablePrefs}function getmaxQuickReportSize_NS(b){return getUDDHolderById(b).maxQuickReportSize}function getquickReportsExisting_NS(b){return getUDDHolderById(b).quickReportsExisting}function getcurQuickReportSize_NS(b){return getUDDHolderById(b).curQuickReportSize}function getsysMsgPromptType_NS(b){return getUDDHolderById(b).sysMsgPromptType}function getQBE_NS(b){return getUDDHolderById(b).qbe}function getTemplateFields_NS(b){return getFormContext(b).TemplateFields}function getDBSnapshot_NS(b){return getFormContext(b).DBSnapshot}function setDBSnapshot_NS(b,d){getFormContext(b).DBSnapshot=d}function getARMenuCache_NS(b){return getFormContext(b).ARMenuCache}function getDiaryFields_NS(b){return getFormContext(b).DiaryFields}function getViewFields_NS(b){return getFormContext(b).ViewFields}function getARFieldROBg_NS(b){return getFormContext(b).ARFieldROBg}function setARFieldROBg_NS(b,d){getFormContext(b).ARFieldROBg=d}function getFormPaneMPanes_NS(b){return getFormContext(b).FormPaneMPanes}function getFormElements_NS(b){return getFormContext(b).FormElements}function getToolBarPane_NS(b){return getFormContext(b).ToolBarPane}function setToolBarPane_NS(b,d){getFormContext(b).ToolBarPane=d}function getFormContainerPane_NS(b){return getFormContext(b).FormContainerPane}function setFormContainerPane_NS(b,d){getFormContext(b).FormContainerPane=d}function getFormContainerPaneSH_NS(b){return getFormContext(b).FormContainerPaneSH}function setFormContainerPaneSH_NS(b,d){getFormContext(b).FormContainerPaneSH=d}function getFormContainerPaneSW_NS(b){return getFormContext(b).FormContainerPaneSW}function setFormContainerPaneSW_NS(b,d){getFormContext(b).FormContainerPaneSW=d}function getSplitterPane_NS(b){return getFormContext(b).SplitterPane}function setSplitterPane_NS(b,d){getFormContext(b).SplitterPane=d}function getResultsListPane_NS(b){return getFormContext(b).ResultsListPane}function setResultsListPane_NS(b,d){getFormContext(b).ResultsListPane=d}function getPromptBarPane_NS(b){return getFormContext(b).PromptBarPane}function setPromptBarPane_NS(b,d){getFormContext(b).PromptBarPane=d}function getQBPane_NS(b){return getFormContext(b).QBPane}function setQBPane_NS(b,d){getFormContext(b).QBPane=d}function getLayoutParentFields_NS(b){return getFormContext(b).LayoutParentFields}function getARKeywords_NS(b){return getFormDataHolderById(b).ARKeywords}function getARKWValues_NS(b){return getFormContext(b).ARKWValues}function getARProcessEventMIncomingQ_NS(b){if(typeof getFormContext(b)=="undefined"){return undefined}return getFormContext(b).ARProcessEventMIncomingQ}function getTableFields_NS(b){return getFormContext(b).TableFields}function getTemplates_NS(){return fc.Templates}function getcurrencyCodes_NS(b){return currencyCodes}function getcurrencyMenu_NS(b){return currencyMenu}function getcurrencyFieldMenu(d,b){return getFormContext(d).fields[b].mMenuDef}function getDiaryHistory(d,b){var f=getFormContext(d).fields[b].GetHistory();return f}function showDiaryHistory(d,b){var f=false;if(getFormContext(d).ARStateCurrent!=1&&getFormContext(d).ARStateCurrent!=4){f=true}return f}function getStatusEnumInfo_NS(b){return getFormDataHolderById(b).StatusEnumInfo}function getARMenus_NS(b){return getFormDataHolderById(b).ARMenus}function getGInfo_NS(b){return getUDDHolderById(b).GInfo}function getARTitles_NS(b){return getFormDataHolderById(b).ARTitles}function getAttachPoolFields_NS(b){return getFormContext(b).AttachPoolFields}function getPageDirty_NS(b){return getFormContext(b).PageDirty}function setPageDirty_NS(b,d){getFormContext(b).PageDirty=d}function getnextZIndex_NS(b){return getFormContext(b).nextZIndex}function setnextZIndex_NS(b,d){getFormContext(b).nextZIndex=d}function getWDECurrentDrag_NS(b){return getFormContext(b).WDECurrentDrag}function setWDECurrentDrag_NS(b,d){getFormContext(b).WDECurrentDrag=d}function getFormJSHolder_NS(b){return getFormContext(b).FormJSHolder}function setFormJSHolder_NS(b,d){getFormContext(b).FormJSHolder=d}function getflipper_NS(b){return getFormContext(b).flipper}function setflipper_NS(b,d){getFormContext(b).flipper=d}function getrightimg_NS(b){return getFormContext(b).rightimg}function setrightimg_NS(d,b){getFormContext(d).rightimg=b}function getdownimg_NS(b){return getFormContext(b).downimg}function setdownimg_NS(b,d){getFormContext(b).downimg=d}function gettbopen_NS(b){return getFormContext(b).tbopen}function settbopen_NS(b,d){getFormContext(b).tbopen=d}function gettbmaxheight_NS(b){return getFormContext(b).tbmaxheight}function settbmaxheight_NS(d,b){getFormContext(d).tbmaxheight=b}function getWindowArgs_NS(b){return getWindowMgr_NS().windowArgs[""+b]}function rmWindowArgs_NS(b){if(typeof wm.windowArgs[""+b]!="undefined"){delete wm.windowArgs[""+b]}}function setWindowArgs_NS(b,d){getWindowMgr_NS().windowArgs[""+b]=d}function getChildArrived_NS(b){return getWindowMgr_NS().weChildArrived[""+b]}function setChildArrived_NS(b,d){getWindowMgr_NS().weChildArrived[""+b]=d}function removeChildArrived_NS(b){if(typeof wm.weChildArrived[""+b]!="undefined"){delete wm.weChildArrived[""+b]}}function allocWindowID_NS(){return getWindowMgr_NS().allocWindow()}function getTopWinWindowID_NS(){return getWindowMgr_NS().getTopWinWindowID()}function getParentWindowID_NS(b){return getWindowMgr_NS().getParentWindowID(b)}function getcontinuationFuncs_NS(b){return getWindowMgr_NS().continuationFuncs[""+b]}function setcontinuationFuncs_NS(b,d){getWindowMgr_NS().continuationFuncs[""+b]=d}function pushCurrentWindowID_NS(b){getWindowMgr_NS().pushCurrentWindowID(b)}function popCurrentWindowID_NS(){return(getWindowMgr_NS().popCurrentWindowID())}function getCurrentWindowID_NS(){return(getWindowMgr_NS().getCurrentWindowID())}function getOpenerWindowID(b){var d=getWindowMgr_NS().weOpenerWindowIDs[""+b];if(typeof d=="undefined"){return null}return d}function setOpenerWindowID(b,d,f){getWindowMgr_NS().weOpenerWindowIDs[""+b]={windowID:""+d,windowObj:f}}function removeOpenerWindowID(b){if(typeof wm.weOpenerWindowIDs[""+b]!="undefined"){delete wm.weOpenerWindowIDs[""+b]}}function genAllLogicalChildWindowIDsInList(d,b){var g=getLogicalChildWindowIDs(d);if(g!=null&&g.length>0){for(var f in g){b.push(g[f]);genAllLogicalChildWindowIDsInList(g[f],b)}}}function getLogicalChildWindowIDs(b){var s=[];var d=getFormContext(b);if(typeof d=="undefined"){return s}var o=new Object();var k=getViewFields_NS(b);for(var f in k){var h=null;if(k[f].isInlineForm()){h=k[f].mChildWindowID}if((h!=null)&&((""+h in o)==false)){var g=wm.windowHandles[""+h];if(typeof g!="undefined"&&g!=null){o[""+h]=h}}}for(var h in o){s.push(o[h])}return s}function isLogicalWindow(b){var g=wm.windowHandles[""+b];if(typeof g=="undefined"||g==null){return false}if(g.parentWindowID==null){return false}var f=getLogicalChildWindowIDs(g.parentWindowID);for(var d in f){if(f[d]==b){return true}}return false}function getLogicalWindow(d){var g=wm.windowHandles[""+d];if(typeof g=="undefined"||g==null){return null}if(g.parentWindowID==null){return null}var b=getViewFields_NS(g.parentWindowID);for(var f in b){if(b[f]!=null&&b[f].isInlineForm()&&b[f].mChildWindowID!=null&&b[f].mChildWindowID==d){return b[f]}}return null}function getChildWindowIDs(b){var d=getWindowMgr_NS().weChildrenWindowIDs[""+b];if(typeof d=="undefined"){return null}return d}function addChildWindowID(d,f,h){var k=getWindowMgr_NS().weChildrenWindowIDs[""+d];if(typeof k=="undefined"){k=[];getWindowMgr_NS().weChildrenWindowIDs[""+d]=k}var b=k.length;for(var g=0;g<b;g++){}k.push({windowID:""+f,windowObj:h})}function updateChildWindowID(d,f,h){var k=getWindowMgr_NS().weChildrenWindowIDs[""+d];var b=k.length;for(var g=0;g<b;g++){if(f==k[g].windowID){k[g].windowObj=h;break}}}function getChildWindowIDFromName(b){return(getWindowMgr_NS().weChildrenNameToWindowID[""+b])}function setChildWindowIDForName(b,d){getWindowMgr_NS().weChildrenNameToWindowID[""+b]=d}function removeChildWindowID(f,g){removeWindowMode(g);removeWindowType(g);rmWindowArgs_NS(g);for(var d in wm.weChildrenNameToWindowID){if(wm.weChildrenNameToWindowID[d]==g){delete wm.weChildrenNameToWindowID[d];break}}removeOpenerWindowID(g);removeChildArrived_NS(g);var k=wm.weChildrenWindowIDs[""+f];if(typeof k=="undefined"){return}var b=k.length;for(var h=0;h<b;h++){if(k[h].windowID==g){k.splice(h,1);break}}}function removeChildWindowIDs(b){delete getWindowMgr_NS().weChildrenWindowIDs[""+b]}function getWindowType(b){var d=getWindowMgr_NS().weWindowTypes[""+b];if(typeof d=="undefined"){return""}return d}function setWindowType(b,d){getWindowMgr_NS().weWindowTypes[""+b]=d}function removeWindowType(b){if(typeof wm.weWindowTypes[""+b]!="undefined"){delete wm.weWindowTypes[""+b]}}function getWindowMode(b){var d=getWindowMgr_NS().weWindowModes[""+b];if(typeof d=="undefined"){return""}return d}function setWindowMode(b,d){getWindowMgr_NS().weWindowModes[""+b]=d}function removeWindowMode(b){if(typeof wm.weWindowModes[""+b]!="undefined"){delete wm.weWindowModes[""+b]}}function hookChildrenToOpener(h){var w=getChildWindowIDs(h);if(w==null){return}var d=w.length;var g=getOpenerWindowID(h);if((g==null)&&(typeof window.weOpener!="undefined")&&(window.weOpener)){g={windowID:""+getTopWinWindowID_NS(),windowObj:window.weOpener}}if(g==null){for(var s=d-1;s>=0;--s){var f=w[s].windowID;var o=w[s].windowObj;if((o.closed)||(getWindowType(f)=="URL")){removeChildWindowID(h,f);continue}if(typeof o.removeOpenerWindowID!="undefined"){o.removeOpenerWindowID(getTopWinWindowID_NS())}if(typeof o.weOpener!="undefined"){o.weOpener=null}removeChildWindowID(h,f)}return}var k=g.windowID;var b=g.windowObj;if(b.closed||!("ARSystemInit" in b)){return}for(var s=d-1;s>=0;--s){var f=w[s].windowID;var o=w[s].windowObj;if((o.closed)||(getWindowType(f)=="URL")){removeChildWindowID(h,f);continue}if(typeof o.getOpenerWindowID!="undefined"){if(o.getOpenerWindowID(getTopWinWindowID_NS())!=null){o.setOpenerWindowID(getTopWinWindowID_NS(),k,b)}}if(typeof o.weOpener!="undefined"){o.weOpener=b}var v=b.allocWindowID_NS();b.setWindowMode(v,getWindowMode(f));b.setWindowType(v,getWindowType(f));var y=getWindowArgs_NS(f);if(typeof y!="undefined"){b.setWindowArgs_NS(v,getWindowArgs_NS(f))}else{b.setWindowArgs_NS(v,null)}b.setChildWindowIDForName(o.name,v);b.setOpenerWindowID(v,k,b);var u=getChildArrived_NS(f);if(typeof u!="undefined"){b.setChildArrived_NS(v,u)}b.addChildWindowID(k,v,o);removeChildWindowID(h,f)}}function getChildWindowIDsRecursive(d){var s=[];var o=getChildWindowIDs(d);if(o==null){return null}s=s.concat(o);var g=o.length;for(var f=0;f<g;f++){var k=o[f].windowID;var b=o[f].windowObj;var h=b.getChildWindowIDsRecursive(k);if(h!=null){s=s.concat(h)}}return s}function getTopLevelBrowserWindow(){var b=window;var d=b;while(d){d=b.parent;if(d!=null&&!d.closed&&d!=b){if(!("ARSystemInit" in d)){break}b=d}else{break}}return b}function getSameWindowRootWindowID(b){var f=getOpenerWindowID(b);if(f==null){return null}var d=f.windowID;var h=f.windowObj;if(h!=window){return null}var g=getSameWindowRootWindowID(d);if(g==null){return d}else{return g}}function getTopLevelWindowIDs(){var g={};var f=[];for(var b in getWindowMgr_NS().windowHandles){var d=getSameWindowRootWindowID(b);if(d==null){d=b}if(d in g){continue}f.push({windowID:d,windowObj:window});g[d]=d}return f}function getTopLevelBrowserWindowIDs(){var b=getTopLevelBrowserWindow();return b.getTopLevelWindowIDs()}function getAllWindowIDs(){var g=[];var d=window;var f=d;while(f){for(var b in f.getWindowMgr_NS().windowHandles){g.push({windowID:b,windowObj:f})}f=d.parent;if(f!=null&&!f.closed&&f!=d){if(!("ARSystemInit" in f)){break}d=f}else{break}}return g}function getFormWorkflowHolder(f,d,b){var g=(f+"_"+d+"_"+b);return fc.formWorkflows[g]}function getFormWorkflowHolderById(b){var d=getFormContext(b);var f=(d.server+"_"+d.formName+"_"+d.view);return fc.formWorkflows[f]}function setFormWorkflowHolder(f,d,b,h){var g=(f+"_"+d+"_"+b);if(getFormWorkflowHolder(f,d,b)==null){fc.formWorkflows[g]=h}}function getFormDataHolder(f,d,b){var g=(f+"_"+d+"_"+b);return fc.formDatas[g]}function getFormDataHolderById(b){var d=getFormContext(b);var f=(d.server+"_"+d.formName+"_"+d.view);return fc.formDatas[f]}function setFormDataHolder(f,d,b,h){var g=(f+"_"+d+"_"+b);if(getFormDataHolder(f,d,b)==null){fc.formDatas[g]=h}}function getUDDHolder(f,d,b){var g=(f+"_"+d+"_"+b);return fc.udds[g]}function getUDDHolderById(b){var d=getFormContext(b);var f=(d.server+"_"+d.formName+"_"+d.view);return fc.udds[f]}function setUDDHolder(f,d,b,h){var g=(f+"_"+d+"_"+b);if(getUDDHolder(f,d,b)==null){fc.udds[g]=h}}function setSFVSnippet(g,f,b,d){var h=(g+"_"+f+"_"+b);fc.sfvsnippets[h]=d}function getSFVSnippet(f,d,b){return fc.sfvsnippets[(f+"_"+d+"_"+b)]}function setSFMap(g,f,b){var d=(g+"_"+f);var h=(g+"_"+f+"_"+b);fc.sfmap[d]=h}function getSFMap(d,b){return fc.sfmap[(d+"_"+b)]}function getSFVSnippetFromSF(f,b){var d=getSFMap(f,b);if(d!=null){return fc.sfvsnippets[d]}return null}function saveGuide(b){var d=getCurWFC_NS(b);var f=d.getGuideState();if(f!=null){var g=d.guideCtxt;d.guideCtxtSav.push({g:1,gsav:g});d.guideCtxt=[]}else{d.guideCtxtSav.push({g:0,gsav:null})}}function restoreGuide(b){var d=getCurWFC_NS(b);var f=d.guideCtxtSav.pop();if(f==null||typeof f.g=="undefined"){LogWrite("restoreGuide uneven push/pop")}else{if(f.g==1){d.guideCtxt=f.gsav}}}function ARRunGotoX(s,h,k,b,d,g){var o=[h,d,0];var f=[h];var u=[];u.push({f:restoreGuide,a:f});u.push({t:s,f:ARRunGoto,a:o,e:ARRunGotoException,ea:o});return{n:u,c:{f:saveGuide,a:f}}}function ARRunGoto(b,d,g){while(g<d.length){var h=getCurWFC_NS(b).execute({f:d[g+1],a:[b]});if(h){ActiveLinkLogWriteEnd(b,"ActiveLink End:- ");var f=[b,d,g+2];return{i:1,n:{f:ARRunGoto,a:f,e:ARRunGotoException,ea:f}}}g+=2}}function ARRunGotoException(h,b,d,g){if(typeof h!="object"||!(h instanceof WorkflowException)){throw h}if(h.getCode()==1){var k=h.getNumValue();while((g>0&&k<d[g])||g>=d.length){g-=2}while(g<d.length&&k>d[g]){g+=2}if(g<d.length){var f=[b,d,g];return{n:{f:ARRunGoto,a:f,e:ARRunGotoException,ea:f}}}}else{restoreGuide(b);throw h}}function ARRunX(h,g,k,b,d,f,w){LogEvent(g,k,b);var s=[];s.push({f:LogEndofEvent,a:[g,k,b]});var o=d.length;var y=f.length;if(o==y){for(var v=o-1;v>=0;v--){var u="ActiveLink End:- "+f[v];s.push({f:ActiveLinkLogWriteEnd,a:[g,u]});s.push({t:h,f:d[v],a:[g,w]})}}else{for(var v=o-1;v>=0;v--){s.push({f:ActiveLinkLogWriteEnd,a:[g,""]});s.push({t:h,f:d[v],a:[g,w]})}}return getCurWFC_NS(g).executeAll(s)}function ARGotoGuideLabel(b,g){var f=getCurWFC_NS(b).getGuideState();if(f!=null){var d=f.f;var h;for(h=0;h<d.length;++h){if(typeof d[h]=="string"&&d[h]==g){f.i=h;throw new WorkflowException(b,2,g)}}}}function ARRunGuideX(o,b,k,g,f,h){var d=getCurWFC_NS(b).getGuideState();d.f=f;d.i=0;return{c:{f:ARRunGuide,a:[b],e:ARRunGuideException,ea:[b]}}}function ARRunGuide(b){var f=getCurWFC_NS(b).getGuideState();var h=getFormWorkflowHolder(getFormContext(b).server,getFormContext(b).formName,getFormContext(b).view);while(f.i<f.f.length){var d=f.f[f.i++];if(typeof d=="function"){var g=getCurWFC_NS(b).execute({t:h,f:d,a:[b]});if(g){ActiveLinkLogWriteEnd(b,"ActiveLink End:- ");return{i:1,n:{f:ARRunGuide,a:[b],e:ARRunGuideException,ea:[b]}}}ActiveLinkLogWriteEnd(b,"ActiveLink End:- ")}}}function ARRunGuideException(d,b){if(typeof d!="object"||!(d instanceof WorkflowException)){throw d}switch(d.mCode){case 2:return{n:{f:ARRunGuide,a:[b],e:ARRunGuideException,ea:[b]}};case 1:return{n:{f:ARRunGuide,a:[b],e:ARRunGuideException,ea:[b]}};default:throw d}}function CallIf(f,g){if(!f){return}var b=new Array(arguments.length-2);for(var d=0;d<arguments.length-2;++d){b[d]=arguments[d+2]}return g.apply(null,b)}function External(b,d){var f=F(b,d).G().toString().trim(1|2);if(f==""){return true}f=ExpandString(b,f,2|4|8);req=new NDXCompileQualification(b,ARKWGetStringByIdx(b,7),ARKWGetStringByIdx(b,6),ARKWGetStringByIdx(b,17),f);return req.result}var WorkflowEventMap={0:{f:"AREVTNone"},1:{f:"AREVTButton",id:true},2:{f:"AREVTReturn",id:true},4:{f:"AREVTSubmit"},8:{f:"AREVTModify"},16:{f:"AREVTDisplay"},32:{f:"AREVTModifyAll"},64:{f:"AREVTMenuOpen",id:true},128:{f:"AREVTMenuChoice",id:true},256:{f:"AREVTLoseFocus",id:true},512:{f:"AREVTSetDefault"},1024:{f:"AREVTQuery"},2048:{f:"AREVTAfterModify"},4096:{f:"AREVTAfterSubmit"},8192:{f:"AREVTGainFocus",id:true},16384:{f:"AREVTWindowOpen"},32768:{f:"AREVTWindowClose"},65536:{f:"AREVTUndisplay"},131072:{f:"AREVTCopySubmit"},262144:{f:"AREVTWindowLoaded"},524288:{f:"AREVTInterval",id:true},1048576:{f:"AREVTEvent"},2097152:{f:"AREVTTableContentChange",id:true},4194304:{f:"AREVTHoverLabel",id:true},8388608:{f:"AREVTHoverData",id:true},16777216:{f:"AREVTHoverField",id:true},33554432:{f:"AREVTPageExpand",id:true},67108864:{f:"AREVTPageCollapse",id:true},134217728:{f:"AREVTDrag",id:true},268435456:{f:"AREVTDrop",id:true}};function AREventFunction(d,g,o){if(g in WorkflowEventMap){var b=WorkflowEventMap[g];var k=b.f;if(b.id&&typeof o!="undefined"){k=k+o}var h=getFormContext(d);var f=getFormWorkflowHolder(h.server,h.formName,h.view);if(k in f){return{h:f,f:f[k]}}}return null}function ARRegisterInterval(b,f,d){if(isLogicalWindow(b)){wm.pushInlineInterval(b,function(){promptBar.setToClear();var g=getFormWorkflowHolderById(b);LogInterval(b,d);new WorkflowContext(b,{t:g,f:f,a:[b]})},d*1000)}else{setInterval(function(){promptBar.setToClear();var g=getFormWorkflowHolderById(b);LogInterval(b,d);new WorkflowContext(b,{t:g,f:f,a:[b]})},d*1000)}}function ExpandServerName(b,d){d=ExpandString(b,d,1|2|4);if(d=="@"){d=ARKWGetStringByIdx(b,7)}if(isValidIPv4(d)){return d}var f=d.indexOf(".");if(f>0){if(typeof shortNameFlagList!="undefined"&&(shortNameFlagList[d]||shortNameFlagList[d.substring(0,f)])){d=d.substring(0,f)}}return d}function ExpandSchemaName(b,d){d=ExpandString(b,d,1|2|4);if(d=="@"){d=ARKWGetStringByIdx(b,6)}return d}function ExpandGuideName(d,b){return ExpandString(d,b,1|2|4)}function ExpandQualifier(g,s,k,h,v,u){if("extids" in s){do{var d=new Array();var f=new Array();var b=new Array();var w=new FieldList(g,s.extids);w.ToArrays(d,f,b);if(typeof v=="undefined"){v=false}if(v){s.fieldids=d;s.fieldvals=f;s.fieldtypes=b;s.fieldexterns=new Array();for(var o=0;o<s.fieldids.length;o++){s.fieldexterns.push(true)}break}else{if(!u){u="DisabledSessionExcludedTableAutoRefreshCall"}req=new NDXCompileExternalQualification(g,ARKWGetStringByIdx(g,7),ARKWGetStringByIdx(g,6),ARKWGetStringByIdx(g,17),h,k,s.qual,d,f,b,u);s=req.result}}while("extids" in s)}if(typeof s.fieldids=="undefined"||s.fieldids==null){s.fieldids=new Array();s.fieldvals=new Array();s.fieldtypes=new Array();s.fieldexterns=new Array()}if("ids" in s){var w=new FieldList(g,s.ids);w.ToArrays(s.fieldids,s.fieldvals,s.fieldtypes);for(var o=0;o<s.ids.length;o++){s.fieldexterns.push(false)}}return s}function containsExternal(b){return b.toLowerCase().indexOf("external")!=-1}var REGEXPREF=/\$.*\$/;function containsRef(b){return b.match(REGEXPREF)!=null;return b.toLowerCase().indexOf("$")!=-1}function IsExternQualOptimizable(g,o){if(!("extids" in o)){return false}var s=false;var u=false;var v=new FieldList(g,o.extids);var d=new Array();var f=new Array();var b=new Array();v.ToArrays(d,f,b);for(var k in f){var h=f[k];if(containsExternal(h)){s=true}else{if(containsRef(h)){u=true}}}return !s&&!u}function ExpandKeyword(f,d,g,k,h,s){var v=null;var w=null;var y=/^-{0,2}[0-9]+$/;var o=y.exec(d);if(o!=null){if(o[0]>=0){return v}if(o[0]=="--1"){return""}w=-o[0]+1;if(!ARKWIsKeywordIdx(w)){return v}v="$"+ARKWGetNameByIdx(f,w)+"$"}else{if(ARKWIsKeywordName(f,d)){w=ARKWGetKeywordIdx(f,d)}if(w==null||isNaN(w)||!ARKWIsKeywordIdx(w)){return v}}var u=ARKWIsTemporal(f,w);if(((g&2)&&!ARKWIsTimeRelated(f,w)&&!u)||((g&4)&&u)||((g&16)&&ARKwIsConstant(f,w))){if(s){s.hasKeyword=true;if(u){s.hasTemporalKeyword=true}}var b=ARKWGetByIdx(f,w,k);if(ARKWIsTimeRelated(f,w)){switch(h){case 13:b=b.toDate();break;case 7:b=b.toTime();break;case 14:b=b.toTOD();break;case 3:b=b.toReal();break;case 10:b=b.toDecimal();break;case 2:b=b.toInteger();break}}v=b.toString()}return v}function ExpandFieldReference(f,d,g,y){var w=null;var s=parseInt(d);var v=(isNaN(parseInt(d)))?Field_FindByDBN(f,d):F(f,d);var k=[];if(v==null||v==DummyField){var o=0;var u=-2;while(o<2){u=d.lastIndexOf(".");if(u<1){break}k[o++]=d.substring(u+1,d.length)+"";d=d.substring(0,u);v=(isNaN(parseInt(d)))?Field_FindByDBN(f,d):F(f,d);if(v!=null&&v.mID!=0){break}}}if(v!=null&&v!=DummyField){var b=v.G();if(v.mIsComplexField&&k.length>0){var h=b.compound(k);if(h!=null){w=h.toString()}}else{if(k.length===0){if(typeof y!="undefined"&&y in DatatypeFactories){if(!b.isNull){w=DatatypeFactories[y](b)}else{w=DatatypeFactories[0](b)}w=w.toString()}else{w=b.toString()}}}}else{if(v!=null&&v==DummyField&&v.mObj!=null){b=v.mObj.v;if(b!=null){if(typeof y!="undefined"&&y in DatatypeFactories){if(!b.isNull){w=DatatypeFactories[y](b)}else{w=DatatypeFactories[0](b)}w=w.toString()}else{if(!b.isNull){w=b.toString()}}}}}return w}function ExpandStringInDollar(f,v,g,s,o,u){var B="";var A=previousExpand=sentinel=0;var b=end=0;var z=eQuote=needQuote=false;var w="$";var h=v.split(w);for(var k=0;k<h.length;++k){var d=h[k];if(d==""||(k==(h.length-1))){if(A||(sentinel&&!previousExpand)){B+=w}if(k==(h.length-1)){B+=d}A=1;previousExpand=0;continue}sentinel=1;if(k>0&&!previousExpand){var y;if((g&2)||(g&4)){if(!(h.length==3&&h[0]==""&&h[2]=="")){o=4}y=ExpandKeyword(f,d,g,s,o,u)}if(y==null&&(g&1)){y=ExpandFieldReference(f,d,g)}if(y!=null){d=y;y=null;previousExpand=1}else{if(h.length>1){B+=w}}}else{previousExpand=0}A=0;B+=d}return B}function ExpandPart(g,d,f){var o="$";var h=f;var v=0;var u=d.indexOf(o);var w=-1;var k="";while(u!=-1){k+=d.substring(v,u);w=d.indexOf(o,u+1);if(w>=0){var b=d.substring(u+1,w);var s=null;if((h&2)||(h&4)){s=ExpandKeyword(g,b,h)}if(s==null&&(h&1)){s=ExpandFieldReference(g,b,h)}k+=(s!=null)?s:o+b+o;v=w+1;u=(v<d.length)?d.indexOf(o,v):-1}else{k+=d.substr(u);u=-1;v=d.length}}if(v>0&&v<d.length){k+=d.substr(v)}return k}function ExpandStringInDollarProcess(g,b,s,y,u){var J=" ";var D=b.split(J);var v="$";var C='"';var o=-2;var z="";var h=false;var k=false;for(var H=0;H<D.length;H++){var E=D[H];k=false;var w=E;if(E.length<=0){if(h){z+=" "}continue}else{if(h){z+=" "}}if(!h){o++}var d=E.indexOf(v,1);if(!h&&E.substr(0,1)==v&&E.substr(E.length-1,1)==v&&d==E.length-1){if(E.length>1){var B=E.substring(1,E.length-1);var f=null;if((s&2)||(s&4)){f=ExpandKeyword(g,B,s)}if(f==null&&(s&1)){f=(u&&o>=0&&o<y.length)?ExpandFieldReference(g,B,s,y[o]):ExpandFieldReference(g,B,s)}if(f!=null){E=f}}}else{if(h||E.substr(0,1)==C||E.substr(E.length-1,1)==C){var A=(E.substr(0,1)==C)?true:false;if(h&&A){A=false}if(h&&E.substr(E.length-1,1)==C){h=false;k=true}else{if(E.substr(0,1)==C){if(E.length==1){h=true}else{h=(E.substr(E.length-1,1)==C)?false:true}}}var G=E;if(A){G=" "+E}var I=E.indexOf(v);if(I>=0){G=(A)?" ":""}G+=ExpandPart(g,E,s);E=G}else{if(E.indexOf(v)!=-1){E=ExpandPart(g,E,s)}}}if(z.length>0&&!h&&!k){z+=" "}if(E.length>0){z+=E}}return z}function ExpandString(f,h,d,b,k,g){if(h.indexOf("$")==-1){return h}var o=ExpandStringInDollar(f,h,d,b,k,g);if((d&4)&&ARKWIsTemporalString(f,o)){o=ExpandStringInDollar(f,o,d,b,k,g)}return o}function ExpandStringProcess(d,f,b,g,k){if(f.indexOf("$")==-1){return f}var h=ExpandStringInDollarProcess(d,f,b,g,k);if((b&4)&&ARKWIsTemporalString(d,h)){h=ExpandStringInDollar(d,h,b)}return h}var CacheLocal=new function(){if("localStorage" in window&&window.localStorage!==null){this.mCache=localStorage}this.storeData=function(b,d){this.mCache.setItem(b,d)};this.loadData=function(b){var d=this.mCache.getItem(b);return d};this.removeData=function(b){this.mCache.removeItem(b)};this.clearData=function(){this.mCache.clear()}};var doneFlashCheck=false;function initFlashApp(){if(!doneFlashCheck){var h="WARNING: The configuration is set to enable Flash for global field storage, but could not detect Adobe Flash browser plugin. The application may not work properly.";if(navigator.plugins!=null&&navigator.plugins.length>0){if(!navigator.plugins["Shockwave Flash 2.0"]&&!navigator.plugins["Shockwave Flash"]){LogWrite(h);doneFlashCheck=true;return}}else{var d=null;try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");doneFlashCheck=true}catch(f){LogWrite(h);doneFlashCheck=true;return}if(d==null){LogWrite(h);doneFlashCheck=true;return}}}flashInit=true;var g=document.getElementById("globaldata");if(g!=null){return}var k=document.createElement("div");k.setAttribute("id","globaldata");k.style.top="0px";k.style.left="0px";k.style.width="2px";k.style.height="2px";k.style.zIndex="-999";var b="<object id='SharedObjects' classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' height='100%' width='100%'>";b+="<param name='flashvars' value='bridgeName=SharedObjects'/>";b+="<param name='wmode' value='transparent'/>";b+="<param name='src' value='";b+=RelContextPath;b+="resources/swf/SharedObjects.swf' />";b+="<embed name='SharedObjects' pluginspage='http://www.macromedia.com/go/getflashplayer' src='";b+=RelContextPath;b+="resources/swf/SharedObjects.swf' height='100%' width='100%' wmode='transparent' flashvars='bridgeName=SharedObjects'/>";b+="</object>";document.body.appendChild(k);k.innerHTML=b}function flashAppInitialized(){flashAppInit=true;SharedObjectFlashApp=document.SharedObjects}var flashInit=false;var flashAppInit=false;var SharedObjectFlashApp=null;function setGlobalFields(d){try{var f=getCookie("MJUID");if(f!=null&&f.length>0){if(enableFlashForGlobals){if(!flashInit){initFlashApp()}if(SharedObjectFlashApp!=null&&flashInit&&flashAppInit){d=d.JScriptFlexEncode();SharedObjectFlashApp.setFieldString(f,d)}else{CacheLocal.storeData(f,JSON.stringify(d))}}else{CacheLocal.storeData(f,JSON.stringify(d))}}}catch(b){}}function getGlobalFields(){var f=getCookie("MJUID");var d=null;try{if(f!=null&&f.length>0){if(enableFlashForGlobals){if(!flashInit){initFlashApp()}if(SharedObjectFlashApp!=null&&flashInit&&flashAppInit){d=SharedObjectFlashApp.getFieldString(f)}else{d=JSON.parse(CacheLocal.loadData(f))}}else{d=JSON.parse(CacheLocal.loadData(f))}}}catch(b){}if(d==null){d=""}return d}function removeGlobalFields(){var d=getCookie("MJUID");try{if(d!=null&&d.length>0){if(enableFlashForGlobals){if(!flashInit){initFlashApp()}if(SharedObjectFlashApp!=null&&flashInit&&flashAppInit){value=SharedObjectFlashApp.removeFieldString(d)}else{CacheLocal.removeData(d);CacheLocal.clearData()}}else{CacheLocal.removeData(d);CacheLocal.clearData()}}}catch(b){}}function setProxyGlobalFields(b){gfProxyTempStorage=b}function getProxyGlobalFields(){return(gfProxyTempStorage)}var gfProxyTempStorage=null;var lCache=false;function initFlashBackground(f,h){var d=parseInt(h);if(d>0){var b=parseInt(f);var g=getFormContext(b).fields[d];if(g!=null){g.flashInit(true)}}}function DeserializeGlobals(name){var ck=null;var lStore=null;if(name=="GF"){var lStore=getCookie("FC");ck=getGlobalFields();lCache=true}if(lStore==null){ck=loadCookie(name)}if(ck!=null&&ck.length>0){var vals;var sf;if(name=="GF"){sf=getRegexXSS("GF",ck)}if(name=="GKW"){sf=getRegexXSS("GKW",ck)}if(sf!=null&&sf.length>0){ck=sf[0]}else{return null}eval("vals = "+ck+";");return vals}return{}}function SerializeGlobals(d,b,k){var u=[];weDeepSerialise(k,u);u=u.join("");var s=document.cookie;var v=loadCookie(b);var g=s.length;if(v!=null){g-=(3+encodeURIComponent(v).length)}g+=3+encodeURIComponent(u).length;if(b=="GF"){var o=getCookie("FC");if(o==null||o=="0"){deleteCookie("GF","/");o="1";setCookie("FC",o,null,"/",null,null)}if(o=="1"){setGlobalFields(u);lCache=true;return}}if(g>=4096&&b!="GKW"){if(getCurWFC_NS(d)==null){var h={t:2,n:9360,m:null,a:null};var f=promptBar.msgTypeToSysMsgDest(promptBar.ARTypetoPromptType(2));new WorkflowContext(d,{f:WC_DisplayMessage,a:[d,[{mstat:h,msgloc:f}]]})}else{throw new WorkflowException(d,0,[{t:2,n:9360,m:null,a:null}])}}else{setCookie(b,u,null,"/",null)}}function setCookie(f,h,b,o,g){var k=false;if(document.URL.indexOf("https://")==0){k=true}var d=f+"="+encodeURIComponent(h)+((b)?"; expires="+b.toGMTString():"")+((o)?"; path="+o:"")+((g)?"; domain="+g:"")+((k)?"; secure":"");document.cookie=d;if(typeof cookies=="object"){if(cookies[f]!=undefined){cookies[f]=h}}}function deleteCookie(d,g,f){var b=new Date();b.setTime(b.getTime()-1);setCookie(d,"",b,g,f);if(typeof cookies=="object"){if(cookies[d]!=undefined){cookies[d]=""}}}var ConfirmPopupOpen=false;function ARRegisterTableRefreshInterval(b,k,d){window.clearInterval(getTbRefreshIntervals_NS(b)[k.mID]);delete getTbRefreshIntervals_NS(b)[k.mID];var g=0;if(isTableAutoRefreshEnabled&&d>0&&d<tableAutoRefreshMinInterval){g=tableAutoRefreshMinInterval}else{g=d}k.mRefreshInterval=d;if(d>0){var f;if(isTableAutoRefreshExcludedForSessionTimeout){f="SessionExcludedTableAutoRefreshCall"}var h=window.setInterval(function(){if(!ConfirmPopupOpen){new WorkflowContext(b,{t:k,f:k.Refresh,a:[-1,0,false,undefined,f]})}},g*60*1000);getTbRefreshIntervals_NS(b)[k.mID]=h}}function FormatDate(f){var b=localeInfo.daysShort[f.getDay()]+" "+localeInfo.monthsShort[f.getMonth()]+" "+f.getDate()+" "+f.getFullYear()+" "+(f.getHours()<10?("0"+f.getHours()):f.getHours())+":"+(f.getMinutes()<10?("0"+f.getMinutes()):f.getMinutes())+":"+(f.getSeconds()<10?("0"+f.getSeconds()):f.getSeconds())+"."+f.getMilliseconds();return b}function colorValue(v){if(v){var f=v.indexOf("#")>-1;var k=((f)?/^(\w{2})(\w{2})(\w{2})$/:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/);var u=k.exec(v.replace("#",""));if((u)&&(u.length==4)){var h=(f)?16:10;var s=(parseInt(u[1],h).toString(16));s=((s=="0")?"00":s);var o=(parseInt(u[2],h).toString(16));o=((o=="0")?"00":o);var d=(parseInt(u[3],h).toString(16));d=((d=="0")?"00":d);return"#"+s+o+d}}return""}function getRegexXSS(d,b){if(d=="GF"){return b.match(/\{((\d*\:\{t\:\d*,v\:(null|\"((?!\\\\\\\").*)\"),a\:\{([^}]*)\}\}),*)*\}/g)}else{return b.match(/\{((\d*\:\{n\:\"((?!\\\\\\\").*)\",t\:\d*,v\:(null|\"((?!\\\\\\\").*)\"|\d*)\},*)*)\}/g)}}function isValidIPv4(b){var d=/^(([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))\.){3}([01]?[0-9]?[0-9]|2([0-4][0-9]|5[0-5]))$/;if(b.match(d)){return true}else{return false}}var AbsDocumentPath;function GetDocumentLocation(){var g=document.location;var d=g.protocol+"//"+g.hostname;if(document.location.href.indexOf(d)==-1){d=g.protocol+"//["+g.hostname+"]"}if(g.port){d+=":"+g.port}var f=g.pathname;var b=f.length;if(f.charAt(b-1)!="/"){b=f.lastIndexOf("/");f=f.substring(0,b+1)}return d+f}function SetContextPath(){if(typeof(AbsContextPath)=="undefined"||AbsContextPath==null){AbsDocumentPath=GetDocumentLocation();AbsContextPath=AbsDocumentPath+RelContextPath;var f=AbsContextPath.split("/");var d=[];for(var b=0;b<f.length;++b){if(f[b]==".."){d.pop()}else{d.push(f[b])}}AbsContextPath=d.join("/")}else{AbsDocumentPath=""}}function FakeButton_SetAlternative(d,h){if(d.children[0]&&d.children[0].children[0]&&d.children[0].children[0].className=="btnimg"){var b=d.children[0].children[0];if(Boolean(parseInt(b.getAttribute("arimgcenter")))==true){var g=b.getAttribute("artxt");var k=(h)?getLocalizedMessage("{0} Disabled",[g]):g;b.alt=k;b.title=k;if(d.children[0].children[1]&&d.children[0].children[1].className=="btnimg"){var f=d.children[0].children[1];f.alt=k;f.title=k}}}else{var u=SharedSupport_GetAnchorText(d);if(u.trim(1|2)==""){if("artxt" in d){u=d.artxt}else{return}}var s=Field_FromElement(d.parentElement);if(s!=null&&(s.mObj.getAttribute("artype")=="AttachmentPool"||s.mObj.getAttribute("artype")=="Table")){var o=[u,s.GLabel()];d.title=(h)?getLocalizedMessage("{0} for table {1} is disabled",o):getLocalizedMessage("{0} for table {1}",o)}else{d.title=(h)?getLocalizedMessage("{0} Disabled",[u]):u}}}function SharedSupport_GetAnchorText(b){var d=[];var f=b.firstChild;while(f){if(f.firstChild){f=f.firstChild}else{if(f.nodeType==3&&f.nodeValue!="\n"){d.push(f.nodeValue)}while(!(f.nextSibling)){f=f.parentNode;if((f==b)||(f==null)){d=d.join("");return d}}f=f.nextSibling}}return""}function FakeButton_MouseDown(d,b){if(!FakeButton_Disabled(d)){d.className=d.className.replace(/btn3d/,"btn3ddown");d.className=d.className.replace(/toolbarBtn/,"toolbarBtnDown")}}function FakeButton_MouseUpOut(d,b){d.className=d.className.replace(/btn3ddown/,"btn3d");d.className=d.className.replace(/toolbarBtnDown/,"toolbarBtn")}function FakeButton_Disabled(b){return b.className.indexOf("btnd")!=-1}function FakeButton_TabableElementSelector(b){if(!FakeButton_Disabled(b)&&(!b.style||(b.style.visibility!="hidden"))){return b}else{return null}}function FakeButton_Find(g){for(var d=0;g;g=g.parentNode){if(g.nodeType==1&&g.tagName=="A"&&g.className){var f=g.className.split(" ");for(var b in f){if(f[b]=="btn"||f[d]=="btnflt"||f[b]=="pagebtn"){return g}}}}return null}function getLocalizedMessage(h,b,f){var d=(f==null)?h:f+"|"+h;var g=(typeof localizedMessages=="undefined")?window.weOpener.localizedMessages[d]:localizedMessages[d];if(g==null){g=h}if(b==null||b.length<0){return g}return subArgsMessages(g,b)}function subArgsMessages(k,b){var g=k;if(b==null||b.length<0){return g}var f;var d=0;while(true){var h=0;f=new RegExp("\\{"+d+"\\}","gi");while(f.test(g)){g=g.replace(f,b[d]);h++}if(h==0){break}d++}return g}function CompileFunction(str,args,subs){for(var i in subs){str=str.replace(new RegExp(i,"g"),subs[i])}eval("window.CompiledFunction=function("+args+"){"+str+"}")}function ComputeElementPosition(g,f,b,k){while(g!=f&&g.tagName!="HTML"){var h=parseInt(g.style.borderTopWidth);var d=parseInt(g.style.borderLeftWidth);k+=g.offsetTop;b+=g.offsetLeft;b-=g.scrollLeft;k-=g.scrollTop;if(!isNaN(h)){b+=h}if(!isNaN(d)){k+=d}if(g.offsetParent!=null){g=g.offsetParent}else{break}}return{x:b,y:k}}var head=document.getElementsByTagName("head")[0];function createScriptTag(f,g,d){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("language","JavaScript");b.setAttribute("src",f);if(d){b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){vfScriptLoaded(f,g,d)}};b.onload=function(){vfScriptLoaded(f,g,d)};b.onerror=function(){vfScriptLoaded(f,g,d)}}head.appendChild(b);if(typeof g!="undefined"){g()}}var vfScriptRetries=new Array();function vfScriptLoaded(d,f,b){if(typeof window[b]=="undefined"){var g=vfScriptRetries[d];if(typeof g=="undefined"){g=0}g++;vfScriptRetries[d]=g;if(g<=window.backChannelRetryFrequency){setTimeout(function(){createScriptTag(d,f,b)},window.backChannelRetryInterval)}else{vfScriptRetries[d]=0;MessagePopup(getCurrentWindowID_NS(),[{n:9351,t:2,m:null,a:null}])}}else{}}function createStyleTag(b){var d=document.createElement("link");d.href=b;d.rel="stylesheet";d.type="text/css";document.body.appendChild(d)}function embedScript(f){try{var b=document.createElement("SCRIPT");b.type="text/javascript";b.appendChild(document.createTextNode(f));head.appendChild(b)}catch(d){}}function embedStyle(f){try{var d=document.getElementsByTagName("head")[0];var g=document.createElement("style");g.type="text/css";g.appendChild(document.createTextNode(f));d.appendChild(g)}catch(b){}}function callFunction(g,s,o,u,b){try{var f=window;var d=null;if(g!=null&&g.length>0){f=window[g]}if(s in f){d=f[s];if(typeof u!="undefined"){o.push(u)}if(typeof b!="undefined"){o.push(b)}var k=d.apply(f,o);if(typeof k!="undefined"){return k}}}catch(h){}}function callDVFFunction(d,b,h,k,g){var f=F(d,b).callInternalFunction(h,k,g);if(typeof f!="undefined"){return f}}var OpenedMenu=null;function Menu_DispatchEvent(f,d){if(OpenedMenu==null){return false}if(f==4&&OpenedMenu.mElementStack.length>0){return OpenedMenu.mElementStack[OpenedMenu.mElementStack.length-1].HandleKeyEvent(d)}var g=d.element;while(g&&g!=document.body){var b=g.getAttribute("armenuelementserial");if(g.tagName=="DIV"&&b&&b.length>0){OpenedMenu.mElements[g.getAttribute("armenuelementserial")].HandleMouseEvent(f,d);return true}g=g.parentNode}if(f==2||(f==0)){Menu_Close()}return false}var nextZIndex=100001;function GetAppStyleSheet(f){var b=getCurrentWindowID_NS();var d=(((ARKWGetStringByIdx(b,21)!=null)?ARKWGetStringByIdx(b,21):"")=="")?"":f+"apps/"+encodeURIComponent(ARKWGetStringByIdx(b,7))+"/"+encodeURIComponent(((ARKWGetStringByIdx(b,21)!=null)?ARKWGetStringByIdx(b,21):""))+"/resources/stylesheets/ARSystem.css"}function isextensionmatch(d,g){if(this.parent!=null&&this.parent.D2MaskForAttachment!=undefined&&this.parent.D2MaskForAttachment&&(this.parent.D2MaskForAttachment=="true")){return true}var h=g.replace(/ /g,"").split(",");var k=d.split(".");extension=k[k.length-1];var b;for(var f=0;f<h.length;f++){if(h[f].toLowerCase()===extension.toLowerCase()){b=true;break}else{b=false}}return b}function FakeButton_SetDisable(g,d){var b=(g.className.indexOf("btnflt")!=-1);var f=(b)?" btndflt":" btnd";if(g.children[0]&&g.children[0].children[0]&&g.children[0].children[0].id.indexOf("dis_img")!=-1&&b){f="btndflt"}if(g.className.indexOf("chunk")!=-1){f=""}g.className=g.className.replace(/[ ]*(btndflt|btnd)[ ]*/," ");if(d){g.className+=f;g.className=g.className.replace(/toolbarBtn/,"toolbarBtnD");if(g.className.indexOf("btnfltd")==-1){g.className=g.className.replace(/btnflt/,"btnfltd")}g.className=g.className.replace(/chunkleft/,"chunkleftbtnd");g.className=g.className.replace(/chunkright/,"chunkrightbtnd");if(g.children[0]&&g.children[0].children[0]&&g.children[0].children[0].id.indexOf("dis_img")!=-1){g.children[0].children[0].style.visibility="inherit";if(g.children[0]&&g.children[0].children[1]){g.children[0].children[1].style.visibility="hidden"}}}else{g.className=g.className.replace(/toolbarBtnD/,"toolbarBtn");g.className=g.className.replace(/btnfltd/,"btnflt");g.className=g.className.replace(/chunkleftbtnd/,"chunkleft");g.className=g.className.replace(/chunkrightbtnd/,"chunkright");if(g.children[0]&&g.children[0].children[0]&&g.children[0].children[0].id.indexOf("dis_img")!=-1){g.children[0].children[0].style.visibility="hidden";if(g.children[0]&&g.children[0].children[1]){g.children[0].children[1].style.visibility="visible"}}}if(g.children[0]&&g.children[0].children[0]&&g.children[0].children[0].className=="btnimg"){FakeButton_SetAlternative(g,d)}}var LogWindow=null;var clientLogEnabled=serverLogEnabled=timingsLogEnabled=0;var logTimings=false;var logBuffer="";var logBuffertemp="";var IDs={logWindow:"logWindowId",logMainBody:"logMainBody",logToolbar:"logToolbar",logButton:"logBtn"};var btnTypes={Clear:true};var LogExeStrs={4:"Submit",4096:"After Submit",8:"Modify",2048:"After Modify",1024:"Search",512:"Set Default",16:"Display",65536:"Un-Display",16384:"Window Open",32768:"Window Closed",262144:"Window Loaded",1048576:"Event",524288:"Interval",1:"Button/Menu Field",2:"Return",128:"Menu Choice",8192:"Gain Focus",256:"Lose Focus",2097152:"Table Refresh",4194304:"Hover on Label",8388608:"Hover on Data",16777216:"Hover on Field",33554432:"Expand",67108864:"Collapse",134217728:"Drag",268435456:"Drop"};function LogInit(){clientLogEnabled|=ARPrefsGetAsNumber(20112);timingsLogEnabled|=ARPrefsGetAsNumber(23605);serverLogEnabled|=ARPrefsGetAsNumber(20113)|ARPrefsGetAsNumber(20114)|ARPrefsGetAsNumber(20115);LogInit1()}function writeLogStyles(){var b='<style>pre {margin-bottom:0px;margin-top:0px}div{font-size:10pt;font-family:"Courier";}div.actionn {font-style: italic;}div.action {}div.event {font-size:10pt; font-style: bold;color:blue;}div.aract {padding-left:25px;font-weight:bold; color:#FFA100;}div.aract_non_deb {padding-left:25px;}* {padding: 0px;margin: 0px;}#logWindowId { font:11px/1.3 arial, tahoma, verdana, serif; font-style: normal;font-weight: normal;color: #000000;background: white;}div.header {width: 100%;background: #dee0e0;float: left;position:fixed;}div.main {width:100%;background: #ffffff;float: left;}div.footer {width: 100%;background: #959FA6;float: left;padding-left: 3%;bottom:0;position:fixed;}div.header .left{width: 68%;padding-left: 4%;float: left;}div.header .right{width: 20%;padding-bottom: 4%;padding-left: 4%;float: left;}div.main .left{padding: 0 ;float: left;}div.main .mainBody{width: 96%;padding-bottom: 4%;margin-top: 5%;margin-bottom:2%;margin-left: 3%;float: left;}div.main .right{float: left;}div.footer .left{}div.footer .right{}table.logToolbar{width:500px;height:10px;background-color:#dee0e0;margin:0px;}</style>';return b}function writeScriptTag(){var b='<script type="text/javascript"><\/script>';return b}function LogInit1(){try{if(LogWindow==null||LogWindow.closed){var k=weGetOpener(getTopWinWindowID_NS());if(k!=null&&!k.closed&&k.LogWindow&&!k.LogWindow.closed){LogWindow=k.LogWindow}}}catch(d){}if((clientLogEnabled||serverLogEnabled||timingsLogEnabled)&&(LogWindow==null||LogWindow.closed)){var h=0;var g=0;var f=Math.floor(window.screen.availWidth/2);var b=Math.floor(window.screen.availHeight/2);LogWindow=window.open("","Log"+document.domain.replace(/[^A-Za-z0-9_]/g,"_"),"width="+(f-10)+",height="+(b-28)+",top="+g+",left="+h+",scrollbars,resizable=yes");LogWindow.document.write('<html><head><meta http-equiv="content-type" content="text/html;charset=utf-8">'+writeScriptTag()+"<title>Workflow Logging - "+document.domain+"</title>"+writeLogStyles()+"</head><body>");LogWindow.document.write('<script type="text/javascript">function clearLogsAfterLogOut() { var logDIV = document.getElementById(\'logMainBody\'); if(null != logDIV && "" != logDIV.innerHTML) { logDIV.innerHTML=""; } } <\/script>');generateMarkup()}}function generateMarkup(){var g=false;if(LogWindow.document.body){var f=LogWindow.document.body.children;if(f){for(i=0;i<f.length;i++){if("logWindowId"==f[i].id){g=true;break}}}}if(g){return}var d=[];for(type in btnTypes){d.push(['<input value="',type,'" class="',type,'" type=button onclick="',type,'Btn()"/>'].join(""))}var b=LogWindow.document.createElement("DIV");b.id=IDs.logWindow;b.style.display="block";b.innerHTML=['<div class="header">','<div class="left">','<table id="',IDs.logToolbar,'" class="logToolbar" title="Log Toolbar">',"<tbody>",'<td title="Clear Log">',d.join(""),"</td>","</tbody>","</table>","</div>",'<div class="right"></div>',"</div>",'<div class="main">','<div class="left"></div>','<div id="',IDs.logMainBody,'" class="mainBody"></div>','<div class="right"></div>',"</div>",'<div class="footer">','<div class="left">Logging...</div>','<div class="right"></div>',"</div>"].join("");if(LogWindow.document.body){LogWindow.document.body.appendChild(b);addBtnFns()}}function addBtnFns(){var d=LogWindow.document.getElementsByTagName("SCRIPT")[0];var b="function ClearBtn(){ try { window.opener.ClearBtn() } catch(ex) {clearLogsAfterLogOut();} }";if(d!="undefined"){d.text+=b}}function ClearBtn(){var b=$(LogWindow.document.body).find("div.mainBody");if(b[0]!="undefined"){logBuffertemp=b[0].innerHTML;b[0].innerHTML=""}}function addLogBuffer(g){try{var d=LogWindow.document.getElementById("logMainBody");if(d&&d!="undefined"){var b=LogWindow.document.createElement("DIV");b.innerHTML=g;d.appendChild(b)}else{LogWindow.document.write(g)}}catch(f){}}function getLogWindowObjectById(d){try{return LogWindow.document.getElementById(d)}catch(b){}}function LogWriteServer(b){if(!serverLogEnabled&&!timingsLogEnabled){return}LogWrite(b,false)}function LogWrite(h,g){if(!clientLogEnabled&&!serverLogEnabled&&!timingsLogEnabled){return}var f=false;if(!g){f=true}else{f=!g}if(h){if(!f){logBuffer+=h}else{if(h.length<=LOG_BUFFER_CHUNK_SIZE){logBuffer+="<pre>"+h.removeXssVulnerability()+"</pre>"}else{do{var b=h.substr(LOG_BUFFER_CHUNK_SIZE).indexOf(" ");if(b!=-1){b+=LOG_BUFFER_CHUNK_SIZE}else{b=LOG_BUFFER_CHUNK_SIZE}var d=(new Date()).getTime()+mapIndexToId.length;logBuffer+='<pre id="logPre'+d+'"></pre>';logMsgByPreId[d]=h.substr(0,b).removeXssVulnerability();mapIndexToId[mapIndexToId.length]=d;h=h.substr(b)}while(h.length>0)}}}}var LOG_BUFFER_CHUNK_SIZE=10000;var mapIndexToId=new Array();var logMsgByPreId=new Array();function FlushLogBuffer(){if(logBuffer.length>0){LogInit1();addLogBuffer(logBuffer);for(var d=0;d<mapIndexToId.length;d++){var b=getLogWindowObjectById("logPre"+mapIndexToId[d]);if(b){b.innerHTML=logMsgByPreId[mapIndexToId[d]]}LogWindow.scroll(0,1000000000)}LogWindow.scroll(0,1000000000)}logMsgByPreId=new Array();mapIndexToId=new Array();logBuffer=""}function getguidelevelstr(b){var g=getCurWFC_NS(b).getGuideLevels();if(g==null){return""}var d="";for(var f=0;f<g;f++){d+="&nbsp;&nbsp;"}return d}function LogActionNum(d,g){var b=getguidelevelstr(d)+"&nbsp;"+g;var f='<div class="actionn">'+b+"</div>";LogWrite(f,true)}function LogPath(d,g){var b=getguidelevelstr(d)+g;var f="<div>"+b+"</div>";LogWrite(f,true)}function LogEvtType(b,h,f){if(h==524288){return""+f}else{if(h==1){var g=getFields_NS(b)[f];if(g){var d=g.GLabelOrName();return d+"("+f+")"}else{return""+f}}else{if(h>=2&&h<=268435456){var g=getFields_NS(b)[f];if(g){var d=g.GLabelOrName();return d+"("+f+")"}else{return""+f}}}}return""}function LogEvent(f,k,g){if(k==-1||k==524288){return}var s=new Date();var h=getFormContext(f);var b=getguidelevelstr(f)+"EVENT Start:- "+LogExeStrs[k]+" | ";if(g&&g!=-1){b+="&nbsp"+LogEvtType(f,k,g)}if(h){b+="&nbsp;&nbsp;|&nbsp;"+h.formName+"/"+h.view}b+="&nbsp;&nbsp;&nbsp;"+s.toDateString()+"&nbsp;"+s.toLocaleTimeString();var o='<div class="event">'+b+"</div>";LogWrite(o,true)}function LogEndofEvent(f,k,g){if(k==-1){return}var s=new Date();var h=getFormContext(f);if(k==524288){b=getguidelevelstr(f)+"EVENT End:- Interval "+g+" secs"}else{var b=getguidelevelstr(f)+"EVENT End:- "+LogExeStrs[k]+" | ";if(g&&g!=-1){b+="&nbsp"+LogEvtType(f,k,g)}}if(h){b+="&nbsp;&nbsp;|&nbsp;"+h.formName+"/"+h.view}b+="&nbsp;&nbsp;&nbsp;"+s.toDateString()+"&nbsp;"+s.toLocaleTimeString();var o='<div class="event">'+b+"</div>";LogWrite(o,true)}function LogEventEvent(f,g,k){var s=new Date();var h=getFormContext(f);var b="EVENT: Event "+g+" ";b+=((k==null)||(k=="null"))?"no data":k.removeXssVulnerability();if(h){b+="&nbsp;&nbsp;|&nbsp;"+h.formName+"/"+h.view}b+="&nbsp;&nbsp;&nbsp;"+s.toDateString()+"&nbsp;"+s.toLocaleTimeString();var o='<div class="event">'+b+"</div>";LogWrite(o,true)}function LogInterval(f,g){var o=new Date();var h=getFormContext(f);var b="EVENT Start:- Interval "+g+" secs";if(h){b+="&nbsp;&nbsp;|&nbsp;"+h.formName+"/"+h.view}b+="&nbsp;&nbsp;&nbsp;"+o.toDateString()+"&nbsp;"+o.toLocaleTimeString();var k='<div class="event">'+b+"</div>";LogWrite(k,true)}function LogAction(d,g){var b=getguidelevelstr(d)+"&nbsp;"+g;var f='<div class="action">'+b+"</div>";LogWrite(f,true)}function LogGuideExit(d,g){var b=getguidelevelstr(d)+"Exiting Guide : "+g;var f='<div class="event">'+b+"</div>";LogWrite(f,true)}function LogGuideExitAll(d){var b=getguidelevelstr(d)+"Exiting All Guides";var f="<div>"+b+"</div>";LogWrite(f,true)}function LogLoopGuide(d,g){var b=getguidelevelstr(d)+"LoopGuide: "+g;var f="<div>"+b+"</div>";LogWrite(f,true)}function LogGuideMessage(d,g){var b=getguidelevelstr(d)+g;var f="<div>"+b+"</div>";LogWrite(f,true)}function LogGuideMessage1(d,g,h){var b=getguidelevelstr(d);b=b+"Guide Called "+g+" On Server "+h;var f='<div class="event">'+b+"</div>";LogWrite(f,true)}function ActiveLinkLogWriteExt(f,o){var b=getguidelevelstr(f)+o;var g=getFormContext(f);if(g){b+=" | "+g.formName+"/"+g.view}var k=new Date();b+=" - "+k.toDateString()+" "+k.toLocaleTimeString()+" ms "+k.getMilliseconds();var h='<div class="event">'+b+"</div>";ActiveLinkLogWrite(h,true)}function ActiveLinkLogWriteEnd(f,o){var b=getguidelevelstr(f)+o;var g=getFormContext(f);if(g){b+=" | "+g.formName+"/"+g.view}var k=new Date();b+=" - "+k.toDateString()+" "+k.toLocaleTimeString()+" ms "+k.getMilliseconds();var h='<div class="event">'+b+"</div>";ActiveLinkLogWrite(h,true)}function ActiveLinkLogWrite(d,b){FlushLogBuffer();if(d){LogWrite(d,b)}}function LogAndAlert(b){if(clientLogEnabled){LogWrite("Alert: "+b)}alert(b)}function getCurrentDate(){var b=new Date();return b.toLocaleString()}var curClickElement=null;FormEvent.Trampoline=function(b){return function(g){var f=new FormEvent(g);var d=b(f);if(typeof d=="boolean"&&d==false){f.StopDefault()}else{if(typeof d=="string"){if(!(this.name.match("^VF")=="VF")){licenseSessionCloseWindow()}return d}}}};function FormEvent(){var b=0;var f=null;if(arguments.length==2){b=arguments[0];f=arguments[1]}else{f=arguments[0]}this.mStoppedDefault=false;if(typeof f!="number"){this.PDBuild(f);if(getFormContext(b)){realtimeKeyMap[49]=this.shift?1:0;realtimeKeyMap[50]=this.alt?1:0;realtimeKeyMap[51]=this.ctrl?1:0}}else{var d=getFields_NS(b)[f].GetFocusElement();this.alt=this.ctrl=this.shift=this.key=this.ox=this.oy=this.button=0;this.element=d}}FormEvent.prototype.PDBuild=function(b){this.alt=b.altKey;if(navigator.platform.indexOf("Mac")!=-1){this.ctrl=b.metaKey}else{this.ctrl=b.ctrlKey}this.shift=b.shiftKey;this.key=b.keyCode;this.button=b.button;this.meta=b.metaKey;this.ox=window.event.offsetX;this.oy=window.event.offsetY;this.element=b.target;if(this.element!=null&&this.element.nodeType==3){this.element=this.element.parentNode}this.mEventObject=b;this.mMouseX=window.event.clientX;this.mMouseY=window.event.clientY};FormEvent.prototype.PDStopBubbling=function(){this.mEventObject.stopPropagation()};FormEvent.prototype.PDStopDefault=function(){if(this.mEventObject.preventDefault){this.mEventObject.preventDefault()}this.mEventObject.stopPropagation();this.mStoppedDefault=true};FormEvent.prototype.PDSetKeyCode=function(b){};FormEvent.PDFireChangeEvent=function(d){var b=document.createEvent("HTMLEvents");b.initEvent("change",true,false);d.dispatchEvent(b)};FormEvent.PDFireClickEvent=function(d){var b=document.createEvent("MouseEvents");b.initEvent("click",true,true);d.dispatchEvent(b)};FormEvent.PDFireClickEventFromSRCElement=function(d,g,f){var b=document.createEvent("MouseEvents");b.initEvent("click",true,true);curClickElement={ele:g,screenX:f.screenX,screenY:f.screenY};d.dispatchEvent(b)};FormEvent.prototype.StopBubbling=FormEvent.prototype.PDStopBubbling;FormEvent.prototype.StopDefault=FormEvent.prototype.PDStopDefault;FormEvent.prototype.SetKeyCode=FormEvent.prototype.PDSetKeyCode;FormEvent.FireChangeEvent=FormEvent.PDFireChangeEvent;FormEvent.FireClickEvent=FormEvent.PDFireClickEvent;FormEvent.FireClickEventFromSRCElement=FormEvent.PDFireClickEventFromSRCElement;FormEvent.lastMouseDownEvent=null;function FillLayoutPolicy(){this.mNumVisibleChildren=0;this.mLayoutFields={};this.mWidth=0;this.mHeight=0}FillLayoutPolicy.prototype.RegisterLayoutField=function(g,d){this.mLayoutFields[g.mID]=g;this.mNumVisibleChildren++;if(d==true){var b=Math.round(100/this.mNumVisibleChildren);for(var f in this.mLayoutFields){if(this.mLayoutFields[f]!=null){this.mLayoutFields[f].perWidth=100;this.mLayoutFields[f].perHeight=b}}this.ReCalculateLayout()}};FillLayoutPolicy.prototype.DeRegisterLayoutField=function(f){if(f in this.mLayoutFields){this.mLayoutFields[f]=null;this.mNumVisibleChildren--;var b=Math.round(100/this.mNumVisibleChildren);for(var d in this.mLayoutFields){if(this.mLayoutFields[d]!=null){this.mLayoutFields[d].perWidth=100;this.mLayoutFields[d].perHeight=b}}this.ReCalculateLayout()}};FillLayoutPolicy.prototype.ReCalculateNewLayout=function(d,b){this.mWidth=d;this.mHeight=b;for(var f in this.mLayoutFields){if(this.mLayoutFields[f]!=null&&this.mLayoutFields[f].mFlowID==0){if(resizeWindow){this.mLayoutFields[f].ResizeTo(d,b)}else{return}}else{if(this.mLayoutFields[f]!=null){this.mLayoutFields[f].ResizeTo(d,b)}}}};FillLayoutPolicy.prototype.ReCalculateLayout=function(){for(var b in this.mLayoutFields){if(this.mLayoutFields[b]!=null){this.mLayoutFields[b].ResizeTo(this.mWidth,this.mHeight)}}};function FormPane(b,f,o,h,k,g){this.windowID=b;this.mFixedHeight=f;this.mHandler=k;this.mHandlerObj=(g!=null)?g:this;this.mObj=o;this.mVisible=h;this.mFillStyle=0;this.mNewZindex=this.mOrigZIndex=this.mObj.style.zIndex;this.mObj.setAttribute("arwindowid",b);var d=this.mObj.getAttribute("arfillstyle");if(d!=null){this.mFillStyle=parseInt(d)}if(this.mFillStyle==1){this.mObj.style.overflow="auto"}if(!h){this.mObj.style.left="100000px"}this.mHeight=0;this.mY=0;getFormPaneMPanes_NS(this.windowID).push(this)}FormPane.prototype.SetNewZIndex=function(b){this.mNewZIndex=b;this.mObj.style.zIndex=b};FormPane.prototype.ResetZIndex=function(){this.mNewZIndex=this.mOrigZIndex;this.mObj.style.zIndex=this.mOrigZIndex};FormPane.prototype.ResizeChildren=function(d,b){for(var f in this.mLayoutFields){if(this.mLayoutFields[f]!=null){this.mLayoutFields[f].ResizeTo(d,b)}}};FormPane.prototype.SVis=function(b){this.mVisible=b;this.mObj.style.left=(b?0:100000)+"px"};FormPane.prototype.GVis=function(){return this.mVisible};FormPane.prototype.changeHeight=function(b){this.mFixedHeight=b};FormPane.prototype.getHeight=function(){return this.mHeight};FormPane.Layout=function(f){var G=getFormPaneMPanes_NS(f);var d=G.length,A=0,k=0;for(var g=0;g<d;++g){var u=G[g];if(u.mVisible){if(u.mFixedHeight!=-1){u.mHeight=u.mFixedHeight;A+=u.mHeight}else{u.mHeight=0;++k}}}var z=getLogicalWindow(f);var s=0;var E=0;if(z){s=z.mObj.clientHeight;E=z.mObj.clientWidth}else{s=window.innerHeight}if(A<s&&k>0){var v=s-A;for(var g=0;g<d;++g){var u=G[g];if(u.mVisible&&u.mFixedHeight==-1){var D=Math.floor(v/k);u.mHeight+=D;v-=D;--k}}}var C=0;for(var g=0;g<d;++g){var u=G[g];if(u.mVisible){u.mObj.style.height=u.mHeight+"px";u.mObj.style.top=C+"px";u.mY=C;if(u.mHandler){u.mHandler.call(u.mHandlerObj,(E>0)?E:u.mObj.offsetWidth,u.mHeight)}C+=u.mHeight;if(u.mObj.id=="FormContainer"){u.mObj.style.overflow="hidden"}}}var B=(E>0)?E:(window.innerWidth+1);var b=getFormElements_NS(f)["FormContainer"],o=b.childNodes[1];setTimeout(function(){b.style.overflow="auto";b.scrollLeft=0;b.scrollTop=0},100);if(getFormContainerPaneSH_NS(f)==null){setFormContainerPaneSH_NS(f,o.getAttribute("arbkimgy"));setFormContainerPaneSW_NS(f,o.getAttribute("arbkimgx"))}if(o.nodeType==1&&o.className=="FormContainerBackground"){o.style.height=((getFormContainerPane_NS(f).mFillStyle==1)?getFormContainerPane_NS(f).mHeight:(getFormContainerPane_NS(f).mHeight>getFormContainerPaneSH_NS(f)?getFormContainerPane_NS(f).mHeight:getFormContainerPaneSH_NS(f)))+"px";o.style.width=((getFormContainerPane_NS(f).mFillStyle>=1)?(B-1):getFormContainerPaneSW_NS(f))+"px"}if(rtfEditor!=null&&rtfEditor.mEditing!=null){rtfEditor.UpdatePos()}};FormPane.Layout2=function(b){setARInitPane_NS(b,true);FormPane.Layout(b);setARInitPane_NS(b,null);for(var f in getLayoutParentFields_NS(b)){var d=getLayoutParentFields_NS(b)[f];if(d==null||d.mObj.style.visibility=="hidden"||d.mObj.style.display=="none"){continue}d.ResizeChildren()}};function ToolbarButtonIterator(d,b){var g=getFormElements_NS(d)["Toolbar"];do{if(!(typeof b=="function")){Assert('(Form.js:143) typeof iter=="function"')}}while(0);do{if(!(b.length==2)){Assert("(Form.js:144) iter.length==2")}}while(0);do{if(!(g.childNodes[2].tagName=="TABLE")){Assert('(Form.js:145) outer.childNodes[2].tagName=="TABLE"')}}while(0);var f=g.childNodes[2].firstChild.firstChild.firstChild;while(f!=null){if(f.nodeType==1){do{if(!(f.tagName=="TD")){Assert('(Form.js:149) gcell.tagName=="TD"')}}while(0);var h=f.firstChild;while(h!=null){if(h.nodeType==1){do{if(!(h.tagName=="A")){Assert('(Form.js:153) gbut.tagName=="A"')}}while(0);b(h,h.className.split(" ")[0])}h=h.nextSibling}}f=f.nextSibling}}var ModeToToolbarItemMap={};ModeToToolbarItemMap.QUERY="newsearch";ModeToToolbarItemMap.CREATE="newrequest";ModeToToolbarItemMap["SET ALL"]="modifyall";var ToolbarItemMap={searchsavechanges:function(b){if((getARStateCurrent_NS(b)==4)){return getCurWFC_NS(b).executeAll({f:FormActionButtonFlags[1002].f,a:[b]})}else{if((getARStateCurrent_NS(b)==1)){return getCurWFC_NS(b).executeAll({f:FormActionButtonFlags[1001].f,a:[b]})}else{if((getARStateCurrent_NS(b)==5)||(getARStateCurrent_NS(b)==6)){return getCurWFC_NS(b).executeAll({f:FormActionButtonFlags[1003].f,a:[b]})}}}},newsearch:1009,newrequest:1010,modifyall:1004,savedsearches:1013,quickreports:1014,advancedsearch:function(b){if((getARStateCurrent_NS(b)==4)){var d=F(b,1005);d.VisClick()}},clear:1006,settodefaults:1007,statushistory:1011,help:1008,home:1012,logout:ARProcessExitApp};function SimulateModeChange(b,d){setTimeout(function(){if(!(d in ModeToToolbarItemMap)){return}if(formModalList.mStack.length>0){formModalList.Reset()}var f=ToolbarItemMap[ModeToToolbarItemMap[d]];if(typeof f=="function"){new WorkflowContext(b,{f:f,a:[b]})}else{if(f in FormActionButtonFlags){new WorkflowContext(b,{f:FormActionButtonFlags[f].f,a:[b]})}}},10)}function ResizeResultsList(d,f){if(!getResultsListPane_NS(d).GVis()){return}var b=getFields_NS(d);if(1020 in b){b[1020].Resize(f?null:window.innerWidth+1,getResultsListPane_NS(d).mHeight)}}function SetWindowSize(b){try{var g=ARPrefsGetAsNumber(23204);var d=getForm_NS(b).maximizeWindow;if(g==1&&!d){d=true}if(d&&!weAmDialogue(window.name)){top.window.moveTo(0,0);top.window.resizeTo(screen.availWidth,screen.availHeight)}}catch(f){}}function detectPopupBlockers(){var s=getCookie("P");if(s==null){var k=0;try{var o=0;var f=screen.width;var g=window.open("about:blank","PopupTest","width=1,height=1,left="+f+",top="+o+",scrollbars=no,toolbar=no,menubars=no,location=no,status=no,titlebar=no");g.close()}catch(d){window.focus();alert(getLocalizedMessage("Popup blockers must be disabled to use this application."));k=1}var u=AbsContextPath.substring(0,AbsContextPath.length-1);var b=u.indexOf("//");u=u.substring(b+2,u.length);parts=u.split("/");var h="";for(i=1;i<=parts.length-1;i++){if(parts[i]!=""){h+="/"+parts[i]}}u=h;setCookie("P",k+"",null,u,null)}}var windowStatus;var sessionTimeoutInSec=90*60;var timeout;var timeoutID;var bCancelTimOutDlg=false;var bClsSesTimDlg=false;var timeoutmsg="Your session will expire in less than {0} minute(s). Please click Ok if you would like to extend the session.";function initSessionTimeoutCounter(){timeout=getCookie("st");bCancelTimOutDlg=false;if(timeout!=null){sessionTimeoutInSec=parseInt(timeout)}updateSessionTimeoutStatus(sessionTimeoutInSec);if(timeoutID!=null){clearTimeout(timeoutID)}timeoutID=setTimeout("setSessionTimeoutCounter()",60000)}function setSessionTimeoutCounter(){sessionTimeoutInSec-=60;updateSessionTimeoutStatus(sessionTimeoutInSec);timeoutID=setTimeout("setSessionTimeoutCounter()",60000)}function updateSessionTimeoutStatus(g){var b=parseInt(timeout);if(g<=0&&(b>=120)){window.status=windowStatus+" | 00:00";if(window.weDialogueName!=null){var d=getChildWindowIDFromName(window.weDialogueName);var f=getWindowObj(getTopWinWindowID_NS(),d);if(f!=null){$("#"+window.weDialogueName).contents().find("#PopupMsgBox").text(getLocalizedMessage(9201,null,null))}}}else{hours=0;mins=0;out="";hours=Math.floor(g/3600);tmp=g%3600;mins=Math.floor(tmp/60);tmp=tmp%60;if(hours>9){out+=hours+":"}else{out+=(hours>0)?("0"+hours+":"):"00:"}if(mins>9){out+=mins}else{out+="0"+mins}window.status=windowStatus+" | "+out;if((g>0&&g<=300)&&!bCancelTimOutDlg&&bEnblSesToutDlg&&(b>=120)&&(b-g>=60)){if(window.weDialogueName!=null){var d=getChildWindowIDFromName(window.weDialogueName);var f=getWindowObj(getTopWinWindowID_NS(),d);if(f!=null){$("#"+window.weDialogueName).contents().find("#PopupMsgBox").text(getLocalizedMessage(timeoutmsg,[Math.round(sessionTimeoutInSec/60)]))}}else{if(!bClsSesTimDlg){new WorkflowContext(getTopWinWindowID_NS(),{f:function(){var h={};return{c:{f:SessTimeoutPopup,t:this,a:[getTopWinWindowID_NS(),getLocalizedMessage(timeoutmsg,[Math.round(sessionTimeoutInSec/60)]),h,2]},n:{t:this,f:function(){if(("v" in h.result)&&h.result.v==1){if(g>0){var k=GET_XML_HTTP();k.open("POST",AbsContextPath+"shared/keepalive.jsp",true);k.send();initSessionTimeoutCounter()}message_broadcast("OK");setTimeout(function(){bClsSesTimDlg=false;localStorage.removeItem("CLSESSTIMDLG")},50);return}else{if(("v" in h.result)&&h.result.v==-1){message_broadcast("CANCEL");setTimeout(function(){bCancelTimOutDlg=true;localStorage.removeItem("SESSTIMDLGCANCEL")},50);return}}},i:1}}}})}bClsSesTimDlg=false}}}}function message_broadcast(b){if(b=="OK"){localStorage.setItem("CLSESSTIMDLG",JSON.stringify(b))}if(b=="CANCEL"){localStorage.setItem("SESSTIMDLGCANCEL",JSON.stringify(b))}}function message_receive(d){if(d.key=="CLSESSTIMDLG"){var b=JSON.parse(d.newValue);if(b=="OK"){bClsSesTimDlg=true;if(window.weDialogueName!=null){var f=getChildWindowIDFromName(window.weDialogueName);var g=getWindowObj(getTopWinWindowID_NS(),f);if(g!=null){g.weCloseDialogue(f,null);getOpenDIVPopup_NS(getCurrentWindowID_NS()).HidePopup(false);bClsSesTimDlg=false;initSessionTimeoutCounter()}}}}if(d.key=="SESSTIMDLGCANCEL"){var b=JSON.parse(d.newValue);if(b=="CANCEL"){bCancelTimOutDlg=true;if(window.weDialogueName!=null){var f=getChildWindowIDFromName(window.weDialogueName);var g=getWindowObj(getTopWinWindowID_NS(),f);if(g!=null){g.weCloseDialogue(f,null);getOpenDIVPopup_NS(getCurrentWindowID_NS()).HidePopup(false)}}}}}function _ARSystemInitFunc(server,form,view,initFuncs){var sfv=server+"_"+form+"_"+view;for(var i=0;i<initFuncs.length;i++){var initFuncName=(initFuncs[i]+sfv).ARToJSIdentifier();if(initFuncName in window){eval(initFuncName+"();")}}}function SystemInit(){SetContextPath();if(!isPopBlockerDisable){detectPopupBlockers()}licenseSessionInit()}function BrowserWindowInit(b){UserData_Init();LogInit()}function WindowInit(b,d){if(b==getTopWinWindowID_NS()){allocWindowID_NS()}wm.registerWindow(b,d);if(b==getTopWinWindowID_NS()){getWindowMgr_NS().pushCurrentWindowID(b)}}function BuildFormInfo(g,h,d,s,o,f,v,k,w,b,u){fc.registerContext(g,null,h,d,s,w,null,null,k);if(o){TIMELINE.start("FORM_LOAD_INLINE",d)}if(typeof f=="undefined"||f==null){f=getBody()}new WorkflowContext(g,{f:Form_Init,a:[g,h,d,s,o,f,v]});if(!o){if(getCurWFC_NS(g)==null){if(FocusMgr.getFocusedID()==0){FocusMgr.SetFocusToFirst(g)}}else{setTimeout(function(){if(getCurWFC_NS(g)!=null){setTimeout(arguments.callee,100)}else{if(FocusMgr.getFocusedID()==0){FocusMgr.SetFocusToFirst(g)}}},100)}}if(o){TIMELINE.end("FORM_LOAD_INLINE",d)}}var viewFieldNames=new Array();function buildNewInlineForm(g,o,h,b,u,f,v,s){var k=h+"_"+b+"_"+u;var d=("formjs_"+k+"_loaded").ARToJSIdentifier();var w=("uddjs_"+k+"_loaded").ARToJSIdentifier();viewFieldNames[g]=s;new function(){if(typeof window[w]=="undefined"||typeof window[d]=="undefined"){setTimeout(arguments.callee,1)}else{var y=getSFVSnippet(h,b,u);if(typeof y!="undefined"&&y!=null){if(y.whdr!=null&&y.whdr!=""){parseScript(y.whdr);parseStyle(y.whdr)}}WindowInit(g,o);BuildFormInfo(g,h,b,u,true,f,v,s,null,null,null)}}()}function ARSystemInit(d,h,f,b,g,k,o){_fields=g;SystemInit();WindowInit(d,null);setTimeout(function(){var B=h+"_"+f+"_"+b;var u=("uddjs_"+B+"_loaded").ARToJSIdentifier();if(typeof(window[u])=="undefined"){if(RelContextPath!=null){var A=window.location.href;var s=A.substring(A.indexOf("//")+2);s=s.substring(s.indexOf("/"));var y=s.split("?");if(y.length>=2){var z="cacheid=";var w=y[1].split(/[&;]/g);for(var v=w.length;v-->0;){if(w[v].lastIndexOf(z,0)!==-1){w.splice(v,1)}}s=y[0]+"?"+w.join("&")}if(typeof(jsPageException)=="undefined"){if(window.sTok!=null){window.location.href=RelContextPath+"shared/error.jsp?"+s+"&errormess=9506&sToken="+window.sTok}else{window.location.href=RelContextPath+"shared/error.jsp?"+s+"&errormess=9506"}}else{window.location.href=RelContextPath+"shared/login.jsp?"+s}return}window.status=getLocalizedMessage("Waiting to load {0}",["udd.js"]);return}if(typeof(jsPageException)!="undefined"){if(window.sTok!=null){window.location.href=RelContextPath+"shared/error.jsp?"+s+"&errormess=9506&sToken="+window.sTok}else{window.location.href=RelContextPath+"shared/error.jsp?"+s+"&errormess=9506"}return}if(DummyTemplate==null){DummyTemplate=new Template("","",[],[])}BrowserWindowInit(d);BuildFormInfo(d,h,f,b,false,null,null,(window.name=="")?createARRootWindowName():window.name,g,k,o);if((enableAnimate)&&(ARPrefsGetAsNumber(28510))){createScriptTag(RelContextPath+"resources/javascript/"+ARMTGetBrowserTypeString()+"/AnimMgr.js")}TIMELINE.end("PAGE_END",f)},0)}var glTimestamp;var hlength;var ariever6=false;var ardialogfp=null;function Form_Init(y,ab,aa,f,D,o,ao){window.addEventListener("storage",message_receive);var au=new Date();glTimestamp=au;SetWindowSize(y);StateMgr_Init(y);var X=getSFV_NS(y);var g=["uddjsinit"];_ARSystemInitFunc(X.s,X.f,X.v,g);if(ARPrefsGetAsNumber(23605)){var W=new NDXGetAPITimings(y,true).GetResult();if(typeof W!="undefined"&&W.m){LogWriteServer(W.m)}logTimings=true}var af=getUDDHolder(X.s,X.f,X.v);af.uddinit(y);ARKWSetup(y,getARKeywords_NS(y));windowStatus=ExpandString(y,"$USER$ | $SERVER$",2|16);initSessionTimeoutCounter();BuildDummyLoadingMenu(y);var ac=getARMenus_NS(y);for(var am in ac){new ARMenu(y,am,ac[am])}var w=weAmDialogue(window.name)?false:getForm_NS(y).ShowTb;ARKWSet(y,30,AbsContextPath);DummyField=new Field(0,0,{dbn:""});var J=null;var u=null;var ak=o;if(ak.firstChild){ak=ak.firstChild;while(ak){if(ak.id){if(ak.id=="PageLoadProgress"){J=ak}else{if(ak.getAttribute("arindex")=="FormApp"){u=ak}else{if(ak.id=="ardialogfp"){ardialogfp=ak}else{if(ak.getAttribute("arfloattype")==2){var Q=ak.previousSibling;ardialogfp.appendChild(ak);ak=Q}}}}}ak=ak.nextSibling}}if(u){ak=u}else{ak=document.body}if(ak.firstChild){ak=ak.firstChild;while(ak){if(ak.id){getFormElements_NS(y)[(ak.getAttribute("arindex")!=null)?ak.getAttribute("arindex"):ak.id]=ak}ak=ak.nextSibling}}delete getFormElements_NS(y)["PostAppletElement"];if(J){if(D){o.removeChild(J)}else{document.body.removeChild(J)}}if(u){u.style.display=""}else{document.body.style.display=""}var C=getFormWorkflowHolderById(y);C.Activelink_Init(y);getFormDataHolderById(y).JField_Init(y);Field_Init(y,o);if(D){X=getSFVSnippet(ab,aa,f);if(typeof X!="undefined"&&X!=null){if(X.fp!=null&&X.fp!=""){var L=document.createElement("div");L.setAttribute("arwindowid",y);document.body.appendChild(L);L.innerHTML=X.fp.replace(/WIN_0_/gm,"WIN_"+y+"_");var ar=L;var al=getLogicalWindow(y);if(ar.firstChild){ar=ar.firstChild;while(ar){if(ar.nodeType==1){var aw=false;if(ar.getAttribute("arfloattype")==2){aw=true;ardialogfp.appendChild(ar)}else{document.body.appendChild(ar)}Field_Init(y,ar,true);if(aw){al.mFloatingDialogPanels.push(ar)}else{al.mFloatingPanels.push(ar)}}else{L.removeChild(ar)}ar=L.firstChild}}document.body.removeChild(L)}}FieldList.SetAllGlobals(y)}Field_ExpandDefaultValues(y);if(!D){MidTierDragDropMgrInst.init()}DragField_Init(y);DropField_Init(y);var Z=getFormElements_NS(y)["FormContainer"],Y=getFormElements_NS(y)["ResultsList"];var E=getFormElements_NS(y)["Splitter"],h=getFormElements_NS(y)["QueryBar"];var k=getFormElements_NS(y)["Toolbar"];var K=getFormElements_NS(y)["PromptBar"];k.className="ToolBar";var ax=0;var ag=false;if(Z.getAttribute("arfillstyle")==2){ag=true}var R=k.offsetHeight,aq=E.offsetHeight;var O=Y.offsetHeight;if(h){var aj=h.offsetHeight}if(!D){ax=K.offsetHeight}var B=!RLAtBottom(y);if(!weAmDialogue(window.name)){BuildToolbar(y,R,k);if(!w){var ai=getToolBarPane_NS(y);if(ai){ai.SVis(false)}if(ag&&D){k.style.display="none"}else{k.style.visibility="hidden"}}}else{if(ag){k.style.display="none"}else{k.style.visibility="hidden"}}O+=15;if(!D){promptBar=new PromptBar(y,K);setPromptBarPane_NS(y,new FormPane(y,ax,K,false,PromptBar.prototype.Resize,promptBar))}if(B){setResultsListPane_NS(y,new FormPane(y,O,Y,false,DTable.prototype.Resize,getFields_NS(y)[1020]));setSplitterPane_NS(y,new FormPane(y,aq,E,false,null,null))}setFormContainerPane_NS(y,new FormPane(y,-1,Z,true,FillLayoutPolicy.prototype.ReCalculateNewLayout,getVUILayoutModel_NS(y)));if(!B){setSplitterPane_NS(y,new FormPane(y,aq,E,false,null,null));setResultsListPane_NS(y,new FormPane(y,O,Y,false,DTable.prototype.Resize,getFields_NS(y)[1020]))}if(h){setQBPane_NS(y,new FormPane(y,aj,h,false,null,null))}if(ag&&D){Y.style.display="none";E.style.display="none";h.style.display="none";k.style.display="none";var al=getLogicalWindow(y);var P=al.IsInFlowLayout();if(P){var S=al.mObj.className;if(S.indexOf("vwflow")==-1){S+=" vwflow";al.mObj.className=S}}}CreateAdvancedSearchBar(y);if(!D){window.URLParams=[];var ad=/\?*(\w+)=([^\&]*)/g;var W;while((W=ad.exec(window.location.search))){if(W.length==3){try{window.URLParams[W[1]]=decodeURIComponent(W[2].replace(/\+/g," "))}catch(at){}}}}if(!D){weOnLoad(y);hlength=history.length}else{try{if("external" in top){top.external.InlineFormLoaded(y)}}catch(at){}}if(!D){SetupHandlers()}if(!D){FocusMgr_Init();hoverState=new HoverState();toolTip=new ToolTip()}ARProcessEvent.InitKeywordsEtc(y);ARKWGetGlobalKeywords(y);try{var N=[];if(typeof C.RegisterIntervalEvents=="function"){C.RegisterIntervalEvents(y)}if(typeof ao!="undefined"&&ao!=null){setWindowArgs_NS(y,ao)}else{if(getUDDHolderById(y).openingArgs!=null){setWindowArgs_NS(y,getUDDHolderById(y).openingArgs)}}for(var b in af.vf){var G=null;var ae=af.vf[b].server;var I=af.vf[b].form;var H=af.vf[b].view;G=new NDXGetHTMLScriptForViewField(y,ae,((ARKWGetStringByIdx(y,21)!=null)?ARKWGetStringByIdx(y,21):""),I,H,false,af.vf[b].cacheid).GetResult();if(H==null||H==""){setSFMap(ae,I,G.viewname)}setSFVSnippet(ae,I,G.viewname,G);af.vf[b].view=G.viewname;if(!ariever6){InjectFormJS(af.vf[b].server,af.vf[b].form,af.vf[b].view,af.vf[b].cacheid,"")}}var U=getWindowArgs_NS(y);buildStackForArgs(y,N,U);return{n:N}}finally{FormPane.Layout2(y);if(D){var v=ab+"_"+aa+"_"+f;var s=("uddjs_"+v+"_loaded").ARToJSIdentifier();var ah=("formjs_"+v+"_loaded").ARToJSIdentifier();if((typeof window[s]!="undefined"&&typeof window[ah]!="undefined")){for(var A in wm.inlineIntervalsStack){var V=getFormContext(A);var z=0;if(typeof wm.inlineIntervalsStack[A]!="undefined"){z=wm.inlineIntervalsStack[A].length}for(var an=0;an<z;++an){var av=wm.inlineIntervalsStack[A].pop();if(typeof av!="undefined"){V.inlineIntervalHandles.push(setInterval(av.func,av.interval))}}delete wm.inlineIntervalsStack[A]}}}}}function buildStackForArgs(d,b,h){if(typeof h!="undefined"&&h!=null){if("runGuide" in h){b.push({f:ARACTCallGuide,a:[d,h.runGuide.server,h.runGuide.guidename,h.runGuide.hidden,h.runGuide.tableid,h.runGuide.selectedonly]})}if("eid" in h){var g=unescape(encodeURIComponent(h.eid)).length;var f={qual:"4\\1\\1\\1\\2\\4\\"+g+"\\"+h.eid+"\\",fieldids:[],fieldvals:[],fieldtypes:[]};b.push({t:getStateMgr_NS(d),f:getStateMgr_NS(d).OpenWindowQuery,a:[d,14,f]})}else{if("qual" in h){var k=10;if(("wMode" in h)&&(h.wMode!=0)&&(h.wMode!=1)&&(h.wMode!=9)){k=h.wMode}if(typeof h.sort!="undefined"){if(gettablePrefs_NS(d)==null){getUDDHolderById(d).tablePrefs={colSort:{},colWs:{},colOrd:{},interval:{}}}gettablePrefs_NS(d).colSort[1020]=h.sort}if(h.wMode!=2){if("interval" in h&&h.interval>0){b.push({f:ARRegisterTableRefreshInterval,a:[d,getFields_NS(d)[1020],h.interval]})}b.push({t:getStateMgr_NS(d),f:getStateMgr_NS(d).OpenWindowQuery,a:[d,k,h.qual]});if(k==12||k==13||k==14||k==15||k==16||k==17||k==18||k==19){return}}}}}b.push({f:SetupState,a:[d]})}function RLAtBottom(b){if((F(b,1020) instanceof DTable)&&F(b,1020).GetAtBottom()){return true}if(ARPrefsGetAsNumber(23207)==4){return true}return false}function BodyDrag(h){var d=h.srcElement.getAttribute("arwindowid");var v=window.innerWidth;if(h.state==0){var s=(getFormContainerPane_NS(d).mY<getResultsListPane_NS(d).mY?getFormContainerPane_NS(d).mY:getResultsListPane_NS(d).mY);var u=getFormContainerPane_NS(d).mY+getFormContainerPane_NS(d).mH,o=getResultsListPane_NS(d).mY+getResultsListPane_NS(d).mH;var k=(u>o?u:o);if(s>=k){WDEDragContext_Stop()}h.dragContext.SetDragBounds(0,s,v,k-s)}else{var g=parseInt(getSplitterPane_NS(d).mObj.style.top),f;if(!RLAtBottom(d)){f=g-getResultsListPane_NS(d).mY}else{f=(getResultsListPane_NS(d).mY+getResultsListPane_NS(d).mHeight)-(g+getSplitterPane_NS(d).mObj.offsetHeight)}getResultsListPane_NS(d).mFixedHeight=(f<8?8:f);FormPane.Layout(d)}}function NodeWrite(d,b){while(d.hasChildNodes()){d.removeChild(d.firstChild)}d.appendChild(document.createTextNode(b))}function FormAction_Submit(b){return{c:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).Submit,a:[b]}}}function FormAction_Query(b){HidePromptBar();return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).Query,a:[b]}}}function FormAction_Modify(b){HidePromptBar();return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).Modify,a:[b]}}}function FormAction_ModifyAll(b){var d=getFields_NS(b)[1020];if(d.GetSelectedRowsByEntryId().length==0){getCurWFC_NS(b).status(9365)}return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).ARStateChange,a:[b,6]}}}function FormAction_Clear(b){Field_Clear(b,false)}function FormAction_SavedSearches(b,d){if(getForm_NS(b).SavedSearchesMenu==null){getForm_NS(b).SavedSearchesMenu=new SearchesMenu(b)}return{n:{f:getForm_NS(b).SavedSearchesMenu.Open,t:getForm_NS(b).SavedSearchesMenu,a:[d,3]}}}function FormAction_QuickReports(b,d){if(getForm_NS(b).QuickReportsMenu==null){getForm_NS(b).QuickReportsMenu=new QuickReportsMenu(b)}return{n:{f:getForm_NS(b).QuickReportsMenu.Open,t:getForm_NS(b).QuickReportsMenu,a:[d,3]}}}function FormAction_SetToDefaults(b){return getStateMgr_NS(b).SetDefaults(b,false,true)}function FormAction_NewSearch(b){var f=getFields_NS(b)[1020];var d=gettablePrefs_NS(b);if(d!=null&&typeof d.interval[f.mID]!="undefined"){f.mRefreshInterval=d.interval[f.mID];ARRegisterTableRefreshInterval(b,f,f.mRefreshInterval)}else{f.mRefreshInterval=0;ARRegisterTableRefreshInterval(b,f,0)}HidePromptBar();if(getuserSearches_NS(b)!=null){getuserSearches_NS(b).lastSearch=null}return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).ARStateChange,a:[b,4]}}}function FormAction_NewRequest(b){HidePromptBar();return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).ARStateChange,a:[b,1]}}}function FormAction_NewDialog(b){return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).ARStateChange,a:[b,2]}}}function FormAction_ShowStatusHistory(b){var d=F(b,15).G();if(d instanceof StatusHistoryType){var f=d.GetTable();return{c:{f:StatusHistoryPopup,a:[b,f]}}}}var helpbuttonclicked=false;function FormAction_ShowHelp(b){if(typeof fieldLevelHelp!="undefined"&&fieldLevelHelp){helpbuttonclicked=!helpbuttonclicked;if(helpbuttonclicked){var d="yellow";if(typeof flhMColor!="undefined"){d=flhMColor}Field_Level_SetHelpMarker(d)}else{Field_Level_UnsetHelpMarker()}}else{helpbuttonclicked=false;Field_Level_HideToolTip();window.open("help.html");WorkflowContext.WindowOpened(b)}}function FormAction_SimulateGetEntry(b){return{n:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).ARStateChange,a:[b,getARStateCurrent_NS(b)]}}}function FormAction_OpenHomePage(b){var d=allocWindowID_NS();weOpen(d,b,ARKWGetStringByIdx(b,30)+"home",(""+new Date().getTime()),"HOME",null,null,true,false);WorkflowContext.WindowOpened(b)}function FormAction_GenericApply(b){if(rtfEditor!=null&&rtfEditor.IsVisible()){rtfEditor.Close(true)}if((getARStateCurrent_NS(b)==1)){return getCurWFC_NS(b).execute({f:FormAction_Submit,a:[b]})}else{if((getARStateCurrent_NS(b)==4)&&getForm_NS(b).TbSearch){return getCurWFC_NS(b).execute({f:FormAction_Query,a:[b]})}else{if((getARStateCurrent_NS(b)==5)||(getARStateCurrent_NS(b)==6)){var f=Field_BuildList(b,new FieldList(b),true,true,false,false,true,false);var g=false;for(var d in f.mFields){g=true;break}if(!g){return}return getCurWFC_NS(b).execute({f:FormAction_Modify,a:[b]})}}}}function SetupState(b){var g={f:FormAction_NewSearch,a:[b]};if(getWindowArgs_NS(b)!=null&&"wMode" in getWindowArgs_NS(b)){g.f=getStateMgr_NS(b).OpenWindowFunctions[getStateMgr_NS(b).OpenWindowStates[getWindowArgs_NS(b).wMode][0]]}var f=getCurWFC_NS(b).execute(g);var h=new Date();return f}function ToggleFocusFocusToField(d){var b=getForm_NS(d).LastFormFID;if(b==0){b=getFieldListInfo_NS(d).firstField.mID}getForm_NS(d).LastFormFID=0;return new WorkflowContext(d,{t:FocusMgr,f:FocusMgr.SetFocusToField,a:[d,b]})}function ToggleFocusResultsList(d){var f=FocusMgr.getFocusedID();var b;if(f==1020){return ToggleFocusFocusToField(d)}else{if(f==1005){return ToggleFocusAdvSearch(d)}else{if(F(d,1020).GVis()){getForm_NS(d).LastFormFID=f;return new WorkflowContext(d,{t:FocusMgr,f:FocusMgr.SetFocusToField,a:[d,1020]})}}}}function ToggleFocusAdvSearch(b){var d=FocusMgr.getFocusedID();if(d==1005){ToggleFocusFocusToField(b)}else{if(F(b,1005).GVis()){getForm_NS(b).LastFormFID=d;return new WorkflowContext(b,{t:FocusMgr,f:FocusMgr.SetFocusToField,a:[b,1005]})}}}function Form_FormActionShortcutHandler(b,d){switch(d.key){case 13:return new WorkflowContext(b,{f:FormAction_GenericApply,a:[b]});case 113:return new WorkflowContext(b,{f:FormAction_NewRequest,a:[b]});case 114:return new WorkflowContext(b,{f:FormAction_NewSearch,a:[b]});case 117:return ToggleFocusResultsList(b);case 119:if(getARStateCurrent_NS(b)==1||getARStateCurrent_NS(b)==4){return FormAction_Clear(b)}else{return}case 85:return new WorkflowContext(b,{f:FormAction_SetToDefaults,a:[b]});case 72:return new WorkflowContext(b,{f:FormAction_ShowStatusHistory,a:[b]});case 83:return ToggleFocusAdvSearch(b);case 67:getStateMgr_NS(b).mWindowIsCopyingNew=true;return new WorkflowContext(b,{f:function(){return{c:{f:ExecuteWorkflow,a:[b,131072]},n:{f:FormAction_NewRequest,a:[b]}}}});default:return}}function traverseFields(h,d){var s=0,o=0,b=0;var k=h.mObj.childNodes[1].contentWindow.Fields;for(var g in k){var f=k[g].mObj.className;if(f){if(f.indexOf("AttachmentPool")!=-1||f.indexOf("TableField")!=-1||f.indexOf("TreeField")!=-1||f.indexOf("VNavBar")!=-1){if(d=="vertical"){b=k[g].getScrollheight()}else{b=k[g].getScrollwidth()}if(b>o){o=b}}}}return o}function isFormLoadedOnWindow(b,k,f){if((typeof b=="undefined")||(b==null)){return false}var d=getFormContext(b);if(d!=null){var h=d.server;var g=d.formName;if((h!=null)&&(g!=null)&&(h==k)&&(g==f)){return true}}return false}function LayeredModalDialog(){this.mStack=[];this.mFocusStack=[];this.mPrev=null;this.mCurrentShowing=null;this.mFieldList={};this.mLowestZIndex=nextZIndex}LayeredModalDialog.prototype.addToStack=function(f){if(this.mFieldList[f.mObj.id]!=null){return}this.mStack.push(f);var b=this.mFocusStack.length;var g=false;for(var d=0;d<b;d++){if((FocusMgr.mCurFocusID!=this.mFocusStack[d].fid)||(FocusMgr.mCurFocusWindowID!=this.mFocusStack[d].wid)){continue}g=true;this.mFocusStack.push({wid:this.mCurrentShowing.windowID,fid:this.mCurrentShowing.mID,fele:this.mCurrentShowing.mObj});break}if(!g){this.mFocusStack.push({wid:FocusMgr.mCurFocusWindowID,fid:FocusMgr.mCurFocusID,fele:FocusMgr.mCurFocusElement})}this.mPrev=this.mCurrentShowing;this.mCurrentShowing=f;this.mFieldList[f.mObj.id]=f;if(this.mStack.length==1){weDisableStuff(0);ardialogfp.style.zIndex=nextZIndex++;ardialogfp.className="DialogFloatShow"}this.Show(true)};LayeredModalDialog.prototype.Reset=function(){this.mStack=[];this.mFocusStack=[];this.mPrev=null;this.mCurrentShowing=null;this.mFieldList={};this.mLowestZIndex=nextZIndex;weEnableStuff(0)};LayeredModalDialog.prototype.Show=function(b){if(this.mCurrentShowing==null){return}if(this.mPrev!=null){this.Hide(this.mPrev)}if("SetDisabled" in this.mCurrentShowing){this.mCurrentShowing.SetDisabled(false)}if(b==true){var h=this.mCurrentShowing.mObj;var f=false;h.style.position="absolute";if(h.offsetHeight>ardialogfp.offsetHeight){h.style.top="0px";f=true}else{h.style.top="50%"}h.style.left="50%";var g=(parseInt(h.style.height)<=2)?this.mCurrentShowing.mHg:parseInt(h.style.height);var d=(parseInt(h.style.width)<=2)?this.mCurrentShowing.mWd:parseInt(h.style.width);if(nextZIndex<=this.mLowestZIndex){this.mLowestZIndex=nextZIndex}h.style.zIndex=nextZIndex++;this.EnableDragAndResize();if(typeof AnimMgr!="undefined"){AnimMgr.growFloatingPanel(h,g,d,f,this)}else{h.style.marginLeft=0-(d/2)+"px";if(f){h.style.marginTop="0px"}else{h.style.marginTop=0-(g/2)+"px"}setTimeout(function(){try{h.tabIndex="-1";h.focus()}catch(k){}},100)}}};function reRenderIFrame(f,b){try{var k=document.getElementsByName(f)[0];var d=k.style.height;var o="";var h=k.style.height;if(h.indexOf("px")!=-1){o="px";d=parseInt(h.substring(0,h.length-2))+b}else{if(h.indexOf("%")!=-1){o="%";d=parseInt(h.substring(0,h.length-1))+b}}k.style.height=d+o}catch(g){}}LayeredModalDialog.prototype.EnableDragAndResize=function(){if(this.mCurrentShowing.bHasDragHandle){return}var f=this.mCurrentShowing.mObj;var o=f.children;for(var k=0;k<o.length;k++){if(o[k].id==f.id+"handle"){return}}if(this.mCurrentShowing.mResize){var s=this.mCurrentShowing.mID+"handle";var w=document.createElement("DIV");w.className="ResizeHandle  right";w.id=s;w.style.zIndex=nextZIndex++;f.appendChild(w);var u=new PopupResize(this,f.id,s,"panelresize");u._minX=this.mCurrentShowing.mMinWidth;u._minY=this.mCurrentShowing.mMinHeight}var v=document.createElement("DIV");var g=this.mCurrentShowing.mID+"title";v.id=g;v.style.height="100%";v.className="DraggableTitleBar DIVDraggable";v.innerHTML="<img style='width:100%;height:100%' src='"+RelContextPath+"resources/images/transparent.gif'>";var b=f.getElementsByTagName("fieldset");if(this.mCurrentShowing instanceof DPage){b[0].appendChild(v)}else{var d=b[0].children;for(var h=0;h<d.length;h++){if(d[h].className=="PageBody"){d[h].appendChild(v);break}}}var y=new PopUpDrag(this,f.id,"paneldrag");y.setOuterHandleElId(g);if(this.mCurrentShowing.mResize){y.addInvalidHandleId(s)}ddGlobal=y;this.mCurrentShowing.bHasDragHandle=true};LayeredModalDialog.prototype.Hide=function(b){if("SetDisabled" in b){b.SetDisabled(true)}};LayeredModalDialog.prototype.removeFromStack=function(d){if(this.mFieldList[d.mObj.id]==null){return}var k=null;var h=true;if(d.mObj.id==this.mCurrentShowing.mObj.id){this.mStack.pop();if(this.mFocusStack.length>0){k=this.mFocusStack.pop()}}else{for(var b=0;b<this.mStack.length;b++){var g=this.mStack[b];if(g.mObj.id!=d.mObj.id){continue}this.mStack.splice(b,1);if(this.mFocusStack.length>(b+1)){this.mFocusStack.splice((b+1),1)}if("SetDisabled" in g){g.SetDisabled(false)}}if(this.mPrev.mObj.id==d.mObj.id){if(this.mStack.length-1>0){this.mPrev=this.mStack[this.mStack.length-2]}}}this.mFieldList[d.mObj.id]=null;delete this.mFieldList[d.mObj.id];this.mPrev=null;this.mCurrentShowing=null;if(this.mStack.length>0){this.mCurrentShowing=this.mStack[this.mStack.length-1]}if(this.mStack.length-1>0){this.mPrev=this.mStack[this.mStack.length-2]}this.Show(false);if(this.mCurrentShowing!=null&&(k!=null&&k.wid==this.mCurrentShowing.windowID&&k.fid==this.mCurrentShowing.mID)){h=false;var f=this.mCurrentShowing;setTimeout(function(){try{f.mObj.focus()}catch(o){}},2)}if(this.mStack.length==0){this.mFocusStack=[];ardialogfp.className="DialogFloatHide";weEnableStuff(0)}if(k!=null&&h){FocusMgr.mCurFocusWindowID=k.wid;FocusMgr.mCurFocusID=k.fid;FocusMgr.mCurFocusElement=k.fele;FocusMgr.resettheFocus()}};LayeredModalDialog.prototype.OnResize=function(f,g,d,b){if((f!=g||d!=b)){var h=this.mCurrentShowing;if(h instanceof DPage&&h.mFillModel==null){return}setTimeout(function(){h.ResizeTo(g,b)},5)}};LayeredModalDialog.prototype.OnStartDrag=function(){if(this.mCurrentShowing instanceof DPageHolder){if(this.mCurrentShowing.mViewTypeObj instanceof StackView){this.mCurrentShowing.mViewTypeObj.mRelPosContainer.style.overflowY="hidden"}}};LayeredModalDialog.prototype.OnEndDrag=function(){if(this.mCurrentShowing instanceof DPageHolder){if(this.mCurrentShowing.mViewTypeObj instanceof StackView){this.mCurrentShowing.mViewTypeObj.mRelPosContainer.style.overflowY="auto"}}};LayeredModalDialog.prototype.PanelDialogVisible=function(){return this.mCurrentShowing!=null};var formModalList=new LayeredModalDialog();function ToolTipDialogManager(){this.mFields=[]}ToolTipDialogManager.prototype.show=function(b){if(this.mFields.length==0){this.mPrimary=b}b.mDisplay=false;b.showTT();this.mFields.push(b)};ToolTipDialogManager.prototype.dismiss=function(d){if(this.mFields.length>0){var b=[];var h=null;for(var g=this.mFields.length-1;g>=0;g--){if(!this.mFields[g].EvtInside(d)){if(this.mFields[g].mChild!=null){if(h!=this.mFields[g].mChild){b.push(this.mFields[g])}}else{b.push(this.mFields[g])}}else{h=this.mFields[g]}}if(b.length>0){for(g=0;g<b.length;g++){b[g].reset();RTF_Close(true);for(var f=0;f<this.mFields.length;f++){if((this.mFields[f]!=null)&&this.mFields[f].mID==b[g].mID){this.mFields[f]=null;this.mFields.splice(f,1)}}}b=[]}}};ToolTipDialogManager.prototype.EscapeTooltip=function(){if(this.mFields.length==0){return true}gTTEscScrollposX=getFormElements_NS(0)["FormContainer"].scrollLeft;gTTEscScrollposY=getFormElements_NS(0)["FormContainer"].scrollTop;FocusMgr.resettheFocus();if(this.mFields.length>0){for(var b=0;b<this.mFields.length;b++){this.mFields[b].reset()}}return false};var formTTList=new ToolTipDialogManager();function ValidateTTPanel(){if(formTTList.mFields.length>0){return true}else{return false}}function EscapeTTPanel(){FocusMgr.resettheFocus();return formTTList.EscapeTooltip()}var gTTEscScrollposX=0;var gTTEscScrollposY=0;function SetupHandlers(){getFormElements_NS(0)["FormContainer"].onscroll=FormEvent.Trampoline(function(b){Menu_Close();if(rtfEditor!=null&&rtfEditor.mEditing!=null){rtfEditor.UpdatePos()}if((gTTEscScrollposX!=undefined&&gTTEscScrollposX!=0)||(gTTEscScrollposY!=undefined&&gTTEscScrollposY!=0)){getFormElements_NS(0)["FormContainer"].scrollLeft=gTTEscScrollposX;getFormElements_NS(0)["FormContainer"].scrollTop=gTTEscScrollposY;gTTEscScrollposX=0;gTTEscScrollposY=0}});document.body.onmouseover=FormEvent.Trampoline(function(b){MidTierDragDropMgrInst.lastMouseOverElement=b.element;if(b.element&&b.element.className.indexOf("prompt")==0){promptBar.DOMMouseOver(b)}else{if(!window.weDialogueName){if(Menu_DispatchEvent(1,b)){return false}var d=Field_FromElement(b.element);if(d){d.DOMMouseOver(b)}}}return true});document.body.onmousemove=FormEvent.Trampoline(function(b){MidTierDragDropMgrInst.lastMouseOverElement=b.element;if(!window.weDialogueName){var d=Field_FromElement(b.element);if(d){d.DOMMouseMove(b)}}if(toolTip.isDisplayed()&&hoverState.inEvtHover()){if(!toolTip.EvtInside(b)){ToolTipMouseClose(b.mEventObject)}}return true});document.body.onmousedown=FormEvent.Trampoline(function(g){var d=Window_FromElement(g.element);FormEvent.lastMouseDownEvent=g;if(!wePuntFocus(d)){if(Menu_DispatchEvent(2,g)){return false}if(WDEHandleEvent(0,g)){return false}var b=g.element;if((b=FakeButton_Find(b))){if(FakeButton_Disabled(b)){return false}FakeButton_MouseDown(b)}var h=Field_FromElement(g.element);if(h){if(h.TracksCaret){h.TrackCaret(g.element)}promptBar.setToClear();new WorkflowContext(h.windowID,{f:function(){var f={};if((h instanceof BaseTable&&h.MapUIXY(g.element)!=null)||g.element.tagName=="INPUT"||g.element.tagName=="TEXTAREA"||g.element.tagName=="LABEL"||(g.element.tagName=="DIV"&&(g.element.className.indexOf("text")!=-1||g.element.className.indexOf("DivEditor")!=-1))){if(!(h instanceof DView)||h.mQWidget==null){hoverState.wfMouseDown();f.c={t:FocusMgr,f:FocusMgr.HandleFocusEvt,a:[h.windowID,g]}}}f.n={t:h,f:h.DOMMouseDown,a:[g]};return f}})}}return true});document.body.onmouseup=FormEvent.Trampoline(function(g){var d=Window_FromElement(g.element);MidTierDragDropMgrInst.lastMouseUpElement=g.element;MidTierDragDropMgrInst.currentDownedElement=false;if(!wePuntFocus(d)){if(Menu_DispatchEvent(3,g)){return false}if(WDEHandleEvent(1,g)){return false}var b=g.element;if((b=FakeButton_Find(b))){if(!FakeButton_Disabled(b)){FakeButton_MouseUpOut(b)}}var h=Field_FromElement(g.element);if(h){if(h.TracksCaret){h.TrackCaret(g.element)}new WorkflowContext(h.windowID,{f:function(){var f={};f.c={t:h,f:h.DOMMouseUp,a:[g]};f.n={f:function(){if(g.element.tagName=="INPUT"||g.element.tagName=="TEXTAREA"||g.element.tagName=="LABEL"){hoverState.wfMouseUp()}}};return f}})}}return true});document.body.onmouseout=FormEvent.Trampoline(function(d){if(d.element.className.indexOf("prompt")==0){promptBar.DOMMouseOut(d)}else{if(!window.weDialogueName){var b=d.element;if((b=FakeButton_Find(b))){if(!FakeButton_Disabled(b)){FakeButton_MouseUpOut(b)}}var g=Field_FromElement(d.element);if(g){g.DOMMouseOut(d)}}}return true});document.body.onkeydown=FormEvent.Trampoline(function(s){var b=Window_FromElement(s.element);if(!wePuntFocus(b)){var o=s.element;var g=DIVPopup.FindPopup(b,o);if(g){return g.KeyDown(s)}if(Menu_DispatchEvent(4,s)){return false}if(WDEHandleEvent(3,s)){return false}if(s.alt&&s.ctrl){var k;k=Form_FormActionShortcutHandler(b,s);if(typeof k!="undefined"){return k}}if(s.ctrl&&s.shift&&s.key==36){FocusMgr.SetFocusToFirst(b)}if(s.ctrl&&s.shift&&s.key==191){return new WorkflowContext(b,{f:FormAction_ShowHelp,a:[b]})}if(s.ctrl&&s.shift&&s.key==35){FocusMgr.SetFocusToLast(b)}if(s.alt&&(s.key==120||s.key==121||s.key==123)){return hoverState.hoverByKey(s)}if(s.key==9){var u;hoverState.wfTabStart();if(s.shift){u=FocusMgr.SetFocusToPrevious(s)}else{u=FocusMgr.SetFocusToNext(s)}var d=Field_FromElement(s.element);if(d){new WorkflowContext(d.windowID,{t:d,f:d.DOMKeyDown,a:[s]})}hoverState.wfTabEnd();if(u){s.SetKeyCode(505);return false}return true}if(s.key==27){if(!EscapeTooltip()||!EscapeTTPanel()){s.StopBubbling();s.StopDefault();return false}}if((o=FakeButton_Find(o))){if(FakeButton_Disabled(o)){return false}}var v=Field_FromElement(s.element);if(v){if((s.key==32||s.key==13)&&s.element.type=="image"){s.element.click();return false}if(s.ctrl&&s.key==86){return v.FieldValChanged(s)}promptBar.setToClear();new WorkflowContext(v.windowID,{t:v,f:v.DOMKeyDown,a:[s]});if(s.mStoppedDefault==true){s.SetKeyCode(505);return false}}var w=window.parent.frames;if(w){for(var h=0;h<w.length;h++){try{w[h].KeyDown(s)}catch(y){}}}}return true});document.body.onkeyup=FormEvent.Trampoline(function(g){var d=Window_FromElement(g.element);if(!wePuntFocus(d)){var b=g.element;var k=DIVPopup.FindPopup(d,b);if(k&&"KeyUp" in k){return k.KeyUp(g)}}var h=Field_FromElement(g.element);if(h){if(g.key!=9&&g.key!=16){h.FieldValChanged(g)}if(h.TracksCaret){h.TrackCaret(g.element)}new WorkflowContext(h.windowID,{t:h,f:h.DOMKeyUp,a:[g]})}});document.body.onpaste=FormEvent.Trampoline(function(b){var d=Field_FromElement(b.element);if(d){d.FieldValChanged(b)}});document.body.onselectstart=FormEvent.Trampoline(function(b){var d=Field_FromElement(b.element);if(d){if(d.TracksCaret){d.TrackCaret(b.element)}return d.IsMouseSelectable(b.element)}return true});document.body.onclick=FormEvent.Trampoline(function(s){if(curClickElement!=null){s.element=curClickElement.ele;s.mMouseX=curClickElement.screenX;s.mMouseY=curClickElement.screenY;curClickElement=null}var g=Window_FromElement(s.element);if(TTisDisplayed()){if(TTCloseByClick()){var v=TTNotifyClick(s);switch(v){case 0:s.StopBubbling();s.StopDefault();return false;break;case 3:return true;break;case 1:break}}}if(ValidateTTPanel()){formTTList.dismiss(s)}if(s.element.className.indexOf("prompt")==0){return promptBar.DOMClick(s)}var w=false;var d=false;if(!wePuntFocus(g)){var o=s.element;var h=DIVPopup.FindPopup(g,o);if(h){return h.Click(s)}if(Menu_DispatchEvent(0,s)){return false}if((o=FakeButton_Find(o))){if(FakeButton_Disabled(o)){return false}w=true}var u=Field_FromElement(s.element);if(u){if(helpbuttonclicked){s.StopBubbling();s.StopDefault();return new WorkflowContext(u.windowID,{f:Field_Level_ShowToolTip,t:u,a:[s]})}if(o==null&&s.element&&u.isRTF&&u.isRTF()){if(s.element.tagName=="A"||(s.element.tagName=="IMG"&&s.element.parentNode&&s.element.parentNode.tagName=="A")){return true}}if(u.TracksCaret){u.TrackCaret(s.element)}var y=u.windowID;new WorkflowContext(y,{f:function(){var f={};if(!(s.element.tagName=="INPUT"||s.element.tagName=="TEXTAREA"||(s.element.tagName=="DIV"&&(s.element.className.indexOf("text")!=-1||s.element.className.indexOf("DivEditor")!=-1||s.element.className.indexOf("BaseTableHeader")!=-1)))||("isRTF" in u&&u.isRTF()&&(s.element.tagName=="DIV"&&s.element.className.indexOf("text")!=-1))){f.c={t:FocusMgr,f:FocusMgr.HandleFocusEvt,a:[y,s]}}f.n={f:function(){if(u.GetFocusElementForEvent(s)!=null){return{c:{t:u,f:u.DOMClick,a:[s]}}}else{if(u.IsLabelPart(s.element)){if(1005 in getFields_NS(y)&&F(y,1005).GVis()){if(s.element.className.indexOf("do")!=-1&&(parseInt(s.element.parentNode.getAttribute("arid"))!=178)){var A=new AlertPopup(y);var z=s.element.innerHTML+getLocalizedMessage(" is a display only field.");A.SetContents(getLocalizedMessage("Error"),z);A.ShowCentredPopup(false)}else{F(y,1005).InsertAtCaret("'"+u.GLabelOrID().ARQualifierEncode()+"'")}}s.StopBubbling();s.StopDefault()}else{if(u.GAccess()==3){if(s.element.type=="radio"&&s.element.name!=null&&s.element.name!="undefined"&&s.element.disabled!=true){dradiobutt=document.getElementsByName(s.element.name);if(s.element.disabledindex!=null&&s.element.disabledindex<dradiobutt.length){dradiobutt[s.element.disabledindex].checked=true}if(s.element.disabledindex==null||s.element.disabledindex=="undefined"){for(i=0;i<dradiobutt.length;i++){dradiobutt[i].checked=false}}s.element.disabledindex=null}s.StopDefault()}}}}};return f},cl:true})}else{if(w&&"Toolbar_Click" in window){new WorkflowContext(g,{f:Toolbar_Click,a:[g,s]});var k=o.className.split(" ");if(k.length>=1){k=k[0]}if(!(k in ToolbarItemMap)){return false}var b=ToolbarItemMap[k];if(helpbuttonclicked&&b!=1008){s.StopBubbling();s.StopDefault();return false}}}}else{if($(s.element).parents(".rtf:first").length>0){var u=Field_FromElement(s.element);if(u&&u.ActivateInPlaceEditor){new WorkflowContext(u.windowID,{t:u,f:u.ActivateInPlaceEditor,a:[s]})}}}return !(w|d)});document.body.ondblclick=FormEvent.Trampoline(function(g){var d=Window_FromElement(g.element);if(!wePuntFocus(d)){var b=g.element;if((b=FakeButton_Find(b))){if(FakeButton_Disabled(b)){return false}}var h=Field_FromElement(g.element);if(h){if(h.TracksCaret){h.TrackCaret(g.element)}if(h.GetFocusElementForEvent(g)!=null){promptBar.setToClear();new WorkflowContext(h.windowID,{t:h,f:h.DOMDoubleClick,a:[g]})}h.FieldValChanged(g)}}return true});document.body.onkeypress=FormEvent.Trampoline(function(g){var d=Window_FromElement(g.element);if(!wePuntFocus(d)){var b=g.element;var o=DIVPopup.FindPopup(d,b);if(o){return o.KeyPress(g)}if(g.alt&&g.ctrl){return}var k=Field_FromElement(g.element);if(k){if((g.key==13)||(g.key==32)){if((b=FakeButton_Find(b))){if(FakeButton_Disabled(b)){return false}FakeButton_MouseDown(b);setTimeout(function(){FakeButton_MouseUpOut(b)},250);var h={t:k,f:k.DOMClick,a:[g]};new WorkflowContext(k.windowID,h);return false}}promptBar.setToClear();var h={t:k,f:k.DOMKeyPress,a:[g]};new WorkflowContext(k.windowID,h)}}return true});document.oncontextmenu=FormEvent.Trampoline(function(d){var b=Window_FromElement(d.element);if(!wePuntFocus(b)){var g=Field_FromElement(d.element);if(g&&g.hasContextMenu){new WorkflowContext(g.windowID,{t:g,f:g.DOMContextMenu,a:[d]});return false}}return true});window.onfocus=FormEvent.Trampoline(function(d){var b=Window_FromElement(d.element);if(!wePuntFocus(b)){if(FocusMgr){FocusMgr.WindowGotFocus(b)}if(checkCookiesToLoad()){loadCookie("GF")}FieldList.SetAllGlobals(b)}return true});window.onresize=FormEvent.Trampoline(function(d){var b=Window_FromElement(d.element);if(window.ARInitPane==undefined){Menu_Close();resizeWindow=true;FormPane.Layout(b);resizeWindow=false}return true});window.onbeforeunload=FormEvent.Trampoline(function(f){var d=getCurrentWindowID_NS();if(!globalLogout){Menu_Close();var b={};new WorkflowContext(d,{t:getStateMgr_NS(d),f:getStateMgr_NS(d).WindowIsClosing,a:[b]});if(b.ab){getStateMgr_NS(d).mWindowIsClosed=false;beforeUnloadCalledTimeout=setTimeout(function(){stayOnPage=2},500);return getLocalizedMessage("One or more active links failed when closing the form.  Close this form anyway?",null)}else{if(checkIfWindowDirty().dirty){getStateMgr_NS(d).mWindowIsClosed=false;beforeUnloadCalledTimeout=setTimeout(function(){stayOnPage=2},500);return getLocalizedMessage("Your changes have not been saved or sent.  Do you really want to close the window?",null)}else{getStateMgr_NS(d).ClearSnapshot();if(!(this.name.match("^VF")=="VF")){licenseSessionCloseWindow()}weOnUnload(d);Field_Unload(d)}}}})}var beforeUnloadCalledTimeout;var stayOnPage=1;var closeCalled=false;function checkCookiesToLoad(){var f=getMaxCookieDateValue();var b=wm.lasttimeCookieUpdated;var d=false;if(b==null&&f!=null){d=true}else{if(b!=null&&f!=null&&f>b){d=true}}if(d){wm.lasttimeCookieUpdated=f}return d}function checkIfWindowDirty(){var d=[];var b=getTopWinWindowID_NS();d.push(b);genAllLogicalChildWindowIDsInList(b,d);for(var f=0;f<d.length;f++){if((((getARStateCurrent_NS(d[f])==1)||(getARStateCurrent_NS(d[f])==5))&&getStateMgr_NS(d[f]).IsSaveAllowed(d[f]))&&getFieldChanged_NS(d[f])){return{dirty:true,llen:(d.length-1)}}}return{dirty:false,llen:(d.length-1)}}function getMaxCookieDateValue(){var f=window;var b=wm.lasttimeCookieUpdated;var d=weGetARWindowOpener();if(d!=null&&d&&!d.closed){if(d.wm!=null){return findChildWindowMaxCookieUpdatedValue(d,d.wm.lasttimeCookieUpdated)}else{return null}}else{return null}}function findChildWindowMaxCookieUpdatedValue(f,d){var g=f.getChildWindowIDs(f.wm.topWinWindowID);for(i in g){if(typeof g[i].windowID!="undefined"&&g[i].windowID!=null&&typeof g[i].windowObj.wm=="object"){var b=g[i].windowObj.wm.lasttimeCookieUpdated;if(d==null){d=b}if(d!=null&&b!=null&&d<b){d=b}d=findChildWindowMaxCookieUpdatedValue(g[i].windowObj,d)}}return d}function Form_UpdateToolbar(d){if(getToolBarPane_NS(d)){var b=getFormElements_NS(d)["Toolbar"];NodeWrite(b.firstChild.childNodes[1],getStateMgr_NS(d).GetToolbarTitle())}if((getARStateCurrent_NS(d)==4)){F(d,1005).SVis(F(d,1005).mKeepOpen||ARPrefsGetAsNumber(23203)>0)}else{F(d,1005).SVis(false)}}function ShowToolbar(d,f){var b=getToolBarPane_NS(d);if(b){b.SVis(f);b.mObj.style.visibility=(f)?"":"hidden";FormPane.Layout(d)}}function ShowResultsListPane(b){getResultsListPane_NS(b).SVis(true);getSplitterPane_NS(b).SVis(true);FormPane.Layout(b);getForm_NS(b).LastFormFID=0}function HideResultsListPane(b){getResultsListPane_NS(b).SVis(false);getSplitterPane_NS(b).SVis(false);FormPane.Layout(b)}function HidePromptBar(){promptBar.hide(false)}function formDisableStuff(b){if(getOpenDIVPopup_NS(b)&&getOpenDIVPopup_NS(b).mModal){return}if(window.weDisabledObj){return}var d=getFormElements_NS(b)["FormContainer"];var f=window.document.createElement("DIV");f.className="BlankOutForm";d.appendChild(f);d.formDisabledObj=f}function formEnableStuff(b){if(getOpenDIVPopup_NS(b)&&getOpenDIVPopup_NS(b).mModal){return}var d=getFormElements_NS(b)["FormContainer"];if(d.formDisabledObj){d.removeChild(d.formDisabledObj);d.formDisabledObj=null}}function BuildToolbar(d,b,h){setToolBarPane_NS(d,new FormPane(d,b,h,true,null,null));settbmaxheight_NS(d,b);new ToolbarButtonIterator(d,function(u,s){if(!u.getAttribute("arwindowid")){u.setAttribute("arwindowid",d)}if(s=="searchsavechanges"){u.parentNode.style.width=u.offsetWidth+4;u.parentNode.style.textAlign="center"}});var k=h.childNodes[1];if(!k.getAttribute("arwindowid")){k.setAttribute("arwindowid",d)}setflipper_NS(d,k);var f=k.childNodes[0],o=k.childNodes[1];var g=true;f.style.visibility="hidden";setrightimg_NS(d,f);setdownimg_NS(d,o);settbopen_NS(d,g)}Toolbar_Click=function(b,d){if(!useLegacyRTFEditor){if(rtfEditor!=null&&rtfEditor!="undefined"){rtfEditor.Close(true)}}var h=d.element;if(h==getflipper_NS(b)||h==getrightimg_NS(b)||h==getdownimg_NS(b)){settbopen_NS(b,!gettbopen_NS(b));var g=getToolBarPane_NS(b).mObj;getrightimg_NS(b).style.visibility=(gettbopen_NS(b)?"hidden":"inherit");getdownimg_NS(b).style.visibility=(gettbopen_NS(b)?"inherit":"hidden");g.childNodes[2].style.visibility=(gettbopen_NS(b)?"inherit":"hidden");getToolBarPane_NS(b).mFixedHeight=(gettbopen_NS(b)?gettbmaxheight_NS(b):getflipper_NS(b).offsetHeight);FormPane.Layout(b)}else{var h=FakeButton_Find(d.element);var f=h.className.split(" ");if(f.length>=1){f=f[0]}if(!(f in ToolbarItemMap)){return}var k=ToolbarItemMap[f];if(typeof k=="function"){return k(b)}else{if(k in FormActionButtonFlags){return getCurWFC_NS(b).executeAll({f:FormActionButtonFlags[k].f,a:[b,h]})}}}};Toolbar_UpdateFormActionButtons=function(b){new ToolbarButtonIterator(b,function(f,h){var o=ToolbarItemMap[h];if(typeof o!="function"&&typeof o!="undefined"){var g=((FormActionButtonFlags[o].c&(1<<getARStateCurrent_NS(b)))==0);if(o==1011&&!getFields_NS(b)[15]){g=false}else{if(o==1013&&getuserSearches_NS(b)==null){g=false}else{if(o==1014&&getquickReportsExisting_NS(b)==null){g=false}}}FakeButton_SetDisable(f,!g)}else{if(h=="advancedsearch"){FakeButton_SetDisable(f,!(getARStateCurrent_NS(b)==4))}else{if(h=="searchsavechanges"){var k=getStateMgr_NS(b).GetActionButtonString();NodeWrite(f.childNodes[1],k);if(((getARStateCurrent_NS(b)==4)&&(typeof getForm_NS(b).TbSearch!="undefined"&&getForm_NS(b).TbSearch==false))||(!(getARStateCurrent_NS(b)==4)&&!getStateMgr_NS(b).IsSaveAllowed(b))||((getARStateCurrent_NS(b)==3))){f.style.visibility="hidden";FakeButton_SetDisable(f,true)}else{f.style.visibility="inherit";FakeButton_SetDisable(f,false)}}}}});if(getToolBarPane_NS(b)){var d=getToolBarPane_NS(b).mObj;d.firstChild.className="TBTopBarStatus TBTopBarStatusMode"+getARStateCurrent_NS(b)}};Toolbar_DirtyFlagChanged=function(b,d){if(ApplyButtonIDs[getARStateCurrent_NS(b)]){new ToolbarButtonIterator(b,function(f,g){if(g=="searchsavechanges"){FakeButton_SetDisable(f,!d)}})}};var notUnloaded=true;window.onunload=FormEvent.Trampoline(function(f){notUnloaded=false;document.oncontextmenu=function(){};var b=getTopWinWindowID_NS();if(weAmDialogue(this.name)){var d=this.weGetOpener(b);if(d){if(d.weDisabledObj){d.weEnableStuff(b)}if(d.weDialogueName){d.weDialogueName=null}}}else{if(!globalLogout&&window.weunloadcalled==undefined&&getFormContext(b)){weOnUnload(b)}}});function WorkflowException(d,g,b){this.windowID=d;if(arguments.length==3&&g>=0&&b instanceof Array&&b.length>0){if(!("msgloc" in b[0])){var h=[];for(var f=0;f<b.length;f++){var k=promptBar.msgDestination(b[f].t,false,null);h.push({mstat:b[f],msgloc:k})}this.mArg=h}else{this.mArg=b}}else{this.mArg=b}this.mCode=g;if(g<0){LogWrite("WorkflowException: "+g)}}WorkflowException.prototype.getStatus=function(){var b=[];for(var d=0;d<this.mArg.length;d++){b.push(this.mArg[d].mstat)}return b};WorkflowException.prototype.getLStatus=function(){return this.mArg};WorkflowException.prototype.getCode=function(){return this.mCode};WorkflowException.prototype.hasMessages=function(){if(this.mArg&&this.mArg instanceof Array&&this.mArg.length>0){return true}else{return false}};WorkflowException.prototype.isNumValue=function(){if(this.mArg){return typeof this.mArg=="number"}else{false}};WorkflowException.prototype.getNumValue=function(){if(this.isNumValue()){return this.mArg}else{return null}};WorkflowException.prototype.toString=function(){if(typeof this.mArg=="number"){return"Non-translated, non-formatted AR Error: "+this.mArg}if(typeof this.mArg=="undefined"){return""}return WorkflowContext_StatusToString(this.windowID,this.getStatus())};WorkflowException.prototype.appendStatus=function(b){if(this.mArg instanceof Array){for(var d=0;d<b.length;d++){var f=promptBar.msgDestination(b[d].t,false,null);this.mArg.push({mstat:b[d],msgloc:f})}}};String.prototype.trim=function(b,g){var f=this.toString();if(b&1){f=f.replace((g?(/^[ \t]+/):(/^\s+/)),"")}if(b&2){var h=(g?(/[^ \t]/):(/\S/));for(var d=f.length-1;d>=0;d--){if(h.test(f.charAt(d))){f=f.substring(0,d+1);break}}if(d==-1){f=""}}return f};String.prototype.compareString=function(h){var d=this.length;var b=h.length;var g=Math.min(d,b);for(var f=0;f<g;f++){if(this.charCodeAt(f)>h.charCodeAt(f)){return 1}else{if(this.charCodeAt(f)<h.charCodeAt(f)){return -1}}}if(d>b){return 1}else{if(d<b){return -1}}return 0};String.prototype.localeCompare=String.prototype.compareString;String.prototype.isDigits=function(){return(this.match(/[0-9]+/)!=null)};String.prototype.isNumeric=function(){return(this.match(/^[\d]+$/)!=null)};String.prototype.replaceArgs=function(){var b=arguments;return this.replace(/\{(\d+)\}/g,function(d,f){return b[f]})};var REGEXPSPECIALCHARS=/([\.\*\?\+\[\]\(\)\{\}\^\$\|\\])/g;String.prototype.toRegExp=function(){return this.replace(REGEXPSPECIALCHARS,"\\$1")};var EVENMOREREGEXSPECIALCHAR=/\$/g;String.prototype.toRegExpSP=function(){return this.replace(EVENMOREREGEXSPECIALCHAR,"$$$$")};String.prototype.HTMLEncode=function(){return this.replace(/(<)|(>)|(\")|(&)/gim,function(b,h,g,f,d){if(h){return"&lt;"}if(g){return"&gt;"}if(f){return"&quot;"}if(d){return"&amp;"}})};String.prototype.HTMLDecode=function(){return this.replace(/(&lt;)|(&gt;)|(&quot;)|(&amp;)/gim,function(b,h,g,f,d){if(h){return"<"}if(g){return">"}if(f){return'"'}if(d){return"&"}})};String.prototype.ValidatorUnEscape=function(){return this.replace(/(&#37;)|(&#59;)|(&#40;)|(&#41;)|(&#43;)/gim,function(b,k,h,g,f,d){if(k){return"%"}if(h){return";"}if(g){return"("}if(f){return")"}if(d){return"+"}})};String.prototype.ValidatorEscape=function(){return this.replace(/(%)|(;)|(\()|(\))|(\+)/gim,function(b,k,h,g,f,d){if(k){return"&#37;"}if(h){return"&#59;"}if(g){return"&#40;"}if(f){return"&#41;"}if(d){return"&#43;"}})};String.prototype.JScriptEncode=function(){return this.replace(/(\")|(\n)|(\r)|(\\)/gim,function(b,h,g,f,d){if(h){return'\\"'}if(g){return"\\n"}if(f){return"\\r"}if(d){return"\\\\"}})};String.prototype.JScriptFlexEncode=function(){return this.replace(/(\")|(\\)/gim,function(b,f,d){if(f){return f}if(d){return"\\\\"}})};String.prototype.ARQualifierEncode=function(){return this.replace(/(')/gim,function(b,d){if(d){return"''"}})};String.prototype.EscapeQuote=function(){return this.replace(/(')/gim,function(b,d){if(d){return"\\'"}})};String.prototype.EscapeBackSlashQuote=function(){return this.replace(/\\\'/gim,function(b,d){if(d){return"\\\\'"}})};String.prototype.ConvertCarriageReturn=function(){return this.replace(/(\r\n)|(\n)/gim,function(b,f,d){if(f){return f}if(d){return"\n"}})};String.prototype.ARToJSIdentifier=function(){return this.replace(/[^A-Za-z0-9]/g,function(b){return"_"+b.charCodeAt(0)})};String.prototype._urlencode=function(){var d="0123456789ABCDEF";var h="";for(var f=0;f<this.length;f++){var g=this.charAt(f);var b=g.charCodeAt(0);if(b>255){h+=d.charAt((b&61440)>>12);h+=d.charAt((b&3840)>>8);h+=d.charAt((b&240)>>4);h+=d.charAt(b&15)}else{h+=d.charAt((b>>4)&15);h+=d.charAt(b&15)}}return h};String.prototype.compareToIgnoreCase=function(b){return this.toLowerCase()==b.toLowerCase()};String.prototype.toByteArray=function(){var d=[];var b=this.length;for(var g=0;g<b;g++){if(this.charCodeAt(g)<=127){d.push(this.charCodeAt(g))}else{var h=encodeURIComponent(this.charAt(g)).substr(1).split("%");for(var f=0;f<h.length;f++){d.push(parseInt(h[f],16))}}}return d};String.NBSP=new RegExp(String.fromCharCode(160),"g");String.prototype.replaceNBSP=function(){return this.replace(String.NBSP," ")};String.fromCharCodeWithNumPad=function(b){if(b>=96&&b<=105){b=b-(96-48)}return String.fromCharCode(b)};var regExForXss=/\s+on(\w+)\s*=+|<script\b[^>]*>([\s\S]*?)<\/script>|<iframe([\s\S]*?)\>/gi;var regExForDombased=/(\s*eval\s*\()|(\s*alert\s*\()|(\s*prompt\s*\()/gi;String.prototype.removeXssVulnerability=function(){var b=this.replace(regExForXss," ");return b.replace(regExForDombased," ( ")};function weDeepCopy(b,f){for(var d in f){if(typeof f[d]=="number"||typeof f[d]=="boolean"){b[d]=f[d]}else{if(typeof f[d]=="string"){b[d]=new String(f[d])}else{if(typeof f[d]=="object"){b[d]={};weDeepCopy(b[d],f[d])}else{LogAndAlert("Unknown type "+typeof d)}}}}}function weDeepSerialise(o,g){var d=o instanceof Array;g.push(d?"[":"{");var k=true;for(var f in o){var b=typeof o[f];if(b=="undefined"){continue}if(!k){g.push(",")}if(!d){g.push(f+":")}if(b=="number"||b=="boolean"){g.push(o[f])}else{if(b=="string"){var h=o[f].JScriptEncode();g.push('"'+h+'"')}else{if(b=="object"){if(o[f]!=null){weDeepSerialise(o[f],g)}else{g.push(o[f]+"")}}else{}}}k=false}g.push(d?"]":"}")}function weDeepSerialiseVariable(b){var d=[];weDeepSerialise(b,d);return d.join("")}function addWindowAsChild(h,d,f,g,b){new weWindow(h,d,f,g,b)}function weWindow(k,d,f,g,b){var h=makeweChildName(k,f);this.mWin=k;this.mArg=d;this.mName=f;this.mType=g;this.mContinuation=b;this.mArrived=false}function weGetARWindowOpener(){var d=window.opener;try{if(d==null&&parent!=null&&parent.name!=window.name){d=parent}while(d!=null){if(("quickReportParamURL" in d)||("menubox" in d)){break}if(d.parent!=null&&d.name!=d.parent.name){d=d.parent;continue}d=d.opener}if(d==null){d=window.opener}}catch(b){}return d}function weOnLoad(b,f){window.weDialogueName=null;if(window.name==""&&window.frameElement&&window.frameElement.id){window.name=window.frameElement.id;setWindowName_NS(b,window.name)}if(!window.weOpener){if(window.opener&&!window.opener.closed){window.weOpener=weGetARWindowOpener()}else{window.weOpener=null}}try{if(window.weOpener&&!window.weOpener.closed&&window.name==window.weOpener.name){window.opener=null;window.weOpener=null}}catch(h){window.opener=null;window.weOpener=null}try{if(window.weOpener==null&&parent!=null&&"ARProcessEvent" in parent&&parent.name!=window.name){window.weOpener=parent}}catch(h){}if(window.weOpener&&!window.weOpener.closed&&window.name!=""){if(window.weOpener&&!window.weOpener.closed&&window.weOpener.window.weChildCome){window.weOpener.window.weChildCome(window,window.name,window.arWindowType);window.arWindowType=window.weOpener.window.weExtractWindowType(window,window.name);setWindowType(b,window.arWindowType);setWindowArgs_NS(b,window.weOpener.window.weExtractArgs(window,window.name))}}else{if(window.name==""){setWindowArgs_NS(b,null);window.name=createARRootWindowName();setWindowName_NS(b,window.name)}}if(window.URLParams){if("eid" in window.URLParams){if(!getWindowArgs_NS(b)){setWindowArgs_NS(b,{})}getWindowArgs_NS(b).eid=window.URLParams.eid}if("qual" in window.URLParams){if(!getWindowArgs_NS(b)){setWindowArgs_NS(b,{})}try{var g=new NDXParseAndEncodeQualifier(b,ARKWGetByName(b,"SERVER").toString(),ARKWGetByName(b,"SCHEMA").toString(),ARKWGetByName(b,"VUI").toString(),window.URLParams.qual).result;getWindowArgs_NS(b).qual={qual:g,fieldids:[],fieldvals:[],fieldtypes:[]}}catch(d){LogAndAlert(d)}}if("mode" in window.URLParams){if(!getWindowArgs_NS(b)){setWindowArgs_NS(b,{})}getWindowArgs_NS(b).wMode=(window.URLParams.mode.compareToIgnoreCase("submit")||window.URLParams.mode.compareToIgnoreCase("create"))?2:(window.URLParams.mode.compareToIgnoreCase("modifyDirect")?12:1)}}if(typeof f=="undefined"||!f){notifyExternal(b)}}function notifyExternal(b){try{if(weAmPopup(window.name)&&(getWindowArgs_NS(b)&&getWindowArgs_NS(b).title!=getLocalizedMessage("Add Attachment"))){window.setTimeout(function(){if(typeof FormContainer!="undefined"){if("external" in window.weOpener){try{if(typeof loaded!="undefined"){loaded++}if("external" in top){top.external.PopupFormLoaded()}else{window.weOpener.external.PopupFormLoaded()}}catch(f){}}return}if("external" in window.weOpener){try{if(typeof loaded!="undefined"){loaded++}if("external" in top){top.external.PopupLoaded(b)}else{window.weOpener.external.PopupLoaded(b)}}catch(f){}}},100)}else{if("external" in top){try{if(typeof loaded!="undefined"){loaded++}top.external.FormLoaded(b)}catch(d){}}}}catch(d){}}window.weAddChildWindow=function(g,f,d,h,b,o,k){setWindowArgs_NS(g,b);var s=makeweChildNameUsingParent(k,d);setChildWindowIDForName(s,g);setWindowType(g,h);setcontinuationFuncs_NS(g,null);setOpenerWindowID(g,f,k);addChildWindowID(f,g,o)};window.weOpen=function(h,f,b,z,o,D,C,g,A){initSessionTimeoutCounter();if(weAmDialogue(window.name)){if(window.weOpener&&!window.weOpener.closed&&window.weOpener.window.weOpen){var B=window.weOpener.window.getTopWinWindowID_NS();var d=window.weOpener.window.allocWindowID_NS();if(lCache){var y=getGlobalFields();window.weOpener.setProxyGlobalFields(y)}return window.weOpener.window.weOpen(d,B,b,z,o,D,C,g,A)}return null}setWindowMode(h,"");setWindowType(h,o);setWindowArgs_NS(h,D);var u=makeweChildNameUsingParent(window,z);setChildWindowIDForName(u,h);setOpenerWindowID(h,f,window);setChildArrived_NS(h,false);var s=null;if(g){s=window.open(b,z,(C?(",width="+C[0]+",height="+C[1]):""))}else{if(window.weDialogueName!=null){var w=getChildWindowIDFromName(window.weDialogueName);var k=getWindowObj(f,w)}try{window.parentWindowID=f;window.sendEventToParentWindow=function(G,E){ARProcessSendEvent(G,E)}}catch(v){}s=window.open(b,z,((C?(",width="+C[0]+",height="+C[1]):"")+",toolbar=0,location=no,resizable=yes,menubar=no,scrollbars=")+((A==true)?"yes":"no"))}setTimeout(function(){if(s){s.focus()}},100);WorkflowContext.WindowOpened(f);if(o=="URL"){s=null}else{if(s){addChildWindowID(f,h,s)}}setTimeout(function(){new WorkflowContext(f,{f:function(){RTF_Close(true)}})},0);return s};function getWindowObj(d,g){var b=null;var h=getChildWindowIDs(d);if(h!=null){for(var f in h){if(h[f].windowID==g){b=h[f].windowObj;break}}}if(b===null){var o=null;var k=getLogicalChildWindowIDs(d);if(k==null||k.length<=0){return null}for(var f in k){o=getWindowObj(k[f],g);if(o==null){continue}else{b=o}}}return b}function toggleDisabled(d){try{d.disabled=d.disabled?false:true}catch(f){}if(d.childNodes&&d.childNodes.length>0){for(var b=0;b<d.childNodes.length;b++){toggleDisabled(d.childNodes[b])}}}function weDisableStuff(d){if(isLogicalWindow(d)){d=getTopWinWindowID_NS()}var b=getOpenDIVPopup_NS(d);if(b&&b.mModal){return}if(window.weDisabledObj==null||window.weDisabledObj.style.visibility=="hidden"){var h=getCharEditPopups_NS(d);for(var f=0;f<h.length;f++){toggleDisabled(h[f].mDiv)}}if(!window.weDisabledObj){var g=document.createElement("DIV");g.style.top="0px";g.style.left="0px";g.style.width="100%";g.style.height="100%";g.style.backgroundColor="black";g.style.opacity=".20";g.style.zIndex=nextZIndex++;g.style.visibility="visible";g.oncontextmenu=function(){return false};window.weDisabledObj=g;document.body.appendChild(g)}else{window.weDisabledObj.style.visibility="visible";window.weDisabledObj.style.zIndex=nextZIndex++}}function weDisableStuffActive(b){if(window.weDisabledObj&&window.weDisabledObj.style.visibility=="visible"){return true}return false}function weEnableStuff(d){if(isLogicalWindow(d)){d=getTopWinWindowID_NS()}var b=getOpenDIVPopup_NS(d);if(b&&b.mModal){return}if(window.weDisabledObj&&window.weDisabledObj.style.visibility=="visible"){var h=getCharEditPopups_NS(d);for(var f=0;f<h.length;f++){toggleDisabled(h[f].mDiv)}}if(window.weDisabledObj){if(formModalList.mStack.length>0){var g=formModalList.mLowestZIndex;window.weDisabledObj.style.zIndex=g-1}else{window.weDisabledObj.style.visibility="hidden"}}}var isFrmLoaded=false;var setCount=0;function weUnfreezeParent(g){var f=getChildWindowIDFromName(window.weDialogueName);var h=null;var d=getChildWindowIDs(g);setCount=setCount+1;if(isFrmLoaded||(setCount>20)){setCount=0;isFrmLoaded=false;return}for(var b in d){if(d[b].windowID==f){h=d[b].windowObj;if(h.closed){weEnableStuff(g);setCount=0}else{setTimeout("weUnfreezeParent("+g+")",500)}break}}}window.weOpenDialogue=function(g,d,o,D,E,B,b){D.wMode=0;if(window.weDialogueName!=null){return}weDisableStuff(g);if(b!=20){var z=new Date().getTime()+"D";window.weDialogueName=z;var s,k;var u="";if(B){s=screen.width/2;var C=screen.height;if(B[1]>C){B[1]=C}k=C/2;s-=(B[0]/2);k-=(B[1]/2);if(s<0){s=0}if(k<0){k=0}s=Math.floor(s);k=Math.floor(k);u=",width="+B[0]+",height="+B[1]+",left="+s+",top="+k}var h=allocWindowID_NS();setWindowMode(h,"D");setWindowType(h,o);setWindowArgs_NS(h,D);setcontinuationFuncs_NS(h,E);var y=makeweChildNameUsingParent(window,z);setChildWindowIDForName(y,h);setOpenerWindowID(h,g,window);setChildArrived_NS(h,false);isFrmLoaded=false;var A=window.open(d,z,"toolbar=no,location=no,resizable=yes,scrollbars=no,menubar=no"+u);if(A==null){window.weDialogueName=null;weEnableStuff(g);return A}else{addChildWindowID(g,h,A)}setTimeout("weUnfreezeParent("+g+")",500)}else{var z=new Date().getTime()+"P";window.weDialogueName=z;if(d.indexOf(window.location.pathname)==0){d+=("&n="+z)}var h=allocWindowID_NS();setWindowMode(h,"D");setWindowType(h,o);setWindowArgs_NS(h,D);setcontinuationFuncs_NS(h,E);var y=makeweChildNameUsingParent(window,z);setChildWindowIDForName(y,h);setOpenerWindowID(h,g,window);setChildArrived_NS(h,false);var f;if(D.cb==1){f=new DialogPopup(g,true);if(B!=null){B[1]+=36;B[0]+=2}}else{f=new DialogPopup(g,false)}if(B!=null){f.SetSize(B[0],B[1])}f.SetContents(z,D.title,d);f.ShowCentredPopup(false);var A=f.mIFrame.window;addChildWindowID(g,h,A)}WorkflowContext.WindowOpened(g);var v=new weWindow(A,D,z,o,E);wePuntFocus(g);setTimeout(function(){new WorkflowContext(g,{f:function(){RTF_Close(true)}})},0);return v};window.weOpenModalPopup=function(f,b,h,z,s,y){var o=function(B,w){s.result=w;var C=getCurWFC_NS(B);if(C){isFromResume=1;var A=[];A.push({f:function(){FocusMgr.SetFocusBacktoWindow()},a:[]});C.resume(A);isFromResume=0}};z.wMode=0;if(window.weDialogueName!=null){return}var u=new Date().getTime()+"P";window.weDialogueName=u;var g=allocWindowID_NS();setWindowMode(g,"D");setWindowType(g,h);setWindowArgs_NS(g,z);setcontinuationFuncs_NS(g,o);setOpenerWindowID(g,f,window);var k=makeweChildNameUsingParent(window,u);setChildWindowIDForName(k,g);setChildArrived_NS(g,false);var d=new DialogPopup(f,true);if(y!=null){d.SetSize(y[0],y[1])}d.SetContents(u,z.title,b);d.ShowCentredPopup(false);var v=d.mIFrame.window;addChildWindowID(f,g,v);WorkflowContext.WindowOpened(f);wePuntFocus(f);return{i:1}};window.weOpenModelessPopup=function(d,b,g,u,v,s){u.wMode=0;var k=new Date().getTime()+"MD";var f=allocWindowID_NS();setWindowMode(f,"MD");setWindowType(f,g);setWindowArgs_NS(f,u);setcontinuationFuncs_NS(f,v);setOpenerWindowID(f,d,window);var h=makeweChildNameUsingParent(window,k);setChildWindowIDForName(h,f);var o=window.open(b,k,"toolbar=no,location=no,resizable=yes,scrollbars=no,menubar=no"+(s?(",width="+s[0]+",height="+s[1]):""));addChildWindowID(d,f,o);WorkflowContext.WindowOpened(d);return o};window.weCloseNonModalChildren=function(d){var b=getChildWindowIDs(d);if(b==null){return}var g=b.length;for(var f=0;f<g;f++){var h=b[f].windowID;if(getWindowMode(h).indexOf("MD")!=-1){weForceDialogueClose();removeChildWindowID(d,h)}}};window.weExtractWindowType=function(h,d){var g=makeweChildName(h,d);var b=getChildWindowIDFromName(g);var f=getWindowType(b);return f};window.weExtractArgs=function(h,f){var g=makeweChildName(h,f);var d=getChildWindowIDFromName(g);var b=getWindowArgs_NS(d);setWindowArgs_NS(d,null);return b};window.weChildGone=function(o,d,s,u,g){var b=getChildWindowIDs(o);var v=false;for(var h in b){if(b[h].windowID==d){v=true;break}}if(!v){return}if(weAmDialogue(u)){var f=getcontinuationFuncs_NS(d);if(weAmModal(u)){window.weDialogueName=null;if(f==null){weEnableStuff(o)}}if(f!=null){var k={};if(g){weDeepCopy(k,g)}window.setTimeout(function(){if(weAmModal(u)){weEnableStuff(o)}if(f){f(o,k)}},100)}}if(typeof FieldList!="undefined"){FieldList.SetAllGlobals(o)}removeChildWindowID(o,d)};window.weChildCome=function(d,u,f){var o=null;var y=makeweChildName(d,u);var b=getChildWindowIDFromName(y);if((typeof b=="undefined")||(b==null)){b=allocWindowID_NS();setWindowArgs_NS(b,null);setChildWindowIDForName(y,b);setWindowType(b,f);setcontinuationFuncs_NS(b,null);var g=null;var w=y.indexOf("IF_");if(w!=-1){g=parseInt(y.substring(w+3))}if(typeof g=="undefined"||g==null){g=null;if(weAmInViewField(u)){var z=parseInt(u.substring(2));for(var v in fc.formContexts){var s=fc.formContexts[""+v].ViewFields;for(var h in s){if(h==z){var k=s[h];if(!k.isInlineForm()){g=k.windowID;break}}}if(g!=null){break}}}}if(g==null){g=getTopWinWindowID_NS()}setOpenerWindowID(b,g,window);addChildWindowID(g,b,d)}setChildArrived_NS(b,true)};function weOnUnload(g){if((typeof window.weunloadcalled!="undefined")&&(window.weunloadcalled==true)){return}window.weunloadcalled=true;if(typeof g=="undefined"){g=getTopWinWindowID_NS()}var z=false;var E=getChildWindowIDs(g);var b=(E!=null)?E.length:0;for(var A=0;A<b;A++){if(getWindowArgs_NS(E[A].windowID)!=null){z=true;break}}if(z){LogAndAlert(getLocalizedMessage("Warning: If AR System windows are still loading, they will load incorrectly.\nIf you have AR System windows still loading, do not press 'OK' until they are complete."))}if(window.weDialogueName!=null){var w=getChildWindowIDFromName(window.weDialogueName);var k=null;var u=false;for(var A in E){if(E[A].windowID==w){u=true;k=E[A].windowObj;break}}if(k!=null){if(typeof k.window.weForceDialogueClose!="undefined"){k.window.weForceDialogueClose()}removeChildWindowID(g,w);window.weDialogueName=null}}weCloseNonModalChildren(g);hookChildrenToOpener(g);var o=getLogicalChildWindowIDs(g);for(var A in o){LogicalWindowOnUnload(o[A])}try{var d=getViewFields_NS(g);for(var y in d){if(d[y].mObj.firstChild&&d[y].mObj.firstChild.nodeName=="IFRAME"){d[y].mObj.removeChild(d[y].mObj.firstChild)}}}catch(h){}try{if(typeof window.weOpener!="undefined"){var f=makeweChildName(window,window.name);var v=window.weOpener.window.getChildWindowIDFromName(f);if(typeof v!="undefined"){var D=window.weOpener.window.getOpenerWindowID(v);if(D!=null&&"weChildGone" in D.windowObj.window){D.windowObj.window.weChildGone(D.windowID,v,window,window.name,"weDialogueReturnValue" in window?window.weDialogueReturnValue:null)}}}}catch(C){}document.body.disabled=true;var s=document.createElement("DIV");s.style.top="0px";s.style.left="0px";s.style.width="2400px";s.style.height="1900px";s.style.backgroundColor="white";s.style.zIndex=110000;document.body.appendChild(s);if(weAmPopup(window.name)){if("external" in window.weOpener){for(var A in getFields_NS(g)){try{window.weOpener.external.PopupFormUnLoaded()}catch(B){}return}try{window.weOpener.external.PopupUnLoaded()}catch(B){}}}else{if("external" in window){try{window.external.FormUnloaded()}catch(B){}}}document.body.removeChild(s);document.body.disabled=false}function LogicalWindowOnUnload(g){if(!isLogicalWindow(g)){return}var o=getLogicalChildWindowIDs(g);for(var s in o){LogicalWindowOnUnload(o[s])}var d=getChildWindowIDs(g);var w=(d!=null)?d.length:0;var u=false;for(var s=0;s<w;s++){if(getWindowArgs_NS(d[s])!=null){u=true;break}}if(u){LogAndAlert(getLocalizedMessage("Warning: If AR System windows are still loading, they will load incorrectly.\nIf you have AR System windows still loading, do not press 'OK' until they are complete."))}if(window.weDialogueName!=null){var v=getChildWindowIDFromName(window.weDialogueName);var k=null;var h=false;for(var s in d){if(d[s].windowID==v){h=true;k=d[s].windowObj;break}}if(k!=null){if(typeof k.window.weForceDialogueClose!="undefined"){k.window.weForceDialogueClose()}removeChildWindowID(g,v);window.weDialogueName=null}}for(var b in MidTierDragDropMgrInst.dropTargetHandles){if(b!=null&&b.indexOf("WIN_"+g)!=-1){MidTierDragDropMgrInst.unregisterDropTarget(b)}}var f=getFormContext(g).inlineIntervalHandles;if(f.length>0){while(f.length>0){clearInterval(f.pop())}promptBar.setToClear()}if(typeof wm.inlineIntervalsStack[g]!="undefined"){delete wm.inlineIntervalsStack[g]}weCloseNonModalChildren(g);hookChildrenToOpener(g)}function weGetDialogueParentID(){if(typeof window.weOpener!="undefined"&&window.weOpener!=null){var g=makeweChildName(window,window.name);if(!window.weOpener.window.getChildWindowIDFromName){return -1}var d=window.weOpener.window.getChildWindowIDFromName(g);if(typeof d!="undefined"){var f=window.weOpener.window.getOpenerWindowID(d);if(f!=null){return f.windowID}}else{if(weAmInViewField(g)){var b=g.indexOf("IF_");if(b!=-1){return parseInt(g.substring(b+3))}}}}return 0}function weCloseDialogue(f,b){clearCookiesOnDialogClose();window.weDialogueReturnValue=b;try{var g=window.weOpener.window.getChildWindowIDFromName(window.name);if(g){var h=window.weOpener.window.getOpenerWindowID(g);var d=window.weOpener.window.getOpenDIVPopup_NS(h.windowID);if(weAmPopup(window.name)&&(d!=null)){weOnUnload(f);d.HidePopup(false)}else{window.close()}}}catch(k){window.close()}}function clearCookiesOnDialogClose(){if((window.name.indexOf("ARRoot")!=0)&&openWindowCachId!=""&&closeWindowCachId==""){loadCookie("T");var f=getCookie("T");var d=parseInt(f);if(d>1){loadCookie("w"+window.name);var b=getCookie("w"+window.name);if(b!=undefined&&b!=""){deleteCookie("w"+window.name,"/",null);d--;setCookie("T",d,null,"/",null)}}}}var REGEXPDIALOGUE1=/^[0-9]+(D{1}|(M{1}D{1})|P{1})$/g;var REGEXPDIALOGUE2=/^[0-9]+(M{1}|(M{1}D{1}))$/g;var REGEXPDIALOGUE3=/^[0-9]+(P{1})$/g;function weAmDialogue(b){return(b.match(REGEXPDIALOGUE1)!=null)}function weAmModal(b){return(b.match(REGEXPDIALOGUE2)==null)}function weAmPopup(b){return(b.match(REGEXPDIALOGUE3)!=null)}function weGetOpenDialogueName(){return window.weDialogueName}function weAmInViewField(d){var b=/VF[0-9]+/;if(d==null){return false}return(d.match(b)!=null)}function makeweChildName(d,b){return b}function makeweChildNameUsingParent(d,b){return b}function weGetWindowType(b){if(arguments.length==0){if(window&&window.arWindowType){return window.arWindowType}else{return null}}return getWindowType(b)}window.weForceDialogueClose=function(){window.onbeforeunload=window.onunload=null;licenseSessionCloseWindow();if(window.weDialogueName!=null){var h=getChildWindowIDFromName(window.weDialogueName);for(var u in wm.weChildrenWindowIDs){var b=wm.weChildrenWindowIDs[""+u];if(typeof b!="undefined"){var k=null,g=false;for(var o in b){if(b[o].windowID==h){g=true;k=b[o].windowObj;break}}if(k!=null){k.window.weForceDialogueClose();break}}}}var d=window.weOpener.window.getChildWindowIDFromName(window.name);var s=window.weOpener.window.getOpenerWindowID(d);var f=window.weOpener.window.getOpenDIVPopup_NS(s.windowID);if(f!=null){f.HidePopup(false)}setInterval("window.close()",10)};function wePunt(b){if(window.weDialogueName){var f=getChildWindowIDFromName(window.weDialogueName);var k=getChildWindowIDs(b);var d=false;var h=null;for(var g in k){if(k[g].windowID==f){d=true;h=k[g].windowObj;break}}if(h!=null&&window!=h){if(!h.closed){if(!h.closed&&typeof h.window!="undefined"&&h.wePunt){h.window.wePunt(h.window.getTopWinWindowID_NS())}}else{if(!getChildArrived_NS(f)){weChildGone(b,f,window,window.weDialogueName,null)}}}else{}}else{window.focus()}}function wePuntFocus(b){if(window.weDialogueName){setTimeout(function(){wePunt(b)},100);if("Menu_Close" in window.self){Menu_Close()}return true}return false}function weCloseAllWindows(f,y,v,d){var b=y.getChildWindowIDs(f);if(b!=null){var B=b.length;for(var o=--B;o>-1;o--){var s=b[o].windowObj;if(s==y){continue}try{if(s&&!s.closed&&"weCloseAllWindows" in s){weCloseAllWindows(getTopWinWindowID_NS(),s,false,null)}else{if(s&&!s.closed){weCloseWindow(f,s,false)}}}catch(u){try{if(s){s.window.close()}}catch(u){}}}}var h=y.getLogicalChildWindowIDs(f);for(var k in h){weCloseAllWindows(h[k],y,false,d)}if(isLogicalWindow(f)){return}if(y.weAmDialogue(y.name)){y.weCloseDialogue(f,null)}else{if(v==true&&d!=null){try{var z=document.createElement("form");z.setAttribute("method","post");z.setAttribute("action",d);var g=document.createElement("input");g.setAttribute("type","text");g.setAttribute("name","sToken");g.setAttribute("value",window.sTok);var A=document.createElement("input");A.setAttribute("type","submit");A.setAttribute("value","Submit");z.appendChild(g);z.appendChild(A);document.getElementsByTagName("body")[0].appendChild(z);z.submit()}catch(w){}}else{weCloseWindow(f,y,v)}}}function weRecurAllWindowsIterator(f){windowID=getTopWinWindowID_NS();var g=getChildWindowIDs(windowID);for(var d in g){var b=g[d].windowObj;if(b&&!b.closed&&"weRecurAllWindowsIterator" in b){f.push(b);b.weRecurAllWindowsIterator(f)}}}function weGetAllWindows(b){var d=new Array();var g=window;if(window.weDialogueName!=null){var h=getChildWindowIDFromName(window.weDialogueName);var k=getWindowObj(b,h);if(k!=null&&k.rsso_flag){d.push(k)}}if("weOpener" in g&&g.weOpener==null&&"weRecurAllWindowsIterator" in g){d.push(g)}else{try{while(g.weOpener&&!g.weOpener.closed&&"weRecurAllWindowsIterator" in g.weOpener){g=g.weOpener;if("weOpener" in g&&g.weOpener==null&&"weRecurAllWindowsIterator" in g){d.push(g)}}}catch(f){}}try{g.weRecurAllWindowsIterator(d)}catch(f){}return d}function weGetChildWindows(b){var f=new Array();var d=getChildWindowIDs(b);for(i in d){f.push(d[i].windowObj)}return f}function weGetWindowByName(d,f){var h=weGetAllWindows(d);try{for(var g=0;g<h.length;g++){var b=h[g];if(b&&!b.closed&&"weRecurAllWindowsIterator" in b){if(b.name==f){return b}}}}catch(k){}return null}function weCloseWindowInterval(d,f,b){if(!b){f.close()}else{setTimeout(function(){if(!f.closed&&getStateMgr_NS(d).mWindowIsClosed){f.close()}},0)}}function weCloseWindow(d,k,h){if(isLogicalWindow(d)){var f=getLogicalWindow(d);if(f!=null){f.setClearInlineFormFlag(true)}return}var u=(showWaitCursor==1||showWaitCursor==4);if(h){if(weAmInViewField(k.name)){k.frameElement.src="about:blank";return}if(k.history.length!=undefined){var g=k.history.length;var o=g-1;if(u){o--}if(k.hlength<g){o-=(g-k.hlength)}if(o<=0){weCloseWindowInterval(d,k,h)}else{var b=2;var s=(u&&(showWaitCursor!=2))?b:1;if(k.hlength<g){s+=(g-k.hlength)}if(k.history.length>=s){k.history.go(-s);setTimeout(function(){if(notUnloaded){if(k.parent!=null&&(typeof k.parent!="undefined")){if(stayOnPage!=2||(closeCalled)){setTimeout(function(){stayOnPage=1},1000);closeCalled=true;k.close()}}}},1000)}else{k.history.go(-1)}}}else{weCloseWindowInterval(d,k,h)}}else{weCloseWindowInterval(d,k,h)}}function weGetOpener(d){if(arguments.length==0){d=getTopWinWindowID_NS()}var b=null;if(d!=null){var f=getOpenerWindowID(d);if(f!=null){b=f.windowObj}if(typeof b=="undefined"){b=null}}if((b==null)&&(typeof window.weOpener!="undefined")){b=window.weOpener}return b}function weDisplayWFNotes(b,f){if(f.getCurWFC_NS(b)){var d=f.getCurWFC_NS(b).notes;if(d.length>0){f.getCurWFC_NS(b).notes=[];return WC_DisplayMessage(b,d)}}}function weDisplayWFException(b,d){if((b instanceof WorkflowException)&&b.mArg&&b.mArg.length>0){return WC_DisplayMessage(d,b.getLStatus())}else{throw b}}function createARRootWindowName(){return"ARRoot"+new Date().getTime()}var WDECurrentDrag=null;function WDEDragContext(d,h){this.mStartElement=h;this.mwindowID=h.getAttribute("arwindowid");this.mOrigX=this.mOrigY=0;this.mDX=-d.ox;this.mDY=-d.oy;this.mX=this.mY=this.mMouseX=this.mMouseY=0;this.mWidth=this.mStartElement.offsetWidth;this.mHeight=this.mStartElement.offsetHeight;this.mParentElement=this.mStartElement.offsetParent;while(!this.mParentElement.getAttribute("draghandler")&&this.mParentElement){this.mParentElement=this.mParentElement.offsetParent}this.mMaxX=this.mParentElement.offsetWidth;this.mMaxY=this.mParentElement.offsetHeight;this.mMinX=this.mMinY=0;this.mNewElement=null;var f=wm.getParentWindowID(this.mwindowID);if(this.mStartElement.id=="Splitter"&&f!=null){var b=getViewFields_NS(f);for(var g in b){if(b[g]!=null&&b[g].isInlineForm()&&b[g].mChildWindowID!=null&&b[g].mChildWindowID==this.mwindowID){this.mHandler=window.self[document.body.getAttribute("draghandler")];this.mParentElement=b[g].mObj;break}}}else{this.mHandler=window.self[this.mParentElement.getAttribute("draghandler")]}this.mDragState=0;WDECurrentDrag=this;this.mParentElement.onmousemove=FormEvent.Trampoline(function(k){return !WDECurrentDrag.MouseMove(k)})}WDEDragContext.prototype.MouseMove=function(g){var o=g.element;var b=g.ox,s=g.oy;var h=ComputeElementPosition(o,this.mParentElement,b,s);b=h.x;s=h.y;var k=-1;this.mMouseX=b;this.mMouseY=s;if(this.mDragState==0){this.mOrigX=b;this.mOrigY=s;this.mDragState=1}else{if(this.mDragState==1){var d=Math.abs(s-this.mOrigY);var f=Math.abs(b-this.mOrigX);if(Math.sqrt(d*d+f*f)>4){if(this.mStartElement.getAttribute("dragoriginal")){this.mNewElement=this.mStartElement}else{this.mNewElement=this.mStartElement.cloneNode(true);this.mNewElement.setAttribute("draggable","");this.mParentElement.appendChild(this.mNewElement)}this.mNewElement.className=this.mNewElement.className+" dragging";this.mDragState=2;b+=f;s+=d;k=0}else{return false}}else{if(this.mDragState==2){s+=this.mDY;s=(s<this.mMinY?this.mMinY:s);if(s+this.mHeight>this.mMaxY){s=this.mMaxY-this.mHeight}b+=this.mDX;b=(b<this.mMinX?this.mMinX:b);if(b+this.mWidth>this.mMaxX){b=this.mMaxX-this.mWidth}this.mNewElement.style.top=s+"px";if(this.mStartElement.id=="Splitter"&&wm.getParentWindowID(this.mwindowID)!=null){this.mNewElement.style.left="0px"}else{this.mNewElement.style.left=b+"px"}k=1}}}if(k!=-1){this.mX=b;this.mY=s;this.CallHandler(k)}return true};WDEDragContext.prototype.SetDragBounds=function(d,b,g,f){if(d!=null){this.mMinX=d}if(b!=null){this.mMinY=b}if(g!=null){this.mMaxX=g}if(f!=null){this.mMaxY=f}};WDEDragContext.prototype.CallHandler=function(b){var d={};d.state=b;d.x=this.mX;d.y=this.mY;d.mx=this.mMouseX;d.my=this.mMouseY;d.srcElement=this.mStartElement;d.newElement=this.mNewElement;d.dragContext=this;d.original=(this.mStartElement==this.mNewElement);this.mHandler(d)};WDEDragContext.prototype.Stop=function(b){this.mParentElement.onmousemove=null;if(this.mDragState>=2){if(this.mStartElement!=this.mNewElement){this.mParentElement.removeChild(this.mNewElement)}else{this.mStartElement.className=this.mStartElement.className.replace(/dragging/,"")}if(b){this.mX=this.mOrigX+this.mDX;this.mY=this.mOrigY+this.mDY}this.CallHandler(b?3:2)}WDECurrentDrag=null};function WDEDragContext_Stop(){if(WDECurrentDrag!=null){WDECurrentDrag.Stop(true)}}WDEDragContext.prototype.HandleMouseUp=function(b){var d=b.element;while(d&&d!=this.mParentElement){d=d.offsetParent}this.Stop(d!=this.mParentElement);return true};function WDEHandleEvent(g,f){if(g==0){var h=f.element;while(h&&!h.getAttribute("draggable")){h=h.offsetParent}if(!h||!h.getAttribute("draggable")){return false}if((f.button!=0)||WDECurrentDrag){return true}if(h.className.indexOf("InvisibleSplitterH")!=-1){var d=h.getAttribute("arbcolor");h.style.borderLeft="1px solid "+d}else{if(h.className.indexOf("InvisibleSplitterV")!=-1){var d=h.getAttribute("arbcolor");h.style.borderTop="1px solid "+d}}new WDEDragContext(f,h);return true}else{if(g==1&&WDECurrentDrag!=null){return WDECurrentDrag.HandleMouseUp(f)}else{if(g==3&&f.key==27&&WDECurrentDrag!=null){WDEDragContext_Stop();return true}}}return false}function WorkflowContext(d,g,b){this.windowID=d;this.mMenuOpenning=b;this.execStks=[];this.guideCtxt=[];this.guideCtxtSav=[];this.notes=[];this.mCallbacks=[];this.mStatusTimeout=null;this.dirtyElements={};this.enableWaitCursor=0;this.AddCallback(this,FlushLogBuffer,[]);getWindowMgr_NS().pushCurrentWindowID(d);this.frmNm=getFormContext(d).formName;this.usrClick=(g.cl?g.cl:false);this.wfowId=Math.floor(Math.random()*1000000);if(getWFThreadsList_NS(this.windowID).length==0){TIMELINE.start("WORKFLOW"+this.wfowId,this.frmNm,this.usrClick);for(var f in getAsyncFields_NS(this.windowID)){getAsyncFields_NS(this.windowID)[f].SetAsync(1)}}getWFThreadsList_NS(this.windowID).push(this);setCurWFC_NS(this.windowID,this);this.AddCallback(this,function(){AsyncField_DecrAsyncRef(this.windowID)});if(keyRefCnt<=0){keyRefCnt=0;ARKWSetShifCtrlAltToRealtime()}keyRefCnt++;this.execute(g)}WorkflowContext.prototype.mOpenedWindow=false;WorkflowContext.prototype.setStatus=function(d){var b=window.status;window.status=d;if(this.mStatusTimeout!=null){clearTimeout(this.mStatusTimeout)}this.mStatusTimeout=setTimeout(function(){window.status=b;this.mStatusTimeout=null},5000)};WorkflowContext.prototype.pushEntryIntoCurrentStack=function(g){if(g){var b=this.execStks;var f;if(b.length>0){f=b[b.length-1]}else{f=b}if(g instanceof Array){for(var d in g){f.push(g[d])}}else{f.push(g)}}};WorkflowContext.prototype.pushEntryForBulk=function(g){if(g){var b=this.execStks;var f;if(b.length>0){f=b[b.length-1]}else{f=b}if(g instanceof Array){for(var d in g){if(g[d].n){f.push(g[d].n)}if(g[d].c){f.push(g[d].c)}}}else{if(g.n){f.push(g.n)}if(g.c){f.push(g.c)}}}};WorkflowContext.prototype.resume=function(d){if(d){var b=this.execStks;if(d instanceof Array){b.push(d)}else{b.push([d])}}this.executeAll()};var INTERRUPTED_SE={i:1};var EXECUTED_STACK=[];var FIDMATCH=/^((.*)(:)\s*([0-9]+)\s*)$|^([0-9]+)$/;function WorkflowContext_StatusFIDToLabel(b,h){if(h!=null&&h!="undefined"&&typeof h!="string"){h=h.toString()}var f=h.match(FIDMATCH);if(f!=null&&((f[4]!=""&&f[4]!=null)||(f[5]!=""&&f[5]!=null))){var g=(f[4]==""||f[4]==null)?parseInt(f[5]):parseInt(f[4]);var d=F(b,g).GLabel();if(d==null||d==" "||d==""){d=F(b,g).GName()}if(d!=null&&d!=""){h=(f[2]==null?"":f[2])+(f[3]==null?"":f[3])+" "+d}}return h}function WorkflowContext_GenerateHttpError(d){var b="HTTP "+getLocalizedMessage("Communication Error",null)+" : "+d;return b}function WorkflowContext_StatusToString(windowID,arr){var AR_WARN_NO_READ_ACCESS=60;var ntypes={1:"ARWARN",0:"ARNOTE",2:"ARERR",3:"ARERR"};var out=[];for(var i=0;i<arr.length;++i){with(arr[i]){if(n==0){continue}var http_error="";if(n==9351&&m!=null&&m!=""&&typeof m=="string"&&m.substring(0,4)=="HTTP"){http_error=m;m=null}if(m!=null&&m!=""||a==null||ntypes[t]=="ARERR"||ntypes[t]=="ARWARN"){if(m==null||m==""){if(http_error!=""){m=getLocalizedMessage(n,null)+" "+http_error;http_error=""}else{m=getLocalizedMessage(n,null)}}if("cId" in arr[i]&&(t!=0)&&(n<9999)){out.push(WorkflowContext_StatusFIDToLabel(windowID,m))}else{if(m!=n){out.push(ExpandString(windowID,m,1|2|4))}}if(a){if(m!=n){out.push(" :\n")}if("cId" in arr[i]&&t!=0&&n<9999&&n!=AR_WARN_NO_READ_ACCESS){out.push(WorkflowContext_StatusFIDToLabel(windowID,a))}else{out.push(a)}}}else{out.push(a)}out.push(" (");out.push(ntypes[t]);out.push(" ");out.push(n);out.push(")");out.push("\n")}}return out.join("")}WorkflowContext.WindowOpened=function(b){if(getCurWFC_NS(b)){getCurWFC_NS(b).mOpenedWindow=true}};WorkflowContext.prototype.enterGuide=function(b){this.guideCtxt.push(b)};WorkflowContext.prototype.getGuideState=function(){var b=this.guideCtxt.length;if(b>0){return this.guideCtxt[b-1]}else{return null}};WorkflowContext.prototype.getGuideLevels=function(){var b=this.guideCtxt.length;if(b>0){return b}else{return null}};WorkflowContext.prototype.exitGuide=function(){this.guideCtxt.pop()};WorkflowContext.prototype.AddCallback=function(d,f,b){this.mCallbacks.push({t:d,func:f,args:b})};WorkflowContext.prototype.RunCallbacks=function(){while(this.mCallbacks.length>0){var b=this.mCallbacks.pop();b.func.apply(b.t,b.args?b.args:[])}};WorkflowContext.prototype.addDirtyElement=function(d,b){this.dirtyElements[d]=b};WorkflowContext.prototype.signalDOM=function(){for(var b in this.dirtyElements){if("onchange" in this.dirtyElements[b]){FormEvent.FireChangeEvent(this.dirtyElements[b])}}this.dirtyElements={}};WorkflowContext.prototype.executeAll=WorkflowContext.prototype.execute=function(v){setIsInInterruptMode_NS(this.windowID,0);var z=this.execStks;var w;var s;if(v){if(v instanceof Array){z.push(v)}else{z.push([v])}w=1}else{w=z.length}try{while(w>0){s=z[z.length-1];while(s.length>0){var v=s.pop();if(v.eonly){continue}var b;try{b=(v.a)?v.f.apply(v.t?v.t:null,v.a):((v.t)?v.f.apply(v.t,[]):v.f())}catch(f){while(true){if(v.e){var h=[f];if(v.ea){h=h.concat(v.ea)}try{b=(v.t)?v.e.apply(v.t,h):v.e.apply(null,h);if((f instanceof WorkflowException)&&f.hasMessages()){var k=f.getStatus();if(k[0].n==9201){while(s.length>0){s.pop()}v=null;while(w>0){z.pop();w--}}}break}catch(d){f=d}}do{if(s.length>0){v=s.pop()}else{v=null;z.pop();w--;if(w>0){s=z[z.length-1]}else{if(z.length>0){throw f}else{if(typeof f!="object"){LogAndAlert("Caught exception "+(f.fileName+":"+f.lineNumber+" - "+f.name+":\n\n"+f.message+"... AT:\n\n"+f.stack));return false}if(f instanceof WorkflowException){if(f!=""){if(this.notes.length>0){var b=WC_DisplayMessage(this.windowID,this.notes);this.notes=[];if(b&&b.i&&b.i==1){z.push([{f:WC_DisplayMessage,a:[this.windowID,f.getLStatus()]}]);z.push([{f:function(){}}]);return INTERRUPTED_SE}b=WC_DisplayMessage(this.windowID,f.getLStatus());if(b&&b.i&&b.i==1){z.push([{f:function(){}}]);return INTERRUPTED_SE}}else{var b=WC_DisplayMessage(this.windowID,f.getLStatus());if(b&&b.i&&b.i==1){z.push([{f:function(){}}]);return INTERRUPTED_SE}}}return false}else{LogAndAlert("Caught exception "+(f.fileName+":"+f.lineNumber+" - "+f.name+":\n\n"+f.message+"... AT:\n\n"+f.stack));return false}}}}}while(v==null)}}if(b){if(b.i){if(b.n){s.push(b.n)}else{if(s.length==0&&z.length>0&&z[z.length-1].length==0){z.pop();w--}}FlushLogBuffer();setIsInInterruptMode_NS(this.windowID,1);return INTERRUPTED_SE}else{if(b.isFromFunctionSplit){if(v.e){var y=(v.ea)?{eonly:1,e:v.e,ea:v.ea,t:v.t}:{eonly:1,e:v.e,t:v.t};s.push(y)}}if(b.n){if(b.n instanceof Array){for(var g in b.n){s.push(b.n[g])}}else{s.push(b.n)}}if(b.c){if(!b.isFromFunctionSplit){if(v.e){var y=(v.ea)?{eonly:1,e:v.e,ea:v.ea,t:v.t}:{eonly:1,e:v.e,t:v.t};s.push(y)}}s.push(b.c)}}}}z.pop();w--}return false}finally{if(z.length==0){if(this.notes.length>0){var b=WC_DisplayMessage(this.windowID,this.notes);this.notes=[];if(b&&b.i&&b.i==1){z.push([{f:function(){}}]);return INTERRUPTED_SE}}if(getWFThreadsList_NS(this.windowID).length==1){this.RunCallbacks()}if(FocusMgr==undefined){FocusMgr_Init()}FocusMgr.WorkflowComplete(this.windowID);this.enableWaitCursor=0;if(getWFThreadsList_NS(this.windowID).length>0&&getWFThreadsList_NS(this.windowID)[getWFThreadsList_NS(this.windowID).length-1].execStks.length==0){var o=getWFThreadsList_NS(this.windowID).pop();getWindowMgr_NS().popCurrentWindowID(this.windowID);if(getWFThreadsList_NS(this.windowID).length>0){setCurWFC_NS(this.windowID,getWFThreadsList_NS(this.windowID)[getWFThreadsList_NS(this.windowID).length-1])}else{TIMELINE.end("WORKFLOW"+this.wfowId,this.frmNm);setIsInInterruptMode_NS(this.windowID,0);setCurWFC_NS(this.windowID,null)}}else{TIMELINE.end("WORKFLOW"+this.wfowId,this.frmNm);setIsInInterruptMode_NS(this.windowID,0);setCurWFC_NS(this.windowID,null)}keyRefCnt--;if(keyRefCnt<=0){keyRefCnt=0;ARKWSetShifCtrlAltToRealtime()}if(isLogicalWindow(this.windowID)){var u=getLogicalWindow(this.windowID);if((u!=null)&&(u.getClearInlineFormFlag()==true)){u.Clear()}}}}};function WC_DisplayMessage(d,h){var b=[];var o=0;for(var g=0;g<h.length;++g){var f=promptBar.redirectAtRuntime(h[g].msgloc);if(f==0){var k=promptBar.buildMsgforPrompt(d,h[g].mstat);promptBar.showMessage(promptBar.ARTypetoPromptType(h[g].mstat.t),k);o++}else{b.push(h[g].mstat)}}if(o>0){promptBar.showAllMessages()}if(b.length>0&&!getCurWFC_NS(d).mMenuOpenning){return MessagePopup(d,b)}else{if(b.length>0&&getCurWFC_NS(d).mMenuOpenning){var s=false;for(var g=0;g<h.length;++g){if(b[g].t>1){s=true;break}}if(s){return MessagePopup(d,b)}}}return null}WorkflowContext.prototype.status=function(v,b){var d=false;if(arguments.length==2){d=true}else{b=null}var u=this.notes;if(v instanceof Array){var s=[];for(var f in v){var k=v[f];if(k.t==2||k.t==3){var h=promptBar.msgDestination(k.t,d,b);s.push({mstat:k,msgloc:h})}else{if(k.t==0&&k.n==8914){LogWriteServer(WorkflowContext_StatusToString(this.windowID,[k]))}else{var h=promptBar.msgDestination(k.t,d,b);var o={mstat:k,msgloc:h};u.push(o)}}}if(s.length){if(this.guideCtxt.length>0){throw new WorkflowException(this.windowID,5,s)}else{throw new WorkflowException(this.windowID,0,s)}}}else{var g={n:v,t:2,m:null,a:null};var h=promptBar.msgDestination(2,d,b);throw new WorkflowException(this.windowID,0,[{mstat:g,msgloc:h}])}};var FocusMgr;function FocusMgr_Init(){FocusMgr=new function(){this.mCurFocusID=0;this.mCurFocusWindowID=0;this.mNextFocusID=0;this.mCurFocusElement=null;this.mOpenedWindow=false;this.mFocusStk=[];this.HandleFocusEvt=function(g,h){if(this.mFocusStk.length>0){return}var s=h.element.getAttribute("artabid");if(!s&&h.element.parentNode.parentNode&&h.element.parentNode.parentNode.getAttribute("artabid")){s=h.element.parentNode.parentNode.getAttribute("artabid")}if(!s&&h.element.parentNode&&h.element.parentNode.getAttribute("artabid")){s=h.element.parentNode.getAttribute("artabid")}var o=(s)?getFields_NS(g)[s]:Field_FromElement(h.element);if(o&&!o.mQWidget){var b=o.GetFocusElementForEvent(h);if(b!=null){var d=o.mID;if(o instanceof DTable){var k=o.getChildField(h.element);if(k!=null){d=k}}this.mUIFocusElement=h.element;return{c:{t:this,f:this.changeFocusTo,a:[o.windowID,d,h,b]}}}else{this.mForceFocusToCurrent=true}}};this.changeFocusTo=function(g,s,v,h){var f=true;if(g==this.mCurFocusWindowID&&s==this.mCurFocusID){if((s in getFields_NS(g))&&getFields_NS(g)[s].isRTF&&getFields_NS(g)[s].isRTF()){f=true}else{f=false}}if(f){var y=this.mFocusStk.length;if(y==0){this.mFocusStk.push({ty:2});this.mWFC=getCurWFC_NS(g)}var w=null;var d=null;var u=F(g,s);if(u instanceof JColumn){w=u.mObj.pnt}if(this.mCurFocusID!=0&&getFormContext(this.mCurFocusWindowID)){var k=F(this.mCurFocusWindowID,this.mCurFocusID);if(k instanceof JColumn){d=k.mObj.pnt}}if(s!=d||this.mCurFocusWindowID!=g){this.mFocusStk.push({id:s,ed:v,fe:h,ty:1,wID:g})}else{this.mNextFocusID=d;this.mUIFocusElement=v.element}if(w!=null){var o=null;if(this.mCurFocusID!=0&&getFormContext(this.mCurFocusWindowID)){var b=F(this.mCurFocusWindowID,this.mCurFocusID);if(b instanceof JColumn){o=b.mObj.pnt}}if((w!=o&&w!=this.mCurFocusID)||this.mCurFocusWindowID!=g){this.mFocusStk.push({id:w,ed:v,fe:h,ty:1,wID:g})}}if(this.mCurFocusID!=0&&getFormContext(this.mCurFocusWindowID)){if(d!=null){if((w!=d&&d!=s)||this.mCurFocusWindowID!=g){this.mFocusStk.push({id:d,ed:new FormEvent(this.mCurFocusWindowID,d),ty:0,wID:this.mCurFocusWindowID})}}if(w!=this.mCurFocusID||this.mCurFocusWindowID!=g){this.mFocusStk.push({id:this.mCurFocusID,ed:new FormEvent(this.mCurFocusWindowID,this.mCurFocusID),ty:0,wID:this.mCurFocusWindowID})}}return{n:{t:this,f:this.transitionFocus,a:[g,y]}}}else{if(v){if((!this.mUIFocusElement)||this.mCurFocusElement!=v.element){this.mCurFocusElement=h;this.mForceFocusToCurrent=(!this.mUIFocusElement)||(h!=v.element)||((s in getFields_NS(g))&&getFields_NS(g)[s].mPaneltemplate!=null)}}}};this.transitionFocus=function(g,b){while(this.mFocusStk.length>b){var d=this.mFocusStk.pop();if(d.ty==2){if(this.mNextFocusID>0){this.mCurFocusID=this.mNextFocusID;this.mCurFocusElement=this.mUIFocusElement;this.mNextFocusID=0}return}else{var o=getFields_NS(d.wID)[d.id];var u;var k=this.mCurFocusID;var v=this.mCurFocusWindowID;var y=this.mCurFocusElement;switch(d.ty){case 0:u=o.DOMBlur;break;case 1:this.mCurFocusID=d.id;this.mCurFocusWindowID=g;if(this.mCurFocusID<=0){this.mCurFocusElement=null;continue}this.mCurFocusElement=d.fe;var w=getFormContext(v);var h=null;if(!(w==null||w=="undefined")){h=getFields_NS(v)[k]}if(h&&h.isRTF&&h.isRTF()){if(h.mID==d.id){continue}u=function(f){if(f&&f.element&&f.element.focus){f.element.focus()}return o.DOMFocus(f)}}else{u=o.DOMFocus}break;default:}promptBar.setToClear();var s=getCurWFC_NS(g).execute({t:o,f:u,a:[d.ed],e:this.ftExceptionHandler,ea:[v,k,y]});if(s){return{i:1,n:{t:this,f:this.transitionFocus,a:[g,b]}}}}}};this.TryFocus=function(b,d){try{if(("focus" in d)&&!d.disabled&&d.parentNode&&((this.mCurFocusID in getFields_NS(b))&&getFields_NS(b)[this.mCurFocusID].GetNestedFocusability())){d.focus();return true}}catch(f){}return false};this.reallySetFocus=function(b){var d=this.mCurFocusElement;if(!this.mOpenedWindow&&(this.mFocusStk.length==0)){this.mForceFocusToCurrent=false;if(this.TryFocus(b,d)){return}if(this.mCurFocusID){this.mCurFocusElement=getFields_NS(this.mCurFocusWindowID)[this.mCurFocusID].GetFocusElement();if(this.TryFocus(this.mCurFocusWindowID,this.mCurFocusElement)){return}}this.TryFocus(b,this.mCurFocusElement=document.body)}};this.getFocusedID=function(){return this.mCurFocusID};this.resetFocus=function(b){if(!b){return}this.resettheFocus()};this.resettheFocus=function(){this.mresetEle=this.mCurFocusElement;this.mresetFid=this.mCurFocusID;this.mresetWid=this.mCurFocusWindowID;setTimeout(function(){if(typeof FocusMgr.mresetEle!="undefined"){FocusMgr.TryFocus(FocusMgr.mresetWid,FocusMgr.mresetEle);if(typeof this.mresetFid!="undefined"){getFields_NS(FocusMgr.mresetWid)[FocusMgr.mresetFid].resetFocusTab(FocusMgr.mresetEle)}}delete FocusMgr.mresetEle;delete FocusMgr.mresetFid;delete FocusMgr.mresetWid},0)};this.ftExceptionHandler=function(f,d,g,b){if(FocusMgr.mFocusStk.length>0){FocusMgr.mFocusStk=[];FocusMgr.mCurFocusID=g;FocusMgr.mCurFocusElement=b;FocusMgr.mCurFocusWindowID=d;FocusMgr.mUIFocusElement=null;FocusMgr.mForceFocusToCurrent=true}throw f};this.SetFocusToField=function(g,d){if(!(d in getFields_NS(g))){return}var s=getFields_NS(g)[d];if(!s.GetNestedFocusability()){return}try{if("external" in top&&top.external.SetResult!=undefined){top.focus();window.focus()}}catch(o){}var u=s.GetParent();while(u){if(u instanceof DPage){u.SelectPageDueToFocusInChildField()}u=u.GetParent()}var b=new FormEvent(g,d);var h=this.mFocusStk.length;if(h>0){var k=this.mFocusStk[h-1];if(k.ty==1){this.mFocusStk.pop();this.mFocusStk.push({ty:1,id:d,ed:b,fe:b.element,wID:g});return{n:{t:this,f:this.transitionFocus,a:[g,h-1]}}}else{return{n:{t:this,f:this.changeFocusTo,a:[g,d,b,b.element]}}}}else{this.mUIFocusElement=null;if(s instanceof JColumn&&F(g,s.mObj.pnt).mAsyncDirty==3){this.mForceFocusToCurrent=true}return{n:{t:this,f:this.changeFocusTo,a:[g,d,b,b.element]}}}};this.WorkflowComplete=function(b){var d=getCurWFC_NS(b);if(d!=null&&d==this.mWFC){if(this.mFocusStk.length>0){this.mFocusStk=[]}this.mWFC=null;if(this.mCurFocusID!=0&&this.mCurFocusElement!=this.mUIFocusElement){this.mForceFocusToCurrent=true}this.mUIFocusElement=null}if(d!=null&&d.mOpenedWindow){this.mOpenedWindow=true}if(!this.mOpenedWindow&&this.mForceFocusToCurrent){if(this.mTimeoutID==null){this.mTimeoutID=setTimeout(function(){FocusMgr.mTimeoutID=null;if(getFormContext(b)){FocusMgr.reallySetFocus(b)}},0)}}};this.WindowGotFocus=function(b){this.mOpenedWindow=false;if(this.mForceFocusToCurrent){this.reallySetFocus(b)}};this.SetFocusBacktoWindow=function(){setTimeout(function(){FocusMgr.WindowGotFocus(FocusMgr.mCurFocusWindowID)},0)};this.SetFocusToFirst=function(b){var d=getFieldListInfo_NS(b);this.setFocusToTabElementFromCur(d.firstField.mObj,true)};this.SetFocusToLast=function(b){var d=getFieldListInfo_NS(b);this.setFocusToTabElementFromCur(d.lastField.mObj,false)};this.SetFocusToNext=function(b){return this.setFocusToTabElement(b,true)};this.SetFocusToPrevious=function(b){return this.setFocusToTabElement(b,false)};this.setFocusToTabElement=function(b,d){this.setFocusToTabElementFromCur(b.element,d)};this.setFocusToTabElementFromCur=function(h,g){var f=Window_FromElement(h);var u=Field_FromElement(h);var k;var s;var o;if(g){o=this.getNextFieldOrTBEle;s=this.getNextFieldElement;k=this.getFirstFieldElement}else{o=this.getPrevFieldOrTBEle;s=this.getPrevFieldElement;k=this.getLastFieldElement}var w=null;if(u!=null){if(u instanceof DView&&u.mQWidget!=null){if(g){if(!h.firstElementChild||h.firstElementChild.className!="queryDelBtn"||h.parentNode.parentNode.className.indexOf("queryRowLast")==-1){return false}}else{if(h.parentNode&&h.parentNode.parentNode.className=="queryAndOr"){w=null}else{return false}}}else{w=s.call(this,u,h);if(w&&u instanceof DTable){var b=u.getChildField(w);if(b!=null){u=F(f,b)}}}h=u.mObj}else{if(h==document.body&&this.mCurFocusID>0){var y=getFields_NS(this.mCurFocusWindowID);h=y[this.mCurFocusID].mObj;if(y[this.mCurFocusID].mPaneltemplate!=null){w=s.call(this,y[this.mCurFocusID],this.mCurFocusElement)}}}while(w==null){var v=o.call(this,h,f);if(v instanceof Field){u=v;w=k.call(this,u);h=u.mObj}else{w=v;break}}if(w){if(u){var d=new FormEvent(u.windowID,u.mID);d.element=w;new WorkflowContext(u.windowID,{t:this,f:this.changeFocusTo,a:[u.windowID,u.mID,d,w]});return true}else{setTimeout(function(){w.focus()},0)}}new WorkflowContext(f,{t:this,f:this.changeFocusTo,a:[f,0,null,null]});return false};this.getNextFieldOrTBEle=function(b){return this.nextElementWalker(b,document.body,this,this.fieldOrTBSelector)};this.getPrevFieldOrTBEle=function(d,b){return this.prevElementWalker(d,this.getStopAtElement(b),this,this.fieldOrTBSelector)};this.getNextFieldElement=function(d,b){return this.nextElementWalker(b,d.mObj,d,d.TabableElementSelector)};this.getPrevFieldElement=function(d,b){return this.prevElementWalker(b,d.mObj,d,d.TabableElementSelector)};this.getFirstFieldElement=function(d){var b=d.TabableElementSelector(d.mObj);if(b==null){b=this.nextElementWalker(d.mObj,d.mObj,d,d.TabableElementSelector)}return b};this.getLastFieldElement=function(f){var d=f.GetLastElement();if(d==null){return}if(d.nodeType==1){var b=f.TabableElementSelector(d);if(b){return b}}return this.prevElementWalker(d,f.mObj,f,f.TabableElementSelector)};this.nextElementWalker=function(g,f,h,d){var o=g;while(true){var k;if(o.firstChild&&(!o.style||(o.style.visibility!="hidden"&&o.style.display!="none"))&&!$(o).is(".rtf_text")&&!$(o).is(".rtf")){o=o.firstChild}else{if(o==f){return null}while(!o.nextSibling){o=o.parentNode;if(o==f||o==null){return null}}o=o.nextSibling}if(o.nodeType==1){var b;if((b=d.call(h,o))!=null){return b}}}};this.prevElementWalker=function(g,f,h,d){var o=g;if(g==document.body){if(parent!=null&&"ARProcessEvent" in parent&&parent.name!=window.name){return null}while(o.lastChild&&(!o.style||(o.style.visibility!="hidden"&&o.style.display!="none"))){o=o.lastChild}if(o.nodeType==1){var b;if((b=d.call(h,o))!=null){return b}}}while(o!=f){var k;if(o.previousSibling){o=o.previousSibling;while(o.lastChild&&(!o.style||(o.style.visibility!="hidden"&&o.style.display!="none"))&&!$(o).is(".rtf_text")&&!$(o).is(".rtf")){o=o.lastChild}}else{o=o.parentNode}if(o==f&&f.childNodes&&f.childNodes[0].id=="FormApp"){return null}if(o.nodeType==1){var b;if((b=d.call(h,o))!=null){return b}}}return null};this.fieldOrTBSelector=function(g){var b;if((b=g.getAttribute("arid"))!=null&&g.style.display!="none"&&g.style.visibility!="hidden"){var d=g.getAttribute("arwindowid");var f=getFields_NS(parseInt(d))[parseInt(b)];if(f&&f.GetNestedFocusability()){return f}}if(g.tagName=="A"&&g.className&&(g.className.indexOf("tbbtn")!=-1||g.className.indexOf("TBTopBarBox")!=-1)){return FakeButton_TabableElementSelector(g)}return null};this.getStopAtElement=function(d){if(d==0){return document.body}var f=wm.getParentWindowID(d);var b=getViewFields_NS(f);for(var g in b){if(b[g]!=null&&b[g].isInlineForm()&&b[g].mChildWindowID!=null&&b[g].mChildWindowID==d){return b[g].mObj}}return document.body}}()}function arJumpOutForward(){if(FocusMgr.mCurFocusID!=0){var b=new FormEvent(FocusMgr.mCurFocusWindowID,FocusMgr.mCurFocusID);FocusMgr.SetFocusToNext(b)}}function arJumpOutBackward(){if(FocusMgr.mCurFocusID!=0){var b=new FormEvent(FocusMgr.mCurFocusWindowID,FocusMgr.mCurFocusID);b.shift=true;FocusMgr.SetFocusToPrevious(b)}}function Arithmetic(h,f,d,g){if(g){if(!(g in DatatypeFactories)){return Null}if(f.isNull&&d.isNull){return Null}return(DatatypeFactories[g]())[h](f,d)}else{if(f instanceof Datatype&&d instanceof Datatype){if(f.isNull&&d.isNull){return Null}if(h=="DIV"&&f.type==2&&d.type==2){g=3}else{if(h=="SUB"&&f.type==d.type&&(((1<<7|1<<13|1<<14)&(1<<f.type))|(1<<13&(1<<f.type))|(1<<14&(1<<f.type)))){g=2}else{g=f.isNull?d.type:f.type}}return(DatatypeFactories[g]())[h](f,d)}else{if(f instanceof Datatype&&d==null){g=f.type;return(DatatypeFactories[g]())[h](f)}}}}function Relational(h,f,d,g){if(g){if(!(g in DatatypeFactories)){return false}return(DatatypeFactories[g]())[h](f,d)}else{if(f instanceof Datatype){return f[h](d)}}}function EQ(f,d,g){return Relational("EQ",f,d,g)}function NE(f,d,g){return Relational("NE",f,d,g)}function LT(f,d,g){return Relational("LT",f,d,g)}function LE(f,d,g){return Relational("LE",f,d,g)}function GT(f,d,g){return Relational("GT",f,d,g)}function GE(f,d,g){return Relational("GE",f,d,g)}function LIKE(f,d,g){return Relational("LIKE",f,d,g)}function ADD(f,d,g){return Arithmetic("ADD",f,d,g)}function SUB(f,d,g){return Arithmetic("SUB",f,d,g)}function MUL(f,d,g){return Arithmetic("MUL",f,d,g)}function DIV(f,d,g){return Arithmetic("DIV",f,d,g)}function MOD(f,d,g){return Arithmetic("MOD",f,d,g)}function NEG(b,d){return Arithmetic("NEG",b,null,d)}function HoverState(){this.MOFFSETX=10;this.MOFFSETY=10;this.FOCUSNONE=0;this.GAIN=1;this.LOSE=2;this.MOUSEDWNFLD=1;this.MOUSEUPFLD=2;this.MOUSENONEFLD=0;this.init();this.mHoverWait=this.getHoverWait();this.mFocusEvent=this.FOCUSNONE;this.mMouseFld=this.MOUSENONEFLD;this.mfocusByKey=false;this.mXQTHoverEvent=false;this.mButtonEvent=null}HoverState.prototype.init=function(){this.mTracking=false;this.mTrackEvent=null;this.mTrackfID=0;this.mTimer=null;this.mIgnoreEvent=false;this.mButtonEvent=null};HoverState.prototype.getHoverWait=function(){var b=ARPrefsGetAsNumber(28514);if((isNaN(b)||b<=0)&&hoverWaitTime!=null){b=hoverWaitTime}return b};HoverState.prototype.reset=function(){this.init()};HoverState.prototype.fieldFromElement=function(h){var k=h.getAttribute("artabid");var b;if(k==null){var d=h;var f=(h.className.indexOf("btn")!=-1)?true:false;if(f){d=h.parentNode}if(d!=null){var g=(d.className.indexOf("Tab")!=-1)?true:false;if(g){k=d.getAttribute("artabid");if(k==null){d=d.parentNode;if(d!=null){k=d.getAttribute("artabid");if(k!=null){b=d.getAttribute("arwindowid");return getFields_NS(b)[k]}}}else{b=d.getAttribute("arwindowid");return getFields_NS(b)[k]}}}}else{b=d.getAttribute("arwindowid");return getFields_NS(b)[k]}return Field_FromElement(h)};HoverState.prototype.fieldDisabled=function(b){if(b.GAccess()==3){return true}else{return false}};HoverState.prototype.checkLocation=function(){if(this.mTimer!=null){this.mTimer=null;this.mIgnoreEvent=true;this.triggerEvent(this.mTrackEvent)}else{this.reset()}};HoverState.prototype.startTimer=function(d,b){this.mTrackfID=d.mID;this.mTracking=true;this.mTrackEvent=b;this.mTimer=window.setTimeout("hoverState.checkLocation()",this.mHoverWait)};HoverState.prototype.clearTracking=function(){if(this.mTimer){window.clearTimeout(this.mTimer);this.mTimer=null}this.reset()};HoverState.prototype.eventMouseOver=function(b){if(this.mIgnoreEvent){return}var d=this.fieldFromElement(b.element);if(this.fieldDisabled(d)){return}if(this.mTracking==true){if(this.mTrackfID!=d.mID){this.clearTracking();this.startTimer(d,b)}else{if(b.mMouseX==this.mTrackEvent.mMouseX&&b.mMouseY==this.mTrackEvent.mMouseY){this.mTrackEvent=b}else{this.clearTracking();this.startTimer(d,b)}}}else{this.startTimer(d,b)}return true};HoverState.prototype.eventMouseMove=function(b){if(this.mIgnoreEvent){return}var d=this.fieldFromElement(b.element);if(this.mTracking==true){if(this.mTrackfID!=d.mID){this.clearTracking()}else{this.mTrackEvent=b}}return true};HoverState.prototype.eventMouseOut=function(b){if(this.mIgnoreEvent){return}this.clearTracking()};HoverState.prototype.triggerEvent=function(v){var k=this.fieldFromElement(v.element);if(k==null){return}var b=null;var s=new Array();var o=false;if(k.hasChildFields()){if(k instanceof DTable&&k.isCustomResultsList()){return}if(!(k instanceof DTreeView)){var g=k.getChildField(v.element);if(g!=null){b=getFields_NS(k.windowID)[g];s.push({e:16777216,f:g,w:k.windowID})}if(k.inDataArea){var h=k.inDataArea(v);var d=(h)?8388608:4194304;s.push({e:d,f:k.mID,w:k.windowID})}s.push({e:16777216,f:k.mID,w:k.windowID})}else{s.push({e:16777216,f:k.mID,w:k.windowID})}}else{o=(k.LocInLabel)?k.LocInLabel(v):false;var u=(o)?4194304:8388608;s.push({e:u,f:k.mID,w:k.windowID});s.push({e:16777216,f:k.mID,w:k.windowID})}this.executeEvent(s)};HoverState.prototype.executeEvent=function(h){var d=null;var b=-1;for(var g=0;g<h.length;g++){b=g;d=AREventFunction(h[g].w,h[g].e,h[g].f);if(d!=null){break}}if(d){var k=getFields_NS(h[b].w)[h[b].f];this.mXQTHoverEvent=true;promptBar.setToClear();new WorkflowContext(h[b].w,{f:executeHover,a:[h[b].w,h[b].e,h[b].f]})}else{this.reset()}};HoverState.prototype.getWindowDims=function(){var o=document.body.scrollTop;var f=document.body.scrollLeft;var k=window.innerHeight+o;var b=window.innerWidth+f;var g=k-o;var d=b-f;var h="getWindowDims(t,l b,r h,w)=("+o+","+f+" "+k+","+b+" "+g+","+d;return{top:o,left:f,bottom:k,right:b,w:d,h:g}};HoverState.prototype.SetTipPos=function(b,d){b.style.left=d.x+"px";b.style.top=d.y+"px"};HoverState.prototype.GetTipSize=function(d){var b=new Object();b.x=d.clientWidth;b.y=d.clientHeight;return b};HoverState.prototype.AdjustTipRTL=function(b,g){var f=g.x-b.x;var d=g.y-b.y;f=Math.max(0,f);d=Math.max(0,d);return{x:f,y:d}};HoverState.prototype.calcPos=function(f,D,C,k,g){var y={x:D.x,y:D.y};this.SetTipPos(f,y);var u=this.GetTipSize(f);if(u!=null){var s=g.right;var h=g.bottom;var B=null;var A=null;var d=y.x+u.x;var z=y.y+u.y;if(d>=s){var v=(C!=null)?C.x:y.x;v+=2;B=v-u.x;if(B<0){B=0}}else{if(k){y.x-=this.MOFFSETX}}if(z>=h){var o=(C!=null)?C.y:y.y;o+=2;A=o-u.y;if(A<0){A=0}}else{if(k){y.y-=this.MOFFSETY}}var b=false;if(B!=null){y.x=B;b=true}if(A!=null){y.y=A;b=true}}y.x=Math.max(0,y.x);y.y=Math.max(0,y.y);if(b&&C!=null){this.SetTipPos(f,y);var w=this.GetTipSize(f);if(C.x>=y.x&&C.x<=y.x+w.x){}else{var v=C.x+2;y.x=v-w.x}if(C.y>=y.y&&C.y<=y.y+w.y){}else{var o=C.y+2;y.y=o-w.y}}return{x:y.x,y:y.y}};HoverState.prototype.getTipLocation=function(b,g){winDim=this.getWindowDims();var v=new Object();var s=true;if(this.mXQTHoverEvent){v.x=this.mTrackEvent.mMouseX-document.body.scrollLeft;v.y=this.mTrackEvent.mMouseY-document.body.scrollTop}else{if(this.mButtonEvent){if(this.buttonActivatedByKey()){v=ComputeElementPosition(this.mButtonEvent.element,document.body,0,0);var d=this.mButtonEvent.element;var f=d.style.width;var y=d.style.height;var w=-1;w=f.indexOf("px");if(w!=-1){f=f.substring(0,w)}w=y.indexOf("px");if(w!=-1){y=y.substring(0,w)}f=parseInt(f);y=parseInt(y);v.x+=f/2;v.y+=y/2;s=false}else{v.x=this.mButtonEvent.mMouseX-document.body.scrollLeft;v.y=this.mButtonEvent.mMouseY-document.body.scrollTop}}else{s=false;var k,h;k=window.innerWidth/2;h=window.innerHeight/2;var u=this.GetTipSize(b);if(u){k-=(u.x/2);h-=(u.y/2);if(k<0){k=0}if(h<0){h=0}k=Math.floor(k);h=Math.floor(h)}v.x=k;v.y=h}}var z={x:v.x,y:v.y};var o=new Object();o=this.calcPos(b,v,(s)?z:null,g,winDim);v=o;u=this.GetTipSize(b);return{pos:{x:v.x,y:v.y},tipDims:{w:u.x,h:u.y}}};HoverState.prototype.btnClickS=function(b){this.mButtonEvent=b};HoverState.prototype.btnClickE=function(){this.mButtonEvent=null;this.reset()};HoverState.prototype.afterXQTEvt=function(b){this.mXQTHoverEvent=false;this.reset()};HoverState.prototype.inEvtHover=function(){return this.mXQTHoverEvent};HoverState.prototype.inButtonClick=function(){return this.mButtonEvent!=null};HoverState.prototype.buttonActivatedByKey=function(){if(this.mButtonEvent==null){return null}if(this.mButtonEvent.key==32||this.mButtonEvent.key==13){return true}else{return false}};HoverState.prototype.getHoverField=function(){if(this.mTrackEvent&&this.mXQTHoverEvent){return this.fieldFromElement(this.mTrackEvent.element)}else{return null}};HoverState.prototype.getClickField=function(){if(this.inButtonClick){return this.fieldFromElement(this.mButtonEvent.element)}else{return null}};HoverState.prototype.wfMouseDown=function(){this.mMouseFld=this.MOUSEDWNFLD};HoverState.prototype.wfMouseUp=function(){if(toolTip.isDisplayed()){this.mMouseFld=this.MOUSEUPFLD}else{this.mMouseFld=this.MOUSENONEFLD}};HoverState.prototype.wfTabStart=function(){this.mfocusByKey=true};HoverState.prototype.wfTabEnd=function(){this.mfocusByKey=false};HoverState.prototype.focusEvent=function(b){this.mFocusEvent=b};HoverState.prototype.clearFocusEvent=function(b){var d=(this.mFocusEvent==this.GAIN)?true:false;this.mFocusEvent=this.FOCUSNONE;if(d){return{c:{t:FocusMgr,f:FocusMgr.resetFocus,a:[this.mfocusByKey]}}}};HoverState.prototype.getFocusEvent=function(){return this.mFocusEvent};HoverState.prototype.clickClosedTT=function(){if(this.mFocusEvent==this.FOCUSNONE){return true}if(this.mMouseFld==this.MOUSEUPFLD){this.mMouseFld=this.MOUSENONEFLD;return false}else{return true}};HoverState.prototype.trackingMouse=function(){return this.mTracking};HoverState.prototype.hasMouseTrackEvent=function(){return this.mTrackEvent!=null};HoverState.prototype.getHoverFID=function(b,g){if(this.mTracking==true){if(g==this.mTrackfID){return g}var d=getFields_NS(b)[this.mTrackfID];if(d.hasChildFields()||d.mObj.getAttribute("artype")=="TreeView"){var f=d.isChild(g);return(f)?g:-1}return -1}else{return -1}};HoverState.prototype.getHoverValue=function(b,f){if(this.mTracking==true){var d=getFields_NS(b)[f];if(d!=null){return d.GetHoverValue(this.mTrackEvent)}}return""};HoverState.prototype.hoverByKey=function(b){return true};HoverState.prototype.alExecuteHover=function(b,d,f){this.mXQTHoverEvent=false;this.mButtonEvent=false;return executeHover(b,d,f)};HoverState.prototype.StrExecHover=function(b){return null};var hoverState=null;function executeHover(b,d,f){return{c:{f:ExecuteWorkflow,a:[b,d,f]},n:{f:function(){hoverState.afterXQTEvt(f)}}}}function alExecuteHover(b,d,f){return hoverState.alExecuteHover(b,d,f)}function ToolTip(){this.mTT=document.getElementById("artooltip");this.mDView=new DocView(this.mTT,null,null,true);if(arguments.length){this.init()}}ToolTip.prototype.init=function(){this.mTipDisplayed=false};ToolTip.prototype.reset=function(){this.init();this.mTT.onmouseout=null;this.mTT.style.visibility="hidden";this.mTT.style.top="0px";this.mTT.style.left="0px";this.mTT.innerHTML=null;this.mTT.blur()};ToolTip.prototype.setTipDisplayed=function(d){this.mTipDisplayed=true;if("external" in top){try{top.external.ShowToolTip(d)}catch(b){}}};ToolTip.BackgroundURL="resources/swf/background.swf?a=0.9&c=ececec&b=014c8d&t=1&";ToolTip.small="r=3,3,3,3";ToolTip.big="r=8,8,8,8";ToolTip.prototype.showToolTip=function(b,d){if(d.length==0){return}var g=false;this.mDView.S(d,g);this.mTT.className=(d.match(DocView.HTMLDOCPAT))?"divToolTipHtml":"divToolTip";var o=hoverState.inEvtHover();var u=hoverState.inButtonClick();if(o&&!hoverState.hasMouseTrackEvent()){hoverState.reset();return null}var s=false;if(o){s=true}if(u&&hoverState.buttonActivatedByKey()==false){s=true}if(o){var k=hoverState.getHoverField();if(k){window.setTimeout("toolTip.chgCursor('default')",100)}}this.setTipDisplayed(d);var h=this.mTT;window.setTimeout(function(){if((typeof h!="undefined")&&(h.innerHTML==null||h.innerHTML=="null")){return}var f=hoverState.getTipLocation(h,s);var y=f.pos;var v=f.tipDims;h.style.left=y.x+"px";h.style.top=y.y+"px";h.style.overflow="visible";h.style.visibility="visible";h.style.zIndex=nextZIndex++;try{toolTip.mTT.tabIndex="-1";toolTip.mTT.focus()}catch(w){}},5);if(o){this.mTT.onmouseout=ToolTipMouseClose}return{i:1}};ToolTip.prototype.chgCursor=function(b){var d=hoverState.getHoverField();if(d){d.mObj.style.cursor=b}};ToolTip.prototype.EvtInside=function(f){var o=f.mMouseX;var k=f.mMouseY;var h=this.mTT.style.left;var d=this.mTT.style.top;var b=-1;b=h.indexOf("px");if(b!=-1){h=h.substring(0,b)}b=d.indexOf("px");if(b!=-1){d=d.substring(0,b)}h=parseInt(h);d=parseInt(d);var g=h+this.mTT.clientWidth;var s=d+this.mTT.clientHeight;if(o>(h+1)&&o<=g&&k>(d+1)&&k<=s){return true}else{return false}};ToolTip.prototype.NotifyClick=function(b){if(this.EvtInside(b)){return 3}var f=false;if(!hoverState.inEvtHover()){f=hoverState.clickClosedTT()}if(f){ToolTipClose();var d=0;if(FakeButton_Find(b.element)!=null){d=1}return d}return 3};ToolTip.prototype.EscapeTooltip=function(){if(!this.mTipDisplayed){return true}gTTEscScrollposX=getFormElements_NS(0)["FormContainer"].scrollLeft;gTTEscScrollposY=getFormElements_NS(0)["FormContainer"].scrollTop;FocusMgr.resettheFocus();ToolTipClose();return false};ToolTip.prototype.isDisplayed=function(){return this.mTipDisplayed};var toolTip=null;function ToolTipMouseClose(d){var b=new FormEvent(d);if(!toolTip.EvtInside(b)){b.PDStopBubbling();FocusMgr.resettheFocus();ToolTipClose()}}function ToolTipClose(){toolTip.reset();if(getCurWFC_NS(getCurrentWindowID_NS())){getCurWFC_NS(getCurrentWindowID_NS()).resume()}}function TTNotifyClick(b){return toolTip.NotifyClick(b)}function EscapeTooltip(){return toolTip.EscapeTooltip()}function TTisDisplayed(){return toolTip.isDisplayed()}function TTCloseByClick(){if(toolTip.isDisplayed()){if(hoverState.inEvtHover()){return false}else{return true}}return false}function Field_Level_ShowToolTip(b){var d=FindHelpText_FromElement(b.element);if(d!=""&&d!=null){Field_Level_ShowToolTip_Inner(d,b.mMouseX,b.mMouseY);return false}else{Field_Level_HideToolTip()}return true}function Field_Level_HideToolTip(){document.getElementById("bubble_tooltip").style.display="none"}function Field_Level_SetHelpMarker(b){document.getElementsByTagName("body")[0].style.cursor="help";$("div[arhelp]").css({"border-style":"solid"});$("div[arhelp]").css({"border-color":b});$("div[arhelp]").css({"border-radius":"25px"});$("div[arhelp]").css({"border-width":"thick"});$("a[arhelp]").css({"border-style":"solid"});$("a[arhelp]").css({"border-color":b});$("a[arhelp]").css({"border-radius":"25px"});$("a[arhelp]").css({"border-width":"thick"});var f=getLocalizedMessage("Click on highlighted field to display its help text. Toggle mode off by clicking on Help.");Field_Level_ShowToolTip_Inner(f,760,160);var d=document.getElementById("bubble_tooltip_bottom");d.className="bubble_bottom_ori"}function Field_Level_UnsetHelpMarker(){document.getElementsByTagName("body")[0].style.cursor="";$("div[arhelp]").css({"border-style":""});$("div[arhelp]").css({"border-color":""});$("div[arhelp]").css({"border-radius":""});$("div[arhelp]").css({"border-width":""});$("a[arhelp]").css({"border-style":""});$("a[arhelp]").css({"border-color":""});$("a[arhelp]").css({"border-radius":""});$("a[arhelp]").css({"border-width":""});Field_Level_HideToolTip()}function Field_Level_ShowToolTip_Inner(s,o,h){if(s!=""&&s!=null){var g=document.getElementById("bubble_tooltip");var f=document.getElementById("bubble_tooltip_content");f.innerHTML="<font color='#0000FF'>"+s+"</font>";g.style.display="block";var b=Math.max(document.body.scrollTop,document.documentElement.scrollTop);if(navigator.userAgent.toLowerCase().indexOf("safari")>=0){b=0}g.style.left=o+"px";var k=h-g.offsetHeight+2+b;if(k<0){k=0}g.style.top=k+"px";var d=document.getElementById("bubble_tooltip_bottom");d.className="bubble_bottom"}}function FindHelpText_FromElement(d){var b=document.body;while(d&&d!=b){if(d.nodeType==1){if(d.getAttribute("arstop")=="1"){return null}var f=d.getAttribute("arhelp");if(f&&f!=""){return f}}d=d.parentNode}return null}Datatype.prototype.constructor=Datatype;var DatatypeFactories={};function Datatype(){}Datatype.prototype.init=function(){};Datatype.prototype.type=0;Datatype.prototype.args=function(){return{}};Datatype.prototype.SerializeAsString=function(){var f="{t:"+this.type+',v:"'+this.toPrimitive().JScriptEncode()+'"';if("args" in this){var b=this.args();var d=[];for(i in b){d.push(i+":"+b[i])}f+=",a:{"+d.join(",")+"}"}f+="}";return f};Datatype.prototype.isNull=true;Datatype.prototype.toInteger=function(){var b=new IntegerType(this.toString());return b.toInteger()};Datatype.prototype.toReal=function(){var b=new RealType(LCRealToEn_US(this.toString(),false));return b.toReal()};Datatype.prototype.toDecimal=function(){var b=new DecimalType(LCDecimalToEn_US(this.toString(),false));return b.toDecimal()};Datatype.prototype.toCurrency=function(b){return new CurrencyType(this.toDecimal(),b)};Datatype.prototype.toChar=function(){return this.toString()};Datatype.prototype.toTOD=function(){return new TODType(this.toInteger())};Datatype.prototype.toTime=function(){return new TimeType(this.toInteger())};Datatype.prototype.toDate=function(){return new DateType(this.toInteger())};Datatype.prototype.toString=function(){getCurWFC_NS(getCurrentWindowID_NS()).status(9215)};Datatype.prototype.encrypt=function(){return this.toString()};Datatype.prototype.compareValStr=function(){getCurWFC_NS(getCurrentWindowID_NS()).status(9215)};Datatype.prototype.toAttach=function(b){return new AttachmentType(this.toString())};Datatype.prototype.toPrimitive=function(){getCurWFC_NS(getCurrentWindowID_NS()).status(9215)};Datatype.prototype.toDbgString=function(){var b="dt:{t:"+this.type;if("mValue" in this){b+=",mValue:"+this.mValue}return b+"}"};Datatype.prototype.part=function(){getCurWFC_NS(getCurrentWindowID_NS()).status(9215)};Datatype.prototype.compound=function(b){return null};Datatype.prototype.Diff=function(b){return !(this.type==b.type&&this.mValue==b.mValue)};Datatype.prototype.EQ=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.NE=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.LT=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.LE=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.GT=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.GE=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.LIKE=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9367)};Datatype.prototype.ADD=function(f,d){if(d.isNull){return f}else{if(f.isNull){return d}}getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};Datatype.prototype.SUB=function(f,d){if(d.isNull){return f}else{if(f.isNull){return d}}getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};Datatype.prototype.MUL=function(f,d){getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};Datatype.prototype.DIV=function(f,d){getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};Datatype.prototype.MOD=function(f,d){getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};Datatype.prototype.NEG=function(b){getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};function Datatype_Factory(b){if(b.t in DatatypeFactories){return DatatypeFactories[b.t](b.v,b.a)}return Null}Datatype.prototype.ROUND=function(){var b=this.toReal();b=(b>2147483647)?2147483647:(b<-2147483647)?-2147483647:b;return new IntegerType(Math.round(b))};Datatype.prototype.TRUNC=function(){var b=this.toReal();b=(b>2147483647)?2147483647:(b<-2147483647)?-2147483647:b;return new IntegerType(parseInt(b))};Datatype.prototype.EQForSet=function(b){return this.toString()==b.toString()};Datatype.prototype.ConvertForPushFields=function(d,b){if(this.isNull){return this}return DatatypeFactories[d](this,b)};Datatype.prototype.ConvertForDynamicPushFields=function(d,b){if(this.isNull||!(b in d)){return this}return DatatypeFactories[d[b].t](this,d[b].a)};NullType.prototype=new Datatype();NullType.prototype.constructor=NullType;NullType.superclass=Datatype.prototype;DatatypeFactories[0]=function(b){return Null};function NullType(){if(arguments.length){this.init()}}NullType.prototype.type=0;NullType.prototype.isNull=true;NullType.prototype.toInteger=function(){return 0};NullType.prototype.toReal=function(){return 0};NullType.prototype.toString=function(){return""};NullType.prototype.compareValStr=function(){return this.toString()};NullType.prototype.toPrimitive=function(){return""};NullType.prototype.part=function(){return Null};NullType.prototype.compound=function(b){return Null};NullType.prototype.ADD=function(b){return b};Null=new NullType();NullType.KEYWORD_NULL=new NullType();NullType.prototype.EQ=function(b){return b.isNull};NullType.prototype.NE=function(b){return !this.EQ(b)};NullType.prototype.GT=function(b){return b.isNull};NullType.prototype.LT=function(b){return b.isNull};NullType.prototype.GE=function(b){return b.isNull};NullType.prototype.LE=function(b){return b.isNull};NullType.prototype.LIKE=function(b){return false};CharNullType.prototype=new NullType();CharNullType.prototype.constructor=CharNullType;CharNullType.superclass=NullType.prototype;function CharNullType(){if(arguments.length){this.init()}}CharNull=new CharNullType();CharNullType.KEYWORD_CHAR_NULL=new CharNullType();NullType.prototype.ROUND=function(){return Null};NullType.prototype.TRUNC=function(){return Null};CharType.prototype=new Datatype();CharType.prototype.constructor=CharType;CharType.superclass=Datatype.prototype;DatatypeFactories[4]=function(b){return new CharType(b)};function CharType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}CharType.prototype.init=function(b){if(b instanceof Datatype){this.mValue=b.toChar()}else{if(typeof b=="string"){this.mValue=b}else{this.mValue=b}}};CharType.prototype.type=4;CharType.prototype.isNull=false;CharType.prototype.toString=function(){return this.mValue};CharType.prototype.encrypt=function(){if(this!=undefined&&this!=null&&this.mEncryptDataAtRest!=undefined&&this.mEncryptDataAtRest==true){return this.ConvertPrimitiveToDataType(this.toString().replace(/./g,"*"))}return this.toString()};CharType.prototype.compareValStr=function(){return this.toString()};CharType.prototype.toPrimitive=function(){return this.mValue};CharType.prototype.toTime=function(){return new TimeType(this.toString())};CharType.prototype.toDate=function(){return new DateType(this.toString())};CharType.prototype.toTOD=function(){return new TODType(this.toString())};CharType.prototype.ADD=function(f,d){this.mValue=f.toChar()+d.toChar();return this};CharType.prototype.MOD=function(f,d){if((1<<2&(1<<f.type))&&((1<<2&(1<<d.type))||(1<<0&(1<<d.type)))){if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}else{this.mValue=(f.toInteger()%d.toInteger())+""}}else{if(d.isNull){return f}else{if(f.isNull){if(d instanceof IntegerType){this.mValue="0"}else{return d}}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9339)}}}return this};CharType.prototype.DIV=function(f,d){if(d.isNull){return f}else{if(f.isNull){return d}}getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};CharType.prototype.MUL=function(f,d){if(d.isNull){return f}else{if(f.isNull){return d}}getCurWFC_NS(getCurrentWindowID_NS()).status(9339)};CharType.prototype.EQ=function(d){if(d.isNull){return false}var b=this.mValue;var f=d.toChar();if(getFormElements_NS(getCurrentWindowID_NS())["FormContainer"].getAttribute("arcs")=="1"){if(b!=null){b=b.toLowerCase()}if(f!=null){f=f.toLowerCase()}}if(b==null||f==null){if(b==null&&f==null){return true}else{return false}}else{return b.localeCompare(f)==0}};CharType.prototype.NE=function(b){return !this.EQ(b)};CharType.prototype.GT=function(d){var b=this.mValue;var f=d.toChar();if(getFormElements_NS(getCurrentWindowID_NS())["FormContainer"].getAttribute("arcs")=="1"){if(b!=null){b=b.toLowerCase()}if(f!=null){f=f.toLowerCase()}}if(b==null||f==null){if(b==null&&f==null){return true}else{return false}}else{return b.localeCompare(f)>0}};CharType.prototype.LT=function(d){var b=this.mValue;var f=d.toChar();if(getFormElements_NS(getCurrentWindowID_NS())["FormContainer"].getAttribute("arcs")=="1"){if(b!=null){b=b.toLowerCase()}if(f!=null){f=f.toLowerCase()}}if(b==null||f==null){if(b==null&&f==null){return true}else{return false}}else{return b.localeCompare(f)<0}};CharType.prototype.GE=function(d){var b=this.mValue;var f=d.toChar();if(getFormElements_NS(getCurrentWindowID_NS())["FormContainer"].getAttribute("arcs")=="1"){if(b!=null){b=b.toLowerCase()}if(f!=null){f=f.toLowerCase()}}if(b==null||f==null){if(b==null&&f==null){return true}else{return false}}else{return b.localeCompare(f)>=0}};CharType.prototype.LE=function(d){var b=this.mValue;var f=d.toChar();if(getFormElements_NS(getCurrentWindowID_NS())["FormContainer"].getAttribute("arcs")=="1"){if(b!=null){b=b.toLowerCase()}if(f!=null){f=f.toLowerCase()}}if(b==null||f==null){if(b==null&&f==null){return true}else{return false}}else{return b.localeCompare(f)<=0}};CharType.prototype.LIKE=function(d){var b=this.mValue.replace(/\r\n/g,"\n");var h=d.toChar();if(b==null||h==null){return false}if(getFormElements_NS(getCurrentWindowID_NS())["FormContainer"].getAttribute("arcs")=="1"){b=b.toLowerCase();h=h.toLowerCase()}h=h.replace(/(%)|(_)|(\[.*?\])|([.$^+?*{()\\\/|[\]])/gm,function(k,v,u,s,o){if(v){return"(.|\\n)*"}else{if(u){return"(.|\\n)"}else{if(s){return s}else{if(o){return"\\"+o}}}}});try{var g=new RegExp("^"+h+"$")}catch(f){return false}return b.match(g)!=null};CharType.prototype.toCurrency=function(b){return new CurrencyType(this.toString(),b,true)};DiaryType.prototype=new CharType();DiaryType.prototype.constructor=DiaryType;DiaryType.superclass=CharType.prototype;DatatypeFactories[5]=function(b){return new DiaryType(b)};function DiaryType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}DiaryType.prototype.init=function(b){DiaryType.superclass.init.call(this,b)};DiaryType.prototype.type=5;DiaryType.prototype.toCurrency=function(b){return new CurrencyType(this.toString(),b,true)};ColumnType.prototype=new Datatype();ColumnType.prototype.constructor=ColumnType;ColumnType.superclass=Datatype.prototype;function ColumnType(b){if(arguments.length){this.init(b)}}ColumnType.prototype.init=function(b){ColumnType.superclass.init.call(this);this.mValue=b};MathContext.prototype.getDigits=function(){return this.digits};MathContext.prototype.getForm=function(){return this.form};MathContext.prototype.getLostDigits=function(){return this.lostDigits};MathContext.prototype.getRoundingMode=function(){return this.roundingMode};MathContext.prototype.toString=function(){var g=null;var f=0;var d=null;if(this.form==1){g="SCIENTIFIC"}else{if(this.form==2){g="ENGINEERING"}else{g="PLAIN"}}var b=this.ROUNDS.length;f=0;f:for(;b>0;b--,f++){if(this.roundingMode==this.ROUNDS[f]){d=this.ROUNDWORDS[f];break f}}return"digits="+this.digits+" form="+g+" lostDigits="+(this.lostDigits?"1":"0")+" roundingMode="+d};MathContext.prototype.isValidRound=function(d){var b=0;var f=this.ROUNDS.length;b=0;b:for(;f>0;f--,b++){if(d==this.ROUNDS[b]){return true}}return false};MathContext.prototype.ROUNDS=new Array(4,7,2,1,3,5,6,0);MathContext.prototype.ROUNDWORDS=new Array("ROUND_HALF_UP","ROUND_UNNECESSARY","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_UP");function MathContext(){this.digits=0;this.form=0;this.lostDigits=false;this.roundingMode=0;var b=1;var g=false;var f=4;if(MathContext.arguments.length==4){b=MathContext.arguments[1];g=MathContext.arguments[2];f=MathContext.arguments[3]}else{if(MathContext.arguments.length==3){b=MathContext.arguments[1];g=MathContext.arguments[2]}else{if(MathContext.arguments.length==2){b=MathContext.arguments[1]}else{if(MathContext.arguments.length!=1){throw"MathContext(): "+MathContext.arguments.length+" arguments given; expected 1 to 4"}}}}var d=MathContext.arguments[0];if(d!=9){if(d<0){throw"MathContext(): Digits too small: "+d}if(d>999999999){throw"MathContext(): Digits too large: "+d}}if(b==1){}else{if(b==2){}else{if(b==0){}else{throw"MathContext() Bad form value: "+b}}}if((!(this.isValidRound(f)))){throw"MathContext(): Bad roundingMode value: "+f}this.digits=d;this.form=b;this.lostDigits=g;this.roundingMode=f;return}BigDecimal.div=function(f,d){return(f-(f%d))/d};BigDecimal.prototype.arraycopy=function arraycopy(k,h,b,g,f){var d;if(g>h){for(d=f-1;d>=0;--d){b[d+g]=k[d+h]}}else{for(d=0;d<f;++d){b[d+g]=k[d+h]}}};BigDecimal.prototype.createArrayWithZeros=function createArrayWithZeros(d){var f=new Array(d);var b;for(b=0;b<d;++b){f[b]=0}return f};BigDecimal.prototype.add=function(){var v;if(arguments.length==2){v=arguments[1]}else{if(arguments.length==1){v=this.plainMC()}else{throw"add(): "+arguments.length+" arguments given; expected 1 or 2"}}var b=arguments[0];var C;var d;var E;var g;var D;var G;var A;var s=0;var f=0;var h=0;var u=null;var B=0;var z=0;var o=0;var k=0;var y=0;var w=0;if(v.lostDigits){this.checkdigits(b,v.digits)}C=this;if(C.ind==0){if(v.form!=0){return b.plus(v)}}if(b.ind==0){if(v.form!=0){return C.plus(v)}}d=v.digits;if(d>0){if(C.mant.length>d){C=this.clone(C).round(v)}if(b.mant.length>d){b=this.clone(b).round(v)}}E=new BigDecimal();g=C.mant;D=C.mant.length;G=b.mant;A=b.mant.length;padder:do{if(C.exp==b.exp){E.exp=C.exp}else{if(C.exp>b.exp){s=(D+C.exp)-b.exp;if(s>=((A+d)+1)){if(d>0){E.mant=g;E.exp=C.exp;E.ind=C.ind;if(D<d){E.mant=this.extend(C.mant,d);E.exp=E.exp-((d-D))}return E.finish(v,false)}}E.exp=b.exp;if(s>(d+1)){if(d>0){f=(s-d)-1;A=A-f;E.exp=E.exp+f;s=d+1}}if(s>D){D=s}}else{s=(A+b.exp)-C.exp;if(s>=((D+d)+1)){if(d>0){E.mant=G;E.exp=b.exp;E.ind=b.ind;if(A<d){E.mant=this.extend(b.mant,d);E.exp=E.exp-((d-A))}return E.finish(v,false)}}E.exp=C.exp;if(s>(d+1)){if(d>0){f=(s-d)-1;D=D-f;E.exp=E.exp+f;s=d+1}}if(s>A){A=s}}}}while(false);if(C.ind==this.iszero){E.ind=this.ispos}else{E.ind=C.ind}if(((C.ind==this.isneg)?1:0)==((b.ind==this.isneg)?1:0)){h=1}else{signdiff:do{h=-1;swaptest:do{if(b.ind==this.iszero){}else{if((D<A)||(C.ind==this.iszero)){u=g;g=G;G=u;f=D;D=A;A=f;E.ind=-E.ind}else{if(D>A){}else{B=0;z=0;o=g.length-1;k=G.length-1;compare:for(;;){if(B<=o){y=g[B]}else{if(z>k){if(v.form!=0){return this.ZERO}break compare}y=0}if(z<=k){w=G[z]}else{w=0}if(y!=w){if(y<w){u=g;g=G;G=u;f=D;D=A;A=f;E.ind=-E.ind}break compare}B++;z++}}}}}while(false)}while(false)}E.mant=this.byteaddsub(g,D,G,A,h,false);return E.finish(v,false)};BigDecimal.prototype.compareTo=function(){var k;if(arguments.length==2){k=arguments[1]}else{if(arguments.length==1){k=this.plainMC()}else{throw"compareTo(): "+arguments.length+" arguments given; expected 1 or 2"}}var h=arguments[0];var g=0;var b=0;var f;if(k.lostDigits){this.checkdigits(h,k.digits)}if((this.ind==h.ind)&&(this.exp==h.exp)){g=this.mant.length;if(g<h.mant.length){return -this.ind}if(g>h.mant.length){return this.ind}if((g<=k.digits)||(k.digits==0)){var d=g;b=0;b:for(;d>0;d--,b++){if(this.mant[b]<h.mant[b]){return -this.ind}if(this.mant[b]>h.mant[b]){return this.ind}}return 0}}else{if(this.ind<h.ind){return -1}if(this.ind>h.ind){return 1}}f=this.clone(h);f.ind=-f.ind;return this.add(f,k).ind};BigDecimal.prototype.divide=function(){var f;var b=-1;if(arguments.length==2){if(typeof arguments[1]=="number"){f=new MathContext(0,0,false,arguments[1])}else{f=arguments[1]}}else{if(arguments.length==3){b=arguments[1];if(b<0){throw"divide(): Negative scale: "+b}f=new MathContext(0,0,false,arguments[2])}else{if(arguments.length==1){f=this.plainMC()}else{throw"divide(): "+arguments.length+" arguments given; expected between 1 and 3"}}}var d=arguments[0];return this.dodivide("D",d,f,b)};BigDecimal.prototype.max=function(){var d;if(arguments.length==2){d=arguments[1]}else{if(arguments.length==1){d=this.plainMC()}else{throw"max(): "+arguments.length+" arguments given; expected 1 or 2"}}var b=arguments[0];if((this.compareTo(b,d))>=0){return this.plus(d)}else{return b.plus(d)}};BigDecimal.prototype.min=function(){var d;if(arguments.length==2){d=arguments[1]}else{if(arguments.length==1){d=this.plainMC()}else{throw"min(): "+arguments.length+" arguments given; expected 1 or 2"}}var b=arguments[0];if((this.compareTo(b,d))<=0){return this.plus(d)}else{return b.plus(d)}};BigDecimal.prototype.multiply=function(){var y;if(arguments.length==2){y=arguments[1]}else{if(arguments.length==1){y=this.plainMC()}else{throw"multiply(): "+arguments.length+" arguments given; expected 1 or 2"}}var s=arguments[0];var g;var w;var o;var f=null;var z=null;var u;var A=0;var v;var h;var d=0;var k=0;if(y.lostDigits){this.checkdigits(s,y.digits)}g=this;w=0;o=y.digits;if(o>0){if(g.mant.length>o){g=this.clone(g).round(y)}if(s.mant.length>o){s=this.clone(s).round(y)}}else{if(g.exp>0){w=w+g.exp}if(s.exp>0){w=w+s.exp}}if(g.mant.length<s.mant.length){f=g.mant;z=s.mant}else{f=s.mant;z=g.mant}u=(f.length+z.length)-1;if((f[0]*z[0])>9){A=u+1}else{A=u}v=new BigDecimal();h=this.createArrayWithZeros(A);var b=f.length;d=0;d:for(;b>0;b--,d++){k=f[d];if(k!=0){h=this.byteaddsub(h,h.length,z,u,k,true)}u--}v.ind=g.ind*s.ind;v.exp=(g.exp+s.exp)-w;if(w==0){v.mant=h}else{v.mant=this.extend(h,h.length+w)}return v.finish(y,false)};BigDecimal.prototype.negate=function(){var d;if(arguments.length==1){d=arguments[0]}else{if(arguments.length==0){d=this.plainMC()}else{throw"negate(): "+arguments.length+" arguments given; expected 0 or 1"}}var b;if(d.lostDigits){this.checkdigits(null,d.digits)}b=this.clone(this);b.ind=-b.ind;return b.finish(d,false)};BigDecimal.prototype.plus=function(){var b;if(arguments.length==1){b=arguments[0]}else{if(arguments.length==0){b=this.plainMC()}else{throw"plus(): "+arguments.length+" arguments given; expected 0 or 1"}}if(b.lostDigits){this.checkdigits(null,b.digits)}if(b.form==0){if(this.form==0){if(this.mant.length<=b.digits){return this}if(b.digits==0){return this}}}return this.clone(this).finish(b,false)};BigDecimal.prototype.subtract=function(){var f;if(arguments.length==2){f=arguments[1]}else{if(arguments.length==1){f=this.plainMC()}else{throw"subtract(): "+arguments.length+" arguments given; expected 1 or 2"}}var d=arguments[0];var b;if(f.lostDigits){this.checkdigits(d,f.digits)}b=this.clone(d);b.ind=-b.ind;return this.add(b,f)};BigDecimal.prototype.equals=function(h){var o;var f=0;var k=null;var g=null;if(h==null){return false}if((!(((h instanceof BigDecimal))))){return false}o=h;if(this.ind!=o.ind){return false}if(((this.mant.length==o.mant.length)&&(this.exp==o.exp))&&(this.form==o.form)){var d=this.mant.length;f=0;f:for(;d>0;d--,f++){if(this.mant[f]!=o.mant[f]){return false}}}else{k=this.layout();g=o.layout();if(k.length!=g.length){return false}var b=k.length;f=0;f:for(;b>0;b--,f++){if(k[f]!=g[f]){return false}}}return true};BigDecimal.prototype.format=function(){var J;var k;var f;var g;if(arguments.length==6){J=arguments[2];k=arguments[3];f=arguments[4];g=arguments[5]}else{if(arguments.length==2){J=-1;k=-1;f=1;g=4}else{throw"format(): "+arguments.length+" arguments given; expected 2 or 6"}}var C=arguments[0];var h=arguments[1];var s;var d=0;var o=0;var L=0;var b=null;var H=0;var z=0;var w=0;var N;var G=0;var I=null;var K=0;var B=0;if((C<(-1))||(C==0)){this.badarg("format",1,C)}if(h<(-1)){this.badarg("format",2,h)}if((J<(-1))||(J==0)){this.badarg("format",3,J)}if(k<(-1)){this.badarg("format",4,k)}if(f==1){}else{if(f==2){}else{if(f==(-1)){f=1}else{this.badarg("format",5,f)}}}if(g!=4){try{if(g==(-1)){g=4}else{new MathContext(9,1,false,g)}}catch(E){this.badarg("format",6,g)}}s=this.clone(this);setform:do{if(k==(-1)){s.form=0}else{if(s.ind==this.iszero){s.form=0}else{d=s.exp+s.mant.length;if(d>k){s.form=f}else{if(d<(-5)){s.form=f}else{s.form=0}}}}}while(false);if(h>=0){setafter:for(;;){if(s.form==0){o=-s.exp}else{if(s.form==1){o=s.mant.length-1}else{L=(((s.exp+s.mant.length)-1))%3;if(L<0){L=3+L}L++;if(L>=s.mant.length){o=0}else{o=s.mant.length-L}}}if(o==h){break setafter}if(o<h){b=this.extend(s.mant,(s.mant.length+h)-o);s.mant=b;s.exp=s.exp-((h-o));if(s.exp<this.MinExp){throw"format(): Exponent Overflow: "+s.exp}break setafter}H=o-h;if(H>s.mant.length){s.mant=this.ZERO.mant;s.ind=this.iszero;s.exp=0;continue setafter}z=s.mant.length-H;w=s.exp;s.round(z,g);if((s.exp-w)==H){break setafter}}}N=s.layout();if(C>0){var D=N.length;G=0;G:for(;D>0;D--,G++){if(N[G]=="."){break G}if(N[G]=="E"){break G}}if(G>C){this.badarg("format",1,C)}if(G<C){I=new Array((N.length+C)-G);var A=C-G;K=0;K:for(;A>0;A--,K++){I[K]=" "}this.arraycopy(N,0,I,K,N.length);N=I}}if(J>0){var y=N.length-1;G=N.length-1;G:for(;y>0;y--,G--){if(N[G]=="E"){break G}}if(G==0){I=new Array((N.length+J)+2);this.arraycopy(N,0,I,0,N.length);var v=J+2;K=N.length;K:for(;v>0;v--,K++){I[K]=" "}N=I}else{B=(N.length-G)-2;if(B>J){this.badarg("format",3,J)}if(B<J){I=new Array((N.length+J)-B);this.arraycopy(N,0,I,0,G+2);var u=J-B;K=G+2;K:for(;u>0;u--,K++){I[K]="0"}this.arraycopy(N,G+2,I,K,B);N=I}}}return N.join("")};BigDecimal.prototype.intValueExact=function(){var h;var f=0;var b;var d=0;var k=0;if(this.ind==this.iszero){return 0}h=this.mant.length-1;if(this.exp<0){h=h+this.exp;if((!(this.allzero(this.mant,h+1)))){throw"intValueExact(): Decimal part non-zero: "+this.toString()}if(h<0){return 0}f=0}else{if((this.exp+h)>9){throw"intValueExact(): Conversion overflow: "+this.toString()}f=this.exp}b=0;var g=h+f;d=0;d:for(;d<=g;d++){b=b*10;if(d<=h){b=b+this.mant[d]}}if((h+f)==9){k=BigDecimal.div(b,1000000000);if(k!=this.mant[0]){if(b==-2147483648){if(this.ind==this.isneg){if(this.mant[0]==2){return b}}}throw"intValueExact(): Conversion overflow: "+this.toString()}}if(this.ind==this.ispos){return b}return -b};BigDecimal.prototype.movePointLeft=function(d){var b;b=this.clone(this);b.exp=b.exp-d;return b.finish(this.plainMC(),false)};BigDecimal.prototype.movePointRight=function(d){var b;b=this.clone(this);b.exp=b.exp+d;return b.finish(this.plainMC(),false)};BigDecimal.prototype.scale=function(){if(this.exp>=0){return 0}return -this.exp};BigDecimal.prototype.setScale=function(){var d;if(arguments.length==2){d=arguments[1]}else{if(arguments.length==1){d=7}else{throw"setScale(): "+arguments.length+" given; expected 1 or 2"}}var k=arguments[0];var b;var f;var g=0;var h=0;b=this.scale();if(b==k){if(this.form==0){return this}}f=this.clone(this);if(b<=k){if(b==0){g=f.exp+k}else{g=k-b}f.mant=this.extend(f.mant,f.mant.length+g);f.exp=-k}else{if(k<0){throw"setScale(): Negative scale: "+k}h=f.mant.length-((b-k));f=f.round(h,d);if(f.exp!=(-k)){f.mant=this.extend(f.mant,f.mant.length+1);f.exp=f.exp-1}}f.form=0;return f};BigDecimal.prototype.signum=function(){return this.ind};BigDecimal.prototype.toString=function(){return this.layout().join("")};BigDecimal.prototype.layout=function(){var z;var k=0;var y=null;var w=0;var A=0;var v=0;var h=null;var u;var o;var s=0;z=new Array(this.mant.length);var g=this.mant.length;k=0;k:for(;g>0;g--,k++){z[k]=this.mant[k]+""}if(this.form!=0){y="";if(this.ind==this.isneg){y+="-"}w=(this.exp+z.length)-1;if(this.form==1){y+=z[0];if(z.length>1){y+="."}y+=z.slice(1).join("")}else{engineering:do{A=w%3;if(A<0){A=3+A}w=w-A;A++;if(A>=z.length){y+=z.join("");var d=A-z.length;for(;d>0;d--){y+="0"}}else{y+=z.slice(0,A).join("");y+=".";y+=z.slice(A).join("")}}while(false)}if(w!=0){if(w<0){v="-";w=-w}else{v="+"}y+="E";y+=v;y+=w}return y.split("")}if(this.exp==0){if(this.ind>=0){return z}h=new Array(z.length+1);h[0]="-";this.arraycopy(z,0,h,1,z.length);return h}u=((this.ind==this.isneg)?1:0);o=this.exp+z.length;if(o<1){s=(u+2)-this.exp;h=new Array(s);if(u!=0){h[0]="-"}h[u]="0";h[u+1]=".";var f=-o;k=u+2;k:for(;f>0;f--,k++){h[k]="0"}this.arraycopy(z,0,h,(u+2)-o,z.length);return h}if(o>z.length){s=u+o;h=new Array(s);if(u!=0){h[0]="-"}this.arraycopy(z,0,h,u,z.length);var b=o-z.length;k=u+z.length;k:for(;b>0;b--,k++){h[k]="0"}return h}s=(u+1)+z.length;h=new Array(s);if(u!=0){h[0]="-"}this.arraycopy(z,0,h,u,o);h[u+o]=".";this.arraycopy(z,o,h,(u+o)+1,z.length-o);return h};BigDecimal.prototype.intcheck=function(f,b){var d;d=this.intValueExact();if((d<f)||(d>b)){throw"intcheck(): Conversion overflow: "+d}return d};BigDecimal.prototype.dodivide=function(g,b,E,Q){var I;var f;var O;var R;var C;var S;var s;var P;var A;var u;var v;var H=0;var J=0;var o=0;var B=0;var z=0;var y=0;var G=0;var N=0;var w=null;var D=0;var k=0;var h=null;if(E.lostDigits){this.checkdigits(b,E.digits)}I=this;if(b.ind==0){throw"dodivide(): Divide by 0"}if(I.ind==0){if(E.form!=0){return this.ZERO}if(Q==(-1)){return I}return I.setScale(Q)}f=E.digits;if(f>0){if(I.mant.length>f){I=this.clone(I).round(E)}if(b.mant.length>f){b=this.clone(b).round(E)}}else{if(Q==(-1)){Q=I.scale()}f=I.mant.length;if(Q!=(-I.exp)){f=(f+Q)+I.exp}f=(f-((b.mant.length-1)))-b.exp;if(f<I.mant.length){f=I.mant.length}if(f<b.mant.length){f=b.mant.length}}O=((I.exp-b.exp)+I.mant.length)-b.mant.length;if(O<0){if(g!="D"){if(g=="I"){return this.ZERO}return this.clone(I).finish(E,false)}}R=new BigDecimal();R.ind=(I.ind*b.ind);R.exp=O;R.mant=this.createArrayWithZeros(f+1);C=(f+f)+1;S=this.extend(I.mant,C);s=C;P=b.mant;A=C;u=(P[0]*10)+1;if(P.length>1){u=u+P[1]}v=0;outer:for(;;){H=0;inner:for(;;){if(s<A){break inner}if(s==A){compare:do{var L=s;J=0;J:for(;L>0;L--,J++){if(J<P.length){o=P[J]}else{o=0}if(S[J]<o){break inner}if(S[J]>o){break compare}}H++;R.mant[v]=H;v++;S[0]=0;break outer}while(false);B=S[0]}else{B=S[0]*10;if(s>1){B=B+S[1]}}z=BigDecimal.div((B*10),u);if(z==0){z=1}H=H+z;S=this.byteaddsub(S,s,P,A,-z,true);if(S[0]!=0){continue inner}var K=s-2;y=0;y:for(;y<=K;y++){if(S[y]!=0){break y}s--}if(y==0){continue inner}this.arraycopy(S,y,S,0,s)}if((v!=0)||(H!=0)){R.mant[v]=H;v++;if(v==(f+1)){break outer}if(S[0]==0){break outer}}if(Q>=0){if((-R.exp)>Q){break outer}}if(g!="D"){if(R.exp<=0){break outer}}R.exp=R.exp-1;A--}if(v==0){v=1}if((g=="I")||(g=="R")){if((v+R.exp)>f){throw"dodivide(): Integer overflow"}if(g=="R"){remainder:do{if(R.mant[0]==0){return this.clone(I).finish(E,false)}if(S[0]==0){return this.ZERO}R.ind=I.ind;G=((f+f)+1)-I.mant.length;R.exp=(R.exp-G)+I.exp;N=s;J=N-1;J:for(;J>=1;J--){if(!((R.exp<I.exp)&&(R.exp<b.exp))){break}if(S[J]!=0){break J}N--;R.exp=R.exp+1}if(N<S.length){w=new Array(N);this.arraycopy(S,0,w,0,N);S=w}R.mant=S;return R.finish(E,false)}while(false)}}else{if(S[0]!=0){D=R.mant[v-1];if(((D%5))==0){R.mant[v-1]=(D+1)}}}if(Q>=0){scaled:do{if(v!=R.mant.length){R.exp=R.exp-((R.mant.length-v))}k=R.mant.length-(((-R.exp)-Q));R.round(k,E.roundingMode);if(R.exp!=(-Q)){R.mant=this.extend(R.mant,R.mant.length+1);R.exp=R.exp-1}return R.finish(E,true)}while(false)}if(v==R.mant.length){R.round(E);v=f}else{if(R.mant[0]==0){return this.ZERO}h=new Array(v);this.arraycopy(R.mant,0,h,0,v);R.mant=h}return R.finish(E,true)};BigDecimal.prototype.bad=function(d,b){throw d+"Not a number: "+b};BigDecimal.prototype.badarg=function(b,f,d){throw"Bad argument "+f+" to "+b+": "+d};BigDecimal.prototype.extend=function(b,f){var d;if(b.length==f){return b}d=this.createArrayWithZeros(f);this.arraycopy(b,0,d,0,b.length);return d};BigDecimal.prototype.byteaddsub=function(E,g,D,B,y,d){var G;var C;var w;var H;var f;var k;var s;var v;var o=0;var h=0;var u;var z=0;G=E.length;C=D.length;w=g-1;H=B-1;f=H;if(f<w){f=w}k=null;if(d){if((f+1)==G){k=E}}if(k==null){k=this.createArrayWithZeros(f+1)}s=false;if(y==1){s=true}else{if(y==(-1)){s=true}}v=0;o=f;o:for(;o>=0;o--){if(w>=0){if(w<G){v=v+E[w]}w--}if(H>=0){if(H<C){if(s){if(y>0){v=v+D[H]}else{v=v-D[H]}}else{v=v+(D[H]*y)}}H--}if(v<10){if(v>=0){quick:do{k[o]=v;v=0;continue o}while(false)}}h=v+90;k[o]=this.bytedig[h];v=this.bytecar[h]}if(v==0){return k}u=null;if(d){if((f+2)==E.length){u=E}}if(u==null){u=new Array(f+2)}u[0]=v;var A=f+1;z=0;z:for(;A>0;A--,z++){u[z+1]=k[z]}return u};BigDecimal.prototype.diginit=function(){var b;var f=0;var d=0;b=new Array((90+99)+1);f=0;f:for(;f<=(90+99);f++){d=f-90;if(d>=0){b[f]=(d%10);BigDecimal.prototype.bytecar[f]=(BigDecimal.div(d,10));continue f}d=d+100;b[f]=(d%10);BigDecimal.prototype.bytecar[f]=((BigDecimal.div(d,10))-10)}return b};BigDecimal.prototype.clone=function(d){var b;b=new BigDecimal();b.ind=d.ind;b.exp=d.exp;b.form=d.form;b.mant=d.mant;return b};BigDecimal.prototype.checkdigits=function(d,b){if(b==0){return}if(this.mant.length>b){if((!(this.allzero(this.mant,b)))){throw"Too many digits: "+this.toString()}}if(d==null){return}if(d.mant.length>b){if((!(this.allzero(d.mant,b)))){throw"Too many digits: "+d.toString()}}return};BigDecimal.prototype.round=function(){var k;var g;if(arguments.length==2){k=arguments[0];g=arguments[1]}else{if(arguments.length==1){var u=arguments[0];k=u.digits;g=u.roundingMode}else{throw"round(): "+arguments.length+" arguments given; expected 1 or 2"}}var v;var d;var b;var o=false;var f=0;var s;var h=null;v=this.mant.length-k;if(v<=0){return this}this.exp=this.exp+v;d=this.ind;b=this.mant;if(k>0){this.mant=new Array(k);this.arraycopy(b,0,this.mant,0,k);o=true;f=b[k]}else{this.mant=this.ZERO.mant;this.ind=this.iszero;o=false;if(k==0){f=b[0]}else{f=0}}s=0;modes:do{if(g==4){if(f>=5){s=d}}else{if(g==7){if((!(this.allzero(b,k)))){throw"round(): Rounding necessary"}}else{if(g==5){if(f>5){s=d}else{if(f==5){if((!(this.allzero(b,k+1)))){s=d}}}}else{if(g==6){if(f>5){s=d}else{if(f==5){if((!(this.allzero(b,k+1)))){s=d}else{if((((this.mant[this.mant.length-1])%2))==1){s=d}}}}}else{if(g==1){}else{if(g==0){if((!(this.allzero(b,k)))){s=d}}else{if(g==2){if(d>0){if((!(this.allzero(b,k)))){s=d}}}else{if(g==3){if(d<0){if((!(this.allzero(b,k)))){s=d}}}else{throw"round(): Bad round value: "+g}}}}}}}}}while(false);if(s!=0){bump:do{if(this.ind==this.iszero){this.mant=this.ONE.mant;this.ind=s}else{if(this.ind==this.isneg){s=-s}h=this.byteaddsub(this.mant,this.mant.length,this.ONE.mant,1,s,o);if(h.length>this.mant.length){this.exp++;this.arraycopy(h,0,this.mant,0,this.mant.length)}else{this.mant=h}}}while(false)}if(this.exp>this.MaxExp){throw"round(): Exponent Overflow: "+this.exp}return this};BigDecimal.prototype.allzero=function(g,f){var d=0;if(f<0){f=0}var b=g.length-1;d=f;d:for(;d<=b;d++){if(g[d]!=0){return false}}return true};BigDecimal.prototype.equalzero=function(){return this.allzero(this.mant,0)};BigDecimal.prototype.finish=function(u,h){var s=0;var f=0;var g=null;var k=0;var o=0;if(u.digits!=0){if(this.mant.length>u.digits){this.round(u)}}if(h){if(u.form!=0){s=this.mant.length;f=s-1;f:for(;f>=1;f--){if(this.mant[f]!=0){break f}s--;this.exp++}if(s<this.mant.length){g=new Array(s);this.arraycopy(this.mant,0,g,0,s);this.mant=g}}}this.form=0;var b=this.mant.length;f=0;f:for(;b>0;b--,f++){if(this.mant[f]!=0){if(f>0){delead:do{g=new Array(this.mant.length-f);this.arraycopy(this.mant,f,g,0,this.mant.length-f);this.mant=g}while(false)}k=this.exp+this.mant.length;if(k>0){if(k>u.digits){if(u.digits!=0){this.form=u.form}}if((k-1)<=this.MaxExp){return this}}else{if(k<(-5)){this.form=u.form}}k--;if((k<this.MinExp)||(k>this.MaxExp)){overflow:do{if(this.form==2){o=k%3;if(o<0){o=3+o}k=k-o;if(k>=this.MinExp){if(k<=this.MaxExp){break overflow}}}throw"finish(): Exponent Overflow: "+k}while(false)}return this}}this.ind=this.iszero;if(u.form!=0){this.exp=0}else{if(this.exp>0){this.exp=0}else{if(this.exp<this.MinExp){throw"finish(): Exponent Overflow: "+this.exp}}}this.mant=this.ZERO.mant;return this};BigDecimal.prototype.ispos=1;BigDecimal.prototype.iszero=0;BigDecimal.prototype.isneg=-1;BigDecimal.prototype.MinExp=-999999999;BigDecimal.prototype.MaxExp=999999999;BigDecimal.prototype.MinArg=-999999999;BigDecimal.prototype.MaxArg=999999999;BigDecimal.prototype.gPlainMC=null;BigDecimal.prototype.plainMC=function(){if(BigDecimal.prototype.gPlainMC==null){BigDecimal.prototype.gPlainMC=new MathContext(0,0)}return BigDecimal.prototype.gPlainMC};BigDecimal.prototype.bytecar=new Array((90+99)+1);BigDecimal.prototype.bytedig=BigDecimal.prototype.diginit();BigDecimal.prototype.ZERO=new BigDecimal("0");BigDecimal.prototype.ONE=new BigDecimal("1");BigDecimal.prototype.TEN=new BigDecimal("10");function BigDecimal(){this.ind=0;this.form=0;this.mant=null;this.exp=0;if(arguments.length==0){return}var E;var w;var u;if(arguments.length==1){E=arguments[0];w=0;u=E.length}else{E=arguments[0];w=arguments[1];u=arguments[2]}if(typeof E=="string"){E=E.split("")}var z;var D;var H;var L;var y;var C=0;var K=0;var b=false;var A=0;var G=0;var B=0;var J=0;var I=0;var g=0;if(u<=0){this.bad("BigDecimal(): ",E)}this.ind=this.ispos;if(E[0]==("-")){u--;if(u==0){this.bad("BigDecimal(): ",E)}this.ind=this.isneg;w++}else{if(E[0]==("+")){u--;if(u==0){this.bad("BigDecimal(): ",E)}w++}}z=false;D=false;H=0;L=-1;y=-1;var v=u;C=w;C:for(;v>0;v--,C++){K=E[C];if(K>="0"){if(K<="9"){y=C;H++;continue C}}if(K=="."){if(L>=0){this.bad("BigDecimal(): ",E)}L=C-w;continue C}if(K!="e"){if(K!="E"){if(K<"0"||K>"9"){this.bad("BigDecimal(): ",E)}z=true;y=C;H++;continue C}}if((C-w)>(u-2)){this.bad("BigDecimal(): ",E)}b=false;if((E[C+1])==("-")){b=true;A=C+2}else{if((E[C+1])==("+")){A=C+2}else{A=C+1}}G=u-((A-w));if((G==0)||(G>9)){this.bad("BigDecimal(): ",E)}var s=G;B=A;B:for(;s>0;s--,B++){J=E[B];if(J<"0"){this.bad("BigDecimal(): ",E)}if(J>"9"){this.bad("BigDecimal(): ",E)}else{I=J-"0"}this.exp=(this.exp*10)+I}if(b){this.exp=-this.exp}D=true;break C}if(H==0){this.bad("BigDecimal(): ",E)}if(L>=0){this.exp=(this.exp+L)-H}var o=y-1;C=w;C:for(;C<=o;C++){K=E[C];if(K=="0"){w++;L--;H--}else{if(K=="."){w++;L--}else{if(K<="9"){break C}else{break C}}}}this.mant=new Array(H);B=w;if(z){exotica:do{var h=H;C=0;C:for(;h>0;h--,C++){if(C==L){B++}J=E[B];if(J<="9"){this.mant[C]=J-"0"}else{this.bad("BigDecimal(): ",E)}B++}}while(false)}else{simple:do{var f=H;C=0;C:for(;f>0;f--,C++){if(C==L){B++}this.mant[C]=E[B]-"0";B++}}while(false)}if(this.mant[0]==0){this.ind=this.iszero;if(this.exp>0){this.exp=0}if(D){this.mant=this.ZERO.mant;this.exp=0}}else{if(D){this.form=1;g=(this.exp+this.mant.length)-1;if((g<this.MinExp)||(g>this.MaxExp)){this.bad("BigDecimal(): ",E)}}}return}DecimalType.prototype=new Datatype();DecimalType.prototype.constructor=DecimalType;DecimalType.superclass=Datatype.prototype;DatatypeFactories[10]=function(d,b){if(typeof b!="undefined"&&"p" in b){return new DecimalType(d,b.p)}else{return new DecimalType(d)}};function DecimalType(b,d){if(arguments.length&&!(typeof b=="undefined")){this.init(b,d)}}DecimalType.prototype.mPrecision=2;DecimalType.prototype.init=function(g,f){DecimalType.superclass.init.call(this);if(typeof f=="number"){this.mPrecision=f}if(g instanceof Datatype){this.mValue=g.toDecimal()}else{if(typeof g=="string"){try{var b=new RegExp("^\\s*([+-]?[\\d,]+(\\.\\d+)?)(.*)$");g=g.replace(b,"$1");this.mValue=new BigDecimal(g)}catch(d){this.mValue=new BigDecimal("0")}}else{if(g==null){this.mValue=new BigDecimal("0")}else{if(g instanceof BigDecimal){this.mValue=g}else{}}}}};DecimalType.prototype.set=function(b){this.mValue=b};DecimalType.prototype.type=10;DecimalType.prototype.isNull=false;DecimalType.prototype.args=function(){return{p:this.mPrecision}};DecimalType.prototype.toDecimal=function(){return this.mValue};DecimalType.prototype.toString=function(){var b=DecimalType.Round(this.mValue,this.mPrecision);return En_USDecimalToLC(b.toString())};DecimalType.prototype.compareValStr=function(){return this.toString()};DecimalType.prototype.toChar=function(){return this.toString()};DecimalType.prototype.toPrimitive=function(){var b=DecimalType.Round(this.mValue,this.mPrecision);return b.toString()};DecimalType.Round=function(d,b){return new BigDecimal(d.format(-1,b))};DecimalType.prototype.ROUND=function(){return new DecimalType(DecimalType.Round(this.mValue,0),this.mPrecision)};DecimalType.prototype.TRUNC=function(){return new DecimalType(DecimalType.Round(this.mValue.add(new BigDecimal("-0.5")),0),this.mPrecision)};DecimalType.prototype.ADD=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.set(f.toDecimal().add(d.toDecimal()));return this};DecimalType.prototype.SUB=function(f,d){if((!(((1<<7|1<<13|1<<14)&(1<<f.type))||(1<<0&(1<<f.type)))&&((1<<7|1<<13|1<<14)&(1<<d.type)))||(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))&&(f.type!=d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.set(f.toDecimal().subtract(d.toDecimal()));return this};DecimalType.prototype.MUL=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.mPrecision=9;this.set(f.toDecimal().multiply(d.toDecimal()));return this};DecimalType.prototype.DIV=function(f,d){this.mPrecision=9;if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(d.toDecimal()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}f=f.toDecimal();d=d.toDecimal();this.set(f.divide(d,9,4));return this};DecimalType.prototype.MOD=function(f,d){if(!((1<<2&(1<<f.type))&&(1<<2&(1<<d.type)))&&!((1<<0&(1<<f.type))&&(((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))|(1<<6&(1<<d.type)))||((1<<4|1<<5)&(1<<d.type))))&&!((((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))|(1<<6&(1<<f.type)))||((1<<4|1<<5)&(1<<f.type)))&&(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(!(f instanceof IntegerType&&(d instanceof IntegerType||d instanceof NullType))){this.set(new BigDecimal("0"))}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}this.set(new BigDecimal(""+(f.toInteger()%d.toInteger())))}return this};DecimalType.prototype.NEG=function(b){this.set(b.toDecimal().multiply(new BigDecimal("-1")));return this};DecimalType.prototype.EQ=function(b){if(b.isNull){return false}return(this.mValue.compareTo(b.toDecimal())==0)};DecimalType.prototype.NE=function(b){return !this.EQ(b)};DecimalType.prototype.GT=function(b){if(b.isNull){return false}return(this.mValue.compareTo(b.toDecimal())>0)};DecimalType.prototype.GE=function(b){if(b.isNull){return false}return(this.mValue.compareTo(b.toDecimal())>=0)};DecimalType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};DecimalType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};DecimalType.prototype.toReal=function(){return new RealType(this.mValue.toString()).toReal()};DecimalType.prototype.toInteger=function(){return new IntegerType(this.mValue.toString()).toInteger()};CurrencyType.prototype=new Datatype();CurrencyType.prototype.constructor=CurrencyType;CurrencyType.superclass=Datatype.prototype;DatatypeFactories[12]=function(d,b){if(typeof b!="undefined"&&"p" in b){return new CurrencyType(d,b.p)}else{return new CurrencyType(d)}};function CurrencyType(b,d,f){if(arguments.length&&!(typeof b=="undefined")){this.init(b,d,f)}}CurrencyType.prototype.type=12;CurrencyType.prototype.isNull=false;CurrencyType.prototype.mPrecision=2;CurrencyType.RE_NUMBER=new RegExp("^\\s*([+-]?[\\d,]+(\\.\\d+)?)(.*)$");CurrencyType.prototype.init=function(f,d,o){CurrencyType.superclass.init.call(this);if(typeof d=="number"){this.mPrecision=d}if(typeof o!="boolean"){o=false}if(f instanceof CurrencyType){this.mValue=f.mValue;if(this.mValue==null){this.mValue=new BigDecimal("0")}this.mCurCode=f.mCurCode;if(typeof(d)=="object"){this.mPrecision=d.GetPrecision(this.mCurCode)}else{this.mPrecision=f.mPrecision}this.mDate=f.mDate;this.mFunc={};for(var k in f.mFunc){this.mFunc[k]={};for(var s in f.mFunc[k]){this.mFunc[k][s]=f.mFunc[k][s]}}}else{if(f instanceof Datatype){f=f.toCurrency(d);this.mValue=f.mValue;this.mCurCode=f.mCurCode;this.mPrecision=f.mPrecision;this.mDate=f.mDate;this.mFunc={};for(var k in f.mFunc){this.mFunc[k]={p:f.mFunc[k].p,v:f.mFunc[k].v}}}else{if(typeof f=="string"){this.mValue=null;this.mCurCode="";var u=f.split(" ");if(u.length>1){this.mCurCode=u[1].toUpperCase();if(typeof(d)=="object"){this.mPrecision=d.GetPrecision(this.mCurCode)}}if(u.length>0){try{var w=u[0];if(o){w=LCDecimalToEn_US(w,false)}w=w.replace(CurrencyType.RE_NUMBER,"$1");this.mValue=new BigDecimal(w)}catch(g){if(this.mCurCode==null||this.mCurCode==""){this.mValue=null}else{this.mValue=new BigDecimal("0")}}}if(u.length>2){this.mDate=new TimeType(u[2]).toInteger()}this.mFunc={};var h,b,v;for(h=3;h+1<u.length&&u[h+1].length>0;h+=2){b=2;if(typeof d=="object"){b=d.GetPrecision(u[h+1])}v=u[h];if(o){v=LCDecimalToEn_US(v,false)}try{v=new BigDecimal(v)}catch(g){v=new BigDecimal("0")}this.mFunc[u[h+1]]={v:v,p:b}}}else{if(f==null){this.mValue=null;this.mCurCode="";this.mFunc=null}else{if(f instanceof BigDecimal||typeof f=="number"){if(typeof f=="number"){f=new BigDecimal(""+f)}this.mValue=f;this.mCurCode="";this.mFunc=null}else{}}}}}this.mDate=this.getDate()};CurrencyType.prototype.part=function(d,b){switch(b){case 0:return this;case 1:return(this.mValue==null)?Null:new DecimalType(this.mValue);case 2:return new CharType(this.mCurCode);case 3:return new TimeType(this.getDate());case 4:if(d in this.mFunc){var f=this.mFunc[d].v;if(f==null){return Null}f=new CurrencyType(f,this.mFunc[d].p);f.mCurCode=d;return f}else{return Null}}return Null};CurrencyType.prototype.compound=function(d){if(d.length!=1&&d.length!=2){return null}var f="";var b=-1;var g=d[0].toUpperCase();if(g=="FIELD"){b=0}else{if(g=="VALUE"){b=1}else{if(g=="TYPE"){b=2}else{if(g=="DATE"){b=3}else{if(typeof g=="string"&&g.length==3){b=4;f=g}else{if(g.isDigits()){b=parseInt(g,10);if(b<0||b>4){return null}}else{return null}}}}}}return this.part(f,b)};CurrencyType.prototype.toCurrency=function(){return this};CurrencyType.prototype.toString=function(){if(this.mValue==null){return this.mCurCode}var b=DecimalType.Round(this.mValue,this.mPrecision);return En_USDecimalToLC(b.toString())+" "+this.mCurCode};CurrencyType.prototype.compareValStr=function(){return this.toString()};CurrencyType.prototype.toChar=function(){return this.toString()};CurrencyType.prototype.toPrimitive=function(){var g="";if(this.mValue!=null){g=DecimalType.Round(this.mValue,this.mPrecision)}if(this.mCurCode==null){return g.toString()}g+=" "+this.mCurCode;var b=true;for(var d in this.mFunc){if("v" in this.mFunc[d]&&this.mFunc[d].v!=null){if(b){g+=" "+this.getDate();b=false}g+=" "+DecimalType.Round(this.mFunc[d].v,this.mFunc[d].p);g+=" "+d}}return g.toString()};CurrencyType.prototype.toDecimal=function(){if(this.mValue==null){return new BigDecimal("0")}return this.mValue};CurrencyType.prototype.toInteger=function(){if(this.mValue==null){return new IntegerType(0)}return new IntegerType(this.mValue.toString()).toInteger()};CurrencyType.prototype.toReal=function(){if(this.mValue==null){return new RealType("0")}return new RealType(this.mValue.toString()).toReal()};CurrencyType.prototype.CalculateFunctional=function(){var f;if(this.mValue==null){return}if(this.mValue.equalzero()){for(f in this.mFunc){this.mFunc[f].v=new BigDecimal("0")}return}var b=null;for(f in this.mFunc){var d=this.mCurCode+f;if(this.mCurCode==f){this.mFunc[f].v=new BigDecimal(this.mValue.toString())}else{if(b==null){b=GetExchangeRates(ARKWGetByName(getCurrentWindowID_NS(),"SERVER").toString(),this.getDate())}if(d in b&&b[d]){this.mFunc[f].v=this.mValue.multiply(b[d])}}}};CurrencyType.prototype.CurrSetDate=function(b){if(b>2147483647||b<=0){b=new Date().UnixTimestamp()}var d=new CurrencyType(this.mValue,this.mPrecision);d.mCurCode=this.mCurCode;d.mFunc={};d.mDate=b;var f;for(f in this.mFunc){d.mFunc[f]={p:this.mFunc[f].p,v:null}}d.CalculateFunctional();return d};CurrencyType.prototype.CurrSetType=function(f){if(f instanceof CurrencyType){f=f.mCurCode}else{f=f.toString();var d=/[A-Za-z]+/;var b=d.exec(f);if(b){f=b[0].toUpperCase()}else{return Null}}if(!(f in currencyCodes)){return Null}var g=new CurrencyType(this.mValue,this.mPrecision);g.mCurCode=f;g.mFunc={};g.mDate=this.getDate();g.mValue=this.mValue;var h;for(h in this.mFunc){g.mFunc[h]={p:this.mFunc[h].p,v:null}}g.CalculateFunctional();return g};CurrencyType.prototype.CurrSetValue=function(b){var d=new CurrencyType(this.mValue,this.mPrecision);d.mCurCode=this.mCurCode;d.mFunc={};d.mDate=this.getDate();d.mValue=new BigDecimal(b.toString());var f;for(f in this.mFunc){d.mFunc[f]={p:this.mFunc[f].p,v:null}}d.CalculateFunctional();return d};CurrencyType.prototype.CurrConvert=function(h,f,b){if(typeof b!="number"){b=this.mPrecision}if(f>2147483647||f<=0){f=new Date().UnixTimestamp()}h=h.toUpperCase();if(!(h in currencyCodes)){return Null}var k=new CurrencyType(this.mValue,b);k.mCurCode=h;k.mFunc={};k.mDate=f;if(this.mCurCode==k.mCurCode){k.mValue=this.mValue}else{var d=GetExchangeRates(ARKWGetByName(getCurrentWindowID_NS(),"SERVER").toString(),f);var g=this.mCurCode+h;if(g in d&&d[g]){k.mValue=((this.mValue==null)?null:this.mValue.multiply(d[g]))}else{return Null}}var o;for(o in this.mFunc){k.mFunc[o]={p:this.mFunc[o].p,v:null}}k.CalculateFunctional();return k};CurrencyType.prototype.getDate=function(){if(this.mDate==null||typeof(this.mDate)=="undefined"){this.mDate=new Date().UnixTimestamp()}return this.mDate};CurrencyType.prototype.ADD=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}return CurrencyType.ArithOp(f,d,BigDecimal.prototype.add,this)};CurrencyType.prototype.SUB=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}return CurrencyType.ArithOp(f,d,BigDecimal.prototype.subtract,this)};CurrencyType.prototype.MUL=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.mPrecision=9;return CurrencyType.ArithOp(f,d,BigDecimal.prototype.multiply,this)};CurrencyType.prototype.DIV=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.mPrecision=9;return CurrencyType.ArithOp(f,d,BigDecimal.prototype.divide,this)};CurrencyType.prototype.MOD=function(f,d){if(!((1<<2&(1<<f.type))&&(1<<2&(1<<d.type)))&&!((1<<0&(1<<f.type))&&(((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))|(1<<6&(1<<d.type)))||((1<<4|1<<5)&(1<<d.type))))&&!((((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))|(1<<6&(1<<f.type)))||((1<<4|1<<5)&(1<<f.type)))&&(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(!(f instanceof IntegerType&&(d instanceof IntegerType||d instanceof NullType))){this.mValue=new BigDecimal("0")}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}this.mValue=new BigDecimal(""+(f.toInteger()%d.toInteger()))}return this};CurrencyType.ArithOp=function(h,f,o,d){var g=(o==BigDecimal.prototype.divide);var k=(h instanceof CurrencyType)&&!(f instanceof CurrencyType);h=h.toCurrency(d.mPrecision);f=f.toCurrency(d.mPrecision);if(h.mValue==null&&f.mValue==null){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(h.mValue==null||f.mValue==null){return Null}if(h instanceof CurrencyType&&h.mCurCode!=""){if(f.mCurCode==""){f.mCurCode=h.mCurCode}if(f.mCurCode!=h.mCurCode){if(h.mCurCode in f.mFunc||!(f.mCurCode in h.mFunc)){f=f.CurrConvert(h.mCurCode,f.getDate(),d.mPrecision)}else{h=h.CurrConvert(f.mCurCode,h.getDate(),d.mPrecision)}if(f.isNull){f=new CurrencyType("0");f.mCurCode=h.mCurCode}}}else{h=new CurrencyType(h.toDecimal());h.mCurCode=f.mCurCode}d.mCurCode=h.mCurCode;if(g&&f.toDecimal()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}d.mValue=o.call(h.mValue,f.mValue);d.mDate=h.mDate;d=d.ROUNDToOwnPrecision();if(d.mCurCode&&(!g||(g&&k))){return d}else{return new DecimalType(d.mValue)}};CurrencyType.prototype.NEG=function(b){if(b instanceof CurrencyType){this.mValue=b.mValue.multiply(new BigDecimal("-1"));this.mCurCode=b.mCurCode;this.mPrecision=b.mPrecision;return this}else{return new DecimalType(b.toDecimal().multiply(new BigDecimal("-1")))}};CurrencyType.prototype.RELOP=function(f,g){if(f.isNull){return false}if(this.mValue==null){this.mValue=new BigDecimal("0")}if(f.isNull){return false}if(f instanceof CurrencyType){if(this.mCurCode==f.mCurCode){return g(this.mValue.compareTo(f.mValue))}else{if(f.mCurCode){var d=this.CurrConvert(f.mCurCode,this.getDate());return(!d.isNull&&d.mCurCode==f.mCurCode&&g(d.mValue.compareTo(f.mValue)))}}}else{return g(this.mValue.compareTo(f.toDecimal()))}return false};CurrencyType.prototype.EQ=function(b){return this.RELOP(b,function(d){return(d==0)})};CurrencyType.prototype.NE=function(b){return !this.EQ(b)};CurrencyType.prototype.GT=function(b){return this.RELOP(b,function(d){return(d>0)})};CurrencyType.prototype.GE=function(b){return this.RELOP(b,function(d){return(d>=0)})};CurrencyType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};CurrencyType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};CurrencyType.prototype.ROUNDToOwnPrecision=function(){var b=new CurrencyType(this);return this.CurrSetValue(DecimalType.Round(b.mValue,b.mPrecision))};CurrencyType.prototype.ROUND=function(){var b=new CurrencyType(this);return this.CurrSetValue(DecimalType.Round(b.mValue,0))};CurrencyType.prototype.TRUNC=function(){var b=new CurrencyType(this);return this.CurrSetValue(new DecimalType(b.mValue,b.mPrecision).TRUNC().toDecimal())};CurrencyType.prototype.EQForSet=function(b){if(b.type==12&&this.mDate!=b.mDate){return false}return this.toString()==b.toString()};CurrencyType.prototype.Diff=function(b){return !(this.type==12&&this.mValue==b.mValue&&this.mDate==b.mDate)};RealType.prototype=new Datatype();RealType.prototype.constructor=RealType;RealType.superclass=Datatype.prototype;DatatypeFactories[3]=function(d,b){if(typeof b!="undefined"&&"p" in b){return new RealType(d,b.p)}else{return new RealType(d)}};function RealType(b,d){if(arguments.length&&!(typeof b=="undefined")){this.init(b,d)}}RealType.prototype.mPrecision=6;RealType.prototype.init=function(d,b){if(typeof b=="number"){this.mPrecision=b}if(d instanceof Datatype){this.mValue=d.toReal()}else{if(typeof d=="string"){this.mValue=parseFloat(d);if(isNaN(this.mValue)){this.mValue=0}}else{this.mValue=d}}};RealType.prototype.set=function(b){if(this.mPrecision>0){this.mValue=Math.round(b*Math.pow(10,this.mPrecision))/Math.pow(10,this.mPrecision)}else{this.mValue=b}};RealType.prototype.type=3;RealType.prototype.isNull=false;RealType.prototype.toReal=function(){return this.mValue};RealType.prototype.toChar=function(){return En_USRealToLC(this.mValue.toFixed(this.mPrecision))};RealType.prototype.args=function(){return{p:this.mPrecision}};RealType.prototype.toString=function(){var b="";if(this.mValue>=1000000000||this.mValue<=-1000000000||(this.mValue>0&&this.mValue<0.000001)||(this.mValue<0&&this.mValue>-0.000001)){if(this.mValue<0){var o=-(this.mValue);b="-"+o.toExponential(this.mPrecision)}else{b=this.mValue.toExponential(this.mPrecision)}var h=new RegExp("^([+-]?\\d+)(\\.[1-9]*)0*([Ee][+-]?\\d+)$");b=b.replace(h,"$1$2$3");h=new RegExp("^(.*)\\.([Ee].*)$");b=b.replace(h,"$1$2");var d=b.length-1;while(d>0&&b.charAt(d)!="+"&&b.charAt(d)!="-"){d--}d++;var g=b.substring(0,d);var k=3-(b.length-d);for(var f=0;f<k;f++){g+="0"}g+=b.substr(d);b=g}else{b=this.mValue.toFixed(this.mPrecision)}return En_USRealToLC(b)};RealType.prototype.compareValStr=function(){return this.toString()};RealType.prototype.toPrimitive=function(){return this.mValue.toString()};RealType.prototype.ADD=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.set(f.toReal()+d.toReal());return this};RealType.prototype.SUB=function(f,d){if((!(((1<<7|1<<13|1<<14)&(1<<f.type))||(1<<0&(1<<f.type)))&&((1<<7|1<<13|1<<14)&(1<<d.type)))||(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))&&(f.type!=d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.set(f.toReal()-d.toReal());return this};RealType.prototype.MUL=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.mPrecision=9;this.set(f.toReal()*d.toReal());return this};RealType.prototype.DIV=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.mPrecision=9;if(d.toReal()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}this.set(f.toReal()/d.toReal());return this};RealType.prototype.MOD=function(f,d){if(!((1<<2&(1<<f.type))&&(1<<2&(1<<d.type)))&&!((1<<0&(1<<f.type))&&(((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))|(1<<6&(1<<d.type)))||((1<<4|1<<5)&(1<<d.type))))&&!((((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))|(1<<6&(1<<f.type)))||((1<<4|1<<5)&(1<<f.type)))&&(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(!(f instanceof IntegerType&&(d instanceof IntegerType||d instanceof NullType))){this.set(0)}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}this.set(f.toInteger()%d.toInteger())}return this};RealType.prototype.NEG=function(b){this.set(-b.toReal());return this};RealType.prototype.EQ=function(b){if(b.isNull){return false}return this.mValue==b.toReal()};RealType.prototype.NE=function(b){return !this.EQ(b)};RealType.prototype.GT=function(b){if(b.isNull){return false}return this.mValue>b.toReal()};RealType.prototype.GE=function(b){if(b.isNull){return false}return this.mValue>=b.toReal()};RealType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};RealType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};RealType.prototype.toDecimal=function(){var b=new DecimalType(this.mValue.toFixed(this.mPrecision));return b.toDecimal()};RealType.prototype.toInteger=function(){return new IntegerType(this.mValue).toInteger()};IntegerType.prototype=new Datatype();IntegerType.prototype.constructor=IntegerType;IntegerType.superclass=Datatype.prototype;DatatypeFactories[2]=function(b){return new IntegerType(b)};function IntegerType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}IntegerType.prototype.init=function(g){if(g instanceof Datatype){this.mValue=g.toInteger()}else{if(typeof g=="string"){var b=/([+-]?[0-9]*).*/;g=g.replace(b,"$1");var d=parseInt(g,10);if(d>2147483647){this.mValue=2147483647}else{if(d<-2147483647){this.mValue=-2147483647}else{this.mValue=d}}if(isNaN(this.mValue)){this.mValue=0}}else{if(typeof g=="number"){if(g<0){this.mValue=Math.ceil(g)}else{this.mValue=Math.floor(g)}}else{this.mValue=g}}}if(this.mValue<-2147483647){this.mValue=-2147483647}else{if(this.mValue>2147483647){this.mValue=2147483647}}};IntegerType.prototype.mOverflow=0;IntegerType.prototype.set=function(b){if(b<-2147483647){this.mOverflow=b-(-2147483647);b=-2147483647}else{if(b>2147483647){this.mOverflow=b-(2147483647);b=2147483647}else{this.mOverflow=0}}this.mValue=b};IntegerType.prototype.type=2;IntegerType.prototype.isNull=false;IntegerType.prototype.toInteger=function(){return this.mValue};IntegerType.prototype.toReal=function(){return this.mValue};IntegerType.prototype.toString=function(){return this.mValue.toString()};IntegerType.prototype.compareValStr=function(){return this.toString()};IntegerType.prototype.toPrimitive=function(){return this.mValue.toString()};IntegerType.prototype.ADD=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.ADD(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.ADD(f,d).toInteger())}else{this.set(f.toInteger()+d.toInteger())}}if(this.mOverflow!=0){return new DecimalType((this.toInteger()+this.mOverflow)+"")}return this};IntegerType.prototype.SUB=function(f,d){if((!(((1<<7|1<<13|1<<14)&(1<<f.type))||(1<<0&(1<<f.type)))&&((1<<7|1<<13|1<<14)&(1<<d.type)))||(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))&&(f.type!=d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.SUB(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.SUB(f,d).toInteger())}else{this.set(f.toInteger()-d.toInteger())}}if(this.mOverflow!=0){return new DecimalType((this.toInteger()+this.mOverflow)+"")}return this};IntegerType.prototype.MUL=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.MUL(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType){var g=new DecimalType(null);this.set(g.MUL(f,d).toInteger())}else{if(f instanceof CurrencyType||d instanceof CurrencyType){var g=new CurrencyType(null);this.set(g.MUL(f,d).toInteger())}else{this.set(f.toInteger()*d.toInteger())}}}if(this.mOverflow!=0){return new DecimalType((this.toInteger()+this.mOverflow)+"")}return this};IntegerType.prototype.DIV=function(f,d){if(((1<<7|1<<13|1<<14)&(1<<f.type))||((1<<7|1<<13|1<<14)&(1<<d.type))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.DIV(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType){var g=new DecimalType(null);this.set(g.DIV(f,d).toInteger())}else{if(f instanceof CurrencyType||d instanceof CurrencyType){var g=new CurrencyType(null);this.set(g.DIV(f,d).toInteger())}else{var g=(f.toInteger()/d.toInteger());if(g<0){this.set(Math.ceil(g))}else{this.set(Math.floor(g))}}}}if(this.mOverflow!=0){return new DecimalType((this.toInteger()+this.mOverflow)+"")}return this};IntegerType.prototype.MOD=function(f,d){if(!(((((1<<4|1<<5)&(1<<f.type))|(1<<0&(1<<f.type)))|(1<<6&(1<<f.type)))&&(((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))|(1<<6&(1<<d.type)))|((1<<4|1<<5)&(1<<d.type))))&&!((1<<2&(1<<f.type))&&(((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))|(1<<6&(1<<d.type)))|((1<<4|1<<5)&(1<<d.type))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))&&!(1<<2&(1<<d.type))){this.set(0)}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306)}this.set(f.toInteger()%d.toInteger())}return this};IntegerType.prototype.NEG=function(b){this.set(-b.toInteger());return this};IntegerType.prototype.EQ=function(b){if(b.isNull){return false}return this.mValue==b.toInteger()};IntegerType.prototype.NE=function(b){return !this.EQ(b)};IntegerType.prototype.GT=function(b){if(b.isNull){return false}return this.mValue>b.toInteger()};IntegerType.prototype.GE=function(b){if(b.isNull){return false}return this.mValue>=b.toInteger()};IntegerType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};IntegerType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};IntegerType.ZERO=new IntegerType(0);IntegerType.ONE=new IntegerType(1);TimeType.prototype=new Datatype();TimeType.prototype.constructor=TimeType;TimeType.superclass=Datatype.prototype;DatatypeFactories[7]=function(b){return new TimeType(b)};function TimeType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}TimeType.prototype.init=function(b){if(b instanceof Datatype){this.mValue=b.toTime().toInteger()}else{if(typeof b=="string"){if(b.isNumeric()){this.mValue=parseInt(b,10)}else{this.mValue=TimeType.getTimestamp(b)}}else{this.mValue=b}}this.set(this.mValue)};TimeType.prototype.set=function(b){if(b<0){b=0;this.valueAdjusted=true}else{if(b>2147483647){b=2147483647;this.valueAdjusted=true}}this.mValue=b};TimeType.prototype.type=7;TimeType.prototype.isNull=false;TimeType.prototype.valueAdjusted=false;TimeType.prototype.toInteger=function(){return this.mValue};TimeType.prototype.toDecimal=function(){return new IntegerType(this.toInteger()).toDecimal()};TimeType.prototype.toReal=function(){return this.mValue};TimeType.prototype.DisplayFormat=0;TimeType.prototype.setDisplayFormat=function(b){this.DisplayFormat=b};TimeType.prototype.getDisplayFormat=function(){return this.DisplayFormat};TimeType.prototype.toString=function(b){if(arguments.length<1){b=this.DisplayFormat}return TimeType.getDateTimeString(this.mValue,b)};TimeType.prototype.compareValStr=function(){return this.toString()};TimeType.prototype.toPrimitive=function(){return this.mValue.toString()};TimeType.prototype.toTOD=function(){var b=new ARDate();b.STimestamp(this.mValue);return new TODType(b.format(localeInfo.timeFormatPattern,7))};TimeType.prototype.toDate=function(){var b=new ARDate();b.STimestamp(this.mValue);return new DateType(b.format(localeInfo.dateFormatPattern,13))};TimeType.prototype.ADD=function(f,d){if(((((1<<7|1<<13|1<<14)&(1<<f.type))|(1<<13&(1<<f.type))|(1<<14&(1<<f.type)))&&d instanceof CharType)||((((1<<7|1<<13|1<<14)&(1<<d.type))|(1<<13&(1<<d.type))|(1<<14&(1<<d.type)))&&f instanceof CharType)){return new CharType(f.toString()+d.toString())}if(f instanceof CurrencyType||(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))&&(!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))||(1<<12&(1<<d.type))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<4|1<<5)&(1<<f.type))){f=f.toTime()}if(((1<<4|1<<5)&(1<<d.type))){d=d.toTime()}if(f instanceof DateKWType||d instanceof DateKWType||f instanceof TODKWType||d instanceof TODKWType){this.set(f.toInteger()+d.toInteger())}else{if(f instanceof DateType||d instanceof DateType){var g=new DateType(f.toInteger()+d.toInteger());this.set(g.toTime().toInteger())}else{if(f instanceof TODType||d instanceof TODType){var g=new TODType(f.toInteger()+d.toInteger());this.set(g.toTime().toInteger())}else{if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.ADD(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.ADD(f,d).toInteger())}else{this.set(f.toInteger()+d.toInteger())}}}}}return this};TimeType.prototype.SUB=function(f,d){if(((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))||(1<<13&(1<<f.type))||(1<<14&(1<<f.type)))&&!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type))))||(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))&&(1<<12&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<4|1<<5)&(1<<f.type))){f=f.toTime()}if(((1<<4|1<<5)&(1<<d.type))){d=d.toTime()}if(f instanceof DateKWType||d instanceof DateKWType||f instanceof TODKWType||d instanceof TODKWType){this.set(f.toInteger()-d.toInteger())}else{if(f instanceof DateType){var g=new DateType(f.toInteger()-d.toInteger());this.set(g.toTime().toInteger())}else{if(f instanceof TODType){var g=new TODType(f.toInteger()-d.toInteger());this.set(g.toTime().toInteger())}else{if(f instanceof RealType||(!(f instanceof TimeType)&&(d instanceof RealType))){var g=new RealType(0);this.set(g.SUB(f,d).toInteger())}else{if((f instanceof DecimalType||(!(f instanceof TimeType)&&(d instanceof DecimalType)))||(f instanceof CurrencyType||(!(f instanceof TimeType)&&(d instanceof CurrencyType)))){var g=new DecimalType(null);this.set(g.SUB(f,d).toInteger())}else{if(f instanceof TimeType&&d instanceof TimeType){this.set(f.toInteger()-d.toInteger());return new IntegerType(this.toInteger())}else{if(f instanceof CharType){f=f.toTime()}this.set(f.toInteger()-d.toInteger())}}}}}}return this};TimeType.prototype.MOD=function(f,d){if(!(((1<<2&(1<<f.type))||(1<<0&(1<<f.type)))&&((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if((f instanceof IntegerType||f instanceof NullType)&&(d instanceof IntegerType||d instanceof NullType)){if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.set(f.toInteger()%d.toInteger())}else{this.set(0)}return this};TimeType.prototype.MUL=function(f,d){if(!((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))||((1<<7|1<<13|1<<14)&(1<<f.type)))||!((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))||((1<<7|1<<13|1<<14)&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.MUL(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.MUL(f,d).toInteger())}else{this.set(f.toInteger()*d.toInteger())}}return this};TimeType.prototype.DIV=function(f,d){if(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))||!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.DIV(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.DIV(f,d).toInteger())}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.set(Math.floor(f.toInteger()/d.toInteger()))}}return this};TimeType.prototype.EQ=function(b){if(b.type==4){b=b.toTime()}if(b.isNull){return false}if((b.type!=7)&&(b.type!=2)&&(b.type!=14)&&(b.type!=13)){return false}return this.mValue==b.toTime().toInteger()};TimeType.prototype.NE=function(b){return !this.EQ(b)};TimeType.prototype.GT=function(b){if(b.isNull){return false}if(!(b instanceof TimeType)&&!(b instanceof IntegerType)&&!(b instanceof TODType)&&!(b instanceof DateType)){return false}return this.mValue>b.toTime().toInteger()};TimeType.prototype.GE=function(b){if(b.isNull){return false}if(!(b instanceof TimeType)&&!(b instanceof IntegerType)&&!(b instanceof TODType)&&!(b instanceof DateType)){return false}return this.mValue>=b.toTime().toInteger()};TimeType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};TimeType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};TimeType.getTimestamp=function(f){var d=-1;var b=ARDate.parseDateTime(f);if(b==null){b=ARDate.parseDate(f)}if(b!=null){d=b.GTimestamp();if(d>=0&&d<=2147483647){return d}}d=LCDecimalToEn_US(f,false);if(d==0){d=parseFloat(f)}d=parseInt(d);if(isNaN(d)){d=-1}return d};TimeType.getDateTimeString=function(f,h){var d=parseFloat(f);d=parseInt(d);if(isNaN(d)){return""}if(d<0){d=0}if(d>2147483647){d=2147483647}var b=new ARDate();b.STimestamp(d);var g;if(h==2){g=localeInfo.dateFormatPattern}else{if(h==1){g=localeInfo.timeFormatPattern}else{g=localeInfo.dateFormatPattern+" "+localeInfo.timeFormatPattern}}return b.format(g,7)};DateType.prototype=new Datatype();DateType.prototype.constructor=DateType;DateType.superclass=Datatype.prototype;DatatypeFactories[13]=function(b){if(typeof b=="object"&&b.type==14&&!(b instanceof TODKWType)){return Null}return new DateType(b)};function DateType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}DateType.prototype.init=function(b){if(b instanceof Datatype){this.mValue=b.toDate().toInteger()}else{if(typeof b=="string"){if(b.isNumeric()){this.mValue=parseInt(b,10)}else{this.mValue=DateType.getDays(b)}}else{this.mValue=b}}this.set(this.mValue)};DateType.prototype.set=function(b){if(b<0){b=0;this.valueAdjusted=true}else{if(b>5373120){b=5373120;this.valueAdjusted=true}}this.mValue=b};DateType.prototype.type=13;DateType.prototype.isNull=false;DateType.prototype.valueAdjusted=false;DateType.prototype.toString=function(){return DateType.getDateString(this.mValue)};DateType.prototype.compareValStr=function(){return this.toString()};DateType.prototype.toInteger=function(){return this.mValue};DateType.prototype.toDecimal=function(){return new IntegerType(this.toInteger()).toDecimal()};DateType.prototype.toReal=function(){return this.mValue};DateType.prototype.toTOD=function(){return Null};DateType.prototype.toTime=function(){var d=ARDate.getDateObject(this.mValue);var b=d.GTimestamp();if(b<0){b=0}return new TimeType(b)};DateType.prototype.toPrimitive=function(){return this.mValue.toString()};DateType.prototype.ADD=function(f,d){if(f instanceof CurrencyType||f instanceof TODType||d instanceof TODType||(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))&&(!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))||(1<<12&(1<<d.type))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<4|1<<5)&(1<<f.type))){f=f.toDate()}if(((1<<4|1<<5)&(1<<d.type))){d=d.toDate()}if(f instanceof TimeType||d instanceof TimeType){var g=new TimeType(f.toInteger()+d.toInteger());this.set(g.toDate().toInteger())}else{if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.ADD(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.ADD(f,d).toInteger())}else{this.set(f.toInteger()+d.toInteger())}}}return this};DateType.prototype.SUB=function(f,d){if((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))&&!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type))))||(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))&&(1<<12&(1<<d.type)))||((f instanceof DateType)&&(d instanceof DateType))||(1<<14&(1<<f.type))||(1<<14&(1<<d.type))||(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type))&&!((1<<13&(1<<f.type))&&(1<<13&(1<<d.type))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<4|1<<5)&(1<<f.type))){f=f.toDate()}if(((1<<4|1<<5)&(1<<d.type))){d=d.toDate()}if(f instanceof TimeType){if(d instanceof TimeType){this.set(f.toDate().toInteger()-d.toDate().toInteger())}else{var g=new TimeType(f.toInteger()-d.toInteger());this.set(g.toDate().toInteger())}}else{if(f instanceof RealType||(!(f instanceof DateType)&&(d instanceof RealType))){var g=new RealType(0);this.set(g.SUB(f,d).toInteger())}else{if((f instanceof DecimalType||(!(f instanceof DateType)&&(d instanceof DecimalType)))||(f instanceof CurrencyType||(!(f instanceof DateType)&&(d instanceof CurrencyType)))){var g=new DecimalType(null);this.set(g.SUB(f,d).toInteger())}else{if(f instanceof DateType&&d instanceof DateType){this.set(f.toInteger()-d.toInteger());return new IntegerType(this.toInteger())}else{if(f instanceof CharType){f=f.toDate()}this.set(f.toInteger()-d.toInteger())}}}}return this};DateType.prototype.MOD=function(f,d){if(!(((1<<2&(1<<f.type))||(1<<0&(1<<f.type)))&&((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if((f instanceof IntegerType||f instanceof NullType)&&(d instanceof IntegerType||d instanceof NullType)){if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.set(f.toInteger()%d.toInteger())}else{this.set(0)}return this};DateType.prototype.MUL=function(f,d){if(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))||!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.MUL(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.MUL(f,d).toInteger())}else{this.set(f.toInteger()*d.toInteger())}}return this};DateType.prototype.DIV=function(f,d){if(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))||!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.DIV(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.DIV(f,d).toInteger())}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.set(Math.floor(f.toInteger()/d.toInteger()))}}return this};DateType.prototype.EQ=function(b){if(b.type==4){b=b.toDate()}if(b.isNull){return false}if((b.type!=7)&&(b.type!=2)&&(b.type!=14)&&(b.type!=13)){return false}return this.mValue==b.toDate().toInteger()};DateType.prototype.NE=function(b){return !this.EQ(b)};DateType.prototype.GT=function(b){if(b.isNull){return false}if(!(b instanceof TimeType)&&!(b instanceof IntegerType)&&!(b instanceof TODType)&&!(b instanceof DateType)){return false}return this.mValue>b.toDate().toInteger()};DateType.prototype.GE=function(b){if(b.isNull){return false}if(!(b instanceof TimeType)&&!(b instanceof IntegerType)&&!(b instanceof TODType)&&!(b instanceof DateType)){return false}return this.mValue>=b.toDate().toInteger()};DateType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};DateType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};DateType.prototype.ADDWEEKS=function(b){return this.ADD(this,new IntegerType(7*b.toInteger()))};DateType.prototype.ADDMONTHS=function(f){var h=ARDate.getDateObject(this.toInteger());f=f.toInteger();var g;if(f<0){g=h.GYear()-Math.floor(-f/12)}else{g=Math.floor(f/12)+h.GYear()}var d=(f%12)+h.GMonth();if(d>12){g+=1;d=(d%12)}else{if(d<1){g-=1;d+=12}}var k=h.GDate();var b=ARDate.getDaysInMonth(d,g);if(k>b){k=b}h=new ARDate(g,d,k,h.GHour(),h.GMinute(),h.GSecond());this.set(h.GDays());return this};DateType.prototype.ADDYEARS=function(b){var d=ARDate.getDateObject(this.toInteger());d=new ARDate(d.GYear()+b.toInteger(),d.GMonth(),d.GDate(),d.GHour(),d.GMinute(),d.GSecond());this.set(d.GDays());return this};DateType.getDays=function(f){var d=-1;var b=ARDate.parseDate(f);if(b!=null){d=b.GDays();if(d>=0&&d<=5373120){return d}}var g=ARDate.parseTime(f);if(g!=null){return(new DateKWType()).mValue}d=LCDecimalToEn_US(f,false);if(d==0){d=parseFloat(f)}d=parseInt(d);if(isNaN(d)){d=-1}return d};DateType.getDateString=function(f){var d=parseFloat(f);d=parseInt(d);if(isNaN(d)){return""}if(d<0){d=0}if(d>5373120){d=5373120}var b=new ARDate();b.SDays(d);return b.format(localeInfo.dateFormatPattern,13)};TODType.prototype=new Datatype();TODType.prototype.constructor=TODType;TODType.superclass=Datatype.prototype;DatatypeFactories[14]=function(b){if(typeof b=="object"&&b.type==13&&!(b instanceof DateKWType)){return Null}return new TODType(b)};function TODType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}TODType.prototype.init=function(b){if(b instanceof Datatype){this.mValue=b.toTOD().toInteger()}else{if(typeof b=="string"){this.mValue=(b.isNumeric())?parseInt(b,10):TODType.convertStringToTime(b)}else{this.mValue=b}}this.set(this.mValue)};TODType.prototype.set=function(b){if(b<0){b=0;this.valueAdjusted=true}else{if(b>86399){b=86399;this.valueAdjusted=true}}this.mValue=b};TODType.prototype.type=14;TODType.prototype.isNull=false;TODType.prototype.valueAdjusted=false;TODType.prototype.getTimeObj=function(){var f=Math.floor(this.mValue/3600);var b=Math.floor((this.mValue-(f*3600))/60);var d=Math.floor((this.mValue-(f*3600))-(b*60));return{h:f,m:b,s:d}};TODType.prototype.toTime=function(){return new TimeType(this.toString())};TODType.prototype.toDate=function(){return Null};TODType.prototype.toInteger=function(){return this.mValue};TODType.prototype.toDecimal=function(){return new IntegerType(this.toInteger()).toDecimal()};TODType.prototype.toReal=function(){return this.mValue};TODType.prototype.toString=function(){return TODType.convertNumberToTime(this.mValue)};TODType.prototype.compareValStr=function(){return this.toString()};TODType.prototype.toPrimitive=function(){return this.mValue.toString()};TODType.prototype.ADD=function(f,d){if(f instanceof CurrencyType||f instanceof DateType||d instanceof DateType||(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))&&(!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))||(1<<12&(1<<d.type))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<4|1<<5)&(1<<f.type))){f=f.toTOD()}if(((1<<4|1<<5)&(1<<d.type))){d=d.toTOD()}if(f instanceof TimeType||d instanceof TimeType){var g=new TimeType(f.toInteger()+d.toInteger());this.set(g.toTOD().toInteger())}else{if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.ADD(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.ADD(f,d).toInteger())}else{this.set(f.toInteger()+d.toInteger())}}}return this};TODType.prototype.SUB=function(f,d){if((((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))&&!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type))))||(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))&&(1<<12&(1<<d.type)))||((1<<13&(1<<f.type))||(1<<13&(1<<d.type)))||(((1<<7|1<<13|1<<14)&(1<<f.type))&&((1<<7|1<<13|1<<14)&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(((1<<4|1<<5)&(1<<f.type))){f=f.toTOD()}if(((1<<4|1<<5)&(1<<d.type))){d=d.toTOD()}if(f instanceof TimeType){if(d instanceof TimeType){this.set(f.toTOD().toInteger()-d.toTOD().toInteger())}else{var g=new TimeType(f.toInteger()-d.toInteger());this.set(g.toTOD().toInteger())}}else{if(f instanceof RealType||(!(f instanceof TODType)&&(d instanceof RealType))){var g=new RealType(0);this.set(g.SUB(f,d).toInteger())}else{if((f instanceof DecimalType||(!(f instanceof TODType)&&(d instanceof DecimalType)))||(f instanceof CurrencyType||(!(f instanceof TODType)&&(d instanceof CurrencyType)))){var g=new DecimalType(null);this.set(g.SUB(f,d).toInteger())}else{if(f instanceof CharType){f=f.toTOD()}this.set(f.toInteger()-d.toInteger())}}}return this};TODType.prototype.MOD=function(f,d){if(!(((1<<2&(1<<f.type))||(1<<0&(1<<f.type)))&&((((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if((f instanceof IntegerType||f instanceof NullType)&&(d instanceof IntegerType||d instanceof NullType)){if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.set(f.toInteger()%d.toInteger())}else{this.set(0)}return this};TODType.prototype.MUL=function(f,d){if(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))||!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.MUL(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.MUL(f,d).toInteger())}else{this.set(f.toInteger()*d.toInteger())}}return this};TODType.prototype.DIV=function(f,d){if(!(((1<<2|1<<3|1<<10|1<<12)&(1<<f.type))|(1<<0&(1<<f.type)))||!(((1<<2|1<<3|1<<10|1<<12)&(1<<d.type))|(1<<0&(1<<d.type)))){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}if(f instanceof RealType||d instanceof RealType){var g=new RealType(0);this.set(g.DIV(f,d).toInteger())}else{if(f instanceof DecimalType||d instanceof DecimalType||f instanceof CurrencyType||d instanceof CurrencyType){var g=new DecimalType(null);this.set(g.DIV(f,d).toInteger())}else{if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.set(Math.floor(f.toInteger()/d.toInteger()))}}return this};TODType.prototype.EQ=function(b){if(b.type==4){b=b.toTOD(b)}if(b.isNull){return false}if((b.type!=14)&&(b.type!=2)&&(b.type!=7)){return false}var d=b.toTOD().toInteger();return this.mValue==d};TODType.prototype.NE=function(b){return !this.EQ(b)};TODType.prototype.GT=function(b){if(b.isNull){return false}if(!(b instanceof TODType)&&!(b instanceof IntegerType)&&!(b instanceof TimeType)){return false}var d=b.toTOD().toInteger();return this.mValue>d};TODType.prototype.GE=function(b){if(b.isNull){return false}if(!(b instanceof TODType)&&!(b instanceof IntegerType)&&!(b instanceof TimeType)){return false}var d=b.toTOD().toInteger();return this.mValue>=d};TODType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};TODType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};TODType.convertStringToTime=function(f){var d=-1;var b=ARDate.parseTime(f);if(b!=null){d=b.GTimeOfDay()}else{d=parseFloat(f);d=parseInt(d);if(isNaN(d)){d=-1}}return d};TODType.convertNumberToTime=function(g){var d=parseFloat(g);d=parseInt(g);if(isNaN(d)){return""}if(d<0){d=0}if(d>86399){d=86399}var b=new ARDate();var f=d%60;b.SSecond(f);b.SMinute(((d-f)%3600)/60);b.SHour(Math.floor(d/3600));return b.format(localeInfo.timeFormatPattern,14)};TODType.convertToTime=function(h,f,g,b){var d=localeInfo.timeSeparator;return h+d+f+d+g};EnumType.prototype=new Datatype();EnumType.prototype.constructor=EnumType;EnumType.superclass=Datatype.prototype;DatatypeFactories[6]=function(k,b){if(typeof b!="undefined"&&"l" in b){return new EnumType(k,b.l)}if(k instanceof Datatype){if(k.type!=4){return new EnumType(k)}k=k.toString()}var g=/^([0-9]+) (.*)$/;if(g.test(k)){return new EnumType(k.replace(g,"$1"),k.replace(g,"$2"))}if(typeof k=="string"){if(typeof b!="undefined"&&"el" in b){var d=b.el;for(i in d){if(k==d[i]){return new EnumType(i,k)}}}var h=parseFloat(k);k=parseInt(h);if(isNaN(k)){return Null}}return new EnumType(k)};function EnumType(f,d){if(arguments.length&&!(typeof f=="undefined")){this.init(f,d)}}EnumType.prototype.init=function(b,d){if(b instanceof Datatype){this.mValue=b.toInteger()}else{if(typeof b=="string"){var g=parseFloat(b);this.mValue=parseInt(g);if(isNaN(this.mValue)){this.mValue=0}}else{this.mValue=b}}this.mLabel=d};EnumType.prototype.type=6;EnumType.prototype.isNull=false;EnumType.prototype.toInteger=function(){return this.mValue};EnumType.prototype.toReal=function(){return this.mValue};EnumType.prototype.toDecimal=function(){return new BigDecimal(""+this.mValue)};EnumType.prototype.toString=function(){if(typeof this.mLabel=="undefined"){return this.mValue.toString()}return this.mLabel.HTMLDecode()};EnumType.prototype.compareValStr=function(){return this.mValue.toString()};EnumType.prototype.toTime=function(){if(this.toString().isNumeric()||ARDate.parseDateTime(this.toString())!=null){return new TimeType(this.toString())}else{return new TimeType(this.toInteger())}};EnumType.prototype.toDate=function(){if(this.toString().isNumeric()||ARDate.parseDate(this.toString())!=null){return new DateType(this.toString())}else{return new DateType(this.toInteger())}};EnumType.prototype.toTOD=function(){if(this.toString().isNumeric()||ARDate.parseTime(this.toString())!=null){return new TODType(this.toString())}else{return new TODType(this.toInteger())}};EnumType.prototype.toPrimitive=function(){var b;if(typeof this.mLabel=="undefined"){b=this.mValue}else{b=this.mLabel.HTMLDecode()}return this.mValue+" "+b};EnumType.prototype.args=function(){if(typeof this.mLabel=="undefined"){return{}}else{return{l:this.mLabel.HTMLDecode()}}};EnumType.prototype.EQ=function(b){if(b.isNull){return false}if(b.type==4){var d=b.toString();if(this.mLabel.HTMLDecode()==d){return true}else{return false}}return this.mValue==b.toInteger()};EnumType.prototype.NE=function(b){return !this.EQ(b)};EnumType.prototype.GT=function(b){if(b.isNull){return false}return this.mValue>b.toInteger()};EnumType.prototype.GE=function(b){if(b.isNull){return false}return this.mValue>=b.toInteger()};EnumType.prototype.LT=function(b){if(b.isNull){return false}return !this.GE(b)};EnumType.prototype.LE=function(b){if(b.isNull){return false}return !this.GT(b)};EnumType.prototype.ADD=function(f,d){if((f instanceof EnumType||f instanceof IntegerType||f instanceof NullType)&&(d instanceof EnumType||d instanceof IntegerType||d instanceof NullType)){this.mValue=f.toInteger()+d.toInteger();return this}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}};EnumType.prototype.SUB=function(f,d){if((f instanceof EnumType||f instanceof IntegerType||f instanceof NullType)&&(d instanceof EnumType||d instanceof IntegerType||d instanceof NullType)){var g=f.toInteger()-d.toInteger();if(g<0){getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}this.mValue=g;return this}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}};EnumType.prototype.MUL=function(f,d){if((f instanceof EnumType||f instanceof IntegerType||f instanceof NullType)&&(d instanceof EnumType||d instanceof IntegerType||d instanceof NullType)){this.mValue=f.toInteger()*d.toInteger();return this}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}};EnumType.prototype.DIV=function(f,d){if((f instanceof EnumType||f instanceof IntegerType||f instanceof NullType)&&(d instanceof EnumType||d instanceof IntegerType||d instanceof NullType)){if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.mValue=Math.floor(f.toInteger()/d.toInteger());return this}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}};EnumType.prototype.MOD=function(f,d){if((f instanceof EnumType||f instanceof IntegerType||f instanceof NullType)&&(d instanceof EnumType||d instanceof IntegerType||d instanceof NullType)){if(d.toInteger()==0){getCurWFC_NS(getCurrentWindowID_NS()).status(9306);return}this.mValue=f.toInteger()%d.toInteger();return this}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9339);return}};StatusHistoryType.prototype=new CharType();StatusHistoryType.prototype.constructor=StatusHistoryType;StatusHistoryType.superclass=CharType.prototype;function StatusHistoryType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}StatusHistoryType.prototype.part=function(b,f){var d=this.GetArray();if(b>=0&&b<d.length){if(f==2){return(d[b].t==null)?Null:new TimeType(d[b].t)}else{return(d[b].u==null)?Null:new CharType(d[b].u)}}return Null};StatusHistoryType.prototype.compound=function(f){if(f.length!=2){return null}var d=f[0].toUpperCase();if(d=="TIME"){d=2}else{if(d=="USER"){d=1}else{if(d.isDigits()){d=parseInt(d)}else{return null}}}if(d!=1&&d!=2){return null}var b;if(f[1].isDigits()){b=parseInt(f[1])}else{for(b=0;b<getStatusEnumInfo_NS(getCurrentWindowID_NS()).length;++b){if(f[1]==getStatusEnumInfo_NS(getCurrentWindowID_NS())[b].m){break}}}if(b<0||b>=getStatusEnumInfo_NS(getCurrentWindowID_NS()).length){return null}return this.part(b,d)};StatusHistoryType.prototype.GetArray=function(){if(this.mValue==null){return[]}var g=this.mValue.split("\03");var f=new Array();for(var d=0;d<getStatusEnumInfo_NS(getCurrentWindowID_NS()).length;++d){if(g[d]){var b=g[d].split("\04");if(b.length==2){f.push({t:b[0],u:b[1]});continue}}f.push({t:null,u:null})}return f};StatusHistoryType.prototype.GetTable=function(){var f=this.GetArray();var d=[[getLocalizedMessage("Status"),getLocalizedMessage("Modified Time"),getLocalizedMessage("Modified By")]];for(var b=0;b<f.length;++b){d[b+1]=[getStatusEnumInfo_NS(getCurrentWindowID_NS())[b].l,(f[b].t==null)?"":new TimeType(f[b].t).toString(),(f[b].u==null)?"":f[b].u]}return d};StatusHistoryType.prototype.toReal=function(){return new RealType(this.toInteger()).toReal()};StatusHistoryType.prototype.toDecimal=function(){return new IntegerType(this.toInteger()).toDecimal()};AttachmentType.prototype=new Datatype();AttachmentType.prototype.constructor=AttachmentType;AttachmentType.superclass=Datatype.prototype;DatatypeFactories[11]=function(d,b){return new AttachmentType(d)};function AttachmentType(b){if(arguments.length){this.init(b)}}AttachmentType.NO_SCREEN_TYPE_PAT=/^1\/0/;AttachmentType.WITH_SCREEN_KEY_PREFIX="1/1";AttachmentType.prototype.init=function(k){AttachmentType.superclass.init.call(this);this.mOrigSize=this.mFileName="";this.mValue=this.mDataKey="";if(k instanceof AttachmentType){if(k.isNull){this.isNull=true}else{this.mValue=k.mValue;this.mOrigSize=k.mOrigSize;this.mFileName=k.mFileName;this.mDataKey=k.mDataKey}}else{if(k instanceof Datatype){var d=k.toAttach();if(d.isNull){this.isNull}else{this.mValue=d.mValue;this.mOrigSize=d.mOrigSize;this.mFileName=d.mFileName;this.mDataKey=d.mDataKey}}else{if(typeof k=="string"){try{var g=k.indexOf("/");if(g<=0){throw f}var b=parseInt(k.substring(0,g));if(b<=1){throw f}this.mDataKey=k.substr(++g,b);g+=b;var h=k.indexOf("/",g);b=parseInt(k.substring(g,h));if(b<=0){throw f}this.mOrigSize=k.substr(++h,b);g=h+b;h=k.indexOf("/",g);b=parseInt(k.substring(g,h));if(b<=0){throw f}this.mFileName=k.substr(++h,b);if(this.mDataKey.charAt(2)=="0"){this.mDataKey=this.mDataKey.replace(AttachmentType.NO_SCREEN_TYPE_PAT,AttachmentType.WITH_SCREEN_KEY_PREFIX);this.mDataKey+=window.name.length+"/"+window.name;this.mValue=this.mDataKey.length+"/"+this.mDataKey;this.mValue+=this.mOrigSize.length+"/"+this.mOrigSize;this.mValue+=this.mFileName.length+"/"+this.mFileName}else{this.mValue=k}}catch(f){this.isNull=true}}else{this.isNull=true}}}};AttachmentType.prototype.toChar=function(){return this.toString()};AttachmentType.prototype.toString=function(){return this.mFileName};AttachmentType.prototype.compareValStr=function(){return this.toString()};AttachmentType.prototype.toAttach=function(){return this};AttachmentType.prototype.toURL=function(){return new CharType(JAttachment.getURL(this.mDataKey))};AttachmentType.prototype.toPrimitive=function(){return this.mValue};AttachmentType.prototype.EQ=function(d){if(d.isNull){return false}var b=this.mFileName;var f=d.toChar();if(b==null||f==null){return(b==null&&f==null)}return b.localeCompare(f)==0};AttachmentType.prototype.NE=function(b){return !this.EQ(b)};AttachmentType.prototype.GT=function(d){var b=this.mFileName;var f=d.toChar();if(b==null||f==null){return(b==null&&f==null)}return b.localeCompare(f)>0};AttachmentType.prototype.LT=function(d){var b=this.mFileName;var f=d.toChar();if(b==null||f==null){return(b==null&&f==null)}return b.localeCompare(f)<0};AttachmentType.prototype.GE=function(d){var b=this.mFileName;var f=d.toChar();if(b==null||f==null){return(b==null&&f==null)}return b.localeCompare(f)>=0};AttachmentType.prototype.LE=function(d){var b=this.mFileName;var f=d.toChar();if(b==null||f==null){return(b==null&&f==null)}return b.localeCompare(f)<=0};AttachmentType.prototype.LIKE=function(d){var b=this.mFileName;var h=d.toChar();if(b==null||h==null){return false}h=h.replace(/(%)|(_)|(\[.*\])|([.$^+?*{()\\\/|[\]])/gm,function(k,v,u,s,o){if(v){return".*"}else{if(u){return"."}else{if(s){return s}else{if(o){return"\\"+o}}}}});try{var g=new RegExp("^"+h+"$")}catch(f){return false}return b.match(g)!=null};AttachmentType.prototype.type=11;AttachmentType.prototype.isNull=false;AttachmentType.getKey=function(g,h,v,f){var d=[];var b=F(f,1).G();if(g=="3"&&h>=3000000&&h<=3999999){b=Null}var k="";if((window.name).isNumeric()){k="S"+window.name}else{k=window.name}var s=["1",ARKWGetStringByIdx(f,7),ARKWGetStringByIdx(f,6),b.IsNull?"":b.toString(),h+"",k];for(var z in s){d.push(s[z].length);d.push("/");d.push(s[z])}var y=d.join("");var u=[];u.push(g.length);u.push("/");u.push(g);u.push(y.length);u.push("/");u.push(y);if(g=="4"&&v){var w=v.length+"";u.push(w.length);u.push("/");u.push(w);for(var z in v){var h=v[z];var o=h+"";u.push(o.length);u.push("/");u.push(o)}}return u.join("")};AttachmentType.getKeyForCurrentField=function(d,b){return AttachmentType.getKey("3",d,null,b)};AttachmentType.getKeyForPoolField=function(d,f,b){return AttachmentType.getKey("4",d,f,b)};AttachmentType.prototype.toCurrency=function(b){return new CurrencyType(this.toString(),b,true)};function getDocument(){return document}function getBody(){return document.body}function getDocumentSelection(){return document.selection}function Field_FromElement(g){var f=document.body;while(g&&g!=f){if(g.nodeType==1){if(g.getAttribute("arstop")=="1"){return null}var d=g.getAttribute("arid");if(d){var b=""+g.getAttribute("arwindowid");if(!isNaN(b)){return getFields_NS(parseInt(b))[d]}}}g=g.parentNode}return null}function Window_FromElement(f){var d=document.body;while(f&&f!=d){if(f.nodeType==1){var b=""+f.getAttribute("arwindowid");if(!isNaN(b)){return parseInt(b)}}f=f.parentNode}return 0}Field.prototype.constructor=Field;var DOMFieldFactories={};var JFieldFactories={};var TPAFieldFactories={};function Field_Unload(b){var f=getFields_NS(b);for(var d in f){var g=f[d];g.Unload()}}Field.prototype.mCFCache=new CFCacheObj();function CFCacheObj(b){if(arguments.length){for(var d in b){this[d]=b[d]}}}CFCacheObj.prototype.a=2;CFCacheObj.prototype.l="";CFCacheObj.prototype.c="inherit";CFCacheObj.prototype.f="f1";CFCacheObj.prototype.v=true;CFCacheObj.prototype.m=null;CFCacheObj.prototype.drag=false;CFCacheObj.prototype.drop=false;CFCacheObj.prototype.o=2;Field.mMinWidth=20;Field.mMinHeight=20;function Field(b,f,d){if(arguments.length){this.init(b,f,d)}}Field.prototype.init=function(b,s,k){this.windowID=b;this.mID=s;this.mObj=k;this.mLayoutFields={};this.mFlashInit=false;if(!this.mDOMField&&k!=null&&(!("v" in k))){this.mObj.v=Null;this.mObj.windowID=b}if(s==0){return}this.mCFCache=new CFCacheObj(getDefaults_NS(this.windowID)[s]);getFields_NS(this.windowID)[s]=this;if(this.mID>=1000000&&this.mID<=1999999){this.ReadGlobalData()}this.perWidth=100;this.perHeight=0;this.mHasChildFields=false;this.mFillModel=null;this.mMinWidth=Field.mMinWidth;this.mMaxWidth=32767;this.mMinHeight=Field.mMinHeight;this.mMaxHeight=32767;this.mAutoSizeHeight=false;this.mAutoSizeWidth=false;this.mAllowAutoResize=true;this.mIFrame=null;if(!this.mDOMField){if(!("mDCF" in this)){if(this.mObj&&"dcf" in this.mObj){if(this.mObj.dcf==1){this.mDCF=true}}}return}this.mObj.setAttribute("arwindowid",b);var g=this.mObj.getAttribute("arcontainerid");var h=this.mObj.getAttribute("arflowid");if(h!=null){this.mFlowID=parseInt(h);if(this.mObj.style.visibility!="hidden"&&this.mObj.style.display!="none"){if(h==0){getVUILayoutModel_NS(this.windowID).RegisterLayoutField(this,false);this.setLayoutAttributes()}}}if(g!=null){this.mContainerID=parseInt(g);this.mObj.style.position="relative";this.mObj.style.top="auto";this.mObj.style.left="auto";if(this.mObj.style.visibility!="hidden"&&this.mObj.style.display!="none"){if(this.mContainerID!=0){getFields_NS(this.windowID)[this.mContainerID].RegisterLayoutField(this,false)}else{getVUILayoutModel_NS(this.windowID).RegisterLayoutField(this,false)}this.setLayoutAttributes()}}else{if(this.mFloat==2){var o=this.mObj.getAttribute("arminwidth");var f=this.mObj.getAttribute("arminheight");if(o!=null){this.mMinWidth=parseInt(o);if(this.mMinWidth<Field.mMinWidth){this.mMinWidth=Field.mMinWidth}this.mResize=true}if(f!=null){this.mMinHeight=parseInt(f);if(this.mMinHeight<Field.mMinHeight){this.mMinHeight=Field.mMinHeight}this.mResize=true}}else{if(h!=null&&h>0&&this.mObj.getAttribute("arautofit")==1){this.mObj.style.top="auto";this.mObj.style.left="auto";var d=this.mObj.getAttribute("arminheight");if(d==null){this.mMinHeight=parseInt(this.mObj.style.height)}if(this.mObj.style.visibility!="hidden"&&this.mObj.style.display!="none"){getFields_NS(this.windowID)[parseInt(h)].RegisterLayoutField(this,false)}}}}};Field.prototype.setLayoutAttributes=function(){this.perWidth=parseInt(this.mObj.getAttribute("arpercentwidth"));this.perHeight=parseInt(this.mObj.getAttribute("arpercentheight"));if(this.mObj.getAttribute("arminwidth")!=null){this.mMinWidth=parseInt(this.mObj.getAttribute("arminwidth"))}if(this.mObj.getAttribute("armaxwidth")!=null){this.mMaxWidth=parseInt(this.mObj.getAttribute("armaxwidth"))}if(this.mObj.getAttribute("arminheight")!=null){this.mMinHeight=parseInt(this.mObj.getAttribute("arminheight"))}if(this.mObj.getAttribute("armaxheight")!=null){this.mMaxHeight=parseInt(this.mObj.getAttribute("armaxheight"))}};Field.prototype.SaveGlobalData=function(){if(this.mID>=1000000&&this.mID<=1999999){this.SetCookieValue()}};Field.prototype.GetCookieValue=function(){var b=DeserializeGlobals("GF");if(b!=null&&this.mID in b){return Datatype_Factory(b[this.mID])}return null};Field.prototype.SetCookieValue=function(){var b=DeserializeGlobals("GF");b[this.mID]=this.SerializeVal();SerializeGlobals(this.windowID,"GF",b);wm.lasttimeCookieUpdated=(new Date()).getTime();FieldList.SetGlobalFieldsforOtherWindows(0,this.mID)};Field.prototype.ReadGlobalData=function(){if(this.mID>=1000000&&this.mID<=1999999){if(!("mDCF" in this)){this.mDCF=(this.mDOMField)?(this.mObj.getAttribute("ardcf")!=null):((this.mObj&&"dcf" in this.mObj)?(this.mObj.dcf==1):false)}var b=this.GetCookieValue();if(b!=null){if(b.type!=this.G().type||b.toPrimitive()!=this.G().toPrimitive()||(this.mDOMField&&this.mHaveStoredData&&b.toString()!=this.GetScreenValAsPrimitive())){this.DoSet(b)}}}};Field.prototype.SerializeVal=function(){var b=this.G();if("args" in b){return{t:b.type,v:b.toPrimitive(),a:b.args()}}else{return{t:b.type,v:b.toPrimitive()}}};Field.prototype.DeserializeVal=function(b){this.S(Datatype_Factory(b))};Field.prototype.G=function(){return Null};Field.prototype.encrypt=function(){return this.G()};Field.prototype.GTrim=function(){return this.G()};Field.prototype.GP=function(){return Null};Field.prototype.IsNullKeyword=function(){if("GetScreenValAsPrimitive" in this){var b=this.GetScreenValAsPrimitive();if(typeof b!="undefined"&&b!=null&&b!=""){var d={hasKeyword:false,hasTemporalKeyword:false};b=ExpandString(this.windowID,b,2|4,this.mID,this.mDataType,d);if(d.hasKeyword&&b==""){return true}}}return false};Field.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}return this.G()};Field.GetQBEOperator=function(d){var b=/^(\<\=|\>\=|\=|!\=|\<\>|\<|\>)(.*)/;if(b.test(d)){return d.replace(b,"$1")}return null};Field.prototype.SLoadEntry=function(b){this.DoSLoadEntry(b);this.SaveGlobalData()};Field.prototype.DoSLoadEntry=function(b){return this.DoSet(b)};Field.prototype.FieldValChanged=function(){};Field.prototype.S=function(k){if(typeof k=="undefined"){return}if(!("mDCF" in this)&&this.mID!=0){this.mDCF=(this.mDOMField)?(this.mObj.getAttribute("ARDCF")!=null):((this.mObj&&"dcf" in this.mObj)?(this.mObj.dcf==1):false)}bCheckFirst=!this.mDCF;if(bCheckFirst){bCheckFirst=!getFieldChanged_NS(this.windowID)}else{bCheckFirst=(this.mObj&&"dcf" in this.mObj&&this.mObj.dcf==1)}if(bCheckFirst){var g=this.G();if(g){var h;if(k instanceof Datatype){h=k}else{h=DatatypeFactories[g.type](k)}var b=false;if(this.mID>=1000000&&this.mID<=1999999){var d=this.GetCookieValue();if(d==null){if(k!=null){b=true}}else{b=d.EQForSet(h)}}if(h instanceof EnumType&&typeof h.mLabel=="undefined"&&g.compareValStr()==h.compareValStr()){h.mLabel=g.mLabel}if(g.EQForSet(h)&&(!(this.mDOMField&&this.mHaveStoredData)||h.toString()==this.GetScreenValAsPrimitive())&&!(this instanceof DView)&&!(this instanceof JAttachment)&&!b){return}}else{if(!k){return}}}var f=this.DoSet(k);if(!f&&this==DummyField){this.mObj.v=k}this.mCursorRange=null;this.SaveGlobalData();delete getARMaps_NS(this.windowID)[this.mID];delete getARArrays_NS(this.windowID)[this.mID];return f};Field.prototype.DoSet=function(b){};Field.prototype.Validate=function(){return null};Field.prototype.GName=function(){if(this.mDOMField){return this.mObj.getAttribute("ardbn")}else{return this.mObj.dbn}};Field.prototype.mContainFields=false;Field.prototype.mDOMField=false;Field.prototype.mHaveVisualCharacteristics=false;Field.prototype.GLabel=function(){return this.mCFCache.l};Field.prototype.GLabelOrName=function(){if(this.GLabel().length>0){return this.GLabel()}return this.GName()};Field.prototype.GLabelOrID=function(){if("mOrigLabel" in this){return this.mID+""}else{return this.GLabel()}};Field.prototype.GColour=function(){if(this.mCFCache.c==null&&this.mID in getDefaults_NS(this.windowID)){return getDefaults_NS(this.windowID)[this.mID].c}return this.mCFCache.c};Field.prototype.GFont=function(){return this.mCFCache.f};Field.prototype.GAccess=function(){return this.mCFCache.a};Field.prototype.GVis=function(){return this.mCFCache.v};Field.prototype.GMenu=function(){return this.mCFCache.m};Field.prototype.GDraggable=function(){return this.mCFCache.drag};Field.prototype.GDroppable=function(){return this.mCFCache.drop};Field.prototype.SLabel=function(b){if(this.mCFCache.l!=b){if(!("mOrigLabel" in this)){this.mOrigLabel=this.mCFCache.l}this.mCFCache.l=b;this.UpdateLabel(b)}};Field.prototype.SColour=function(b){if(this.mCFCache.c!=b){this.mCFCache.c=b;this.UpdateColour(b)}};Field.prototype.SFont=function(b){if(this.mCFCache.f!=b){this.mCFCache.f=b;this.UpdateFont(b)}};Field.prototype.SAccess=function(b){if(this.mCFCache.a!=b){this.mCFCache.a=b;this.UpdateAccess(b)}};Field.prototype.SVis=function(d){if(this.mCFCache.v!=d){this.mCFCache.v=d;this.UpdateVis(d);if(this.mContainerID!=null){var b=getVUILayoutModel_NS(this.windowID);if(this.mContainerID!=0&&getFields_NS(this.windowID)[this.mContainerID]){b=getFields_NS(this.windowID)[this.mContainerID].mFillModel}if(!d){b.DeRegisterLayoutField(this.mID)}else{b.RegisterLayoutField(this,true)}}else{if(this.mFillModel){if(d){this.ResizeChildren()}}}}};Field.prototype.SDraggable=function(b){if(this.mCFCache.drag!=b){this.mCFCache.drag=b;this.UpdateDraggable(b)}};Field.prototype.SDroppable=function(b){if(this.mCFCache.drop!=b){this.mCFCache.drop=b;this.UpdateDroppable(b)}};Field.prototype.ResizeChildren=function(){};Field.prototype.SMenu=function(h){if(this.mCFCache.m!=h){this.UpdateMenu(h);if(h!=null&&h.length>2&&(h.charAt(0)=="$"&&h.charAt(h.length-1)=="$")){var b=h.substring(1,h.length-1);if(!isNaN(b)){h=ExpandString(this.windowID,h,1)}}this.mCFCache.m=h;if(this.mInputNode!=null){var f=this.mInputNode.getAttribute("arautoc");var d=(f!=null)&&(f=="1"||f=="2");if(d&&h!="$NULL$"){var g=ARMenu.getMenu(this.windowID,h);if(g==null){new NDXGetMenuDefinition(this.windowID,h,ARKWGetStringByIdx(this.windowID,7),getFormContext(this.windowID).formName);g=ARMenu.getMenu(this.windowID,h)}if(g!=null){setActbProps(this,g)}}}if(this instanceof DChar){this.mAutoCompleteCreated=false}}else{if((h in getARMenuCache_NS(this.windowID))&&!(getARMenuCache_NS(this.windowID)[h] instanceof Object)){return}else{if((h in getARMenuCache_NS(this.windowID))&&!(getARMenuCache_NS(this.windowID)[h].mMenuData instanceof Array)){getARMenuCache_NS(this.windowID)[h].mCharFieldMenu=null}}}};Field.prototype.UpdateAccess=function(b){};Field.prototype.UpdateMenu=function(b){};Field.prototype.GMenuStyle=function(){return 1};Field.prototype.TracksCaret=false;Field.prototype.hasContextMenu=false;Field.prototype.Clear=function(){var b=this.mID;if((b>=1000000&&b<=1999999)||(b>=3000000&&b<=3999999)||b==1576||b==1575){return}this.mObj.v=Null;this.SetDirty()};Field.prototype.DataDefault=function(){if((this.mID>=1000000&&this.mID<=1999999)||(this.mID>=3000000&&this.mID<=3999999)){return}var b=this.GDefault();if(b!=null){this.S(b)}};Field.prototype.GDefault=function(){if("d" in getDefaults_NS(this.windowID)[this.mID]){return(new CharType(ExpandString(this.windowID,""+getDefaults_NS(this.windowID)[this.mID].d,2)))}else{return(Null)}};Field.prototype.MouseSelectable=true;Field.prototype.mHaveStoredData=false;Field.prototype.IsMouseSelectable=function(){return this.MouseSelectable};Field.prototype.QueryOK=function(){return this.mHaveStoredData};Field.prototype.hasChildFields=function(){return this.mHasChildFields};Field.prototype.getChildField=function(){return null};function Field_BuildList(f,C,v,B,o,b,D,z){var y;if(B){var g=new FieldSnapshot(f,true,false,true);if(getDBSnapshot_NS(f)!=null){y=getDBSnapshot_NS(f).DataDiff(g)}else{modifiedOnly=false}}var k=[];var A=false;var d=getFields_NS(f);for(var E in d){var s=d[E];if(s.mHaveStoredData){var G=(D)?s.GTrim():s.G();if(o&&(G==Null||G==CharNull)){if(b||(s.mDataType!=6&&!(s instanceof JAttachment))||(s.mLastChanged&&getField_LastCleared_NS(f)>s.mLastChanged)){if(z&&s instanceof DataField){if(s.mCFCache.o==1||(s.mCFCache.r==1)){var u=s.GDefault();if(u==null||u==Null||u==CharNull){k.push(s.getRequiredException())}}}continue}}var w=s.mID;var h=null;if(v){h=s.Validate()}if(b){if(s.EqualsDefaultValue(h)){continue}}if(B){A=!(((s.mLastChanged&&getField_LastCleared_NS(f)<=s.mLastChanged)&&(w in y))||((w in getForm_NS(f).displayOnlyFields)&&!G.isNull))}if(v&&h){k.push(h);A=true}if(!A){C.AddField(w,G)}}}if(k.length!=0){getCurWFC_NS(f).status(k)}for(ii in getForm_NS(f).systemFields){C.RemoveField(ii)}C.RemoveField(1100);return C}function Field_GetQBEFieldList(f){var s=[];var o={};o.fl=new FieldList(f);o.ps=null;var h=getFields_NS(f);for(var g in h){try{var u=h[g];if(u.mID>=1000000&&u.mID<=1999999){continue}if(u.mHaveStoredData){var b=u.mID;var d;if(u instanceof DataField){d=u.GetScreenValue();if(typeof d!="undefined"&&d!=null){d=d.trim(1|2)}if(typeof d!="undefined"&&d!=null&&d.match(SavedSearches.QBEPSP)){d=d.substring(1,d.length-1);if(!ARKWIsKeywordOrEscapedKeyword(f,d)){if(o.ps==null){o.ps=new Object()}o.ps[b]=d;continue}}}d=u.GetQBEValue();if(d instanceof CharType){d=ARFuncRTrim(d)}if(!d.isNull||d==NullType.KEYWORD_NULL){o.fl.AddField(b,d)}}}catch(k){s.push(k)}}if(s.length!=0){getCurWFC_NS(f).status(s)}return o}function Field_QueryLoadEntry(d,h,b,k){var g=new NDXGetEntry(d,ARKWGetStringByIdx(d,7),ARKWGetStringByIdx(d,6),((ARKWGetStringByIdx(d,21)!=null)?ARKWGetStringByIdx(d,21):""),window.name,h,[],true);var f=g.result;if(f instanceof Array){Field_LoadEntry(d,f,b,k,h)}}function Field_LoadEntry(o,z,A,b,g){DDiary.SetDiaryFieldsDeferred(o,ARKWGetStringByIdx(o,7),ARKWGetStringByIdx(o,6),g);if(z instanceof Array){var d=!A,k=null,h={},B=z.length,s={},y=0;for(var u in z){var C=z[u];if("ts" in C){y=C.ts}else{h[C.i]=C}}var v=getFields_NS(o);for(var u in v){var w=v[u];if(u in h){h[u].a={p:w};k=Datatype_Factory(h[u]);w.SLoadEntry(k)}else{k=Null;if(getViewFields_NS(o)[u]){w.DataDefault();w.ClearInlineFormSettings()}else{if(b&&w.mHaveStoredData){if(w.mDeferred){if(w.mCharEditBox&&w instanceof DDiary){w.GetHistory()}}else{w.Clear()}}}}if(d&&w.mHaveStoredData){s[u]={d:k}}w.mCursorRange=null}setDBSnapshot_NS(o,new FieldSnapshot(o));getDBSnapshot_NS(o).d=true;getDBSnapshot_NS(o).mSnap=s;getDBSnapshot_NS(o).ts=y}Field_ClearChanged(o)}Field.prototype.Snapshot=function(d,b){var f={};if(d){f.d=this.G()}if(this.mHaveVisualCharacteristics&&b){f.a=this.mCFCache.a;f.l=this.mCFCache.l;f.c=this.mCFCache.c;f.f=this.mCFCache.f;f.v=this.mCFCache.v;f.m=this.mCFCache.m}return f};Field.prototype.Restore=function(b,f,d){if(f){this.S(b.d)}if(this.mHaveVisualCharacteristics&&d){this.SAccess(b.a);this.SLabel(b.l);this.SColour(b.c);this.SFont(b.f);this.SVis(b.v);this.SMenu(b.m);if(typeof this.mCFCache.r!="undefined"&&(this.mCFCache.r!=3)){this.clearDec()}}};Field.prototype.mIsComplexField=false;function Field_Clear(d,g){var b=(g)?1020:0;var h=getFields_NS(d);for(var f in h){if(f==b){continue}h[f].Clear()}}function Field_SetROBackground(b,h){setARFieldROBg_NS(b,h);var f=getFields_NS(b);for(var d in f){var g=f[d];if(g.mDOMField&&g.GAccess()==1){g.UpdateROColour()}}}Field.prototype.UpdateROColour=function(){};function Field_GetChanged(b){return getFieldChanged_NS(b)}function Field_ClearChanged(b){setFieldChanged_NS(b,0);setField_LastCleared_NS(b,getField_LastCleared_NS(b)+1);DControl_DirtyFlagChanged(b,0)}function Field_ClearChangedFromRunProcess(b){setFieldChanged_NS(b,0);DControl_DirtyFlagChanged(b,0)}function Field_SetChanged(b){if(getFieldChanged_NS(b)!=1){setFieldChanged_NS(b,1);DControl_DirtyFlagChanged(b,1)}}Field.prototype.SetDirty=function(){this.mLastChanged=getField_LastCleared_NS(this.windowID);if(getFieldChanged_NS(this.windowID)==1||(this.mDCF)){return}DControl_DirtyFlagChanged(this.windowID,1);setFieldChanged_NS(this.windowID,1)};Field.prototype.IsDirty=function(){return getFieldChanged_NS(this.windowID)>0&&this.mLastChanged&&getField_LastCleared_NS(this.windowID)<=this.mLastChanged};function Field_Defaults(b,k,d,h){var o=getDefaults_NS(b);for(var f in o){var s=getFields_NS(b)[f];if(s==null){continue}if(k){s.DataDefault()}if(d&&s.mHaveVisualCharacteristics){var g=o[f];s.SColour("c" in g?g.c:null);s.SFont("f" in g?g.f:"f1");if("l" in g){s.SLabel(g.l)}if("m" in g){s.SMenu(g.m)}if("v" in g){s.SVis(g.v)}if("a" in g){s.SAccess(h?1:g.a)}if(typeof s.mCFCache.r!="undefined"&&s.mCFCache.r!=3){s.clearDec()}}}}function Field_ExpandDefaultValues(b){var g=getDefaults_NS(b);for(var d in g){var f=g[d];if("d" in f){if(typeof f.d=="string"){f.d=ExpandString(b,f.d,16)}}}}var DummyField=null;function F(b,d){if(arguments.length==1){d=arguments[0];b=getCurrentWindowID_NS()}return(d in getFields_NS(b))?getFields_NS(b)[d]:DummyField}function Field_FindByDBN(b,h){var f=getFields_NS(b);for(var d in f){var g=f[d];if(g.mDOMField){if(g.mObj.getAttribute("ardbn")==h){return g}}else{if(g.mObj.dbn==h){return g}}}return null}function Field_FindByLabel(b,d){var g=getFields_NS(b);for(var f in g){var h=g[f];if(h.mHaveVisualCharacteristics&&h.GLabel()==d){return h}}return null}Field.prototype.GetNestedFocusability=function(){var b=this.GetParent();return((this.mDOMField)&&(this.GAccess()!=3)&&this.GVis()&&(b==null||b.GetNestedFocusability()))};Field.prototype.GetFocusElement=function(){return null};Field.prototype.GetSorter=function(){return"lhs.localeCompare(rhs)"};Field.prototype.EqualsDefaultValue=function(h){if(h!=null){return false}var s=this.G();var k=this.GDefault();var f=(k!=null&&s.EQ(k));if(f){var g={35:1,34:1,17:1};if((typeof this.mID!="undefined")&&("d" in getDefaults_NS(this.windowID)[this.mID])){var o=""+getDefaults_NS(this.windowID)[this.mID].d;if(ARKWIsKeywordString(this.windowID,o)){var d=o.substring(1,o.length-1);var b=getARKWNameLookup_NS(this.windowID)[d];return((typeof g[b]!="undefined")?false:true)}else{return true}}else{return true}}else{return false}};Field.prototype.GetType=function(){};Field.prototype.GetScreenValue=function(){return this.G().toString()};Field.prototype.IsVisible=function(){return true};Field.prototype.GetHoverValue=function(b){return""};Field.prototype.Unload=function(){};Field.prototype.resetFocusTab=function(b){};Field.prototype.reset=function(){this.mDisplay=false;this.mTT=this.mObj;this.mTT.onmouseout=null;this.mTT.style.visibility="hidden";if(this.mFieldSetNode){var d=this.mFieldSetNode.getElementsByClassName("surl");if(d.length>0){for(var b=0;d.length>b;b++){d[b].style.visibility="hidden"}}}this.mTT.style.top="0px";this.mTT.style.left="0px"};Field.prototype.getRequiredException=function(){var b={cId:1,t:2,n:9424,a:""};b.m=getLocalizedMessage("Required field (without a default) not specified");b.a=(this.mID).toString();return b};Field.prototype.isRTF=function(){return false};function resizeRTFImage(d,f,b){if(b==undefined){b=1000}window.setTimeout(function(){if(!useLegacyRTFEditor){if(rtfEditor&&rtfEditor.GetEditor().fieldid==f){rtfEditor.GetEditor().setAutoResize()}else{var h=F(d,f);var o=h.mIFrame;var k=YAHOO.util.Dom;if(h.mAutoSizeHeight){var g=o.scrollHeight;$("#arid_WIN_"+d+"_"+f).height(g);$("#arid_WIN_"+d+"_"+f).parent().height(g);h.mInputNode.childNodes[0].childNodes[0].style.overflowY="visible"}if(h.mAutoSizeWidth){var s=o.scrollWidth;$("#arid_WIN_"+d+"_"+f).width(s);$("#arid_WIN_"+d+"_"+f).parent().width(s+30);h.mInputNode.childNodes[0].childNodes[0].style.overflowX="visible"}window.setTimeout(function(){k.setStyle(o,"height","100%");k.setStyle(o,"width","100%")},1)}}else{var h=F(d,f);var o=h.mIFrame;var k=YAHOO.util.Dom;if(h.mAutoSizeHeight){h.AutoHeightRTF();h.mInputNode.childNodes[0].childNodes[0].style.overflowY="visible"}if(h.mAutoSizeWidth){h.AutoWidthRTF();h.mInputNode.childNodes[0].childNodes[0].style.overflowX="visible"}window.setTimeout(function(){k.setStyle(o,"height","100%");k.setStyle(o,"width","100%")},1)}},b)}Field.prototype.SetRTFVal=function(d){try{if(this.mRTF){if(d.length>0){d=d.removeXssVulnerability();d=this.VerifyImageURL(d);var B=document.createElement("div");B.innerHTML=d;var k=$(B).find("img");if(k.length>0){for(var y=0;k.length>y;y++){var z=k[y].attributes;for(a=0;z.length>a;a++){if(z[a].name.indexOf("resizertfimage")>-1){k[y].removeAttribute(z[a].name)}}if(k[y].className!="expTitleImage"&&!(k[y].src.indexOf("ckeditor/plugins/smiley")>-1)){k[y].setAttribute("onload","resizeRTFImage("+this.windowID+","+this.mID+")")}else{var o=k[y].src.indexOf("resources/javascript/ckeditor/plugins/smiley");if(o>-1){var w=k[y].src.substring(o,k[y].src.length);k[y].src=RelContextPath+w}k[y].removeAttribute("onload")}}}if(useLegacyRTFEditor){var b=B.firstChild;try{var h=b.getElementsByTagName("td");if(h&&h!=null&&h.length>0){for(var y=0;h.length>y;y++){if(h[y].className=="expDataA"||h[y].className=="expDataB"){h[y].setAttribute("arwinid",""+this.windowID);h[y].setAttribute("arfid",""+this.mID)}}}}catch(s){d=d}}if(B.innerHTML&&B.innerHTML!=null){d=B.innerHTML}}var u=this.GetIFrameDoc();if(u){u.style.visibility="inherit";var A=this;if((this.mAutoSizeHeight||this.mAutoSizeWidth)&&this.mAllowAutoResize){var g=YAHOO.util.Dom,f=this.mIFrame;if(this.mAutoSizeHeight){g.setStyle(this.mInputNode.parentNode,"height",this.mMinHeight+"px");g.setStyle(this.mInputNode,"height",this.mMinHeight+"px")}if(this.mAutoSizeWidth){g.setStyle(this.mInputNode.parentNode,"width",this.mTextElement.clientWidth+this.mMinWidth+31+"px");g.setStyle(this.mInputNode,"width",this.mMinWidth+"px")}g.setStyle(f,"width","99%");g.setStyle(f,"zoom","1");g.setStyle(f,"cursor","default");var v=function(){window.setTimeout(function(){if(A.mAutoSizeHeight){A.AutoHeightRTF();A.mInputNode.childNodes[0].childNodes[0].style.overflowY="visible"}if(A.mAutoSizeWidth){A.AutoWidthRTF();A.mInputNode.childNodes[0].childNodes[0].style.overflowX="visible"}window.setTimeout(function(){g.setStyle(f,"height","100%");g.setStyle(f,"width","100%");resizeRTFImage(A.windowID,A.mID,1000)},1)},100)};window.setTimeout(function(){v()},100)}if(u.tagName!="DIV"){u.body.innerHTML=d}else{u.firstChild.innerHTML=d;this.fixFontsAndURL(u.firstChild)}}this.mRTFVal=d;this.mAllowAutoResize=true}}catch(s){}return this.GetScreenValAsPrimitive()};Field.prototype.GetRTFVal=function(){if(this.mRTF){var d=this.mInputNode.firstChild;if(d==null||typeof d=="undefined"){return""}var b=d.data;if(typeof b!="undefined"&&b!=null){return b}else{var g=this.GetIFrameDoc();if(g){try{if(g.tagName!="DIV"){return g.body.innerHTML}else{return d.firstChild.innerHTML}}catch(f){if(typeof this.mRTFVal!="undefined"&&this.mRTFVal){return this.mRTFVal}}}else{if(typeof this.mRTFVal!="undefined"&&this.mRTFVal){return this.mRTFVal}else{if(d.tagName!="IFRAME"){return d.innerHTML}}}}}return""};var curClickElement=null;Field.prototype.FireDOCOnClick=function(b){if(this.mInputNode!=null&&this.mRTF){FormEvent.FireClickEventFromSRCElement(document.body,this.mInputNode,b)}};Field.prototype.CreateIFrameText=function(f,b){var g="ltr";var h="iframe_"+this.windowID+"_"+this.mID;var d="javascript:;";return"<iframe name="+h+" id="+h+' title="'+f+'" scrolling='+(b?"no":"auto")+" dir="+g+" border=0 marginWidth=0 marginHeight=0 src="+d+' frameBorder=0 width="100%" height="100%" allowTransparency rightMargin="3px" leftMargin="2px" topMargin="3px" bottomMargin="0px" display="none" visibility="visible"></iframe>'};Field.prototype.CreateIFrame=function(g,s){var k=YAHOO.util.Dom,w=YAHOO.util.Event,o=YAHOO.lang;var v="ltr";var f="iframe_"+this.windowID+"_"+this.mID;var d=document.createElement("iframe");d.id=f;var b={name:f,scrolling:(s?"no":"auto"),title:g,dir:v,border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",rightMargin:"3px",leftMargin:"2px",topMargin:"3px",bottomMargin:"0px",allowTransparency:"true",width:"100%",height:"100%",display:"none",visibility:"visible",cursor:"default"};for(var h in b){if(o.hasOwnProperty(b,h)&&b[h]){d.setAttribute(h,b[h])}}var u="javascript:;";d.setAttribute("src",u);return d};Field.prototype.VerifyImageURL=function(d){if(d&&typeof d=="string"&&d.length>0&&(d.indexOf(" arattid=")>0||d.indexOf(" arqual=")>0||d.indexOf(" arentryid=")>0)){var b=getFields_NS(this.windowID)[1];entryIDVal=null;if(b){if(b.mPrimVal&&b.mPrimVal.length>0){entryIDVal=b.mPrimVal}else{if(b.mObj&&b.mObj.v&&b.mObj.v.mValue){entryIDVal=b.mObj.v.mValue}}if(entryIDVal&&entryIDVal.length>0){d=updateRtfHtml(this.windowID,d,entryIDVal);this.mDataVal=dt=this.ConvertPrimitiveToDataType(d);dtstr=dt.toString()}}}return d};Field.prototype.AutoHeightRTF=function(){if(!this.mRTF||this.mIFrame==null){return}var k=YAHOO.util.Dom,g=YAHOO.util.Event,o=YAHOO.lang;var h=this.mIFrame;var s=this.GetIFrameDoc();var d;if(s.tagName!="DIV"){d=s.body}else{d=s.firstChild}var b=parseInt(k.getStyle(this.mInputNode,"height"),10);var f=b;if(s.documentElement&&typeof s.documentElement!="undefined"){f=s.documentElement.scrollHeight}else{f=d.scrollHeight}f+=10;if(f<this.mMinHeight){f=this.mMinHeight}if(this.mMaxHeight>0&&f>this.mMaxHeight){f=this.mMaxHeight}if(b!=f){k.setStyle(this.mInputNode.parentNode,"height",f+"px");k.setStyle(this.mInputNode,"height",(f+5)+"px");k.setStyle(h,"height","99%");k.setStyle(h,"zoom","1")}if(rtfEditor!=null&&rtfEditor.mEditing!=null){rtfEditor.UpdatePos()}};Field.prototype.AutoWidthRTF=function(){if(!this.mRTF||this.mIFrame==null){return}var h=YAHOO.util.Dom,w=YAHOO.util.Event,o=YAHOO.lang;var f=this.mIFrame;var v=this.GetIFrameDoc();var s;if(v.tagName!="DIV"){s=v.body}else{s=v.firstChild}var b=parseInt(h.getStyle(this.mInputNode,"width"),10);var g=b;g=s.scrollWidth;var k=0;var d;d=this.mInputNode.nextElementSibling;while(d&&d.tagName=="A"){k+=d.offsetWidth+5;if(d.className.indexOf("menu")!=-1){d.style.position="static"}d=d.nextElementSibling}g+=15;if(g<this.mMinWidth){g=this.mMinWidth}if(this.mMaxWidth>0&&g>this.mMaxWidth){g=this.mMaxWidth}if(b!=g){var u=this.mTextElement.clientWidth;if(this.mTextElement.parentNode&&this.mTextElement.parentNode.getAttribute("labelLoc")=="top"){if(k>0){u=0}else{u=-10}}h.setStyle(this.mInputNode.parentNode,"width",u+g+k+2+"px");h.setStyle(this.mInputNode,"width",g+"px");h.setStyle(f,"width","99%");h.setStyle(f,"zoom","1")}};Field.prototype.SetDisabled=function(b){if(!(this instanceof DPage||this instanceof DPageHolder)){return}if(this.mDisabled==b){return}if(this.mDisabledObj==null){var d=document.createElement("DIV");d.style.top="0px";d.style.left="0px";d.style.width="100%";d.style.height="100%";d.style.backgroundColor="black";d.style.opacity=".20";d.style.visibility="hidden";d.style.zIndex=0;this.mDisabledObj=d;this.mObj.appendChild(d)}this.mDisabledObj.style.visibility=(b==true)?"visible":"hidden";this.mDisabledObj.style.zIndex=(b==true)?nextZIndex++:0;this.mDisabled=b};Field.prototype.GetLastElement=function(){var b=this.mObj.lastChild;if(b==null){return null}while(b.lastChild&&(!b.style||(b.style.visibility!="hidden"&&b.style.display!="none"))){b=b.lastChild}return b};function GetFieldLabelColor(b,d){var f=F(b,d);if(f){return f.GColour()}return null}function GetFieldFont(b,d){var f=F(b,d);if(f){return f.GFont()}return null}function GetFieldBGColor(b,d){var f=F(b,d);return(f)?f.mObj.style.backgroundColor:null}function ValidateFieldForPushFieldAction(b,f){var g=F(b,f);if(g){var d=g.Validate();if(d){throw new WorkflowException(b,0,[d])}}}RTF_Close=function(b){if(rtfEditor&&rtfEditor.IsVisible()){rtfEditor.Close(b)}};Field.prototype.GetDOMName=function(){return this.mFrameName};Field.prototype.clearDec=function(){};var rtfEditor=null;var rtfCreated=false;function Field_Init(b,o,k){if(!o){o=getBody(b)}var h=o;if(typeof k=="undefined"){k=false}while(1){var g,d=true;if(h.nodeType==1&&(g=h.getAttribute("arid"))&&(h!=o||k==true)){if(g.indexOf("app")!=-1){var f=DOMFieldFactories[h.getAttribute("artype")](b,g,h)}else{var f=DOMFieldFactories[h.getAttribute("artype")](b,parseInt(g),h)}if(f.mID!=1020&&typeof getFieldListInfo_NS(b).firstField=="undefined"){getFieldListInfo_NS(b).firstField=f}getFieldListInfo_NS(b).lastField=f;d=f.mContainFields}if(h.firstChild&&d){h=h.firstChild}else{while(!h.nextSibling){h=h.parentNode;if(h==o||h.tagName=="BODY"){return}}h=h.nextSibling}}}Field.prototype.mTextElement=null;Field.prototype.TrackCaret=function(f){if("selection" in document&&"createRange" in document.selection){if(!f||f.nodeType!=1){return}var d=f.tagName;if(!(d=="TEXTAREA"||(d=="INPUT"&&f.type.toUpperCase()=="TEXT"))){return}try{var b=document.selection.createRange().duplicate();if(b.parentElement()!=f){return}this.mCursorRange=b}catch(g){}}};Field.prototype.InsertAtCaret=function(d,f){if("setSelectionRange" in d){var g=d.selectionStart,b=d.selectionEnd;if(g==0&&b==0){d.value+=f;d.setSelectionRange(d.value.length,d.value.length)}else{d.value=d.value.substr(0,g)+f+d.value.substr(b);d.setSelectionRange(g+f.length,g+f.length)}}else{if(this.mCursorRange){this.mCursorRange.text=f;this.mCursorRange.select()}else{d.value+=f}}d.focus()};Field.prototype.ResizeTo=function(d,b){if(this.mObj.style.width!=this.perWidth+"%"){this.mObj.style.width=this.perWidth+"%"}if(this.mObj.style.height!=this.perHeight+"%"){this.mObj.style.height=this.perHeight+"%"}};Field.prototype.UpdateLabel=function(k){var o=this.mTextElement;var f=false;if(o){var h=o.firstChild;if(h==null){f=true}while(h!=null&&h.nodeType!=3){h=h.nextSibling}if(h){o.removeChild(h)}if(k!=""||k.length!=0){if((o.tagName=="LABEL"||o.tagName=="label")&&o.parentNode!=null&&((o.parentNode.tagName=="span")||o.parentNode.tagName=="SPAN")&&o.parentNode.nextSibling!=null&&((o.parentNode.nextSibling.tagName=="textarea")||o.parentNode.nextSibling.tagName=="TEXTAREA")){o.style.width="auto"}o.appendChild(document.createTextNode(k))}}else{var d=this.mObj;if(d.children&&d.children[0]!=null&&d.children[0].nodeType==1&&d.children[0].className.indexOf("btnimgdiv")!=-1){var g=d.children[0].children[0];if(Boolean(parseInt(g.getAttribute("aralttxt")))==false){g.setAttribute("artxt",k)}var b=(d.className.indexOf("btnd")!=-1||d.className.indexOf("btndflt")!=-1)?true:false;FakeButton_SetAlternative(this.mObj,b)}}};Field.prototype.UpdateColour=function(d){var f=this.mTextElement;if(!f){return}if(d==null){if("c" in getDefaults_NS(this.windowID)[this.mID]){d=getDefaults_NS(this.windowID)[this.mID].c}else{d=""}}try{f.style.color=d}catch(b){}};Field.prototype.UpdateFont=function(f){var g=this.mTextElement;if(!g){return}var d=g.className.split(" ");for(var b in d){if(d[b].match(/f[0-9]+$/)){d[b]=f;g.className=d.join(" ");return}}d.push(f);g.className=d.join(" ")};Field.prototype.TabableElementSelector=function(b){if(b.tagName=="A"||b.tagName=="INPUT"||b.tagName=="TEXTAREA"){if(!b.style||b.style.visibility!="hidden"){return b}}return null};Field.prototype.InitInputNode=function(){if(!(this.mRTF)){return}var b=YAHOO.util.Dom,A=YAHOO.util.Event,h=YAHOO.lang;if(this.mInputNode.hasChildNodes()){try{var y=this.mIFrame;var z=this.GetIFrameDoc();if(z!=null){A.removeListener(z,"click")}if(y!=null){if(y.tagName=="IFRAME"){y.src=""}else{z.innerHTML=y.innerHTML=""}}}catch(s){}this.mInputNode.innerHTML=""}var k=this.mInputNode.className.indexOf(" sr ")>=0;var f;f=this.CreateDIVRTF(this.mInputNode.getAttribute("title"),k);this.mInputNode.appendChild(f);this.mIFrame=f;if(f==null){return}this.mInputNode.style.overflow=(k?"hidden":"visible");f.style.width=(k?"1000%":"100%");var w="transparent";if(!this.mDisplayAsText){w=((this.GAccess()==1)?getARFieldROBg_NS(this.windowID):"#fff")}if(this.mSingleLine){$(this.mInputNode).css("background-color",w)}if(this.mRTF&&this.mAllowAutoResize&&this.mFlowID&&F(this.mFlowID)&&F(this.mFlowID).mObj&&F(this.mFlowID).mObj.getAttribute("arfillstyle")==2){if(useLegacyRTFEditor){var o='<div class="rtf_text" style=overflow:"hidden"></div>'}else{var o='<div id="rtf_text_'+this.mID+'" class="rtf_text" style=overflow:"hidden"></div>'}}else{if(useLegacyRTFEditor){var o='<div class="rtf_text" style=overflow:"auto"></div>'}else{var o='<div id="rtf_text_'+this.mID+'" class="rtf_text" style=overflow:"auto"></div>'}}var v="ltr";var d="html { height: 100%; width: 100% } body { padding: 0px; background-color:"+w+"; font:8pt arial,helvetica,clean,sans-serif;cursor:default;"+(this.mInputNode.className.indexOf("dat")!=-1?"background:inherit;}":"}");var u="";var g=".expTable {border-color:white; border-style:solid; border-width:1; border-collapse:collapse;} .expTitle, .expTitleText {cursor:pointer; font-weight:bold; color:#4E728C; border-color:white ; border-bottom-style:solid; border-bottom-width:1 } .expTitleImage {cursor: pointer} .expTitleMin {background-color:#cccccc;} .expTitleMout {background-color:#dddddd;} .expDataA {display:;padding-left:32px;} .expDataB {display:none}";o=h.substitute(o,{DIRECTION:v,TITLE:"",CONTENT:"",CSS:d,HIDDEN_CSS:u,EXTRA_CSS:g});var B=this;var z=B.GetIFrameDoc();var C;if(z!=null&&typeof z!="undefined"){if(z.tagName!="DIV"){z.open();z.write(o);z.close()}else{z.innerHTML=o}A.on(z,"click",function(E){var G=A.getTarget(E);if(!IsRTFElemEditable(G,this.windowID,this.mID)){var D=new FormEvent(E);D.PDStopBubbling()}return true},B,true)}};function CreateDIVRTF(b,o){var h=YAHOO.util.Dom,u=YAHOO.util.Event,k=YAHOO.lang;var s="ltr";var f=document.createElement("DIV");f.id=b;f.contentEditable=false;var d={name:b,scrolling:(o?"no":"auto"),dir:s,allowTransparency:"true",frameBorder:"0",border:"0",marginWidth:"0",marginHeight:"0",rightMargin:"3px",leftMargin:"2px",topMargin:"3px",bottomMargin:"0px"};var v={width:"100%",height:"100%",cursor:"default",backgroundColor:"transparent",top:"0",left:"0"};for(var g in d){if(k.hasOwnProperty(d,g)&&d[g]){f.setAttribute(g,d[g])}}for(var g in v){if(k.hasOwnProperty(v,g)&&v[g]){f.style[g]=v[g]}}return f}Field.prototype.CreateDIVRTF=function(d,b){var f="div_"+this.windowID+"_"+this.mID;return CreateDIVRTF(f,b)};Field.prototype.GetFocusElementForEvent=function(d){if(this.GetNestedFocusability()){var f=d.element;var b=this.mObj;while(f!=null){var g=this.TabableElementSelector(f);if(g){return g}if(f==b){break}f=f.parentNode}}return null};Field.prototype.IsLabelPart=function(b){return(b&&b.className.indexOf("label")!=-1)};Field.prototype.LocInLabel=function(b){if(b){if(b.element.className.indexOf("label")!=-1){return true}if(b.element.tagName=="SPAN"){return true}var f=this.mObj.getAttribute("arlbox");if(b.element.className.indexOf("arfid")!=-1){if(f){var g=f.split(",");for(var d=0;d<g.length;d++){g[d]=parseInt(g[d])}if(b.ox>=g[0]&&b.ox<=g[2]&&b.oy>=g[1]&&b.oy<=g[3]){return true}}}}return false};Field.prototype.UpdateVis=function(b){if(!this.mHaveVisualCharacteristics){return}this.mObj.style.visibility=(b?"inherit":"hidden");if(this.mObj.getElementsByTagName("DIV").length>0&&this.mObj.getElementsByTagName("TEXTAREA").length>0){this.mObj.getElementsByTagName("DIV")[0].style.visibility=(b?"inherit":"hidden");this.mObj.getElementsByTagName("TEXTAREA")[0].style.visibility="hidden"}};Field.prototype.UpdateDraggable=function(b){if(!this.mHaveVisualCharacteristics){return}MidTierDragDropMgrInst.setDragSourceEnabled(this.mObj,b)};Field.prototype.UpdateDroppable=function(b){if(!this.mHaveVisualCharacteristics){return}MidTierDragDropMgrInst.setDropTargetEnabled(this.mObj,b)};Field.prototype.RegisterLayoutField=function(f,d){var b=this.mObj.getAttribute("arfillstyle");if(this.mFillModel==null&&b!=null&&b!=0){this.mFillModel=new FillLayoutPolicy()}if(this.mFillModel!=null){this.mFillModel.RegisterLayoutField(f,d)}};Field.prototype.DeRegisterLayoutField=function(b){if(this.mFillModel==null){return}this.mFillModel.DeRegisterLayoutField(b)};Field.prototype.DOMFocus=function(b){var g=this.mID;if(g==0){g=this.mColid}if(rtfEditor!=null&&rtfEditor.mEditing!=null&&rtfEditor.mEditing!=b.element&&rtfEditor.mEditing!=b.element.parentNode){RTF_Close(true)}var d=[];var f=this.windowID;d.push({f:function(){if(hoverState){return hoverState.clearFocusEvent(f)}}});d.push({f:ExecuteWorkflow,a:[f,8192,g]});d.push({f:function(){if(hoverState){hoverState.focusEvent(hoverState.GAIN)}}});if(getCurWFC_NS(this.windowID)){return getCurWFC_NS(this.windowID).execute(d)}else{new WorkflowContext(this.windowID,d)}};Field.prototype.DOMBlur=function(b){if(!useLegacyRTFEditor){if(rtfEditor!=null){rtfEditor.mEditor.closeCKEditor()}}var g=this.mID;if(g==0){g=this.mColid}var d=[];var f=this.windowID;d.push({f:function(){if(hoverState){return hoverState.clearFocusEvent(f)}}});d.push({f:ExecuteWorkflow,a:[f,256,g]});d.push({f:function(){if(hoverState){hoverState.focusEvent(hoverState.LOSE)}}});if(getCurWFC_NS(this.windowID)){return getCurWFC_NS(this.windowID).execute(d)}else{new WorkflowContext(this.windowID,d)}};Field.prototype.DOMClick=Field.prototype.DOMKeyPress=function(b){if(rtfEditor!=null&&rtfEditor.mEditing!=null&&rtfEditor.mEditing!=evt.element){RTF_Close(true)}};Field.prototype.DOMContextMenu=function(b){};Field.prototype.DOMMouseUp=Field.prototype.DOMMouseDown=Field.prototype.DOMMouseOver=Field.prototype.DOMMouseMove=Field.prototype.DOMMouseOut=Field.prototype.DOMKeyDown=Field.prototype.DOMDoubleClick=Field.prototype.DOMKeyUp=Field.prototype.DOMDragStart=function(b){};Field.prototype.GetParent=function(){if(!("parent" in this)){var f=this.mObj.parentNode;var b=getBody();var d;this.parent=null;while(f&&f!=b){if(f.getAttribute("arstop")=="1"){break}if(f.nodeType==1&&(d=f.getAttribute("arid"))){this.parent=getFields_NS(this.windowID)[parseInt(d)];break}else{f=f.parentNode}}}return this.parent};Field.prototype.ShowRTF=function(d){if(d.className.indexOf("dat")!=-1){return}if(!useLegacyRTFEditor){var o=false;if(this.mRTFAdvanced&&$(this.mInputNode).height()>135&&$(this.mInputNode).width()>420){o=true}for(var f in CKEDITOR.instances){var k=f;CKEDITOR.instances[k].updateElement();CKEDITOR.instances[k].destroy();rtfEditor=null}}if(rtfEditor==null){var s=[];var g=null;var b=this.GetRTFVal();if(b){this.mDataVal=new CharType(b)}var u=this;var h=d;s.push({f:function(){if(ShowWaitCursor()){g=new NDXRequest();g.showRunning();weDisableStuff(u.windowID)}return{}},t:this});if(useLegacyRTFEditor){s.push({f:function(){rtfEditor=new RichTextEditor(u.windowID,"rtf_editor");rtfEditor.CreateRTFWidget(d);var v=rtfEditor.GetEditor();if(v!=null){v.on("editorContentLoaded",function(){v.unsubscribeAll("editorContentLoaded");setTimeout(function(){rtfEditor.Show(h,u);rtfCreated=true;if(g){g.hideRunning();weEnableStuff(u.windowID)}rtfEditor.Focus()},5)},v,true)}return{}},t:this})}else{s.push({f:function(){var v="rtf_text_"+this.mID;rtfEditor=new RichTextEditor(u.windowID,v);rtfEditor.CreateRTFWidget(d,this.mID);rtfCreated=true;var w=rtfEditor.GetEditor().GetEditor();if(w!=null){w.on("instanceReady",function(){setTimeout(function(){rtfEditor.Show(h,u);rtfCreated=true;w.on("beforeCommandExec",function(z){var y=z.data.name;var A=w.getSelection().getSelectedText();if(y=="link"&&A.length<1){alert(getLocalizedMessage("Please select link text"));z.cancel()}},w,true);if(!o){$("#"+w.id+"_top").height("30px");$("#"+w.id+"_bottom").height("12px");$("#"+w.id+"_top").hide();$("#"+w.id+"_bottom").hide();$("#"+w.id+"_contents").height(d.clientHeight)}else{$("#"+w.id+"_top").height("30px");$("#"+w.id+"_bottom").height("12px");$("#"+w.id+"_bottom").height("12px");$("#"+w.id+"_bottom").css("padding-top","0px");$("#"+w.id+"_bottom").css("padding-bottom","6px");$("#"+w.id+"_contents").height(d.clientHeight-60);$("span.cke_combo__font > a").css("word-wrap","normal");$("span.cke_combo__font > a").css("width","125px");$("span.cke_combo__font > a > span.cke_combo_text").css("width","110px");$("span.cke_combo__fontsize > a").css("word-wrap","normal");$("span.cke_combo__fontsize > a").css("width","69px");$("span.cke_combo__fontsize > a > span.cke_combo_text").css("width","62px")}w.focus()},5)},w,true);w.on("change",function(y){rtfEditor.OnEditorKeyUp(y);rtfEditor.GetEditor().updateStatusBar()},w,true);w.on("contentDom",function(){this.document.$.onclick=function(A){A.preventDefault();rtfEditor.GetEditor().updateStatusBar();var z=A.target;var y=z.getAttribute("id");var C=(z.tagName=="IMG"&&(z.className.indexOf("expTitleImage")!=-1||(y!=null&&y.substr(0,15)=="img_expSection_")));if(C){var B=findEXPCOLTD(z);if(B!=null){collapse_twisty(0,B,u.windowID,u.mID,true,false)}}}},w,true)}return{}},t:this})}new WorkflowContext(this.windowID,s);if(!useLegacyRTFEditor){if(g){g.hideRunning();weEnableStuff(u.windowID)}}}else{if(rtfCreated){if(rtfEditor.mEditing!=d){this.HideRTF(true);rtfEditor.Show(d,this)}else{rtfEditor.Focus()}}}};Field.prototype.HideRTF=function(b){RTF_Close(b)};Field.prototype.IsDOMVisible=function(){var b=document.body;var d=this.mObj;while(d!=b){if(d.style.visibility=="hidden"){return false}else{if(d.style.visibility=="visible"){return true}else{d=d.parentNode}}}return true};Field.prototype.showTT=function(){this.mTT=this.mObj;this.mTT.onmouseout=null;this.mTT.style.visibility="hidden";this.mTT.style.top="0px";this.mTT.style.left="0px";var f;var g=hoverState.inEvtHover();var u=hoverState.inButtonClick();if(g&&!hoverState.hasMouseTrackEvent()){hoverState.reset();return null}var o=false;if(g){o=true}if(u&&hoverState.buttonActivatedByKey()==false){o=true}if(u){f=hoverState.getClickField();var b=f.GetParent();while(b){if(b.mFloat==3){this.mParent=b;if(b.mChild!=null){b.mChild.reset()}b.mChild=this}b=b.GetParent()}if(this.mParent==null){if(this.mID!=formTTList.mPrimary.mID){while(formTTList.mPrimary){formTTList.mPrimary.reset();formTTList.mPrimary=formTTList.mPrimary.mChild}formTTList.mPrimary=this}}}this.mDisplay=true;var s=this;var d=this.mTT;var w=hoverState.getTipLocation(d,o);var v=w.pos;var k=w.tipDims;d.style.left=v.x+"px";d.style.top=v.y+"px";d.style.visibility="visible";d.style.zIndex=nextZIndex++;try{this.mTT.focus()}catch(h){}};Field.prototype.EvtInside=function(f){var o=f.mMouseX;var k=f.mMouseY;this.mTT=this.mObj;var h=this.mTT.style.left;var d=this.mTT.style.top;var b=-1;b=h.indexOf("px");if(b!=-1){h=h.substring(0,b)}b=d.indexOf("px");if(b!=-1){d=d.substring(0,b)}h=parseInt(h);d=parseInt(d);var g=h+this.mTT.clientWidth;var s=d+this.mTT.clientHeight;if(o>(h+1)&&o<=g&&k>(d+1)&&k<=s){return true}else{return false}};Field.prototype.getNoDragDropStyleClasses=function(){return null};Field.prototype.getDragHandlePrefixes=function(){return null};Field.prototype.setDecorator=function(d,b){};Field.prototype.setBoldness=function(b){};Field.prototype.flashInit=function(b){this.mFlashInit=b};Field.prototype.isFlashInit=function(){return this.mFlashInit};function SetFieldFromDialog(d,b,f){if(b in getFields_NS(d)){var g={};weDeepCopy(g,f);getFields_NS(d)[b].S(Datatype_Factory(f))}}Field.prototype.GetIFrameDoc=function(){if(this.mIFrame==null){return null}if(this.mIFrame.tagName=="IFRAME"){return DocView.GetIFrameDoc(this.mIFrame,this.mIFrame.name)}else{return this.mIFrame}};Field.prototype.fixFontsAndURL=function(b){if(this.mRTF&&b){var d=["","fnt1","fnt2","fnt3","fnt4","fnt5","fnt6","fnt7"];$(b).find("font, a").each(function(u){if($(this).is("a")){var z=$(this).attr("path");var g=$(this).attr("href");var h=$(this)[0].hash;if(z){var f=AbsContextPath+z;$(this)[0].href=f;$(this)[0].target="_blank"}else{if(g&&g.indexOf(AbsContextPath)!=-1&&(g.indexOf("#")==0||(h&&h.indexOf("#")==0&&g.indexOf(h)!=-1))){$(this)[0].href=h;if($(this)[0].target&&$(this)[0].target.length>0){$(this)[0].target=""}}}}else{if($(this).is("font")){var o={};var s=$(this).attr("face");if(s){o["font-family"]=s}s=$(this).attr("color");if(s){o.color=s}s=$(this).attr("size");if(s){if(s>7){s=7}var v=d[s];if(!$(this).hasClass(v)){$(this).addClass(v)}}else{s=$(this).attr("style");if(!s||s.toLowerCase().indexOf("font-size")<0){var y=null;var k=$(this).parents("font[style],font[size],h1,h2,h3,h4,h5,h6").filter(function(){if($(this).is("font")){s=$(k).attr("size");if(s&&s>7){s=7}if(s===null||typeof s==="undefined"){s=$(k).attr("style");if(!s||s.toLowerCase().indexOf("font-size")<0){return false}}}return true}).filter(":first");if($(k)&&$(k).length){if($(k).is("font")){s=$(k).attr("size");if(s&&s>7){s=7}if(s&&d[s]){var v=d[s];if(!$(this).hasClass(v)){$(this).addClass(v)}$(this).css(o);return}else{var w=$(k).attr("style");if(w&&w.length>0&&w.toLowerCase().indexOf("font-size")>=0){y=$(k).css("font-size")}}}else{y=$(k).css("font-size")}}if(!y){y="8pt"}o["font-size"]=y}}$(this).css(o)}}})}};function getExpandedTD(d){var f=d.parentNode;if(f.tagName!="TR"){return null}while(f.nextSibling){f=f.nextSibling;if(f.tagName=="TR"){break}}for(var b=0;b<f.childNodes.length;b++){if(f.childNodes[b]!=null&&f.childNodes[b].tagName=="TD"){return f.childNodes[b]}}return null}function getTwistyIMG(d){var f=d;if(f.className.indexOf("expTitleText")!=-1){while(f.previousSibling){f=f.previousSibling;if(f.tagName=="TD"){break}}}var b=f.getElementsByTagName("img");if(b.length>0){return b[0]}return null}function collapse(d,b){}function collapse_twisty(f,u,h,b,g,k){var d=null;var o=null;if(typeof u!="undefined"&&u!=null){d=getExpandedTD(u);o=getTwistyIMG(u)}if(d==null){d=document.getElementById("expSection_"+f)}if(o==null){o=document.getElementById("img_expSection_"+f)}if(d.className=="expDataB"){d.className="expDataA";o.src=(AbsContextPath+"resources/images/twisty-down-blue.gif");if(!useLegacyRTFEditor){d.style.display="";o.setAttribute("data-cke-saved-src",(AbsContextPath+"resources/images/twisty-down-blue.gif"));expcolFieldSize(h,b,0,g,k)}}else{var s;if(!useLegacyRTFEditor){s=d.scrollHeight}else{s=d.offsetParent.clientHeight-d.offsetHeight}d.className="expDataB";o.src=(AbsContextPath+"resources/images/twisty-right-blue.gif");if(!useLegacyRTFEditor){d.style.display="none";o.setAttribute("data-cke-saved-src",(AbsContextPath+"resources/images/twisty-right-blue.gif"));expcolFieldSize(h,b,s,g,k)}else{collapseFieldSize(h,b,s)}}}function expcolFieldSize(s,k,f,o,v){var w=F(s,k);var b=w.mIFrame;var d=YAHOO.util.Dom,u=YAHOO.util.Event,g=YAHOO.lang;var h;if(w.mAutoSizeHeight&&!v){if(o){resizeRTFImage(s,k,10)}else{var y=b.scrollHeight-f;if(y<w.mMinHeight){h=w.mMinHeight}else{if(w.mMaxHeight!=0&&y>w.mMaxHeight){h=w.mMaxHeight}else{h=y}}d.setStyle(w.mInputNode.parentNode,"height",h+"px");d.setStyle(w.mInputNode,"height",(h+5)+"px");d.setStyle(b,"height","99%");d.setStyle(b,"zoom","1")}}}function collapseFieldSize(f,s,g){var d=F(f,s);var k=d.mIFrame;var h=YAHOO.util.Dom,b=YAHOO.util.Event,o=YAHOO.lang;h.setStyle(d.mInputNode.parentNode,"height",g+"px");h.setStyle(d.mInputNode,"height",(g+5)+"px");h.setStyle(k,"height","99%");h.setStyle(k,"zoom","1");resizeRTFImage(f,s)}function FieldSnapshot(windowID,d,a,hsd){this.windowID=windowID;if(arguments.length==2){eval(d)}else{this.mSnap={};if(arguments.length>2){this.d=d;this.a=a;if(hsd){for(var i in getFields_NS(windowID)){var fi=getFields_NS(windowID)[i];if(fi.mHaveStoredData){this.mSnap[i]=fi.Snapshot(d,a)}}}else{for(var i in getFields_NS(windowID)){this.mSnap[i]=getFields_NS(windowID)[i].Snapshot(d,a)}}}}}FieldSnapshot.prototype.Restore=function(){for(var b in this.mSnap){getFields_NS(this.windowID)[b].Restore(this.mSnap[b],this.d,this.a)}};FieldSnapshot.prototype.DataDiff=function(b){var f={};var d=b.mSnap;var h=this.mSnap;for(var g in getFields_NS(this.windowID)){if(g in h){if(h[g].d.Diff(d[g].d)){f[g]=1}}}return f};FieldSnapshot.prototype.GetDataForID=function(b){if(this.mSnap[b]){return this.mSnap[b].d}else{return Null}};function FieldList(b,g){this.windowID=b;this.mFields=new Object();if(g instanceof Array){for(var f=0;f<g.length;++f){var h=g[f];if(h>0){var d=F(this.windowID,h).G();if(d instanceof CharNullType){d=new CharType(" ")}this.AddField(h,d)}else{this.AddField(h,ARKWGetByNegIdx(this.windowID,h))}}}}FieldList.prototype.F=function(b){return(b in this.mFields)?this.mFields[b]:Null};FieldList.prototype.AddField=function(d,b){this.mFields[d]=b};FieldList.prototype.AddFields1=function(b,g){for(var d=0;d<b.length&&d<g.length;++d){var f=b[d];this.mFields[g[d]]=Datatype_Factory(f)}};FieldList.prototype.RemoveField=function(b){delete this.mFields[b]};FieldList.prototype.ToArrays=function(d,b,g){for(var h in this.mFields){var f=this.mFields[h];d.push(parseInt(h));b.push(f.toPrimitive());g.push(f.type)}};FieldList.prototype.Query=function(f,g,s,u,b,d){f=ExpandServerName(this.windowID,f);g=ExpandSchemaName(this.windowID,g);var o=IsExternQualOptimizable(this.windowID,s);s=ExpandQualifier(this.windowID,s,g,f,o);var w=new NDXGetEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),f,g,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),s.qual,s.fieldids,s.fieldvals,s.fieldtypes,s.fieldexterns,o,b,u,d);var v=w.result;ARKWSetLASTCOUNT(this.windowID,v.n);if("mids" in v){d=v.mids}if("f" in v){this.AddFields1(v.f,d)}else{if("l" in v){var h={};return{n:{f:function(y){if(!("v" in h.result)||h.result.v==-1){getCurWFC_NS(y.windowID).status(0)}w=new NDXGetEntry(y.windowID,f,g,((ARKWGetStringByIdx(y.windowID,21)!=null)?ARKWGetStringByIdx(y.windowID,21):""),window.name,v.l.r[h.result.v].i,d,false);v=w.result;if(v instanceof Array){y.AddFields1(v,d)}else{ARKWSetLASTCOUNT(y.windowID,0);if(b==1){getCurWFC_NS(y.windowID).status(9278)}}},a:[this]},c:{f:SelectionPopup,a:[this.windowID,v,h]}}}else{if((v.n==0&&b==2)||(v.n>0&&u==2)){for(var k=0;k<d.length;++k){this.AddField(d[k],Null)}}else{if(v.n>0){getCurWFC_NS(this.windowID).status(9277)}else{getCurWFC_NS(this.windowID).status(9278)}}}}};FieldList.PopulateValueAndTypeArrays=function(b,g,k,d){for(var f in g){id=g[f];var h;if(id>0){h=F(b,id).G()}else{h=ARKWGetByNegIdx(b,id)}if(h instanceof CharNullType){k.push("");d.push(4)}else{k.push(h.toPrimitive());d.push(h.type)}}};FieldList.prototype.SQLQuery=function(B,o,v,s,G,h,E){var k=new Array();var y=new Array();FieldList.PopulateValueAndTypeArrays(this.windowID,G,k,y);var C=new Array();var f=new Array();FieldList.PopulateValueAndTypeArrays(this.windowID,h,C,f);var b=new NDXGetSQLEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),B,o,s,v,G,k,y,h,C,f,false);var H=b.result;if(typeof H=="object"){ARKWSetLASTCOUNT(this.windowID,H.n);var A=new Array();var D=H.l.r[0].d.length;for(var d=1;d<=D;d++){A.push(d)}if(H.n==1){this.AddFields1(H.l.r[0].d,A)}else{if(v==1){getCurWFC_NS(this.windowID).status(9277)}var w=[];var g=H.l.r[0].d.length;for(var u=1;u<=g;u++){w.push(getLocalizedMessage("Column "+u))}H.l.h=w;var z={};return{c:{f:SelectionPopup,a:[this.windowID,H,z]},n:{a:[this],f:function(L){if(!("v" in z.result)||z.result.v==-1){getCurWFC_NS(L.windowID).status(0)}var N=H.l.r[z.result.v];var K=[];var I=N.d.length;for(var J=0;J<I;++J){K.push(N.d[J])}L.AddFields1(K,A)}}}}}else{ARKWSetLASTCOUNT(this.windowID,H);if((H==0&&s==2)||(H>0&&v==2)){}else{if(H>0){getCurWFC_NS(this.windowID).status(9277)}else{getCurWFC_NS(this.windowID).status(9278)}}}};FieldList.prototype.Push=function(v,o,s,w,f,k,y){var b=(y&&(AREventFunction(this.windowID,4096)||ARPrefsGetAsNumber(28515)==1))?true:false;o=ExpandServerName(this.windowID,o);s=ExpandSchemaName(this.windowID,s);v=ExpandQualifier(this.windowID,v,s,o);var g=new Array();var h=new Array();var d=new Array();this.ToArrays(g,h,d);var u=new Array();this.DirtyTableData(u);if(ShowWaitCursor()&&y){var z=new NDXRequest();z.windowID=this.windowID;var A={isFromFunctionSplit:1,c:{t:this,f:function(){z.AsyncBC("SetEntryList",this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),o,((y)?"":s),F(this.windowID,1).G().toString(),v.qual,v.fieldids,v.fieldvals,v.fieldtypes,f,w,k,g,h,d,getForm_NS(this.windowID).reqIdStrField,b,u);z.showRunning();weDisableStuff(this.windowID);return{i:1}}},n:{t:this,f:this.PushP2,a:[z,y,f,w]}};return A}else{var z=new NDXSetEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),o,((y)?"":s),F(this.windowID,1).G().toString(),v.qual,v.fieldids,v.fieldvals,v.fieldtypes,f,w,k,g,h,d,(!y)?0:getForm_NS(this.windowID).reqIdStrField,b,u);this.PushP2(z,y,f,w)}};FieldList.prototype.PushP2=function(g,h,f,k){var d=g.result;if(d instanceof Object){if(!h){ARKWSetLASTCOUNT(this.windowID,0)}ARKWSetLASTID(this.windowID,d.id);getForm_NS(this.windowID).reqIdStr=d.id;var b=F(this.windowID,getForm_NS(this.windowID).reqIdStrField);if((b.mDataType==7||b.mDataType==12)&&b.mPrimVal.length>0){getForm_NS(this.windowID).statusReqIdStr=b.mPrimVal}else{if(b.mDataType==6&&b.mDataVal.mLabel){getForm_NS(this.windowID).statusReqIdStr=b.mDataVal.mLabel}else{if(typeof d.reqStr!="undefined"){getForm_NS(this.windowID).statusReqIdStr=d.reqStr}}}if(typeof d.e!="undefined"){getForm_NS(this.windowID).entry=d.e}}else{ARKWSetLASTCOUNT(this.windowID,d);if(d==0&&f==1){getCurWFC_NS(this.windowID).status(9278)}else{if(d>0&&k==1){getCurWFC_NS(this.windowID).status(9364)}}}};FieldList.prototype.PushEntry=function(h,o,s,v,k,b){h=ExpandServerName(this.windowID,h);o=ExpandSchemaName(this.windowID,o);var f=new Array();var g=new Array();var d=new Array();this.ToArrays(f,g,d);var u=new Array();this.DirtyTableData(u);if(ShowWaitCursor()){k.req=new NDXRequest();k.req.windowID=this.windowID;return{isFromFunctionSplit:1,c:{t:this,f:function(){k.req.AsyncBC("SetEntry",this.windowID,h,o,window.name,s,v,f,g,d,b,u);k.req.showRunning();weDisableStuff(this.windowID);return{i:1}}},n:{t:this,f:function(){var y=k.req.result;this.PushEntryP2(y,s.length);return}}}}else{k.req=new NDXSetEntry(this.windowID,h,o,window.name,s,v,f,g,d,b,u);var w=k.req.result;this.PushEntryP2(w,s.length);return w}};FieldList.prototype.PushEntryP2=function(b,d){if(b.n==1){getForm_NS(this.windowID).entry=b.e;if("eid" in b){getForm_NS(this.windowID).reqIdStr=b.eid}}};FieldList.SetAllGlobals=function(b,g){if(arguments.length==1){if(b==getTopWinWindowID_NS()){g=true}else{g=false}}var o=getFormContext(b);if(typeof o=="undefined"||o==null){return}var h=getFieldChanged_NS(b);var d=getForm_NS(b);for(var k in d.globalFields){F(b,d.globalFields[k]).ReadGlobalData()}ARKWGetGlobalKeywords(b);if((h==0)&&(getFieldChanged_NS(b)!=0)){Field_ClearChanged(b)}if(g==true){FieldList.SetAllLogicalChildrenGlobals(b,g)}};FieldList.SetAllLogicalChildrenGlobals=function(b,g){var h=getLogicalChildWindowIDs(b);for(var d in h){var f=h[d];if(f!=b){FieldList.SetAllGlobals(f,g)}}};FieldList.SetGlobalFieldsforOtherWindows=function(d,h){do{if(!(typeof d!="undefined")){Assert('(FieldList_ns.js:470) typeof windowID != "undefined"')}}while(0);do{if(!(typeof h!="undefined")){Assert('(FieldList_ns.js:470) typeof fieldid != "undefined"')}}while(0);var u=getFormContext(d);if(typeof u=="undefined"||u==null){return}var v=getFieldChanged_NS(d);var o=getForm_NS(d);for(var s in o.globalFields){if(o.globalFields[s]==h){F(d,o.globalFields[s]).ReadGlobalData()}}if((v==0)&&(getFieldChanged_NS(d)!=0)){Field_ClearChanged(d)}var b=getLogicalChildWindowIDs(d);for(var g in b){var k=b[g];if(k!=d){FieldList.SetGlobalFieldsforOtherWindows(k,h)}}};FieldList.ClearAllGlobals=function(){deleteCookie("GF","/");var b=getCookie("FC");if(b=="1"){removeGlobalFields()}deleteCookie("FC","/")};FieldList.prototype.DirtyTableData=function(b){};DataField.prototype=new Field();DataField.prototype.constructor=DataField;DataField.superclass=Field.prototype;function DataField(b,f,d){if(arguments.length){this.init(b,f,d)}}DataField.prototype.mDOMField=DataField.prototype.mHaveVisualCharacteristics=true;DataField.prototype.init=function(b,g,f){this.mDataVal=(this.mDataType==4)?CharNull:Null;DataField.superclass.init.call(this,b,g,f);var d=this.mObj.childNodes[1];while(d!=null&&(d.nodeType==1&&(d.className&&d.className.indexOf("label")==-1)||!d.className)){d=d.firstChild}this.mTextElement=d;if(this.mInputNode){this.mInputNode.onchange=DataField.fvChanged}};var SACCESSRE=/([ ]*dfro)|([ ]*dfd)/;DataField.fvChanged=FormEvent.Trampoline(function(b){var d=Field_FromElement(b.element);if(d){d.FieldValChanged()}});DataField.prototype.FieldValChanged=function(){var b=this.GetScreenValAsPrimitive();if(this.mPrimVal==b){return}if(this instanceof DEnum&&this.mDataVal.mValue==b){if(!((b==""||typeof b=="undefined")&&(this.mDataVal.mValue!=null))){return}}this.mPrimVal=b;if(b==""||typeof b=="undefined"){this.mDataVal=(this.mDataType==4)?CharNull:Null}else{var d={hasKeyword:false,hasTemporalKeyword:false};b=ExpandString(this.windowID,b,2|4,this.mID,this.mDataType,d);if(d.hasTemporalKeyword){this.mDataVal=null}else{if(b==""){if(d.hasKeyword){this.mDataVal=(this.mDataType==4)?CharNullType.KEYWORD_CHAR_NULL:NullType.KEYWORD_NULL}else{this.mDataVal=(this.mDataType==4)?CharNull:Null}}else{this.mDataVal=this.ConvertPrimitiveToDataType(b)}}}if(!("mDCF" in this)){this.mDCF=(this.mObj.getAttribute("ardcf")!=null)}DataField.superclass.SetDirty.call(this);this.SaveGlobalData()};DataField.prototype.G=function(){if(this.mDataVal==null||(this.mDataVal.mVal&&typeof this.mDataVal.mVal=="string"&&this.mRTF&&this.mRTFAttachmentFieldID&&this.mRTFAttachmentFieldID>0)){var b=this.GetScreenValAsPrimitive();b=ExpandString(this.windowID,b,2|4,this.mID,this.mDataType);if(b==""){return(this.mDataType==4)?CharNull:Null}return this.ConvertPrimitiveToDataType(b)}return this.mDataVal};DataField.prototype.encrypt=function(){return this.G()};DataField.prototype.GetScreenValAsPrimitive=function(){if(this.mbShowURL){return this.GetValue()}else{if(this.mRTF){if(this.mInputNode.firstChild){return this.GetRTFVal()}else{return""}}}return this.mInputNode.value};DataField.prototype.SetScreenValue=function(b){if(this.mbShowURL){this.updateInnerHTML(b);this.mInputNode.value=this.innerText();if(this.mInputNode.value.length>0){this.mDivEditBox.style.visibility="visible";this.mInputNode.style.visibility="hidden"}else{this.mDivEditBox.style.visibility="hidden";this.mInputNode.style.visibility="visible"}this.mOrgValue=this.mInputNode.value}else{if(this.mRTF){this.SetRTFVal(b)}else{this.mInputNode.value=b}}this.FieldValChanged()};DataField.prototype.GetScreenValue=function(){if(this.mbShowURL){return this.GetValue()}else{if(this.mRTF){return this.GetRTFVal()}}return this.mInputNode.value};DataField.prototype.ConvertPrimitiveToDataType=function(b){};DataField.prototype.Clear=function(){var b=this.mID;if((b>=1000000&&b<=1999999)||(b>=3000000&&b<=3999999)||b==1576||b==1575){return}this.mDataVal=(this.mDataType==4)?CharNull:Null;this.mPrimVal="";this.mOrgValue="";if(this.mNeedSpecialSetToScreen){this.SToScreen(this.mDataVal,this.mPrimVal)}else{if(this.mbShowURL){this.SetValue("")}else{if(this.mRTF){this.mAllowAutoResize=false;this.SetRTFVal("")}else{this.mInputNode.value=""}}}if(this.mCharEditBox){if(this.mbShowURL){CharEditBoxPopup_UpdateText(this.mCharEditBox,this.mDivEditBox.innerHTML,true)}else{if(this.mRTF){CharEditBoxPopup_UpdateText(this.mCharEditBox,this.GetRTFVal(),true)}else{CharEditBoxPopup_UpdateText(this.mCharEditBox,this.mPrimVal,false)}}}};DataField.prototype.DoSet=function(d){var f;if(d.isNull){this.mDataVal=(this.mDataType==4)?CharNull:Null;f=""}else{d=this.ConvertDTForS(d);f=d.toString();if(f==""){this.mDataVal=(this.mDataType==4)?CharNull:Null}else{if(d.type==4){var g={hasKeyword:false,hasTemporalKeyword:false};var b=ExpandString(this.windowID,f,2|4|8,this.mID,this.mDataType,g);if(g.hasTemporalKeyword){this.mDataVal=null}else{if((this.mDataType==4)&&!g.hasKeyword){f=f.replace(/<\s*(base)\s+[(href)(target)].*>/gi,"");this.mDataVal=d}else{if(b==""){this.mDataVal=(this.mDataType==4)?CharNull:Null;f=""}else{this.mDataVal=d=this.ConvertPrimitiveToDataType(b);f=d.toString()}}}}else{this.mDataVal=d}}}this.mPrimVal=f;this.mOrgValue=f;if(this.mNeedSpecialSetToScreen){return this.SToScreen(d,f)}if(this.mbShowURL){this.SetValue(f)}else{if(this.mRTF){this.mPrimVal=this.SetRTFVal(f)}else{this.mInputNode.value=f}}if(typeof AnimMgr!="undefined"){AnimMgr.Highlight(this,this.mObj)}if(!this.mbShowURL&&!this.mRTF){this.mPrimVal=this.mInputNode.value}if(this.mCharEditBox){if(this.mbShowURL){CharEditBoxPopup_UpdateText(this.mCharEditBox,this.mDivEditBox.innerHTML,true)}else{if(this.mRTF){CharEditBoxPopup_UpdateText(this.mCharEditBox,this.GetRTFVal(),true)}else{CharEditBoxPopup_UpdateText(this.mCharEditBox,this.mPrimVal,false)}}}this.SetDirty(this.mInputNode)};DataField.prototype.DoSLoadEntry=function(f){var h;if(f.isNull){this.mDataVal=(this.mDataType==4)?CharNull:Null;h=""}else{f=this.ConvertDTForSLE(f);h=f.toString();if(h==""){this.mDataVal=(this.mDataType==4)?CharNull:Null}else{if(f.type==4){var o={hasKeyword:false,hasTemporalKeyword:false};var d=ExpandString(this.windowID,h,2|4,this.mID,this.mDataType,o);if(o.hasTemporalKeyword){this.mDataVal=null}else{if((this.mDataType==4)&&!o.hasKeyword){this.mDataVal=f}else{if(d==""){this.mDataVal=(this.mDataType==4)?CharNull:Null;h=""}else{this.mDataVal=f=this.ConvertPrimitiveToDataType(d);h=f.toString()}}}}else{this.mDataVal=f}}}this.mPrimVal=f.compareValStr();var b=h;if(this.mNeedSpecialSetToScreen){this.SToScreen(f,h);if(this instanceof DGroup){var g=Group_Validate(this.mID,b,false);if(g&&g.v){b=g.v}}}else{if(this.mbShowURL){this.SetValue(h)}else{if(this.mRTF){this.mPrimVal=this.SetRTFVal(h)}else{this.mInputNode.value=h}}if(!this.mbShowURL&&!this.mRTF){this.mPrimVal=this.mInputNode.value}this.SetDirty(this.mInputNode)}var k=this.mCharEditBox?this.mCharEditBox:this.mRichTextEditBox;if(k){if(this.mbShowURL){CharEditBoxPopup_UpdateText(k,this.mDivEditBox.innerHTML,true)}else{if(this.mRTF){CharEditBoxPopup_UpdateText(k,this.GetRTFVal(),true)}else{CharEditBoxPopup_UpdateText(k,b,true)}}}};DataField.prototype.DOMKeyPress=function(b){if(b.key==13){return ExecuteWorkflow(this.windowID,2,this.mID)}};DataField.prototype.GetHoverValue=function(b){return""};DataField.prototype.GetDataPortion=function(){return this.mInputNode};DataField.prototype.TracksCaret=true;DataField.prototype.mDataType=0;DataField.prototype.setDecorator=function(f,d){var b=this.GLabel();if(d==1){b=b+f}else{b=f+b}this.UpdateLabel(b)};DataField.prototype.UpdateAccess=function(f){var d=f==3,b=f==1;var h=this.mObj,g=h;g.className=g.className.replace(SACCESSRE,"");if(d){g.className+=" dfd"}while(1){if(g.nodeType==1&&(g.tagName=="INPUT"||g.tagName=="TEXTAREA")){if(typeof(this.mDisplayAsText)=="undefined"||(typeof(this.mDisplayAsText)!="undefined"&&this.mDisplayAsText==false)){g.disabled=d;g.readOnly=b}if(g.tagName=="INPUT"&&(g.type=="checkbox"||g.type=="radio")){g.disabled=d|b}g.style.backgroundColor=((b&&g.className.indexOf("dat")==-1)?getARFieldROBg_NS(this.windowID):"")}else{if(g.nodeType==1&&g.tagName=="DIV"&&FakeButton_Find(g)){FakeButton_SetDisable(g,d)}}if(g.firstChild){g=g.firstChild}else{while(!g.nextSibling){g=g.parentNode;if(g==h){return}}g=g.nextSibling}}};DataField.prototype.UpdateROColour=function(){var d=this.mObj,b=d;while(1){if(b.nodeType==1){if((b.tagName=="INPUT"||b.tagName=="TEXTAREA")&&b.className.indexOf("dat")==-1){b.style.backgroundColor=getARFieldROBg_NS(this.windowID);return}}if(b.nodeType==1&&(b.tagName=="DIV"||b.tagName=="FIELDSET"||b.tagName=="LEGEND")&&b.firstChild){b=b.firstChild}else{while(!b.nextSibling){b=b.parentNode;if(b==d){return}}b=b.nextSibling}}};DataField.prototype.GetFocusElement=function(){if("mFocusElement" in this){return this.mFocusElement}var d=this.mObj,b=d;while(1){if((b.nodeType==1)&&((b.tagName=="INPUT")||(b.tagName=="TEXTAREA")||(b.tagName=="IMG"))){this.mFocusElement=b;return b}if(b.firstChild){b=b.firstChild}else{while(!b.nextSibling){b=b.parentNode;if(b==d){this.mFocusElement=null;return null}}b=b.nextSibling}}};DataField.prototype.HighlightBorder=function(){var b=this.GetDataPortion();if(b){b.className+=" bHighlight";getStateMgr_NS(this.windowID).highlightedFlds.push(this.mID)}};DataField.prototype.RemoveHighlightBorder=function(){var b=this.GetDataPortion();if(b){b.className=b.className.replace("bHighlight","")}};DataField.prototype.SetDirty=function(b){if(b){if(getCurWFC_NS(this.windowID)){getCurWFC_NS(this.windowID).addDirtyElement(this.mID,b)}else{FormEvent.FireChangeEvent(b)}}if(!((this.mID>=1000000&&this.mID<=1999999||this.mID>=3000000&&this.mID<=3999999)&&getCurWFC_NS(this.windowID))){DataField.superclass.SetDirty.call(this)}};DataField.prototype.DOMMouseOver=function(b){var d=this.mInputNode;if(this.mHasMenu!="undefined"&&this.mHasMenu){d.title=d.value}return hoverState.eventMouseOver(b)};DataField.prototype.DOMMouseMove=function(b){return hoverState.eventMouseMove(b)};DataField.prototype.DOMMouseOut=function(b){return hoverState.eventMouseOut(b)};DataField.prototype.DOMClick=function(b){hoverState.clearTracking()};DataField.prototype.getDragHandlePrefixes=function(){return["label"]};DataField.prototype.setBoldness=function(b){var d=this.mTextElement;if(!d){return}if(d.style){if(b){d.style.fontWeight="bold"}else{d.style.fontWeight="normal"}}};DataField.prototype.clearDec=function(){if(this.mCFCache.r==1||this.mCFCache.r==0){if(this.mCFCache.r==1){this.UpdateLabel(this.GLabel());this.setBoldness(false)}if(this.mTextElement){this.mTextElement.style.fontWeight=""}this.mCFCache.r=3}};function getARKWValuesInstance(){var b=[{n:"NULL",t:0,v:null},{n:"DEFAULT",t:104,v:ARKWGetFieldDefault},{n:"USER",t:0,v:null},{n:"TIMESTAMP",t:60,v:ARKWGetTimeStamp},{n:"TIME",t:60,v:ARKWGetTime},{n:"DATE",t:60,v:ARKWGetDate},{n:"SCHEMA",t:0,v:null},{n:"SERVER",t:0,v:null},{n:"WEEKDAY",t:60,v:ARKWGetWeekday},{n:"GROUPS",t:0,v:null},{n:"OPERATION",t:2,v:null},{n:"HARDWARE",t:0,v:null},{n:"OS",t:40,v:ARKWGetOS},{n:"DATABASE",t:0,v:null},{n:"LASTID",t:6,v:null},{n:"LASTCOUNT",t:7,v:null},{n:"VERSION",t:0,v:null},{n:"VUI",t:0,v:null},{n:"GUIDETEXT",t:0,v:null},{n:"FIELDHELP",t:64,v:null},{n:"GUIDE",t:40,v:ARKWGetGuide},{n:"APPLICATION",t:0,v:null},{n:"LOCALE",t:0,v:null},{n:"CLIENT-TYPE",t:1,v:null},{n:"SCHEMA-ALIAS",t:0,v:null},{n:"ROWSELECTED",t:45,v:ARKWGetRowSelected},{n:"ROWCHANGED",t:41,v:ARKWGetRowChanged},{n:"BROWSER",t:40,v:ARKWGetBrowserVersion},{n:"VUI-TYPE",t:0,v:null},{n:"TCPPORT",t:1,v:null},{n:"HOMEURL",t:2,v:null},{n:"ROLES",t:0,v:null},{n:"EVENTTYPE",t:2,v:null},{n:"EVENTSRCWINID",t:2,v:null},{n:"CURRENTWINID",t:2,v:null},{n:"LASTOPENEDWINID",t:2,v:null},{n:"INBULKTRANSACTION",t:1,v:null},{n:"FIELDID",t:40,v:ARKWGetFieldIDInFocus},{n:"FIELDNAME",t:40,v:ARKWGetFieldNameInFocus},{n:"FIELDLABEL",t:40,v:ARKWGetFieldLabelInFocus},{n:"SERVERTIMESTAMP",t:60,v:ARKWGetServerTimeStamp},{n:"GROUPIDS",t:0,v:null},{n:"EVENTDATA",t:2,v:null},{n:"ERRNOFILTER",t:40,v:ARKGetErrNoFilter},{n:"ERRMSGFILTER",t:40,v:ARKGetErrMsgFilter},{n:"ERRAPPMSGFILTER",t:40,v:ARKGetAppMsgFilter},{n:"INCLNTMANTRANS",t:40,v:ARKGetClientManagedTrans},{n:"DRAGSRCFIELDID",t:40,v:ARKWGetDragSourceFieldID},{n:"DROPTGTFIELDID",t:40,v:ARKWGetDropTargetFieldID},{n:"SHIFT_KEY",t:3,v:null},{n:"ALT_KEY",t:3,v:null},{n:"CTRL_KEY",t:3,v:null},{n:"AUTHSTRING",t:40,v:ARKGetAuthString},{n:"ROWVISIBLE",t:45,v:ARKWGetRowVisible}];return b}function ARKWSetup(b,d){for(var f=0;f<d.length-1;f+=2){getARKWValues_NS(b)[d[f]].v=d[f+1]}}function ARKWSet(d,b,f){getARKWValues_NS(d)[b].v=f}function ARKWGetByIdx(f,d,b){var g;if((((getARKWValues_NS(f)[d]).t&32)!=0)){g=getARKWValues_NS(f)[d].v(f,b)}else{g=getARKWValues_NS(f)[d].v}if(g!=null){if(g instanceof Datatype){return g}else{if((((getARKWValues_NS(f)[d]).t&1)!=0)){return new IntegerType(g)}else{if((((getARKWValues_NS(f)[d]).t&1)==0)){return new CharType(g)}}}}return Null}function ARKWGetByNegIdx(f,d,b){d=(-d)+1;return ARKWGetByIdx(f,d,b)}function ARKWGetNameByIdx(d,b){return getARKWValues_NS(d)[b].n}function ARKWGetKeywordIdx(b,d){return getARKWNameLookup_NS(b)[d]}function ARKWGetByName(d,f,b){return ARKWGetByIdx(d,getARKWNameLookup_NS(d)[f],b)}function ARKWGetStringByIdx(f,d,b){var g=ARKWGetJSNativeByIdx(f,d,b);return g}function ARKWGetJSNativeByIdx(f,d,b){var g;if((((getARKWValues_NS(f)[d]).t&32)!=0)){g=getARKWValues_NS(f)[d].v(f,b)}else{g=getARKWValues_NS(f)[d].v}return g}function ARKWIsKeywordIdx(b){return(b>=0&&b<=53)}function ARKWIsKeywordName(b,d){return(typeof getARKWNameLookup_NS(b)[d]!="undefined")}function ARKWIsKeywordOrEscapedKeyword(b,d){if((ARKWIsKeywordName(b,d))||(d.length>2&&d.charAt(0)=="\\"&&ARKWIsKeywordName(b,d.substr(1)))){return true}return false}function ARKWIsKeywordString(b,d){if(typeof d=="string"||d instanceof CharType){d=d.toString();if(d.length>2&&d.charAt(0)=="$"&&d.charAt(d.length-1)=="$"){return ARKWIsKeywordName(b,d.substring(1,d.length-1))}}return false}function ARKWIsTemporal(d,b){return(((getARKWValues_NS(d)[b]).t&4)!=0)}function ARKWIsTemporalString(b,d){if(typeof d=="string"||d instanceof CharType){d=d.toString();if(d.length>2){d=d.substring(1,d.length-1);if(typeof getARKWNameLookup_NS(b)[d]!="undefined"&&typeof getARKWValues_NS(b)[getARKWNameLookup_NS(b)[d]]!="undefined"){return(((getARKWValues_NS(b)[getARKWNameLookup_NS(b)[d]]).t&4)!=0)}}}return false}function ARKWIsTimeRelated(d,b){return(((getARKWValues_NS(d)[b]).t&16)!=0)}function ARKWIsConstant(d,b){return(((getARKWValues_NS(d)[b]).t&2)==0)}var realtimeKeyMap={};realtimeKeyMap[49]=realtimeKeyMap[50]=realtimeKeyMap[51]=0;var keyRefCnt=0;function ARKWSetShifCtrlAltToRealtime(){var b=getTopWinWindowID_NS();setShifCtrlAltRecursive(b,realtimeKeyMap[49],realtimeKeyMap[51],realtimeKeyMap[50])}function setShifCtrlAltRecursive(f,s,h,d){ARKWSet(f,49,s);ARKWSet(f,51,h);ARKWSet(f,50,d);var b=getLogicalChildWindowIDs(f);if(b==null||b.length==0){return}var o=b.length;for(var k=0;k<o;k++){var g=b[k];if(getFormContext(g)){setShifCtrlAltRecursive(g,s,h,d)}}}function ARKWGetTime(){return new TODKWType()}function ARKWGetTimeStamp(){var b=new Date().UnixTimestamp();return new TimeType(b)}function ARKWGetServerTimeStamp(b){var d=new NDXGetServerTimestamp(b,ARKWGetStringByIdx(b,7)).GetResult();return new TimeType(d)}function ARKWGetDate(){return new DateKWType()}function ARKWGetWeekday(){return new WeekdayKWType()}function ARKWGetFieldDefault(windowID,fieldid){if(typeof fieldid=="undefined"){return null}if(fieldid in getDefaults_NS(windowID)&&"d" in getDefaults_NS(windowID)[fieldid]){var defStr=ExpandString(windowID,""+getDefaults_NS(windowID)[fieldid].d,(F(windowID,fieldid) instanceof JColumn)?1:4);if("de" in getDefaults_NS(windowID)[fieldid]){defStr=ExpandString(windowID,""+getDefaults_NS(windowID)[fieldid].de,(F(windowID,fieldid) instanceof JColumn)?1:4);return eval(defStr)}else{return defStr}}return null}function ARKWGetFieldIDInFocus(b){return FocusMgr.getFocusedID()+""}function ARKWGetFieldNameInFocus(b){var d=FocusMgr.getFocusedID();return F(b,d).GName()}function ARKWGetFieldLabelInFocus(b){var d=FocusMgr.getFocusedID();return F(b,d).GLabel()}function ARKWGetBrowserVersion(){var k=navigator.userAgent;var b="";var s="IE";var g=navigator.appName;var h=k.indexOf(s);if(h!=-1&&k.charAt(h+s.length)==" "){var o=h+s.length+1;var d=k.indexOf(";",o);if(d!=-1){b=" "+k.substr(o,d-o)}return g+b}else{var f;b=k.match(/(opera|chrome|safari|firefox)\/?\s*(\.?\d+(\.\d+)*)/i);if(b&&(f=k.match(/version\/([\.\d]+)/i))!=null){b[2]=f[1]}b=b?b[1]+" "+b[2]:g+" "+navigator.appVersion;return b}}function ARKWGetGuide(b){if(getCurWFC_NS(b)){var d=getCurWFC_NS(b).getGuideState();if(d!=null){return d.g}}return null}function ARKWGetRowSelected(b){if(getCurWFC_NS(b)){var d=getCurWFC_NS(b).getGuideState();if(d!=null){if("table" in d){return d.table.GetRowSelected(d.currow)}}}return null}function ARKWGetRowChanged(b){if(getCurWFC_NS(b)){var d=getCurWFC_NS(b).getGuideState();if(d!=null){if("table" in d){return d.table.GetRowState(d.currow)}}}return null}function ARKWGetRowVisible(b){if(getCurWFC_NS(b)){var d=getCurWFC_NS(b).getGuideState();if(d!=null){if("table" in d){return Number(d.table.GetRowVisibility(d.currow))}}}return null}function ARKWSetLASTID(b,d){ARKWGetGlobalKeywords(b);ARKWSet(b,14,d);ARKWSetGlobalKeywords(b)}function ARKWSetLASTCOUNT(b,d){ARKWGetGlobalKeywords(b);ARKWSet(b,15,d);ARKWSetGlobalKeywords(b)}function ARKWSetGlobalKeywords(b){var d={};d[14]=getARKWValues_NS(b)[14];d[15]=getARKWValues_NS(b)[15];SerializeGlobals(b,"GKW",d)}function ARKWGetGlobalKeywords(d){var f=DeserializeGlobals("GKW");if(f!=null){for(var b in f){getARKWValues_NS(d)[b]=f[b]}}}function ARKWGetOS(){var d=new Array("unknown","unknown");brs=navigator.userAgent.toLowerCase();if(brs.search(/windows\sce/)!=-1){d[0]="Windows CE";try{d[1]=brs.match(/windows\sce\/(\d+(\.?\d)*)/)[1]}catch(f){}return d[0]}else{if((brs.search(/windows/)!=-1)||((brs.search(/win9\d{1}/)!=-1))){var g=d[0]="Windows";if(brs.search(/nt\s6\.0/)!=-1){d[1]=" Vista/2008 Server"}if(brs.search(/nt\s5\.1/)!=-1){d[1]=" XP"}else{if(brs.search(/nt\s5\.0/)!=-1){d[1]=" 2000"}else{if((brs.search(/win98/)!=-1)||(brs.search(/windows\s98/)!=-1)){d[1]=" 98"}else{if(brs.search(/windows\sme/)!=-1){d[1]=" Me"}else{if(brs.search(/nt\s5\.2/)!=-1){d[1]=" 2003"}else{if((brs.search(/windows\s95/)!=-1)||(brs.search(/win95/)!=-1)){d[1]=" 95"}else{if((brs.search(/nt\s4\.0/)!=-1)||(brs.search(/nt4\.0/))!=-1){d[1]=" NT 4"}else{var b=brs.indexOf("nt")+2;d[1]=" "+brs.substring(b,brs.indexOf(";",b))}}}}}}}if(null!=d[1]){g=d[0]+d[1]}return g}else{if(brs.search(/linux/)!=-1){var g="Linux";return g}else{if(brs.search(/sunos/)!=-1){g="sunos";return g}else{if((brs.search(/macintosh/)!=-1)||(brs.search(/mac\x5fpowerpc/)!=-1)){d[0]="macclassic";return d[0]}else{if(brs.search(/os\/2/)!=-1){g="os2";return g}else{if(brs.search(/hp\-ux/)!=-1){g="hpux";return g}else{d[0]="unknown";return d[0]}}}}}}}}function ARKGetErrNoFilter(){return null}function ARKGetErrMsgFilter(){return null}function ARKGetAppMsgFilter(){return null}function ARKGetClientManagedTrans(){return null}function ARKGetAuthString(){return null}function ARKWGetDragSourceFieldID(){return MidTierDragDropMgrInst.getLastDragSourceFieldID()}function ARKWGetDropTargetFieldID(){return MidTierDragDropMgrInst.getLastDropTargetFieldID()}function ShowWaitCursor(){return(showWaitCursor==1||showWaitCursor==2||showWaitCursor==4)}function StateMgr_Init(d){setARStateCurrent_NS(d,0);var b=new function(){this.windowID=d;var w=["NONE","CREATE","DIALOG","GET","QUERY","SET","SET ALL"];var G=[getLocalizedMessage("{0} (NONE)"),getLocalizedMessage("{0} (New)"),"{0}",getLocalizedMessage("{0} (Display)"),getLocalizedMessage("{0} (Search)"),getLocalizedMessage("{0} (Modify)"),getLocalizedMessage("{0} (Modify All)")];var ah={0:[2],1:[4],2:[1],3:[4,5,false],4:[4,5,true],5:[4,5,false],6:[4,3,false],7:[4,3,true],8:[4,3,false],9:[0],10:[4,5,false],11:[4,3,false],12:[0,5,false],13:[0,5,false],14:[0,5,true],15:[0,5,false],16:[0,3,false],17:[0,3,false],18:[0,3,true],19:[0,3,false],99:[4,5,true]};this.OpenWindowStates=ah;this.OpenWindowFunctions={0:FormAction_NewSearch,1:FormAction_NewRequest,2:FormAction_NewDialog,4:FormAction_NewSearch};var f=false,ac=[],v=true,N=false;this.mWindowIsClosed=false;this.mWindowIsClosing=false;this.mWindowIsCopyingNew=false;ac.S01=[av,ao,aa,Z,aC,L,U,aq];ac.S02=[Z,aC,ao,aq];ac.S03=[B,av,ao,aq,aF,ay,k,E];ac.S04=[av,ao,Z,aC,L,aq];ac.S05=[B,av,ao,aq,aF,ay,k,E];ac.S06=[B,av,ao,aq];ac.S10=[X,af,o,aa];ac.S20=[X,o,aa];ac.S30=[aB,aA,X,o,aa,az];ac.S40=[X,o,aa];ac.S50=[aB,X,af,aA,o,aa,az];ac.S60=[X,af,o,aa,az];ac.S15=[av,ao,aF,ay,k,E];ac.S33=[aB,aA,aG,ay,k,E];ac.S55=[aB,af,aA,aa,aG,B,ay,k,E];ac.S61=ac.S64=ac.S66=ac.S65=ac.S41=ac.S44=ac.S45=ac.S43=ac.S46=ac.S31=ac.S34=ac.S51=ac.S54=ac.S56=ac.S11=ac.S14=[A];this.ARStateChange=C;function C(aK,aL){var aN=getARStateCurrent_NS(aK);N=true;var aJ=ac[(("S"+(aN))+(aL))];var aM={i:0,cs:aN,ns:aL};return{c:{f:aI,a:[aK,aJ,aM]},n:{f:aH,a:[aK,aM]}}}function aH(aJ,aK){if(RTF_Close&&typeof RTF_Close!="undefined"){RTF_Close(aJ,true)}v=false;var aL=getARStateCurrent_NS(aJ);if(aK.ab){ARKWSet(aJ,10,w[aL]);getStateMgr_NS(aJ).mWindowIsClosed=false;getStateMgr_NS(aJ).mWindowIsClosing=false;an(aJ,aL)}else{if(aL!=0){I(aJ);DControl_UpdateFormActionButtons(aJ);Form_UpdateToolbar(aJ)}}N=false}function A(aJ,aN){var aK={i:0,cs:0,ns:aN.ns,pas:aN};var aO={i:0,cs:aN.cs,ns:0,nss:aK,pas:aN};var aM=ac[(("S"+(aN.cs))+(0))];var aL=ac[(("S"+(0))+(aN.ns))];return{c:{f:aI,a:[aJ,aM,aO]},n:{f:aI,a:[aJ,aL,aK]}}}function aI(aJ,aK,aM){var aL=aM.i;if(aM.ab){return}if(getWindowArgs_NS(aJ)!=null&&(getWindowArgs_NS(aJ).wMode==99||"eid" in getWindowArgs_NS(aJ))&&aM.cs==0&&aM.ns==4){setARStateCurrent_NS(aJ,aM.ns);getWindowArgs_NS(aJ).wMode=4;return}if((aL==0)&&(aM.cs==0||(aM.cs==1&&aM.ns==5))){setARStateCurrent_NS(aJ,aM.ns);ARKWSet(aJ,10,w[aM.ns]);an(aJ,aM.ns)}if(aL<aK.length){aM.i++;return{c:{f:aK[aL],a:[aJ,aM],e:R,ea:[aJ,aM,false]},n:{f:aI,a:[aJ,aK,aM]}}}}function D(aJ){aJ.ab=1;if(aJ.nss){aJ.nss.ab=1}if(aJ.pas){aJ.pas.ab=1}}function R(aJ,aK,aL,aM){if((aJ instanceof WorkflowException)&&aJ.hasMessages()&&(aJ.getCode()!=5)){if(aM){D(aL)}return WC_DisplayMessage(aK,aJ.getLStatus())}else{throw aJ}}this.InTransition=function(){return N};function an(aK,aQ){if(aK!=getTopWinWindowID_NS()){return}var aL=(aQ==4)?getARTitles_NS(aK).pluralLong:getARTitles_NS(aK).singleLong;if(aL==""){aL=ARKWGetStringByIdx(aK,6)}window.title=document.title=getLocalizedMessage(G[aQ],[aL,ARKWGetStringByIdx(aK,7)]);try{if(window.frameElement&&window.frameElement.parentNode&&window.frameElement.parentNode.className.indexOf("DIVPopupBody")!=-1){var aR=window.frameElement.parentNode.parentNode;if(aR.previousSibling&&aR.previousSibling.tagName=="TR"){var aP=aR.previousSibling.getElementsByTagName("DIV");if(aP.length>0){aP[0].innerHTML=window.title.HTMLEncode()+"&nbsp;&nbsp;&nbsp;"}if(aR.parentNode&&aR.parentNode.parentNode&&aR.parentNode.parentNode.parentNode){var aM=aR.parentNode.parentNode.parentNode.getElementsByTagName("b");var aN="";var aJ=getFormElements_NS(0)["FormContainer"];if(typeof aJ!="undefined"){aN=aJ.style.backgroundColor;if(aN==""){aN="#FFFFFF"}}if(aM.length>3&&aN!=""){aM[0].style.backgroundColor=aN;aM[1].style.backgroundColor=aN;aM[2].style.backgroundColor=aN}}}}}catch(aO){}}this.GetToolbarTitle=function(){var aJ=getLocalizedMessage(G[getARStateCurrent_NS(this.windowID)],["",""]);return aJ.match(/\((.*?)\)/)[1]};this.GetActionButtonString=function(){if(getARStateCurrent_NS(this.windowID)==4){return getLocalizedMessage("Search",null)}else{return getLocalizedMessage("Save",null)}};var Q=false;function aC(aJ,aM){var aK=getWindowArgs_NS(aJ);if(aK!=null&&"fvlist" in aK){for(var aN in aK.fvlist){if(typeof(aK.fvlist[aN])!="function"){if(aN in getFields_NS(aJ)){var aP=Datatype_Factory(aK.fvlist[aN]);if(aP instanceof CharType){aP=new CharType(ExpandString(aJ,aP.toString(),2|4))}getFields_NS(aJ)[aN].S(aP)}}}getWindowArgs_NS(aJ).fvlist=null}if("olserver" in window.URLParams){F(aJ,1041).S(new CharType(window.URLParams.olserver))}if("olapp" in window.URLParams){F(aJ,1042).S(new CharType(window.URLParams.olapp))}if(!Q&&aJ==0){var aO;for(var aL in window.URLParams){if(aL.charAt(0)=="F"&&aL.length>1){var aO=parseInt(aL.substr(1));if(!isNaN(aO)&&aO>0&&aO in getFields_NS(aJ)){getFields_NS(aJ)[aO].S(new CharType(window.URLParams[aL]))}}}Q=true}}function ao(aK,aL){Field_Defaults(aK,0,1,(aL.ns==3)?1:0);var aJ=(aL.ns==4)?2:1;if(aL.ns==2){aJ=2}for(ii in getForm_NS(aK).systemFields){F(aK,ii).SAccess(aJ)}Field_ClearChanged(aK);getStateMgr_NS(aK).mWindowIsClosed=false;getStateMgr_NS(aK).mWindowIsClosing=false;HidePromptBar();return{n:{f:ExecuteWorkflow,a:[aK,16384],e:aj,ea:[aK,aL]}}}function aj(aJ,aK,aL){if(aJ instanceof WorkflowException&&aJ.hasMessages()){D(aL);this.mWindowIsClosed=true;Field_ClearChangedFromRunProcess(aK);return{n:{f:function(){return{c:{f:WC_DisplayMessage,a:[aK,aJ.getLStatus()]},n:{f:ARACTCloseWindow,a:[aK,0]}}}}}}throw aJ}var u,ar;function aF(aJ,aK){u=new FieldSnapshot(aJ,false,true)}function U(aJ,aK){ar=new FieldSnapshot(aJ,false,true)}function aG(aJ){if(u){u.Restore()}}function L(aJ,aK){return ExecuteWorkflow(aJ,262144)}function aq(aJ,aK){DAppList.Load(aJ)}this.WindowIsClosing=function(aK){if(this.mWindowIsClosed){return}getStateMgr_NS(d).mWindowIsClosing=true;var aJ={n:{f:X,a:[this.windowID,aK]}};if((getARStateCurrent_NS(this.windowID)==5)||(getARStateCurrent_NS(this.windowID)==3)){aJ.c=({f:aB,a:[this.windowID,aK]})}return aJ};function X(aJ,aM){if(aM.ab){return}var aL={};aL.c={f:function(){getStateMgr_NS(aJ).mWindowIsClosed=true}};var aK=getWindowArgs_NS(aJ);if(!(aM.cs==4&&aM.ns==0&&aK&&"eid" in aK)){if(aJ==getTopWinWindowID_NS()){HidePromptBar()}aL.n={f:ExecuteWorkflow,a:[aJ,32768],e:function(){if(typeof getFormContext(aJ)!="undefined"&&getFormContext(aJ)!=null){getStateMgr_NS(aJ).mWindowIsClosed=false}R.apply(null,arguments)},ea:[aJ,aM,true]}}return aL}this.ClearSnapshot=o;function o(){u=ar=null;this.mWindowIsClosed=true}function Z(aJ,aK){var aL=1;if(aK.ns==1){aL=ARPrefsGetAsNumber(20101)}else{if(aK.ns==4){aL=ARPrefsGetAsNumber(20102)}else{if(aK.ns==2){aL=0}}}if(getWindowArgs_NS(aJ)!=null&&"wForceClear" in getWindowArgs_NS(aJ)&&getWindowArgs_NS(aJ).wForceClear==1){getWindowArgs_NS(aJ).wForceClear=0;s(aJ,true);if("fvSetDefaults" in getWindowArgs_NS(aJ)&&getWindowArgs_NS(aJ).fvSetDefaults==1){aL=1}else{return}}if(getStateMgr_NS(aJ).mWindowIsCopyingNew){getStateMgr_NS(aJ).mWindowIsCopyingNew=false;return S(aJ,aK)}switch(aL){case 0:return s(aJ,true);case 1:return at(aJ,true);case 2:return S(aJ,aK)}return false}function at(aJ,aK,aM){var aL=getFieldChanged_NS(aJ);Field_Defaults(aJ,1,0,0);if(aM&&!aL){Field_ClearChangedFromRunProcess(aJ,aL)}if(aK){aa(aJ)}return ExecuteWorkflow(aJ,512)}this.SetDefaults=at;function S(aJ,aK){if(aK.ns==1){if(v){return at(aJ,true)}for(ii in getForm_NS(aJ).systemFields){F(aJ,ii).Clear()}aa(aJ)}else{if(aK.ns==4){if(v){return s(aJ,true)}}}DAttachmentPool_DoEntryChange(aJ,false);return ExecuteWorkflow(aJ,512)}function ag(aJ){var aK=false;for(var aL=0;aL<getCharEditPopups_NS(aJ).length;aL++){if(getCharEditPopups_NS(aJ)[aL].NewTextAvail()){aK=true;break}}return aK}function P(aK){var aL;var aJ=getCharEditPopups_NS(aK);for(var aM=0;aM<aJ.length;aM++){if(aJ[aM].NewTextAvail()){aL=aJ[aM].GetText();F(aK,aJ[aM].mField.mID).S(new CharType(aL))}}}function g(){if(typeof rtfEditor!="undefined"&&rtfEditor&&rtfEditor.IsVisible()){rtfEditor.Close(true)}}function af(aK,aM){g();var aN=au(aK)&&getFieldChanged_NS(aK)&&!getStateMgr_NS(aK).mWindowIsCopyingNew;var aJ=ag(aK);if(aN||aJ){if(aM.cs==1||aM.cs==5||aM.cs==6){var aL={};ConfirmPopupOpen=true;return{c:{f:ConfirmPopup,a:[aK,getLocalizedMessage("Do you want to save the current request ?"),aL,1|8|4]},n:{f:function(){ConfirmPopupOpen=false;if(!("v" in aL.result)||aL.result.v==-1){D(aM);if(aM.cs==5){var aO=getFields_NS(aK)[1020];return{c:{t:aO,f:aO.RestoreResultsListToPrevSelection,a:[]}}}}else{if(aL.result.v==1){if(aJ){P(aK)}if(aM.cs==1){return{c:{f:function(){return{c:{f:aD,a:[aK]}}},e:R,ea:[aK,aM,true]}}}if(aM.cs==5||aM.cs==6){return{c:{f:function(){return{c:{f:am,a:[aK]}}},e:R,ea:[aK,aM,true]}}}}}}}}}}}function aa(aJ){Field_ClearChanged(aJ)}function av(aJ,aK){if(aK.ns==5||aK.ns==6||aK.ns==3){Field_Clear(aJ,true)}else{var aL=0;if(aK.ns==1){aL=ARPrefsGetAsNumber(20101)}else{if(aK.ns==4){aL=ARPrefsGetAsNumber(20102)}}if(aL!=2&&(!getStateMgr_NS(aJ).mWindowIsCopyingNew)){Field_Clear(aJ,false)}}}function s(aJ,aK){Field_Clear(aJ,false);if(aK){aa(aJ)}}function al(aJ){g();if(ag(aJ)){P(aJ)}return{c:{f:K,a:[aJ]},n:{f:ai,a:[aJ,5,false]}}}this.Query=al;function aE(aJ,aM,aK){var aL=isLogicalWindow(this.windowID);if(aM==12||aM==13||aM==14||aM==15||aM==16||aM==17||aM==18||aM==19||aM==99){return{c:{f:ai,a:[aJ,ah[aM][1],ah[aM][2],aK,aL]}}}return{c:{f:K,a:[aJ]},n:{f:ai,a:[aJ,ah[aM][1],ah[aM][2],aK,aL]}}}this.OpenWindowQuery=aE;function K(aJ){if(!getCurWFC_NS(aJ)){HidePromptBar()}return ExecuteWorkflow(aJ,1024)}function ai(aJ,aM,aW,aO,aY){var aS=getFields_NS(aJ)[1020];f=aW;var aN;var aR="";var aT="";var aV=null;var aU=Field_GetQBEFieldList(aJ);aN=aU.fl;aV=aU.ps;if(typeof aO=="undefined"){aT=F(aJ,1005).G().toString();var aP=ak(aT,aJ);var aL=-1;var aK=0;var aQ=null;var a1=-1;var a0=0;while(((a1=aT.indexOf("'",a0))!=-1)&&aP.length){a0=aT.indexOf("'",a1+1);if(a0==-1){break}aQ=aT.substring(a1+1,a0);if(aP.indexOf(aQ)!=-1){if((aL=aT.indexOf('"',a0+1))!=-1){aK=aT.indexOf('"',aL+1);if(aK==-1){break}if(aT.charAt(aK+1)=='"'){aK+=1}else{var a3=TimeType.getTimestamp(aT.substring(aL+1,aK));if(a3!=-1){aQ=aT.substring(0,(aL+1));aT=aQ+a3+aT.substr(aK);aK=aQ.length+a3.toString().length+1}else{aK+=1}}a0=aK;continue}}a0+=1}aL=-1;aK=0;aQ=null;var a3=-1;while((aL=aT.indexOf("$",aK))!=-1){aK=aT.indexOf("$",aL+1);aQ=aT.substring(aL+1,aK);if(aQ=="TIMESTAMP"){a3=ARKWGetTimeStamp()}else{if(aQ=="TIME"){a3=ARKWGetTime()}else{if(aQ=="DATE"){a3=ARKWGetDate()}}}if((a3!=-1)&&a3.mValue!="undefined"&&a3.mValue!=-1){aQ=aT.substring(0,aL);aT=aQ+a3.mValue+aT.substr(aK+1);aK=aQ.length+a3.mValue.toString().length+1;a3=-1}else{aK+=1}}if(aT!=""){var aZ=aT.match(SavedSearches.PSP);if(aZ!=null){for(var aX=0;aX<aZ.length;aX++){var a3=aZ[aX];a3=a3.substring(1,a3.length-1);if(!ARKWIsKeywordOrEscapedKeyword(aJ,a3)){if(aV==null){aV=new Object()}aV[a3]=a3}}}aR=aT}}var a2={};return{c:{f:function(a4){if(a4!=null){return ParamSearchPopup(aJ,a2,a4)}},a:[aV]},n:{f:function(ba,a5){var bd=a5;if(ba&&"result" in ba&&"v" in ba.result){for(var a4 in ba.result.v){var a9=getFields_NS(aJ)[a4];var bc=ba.result.v[a4].toString();if(a9){if(bc!=""){var a8=Field.GetQBEOperator(bc);if(a8!=null){bc=a9.FromUIInput(bc.substring(a8.length).trim(1),false,true);bc=new CharType(a8+bc.toPrimitive())}else{bc=a9.FromUIInput(bc,false,true)}aN.AddField(a4,bc)}}else{a4=a4.toRegExp();var a6=new RegExp("\\$"+a4+"\\$","g");a5=a5.replace(a6,bc)}}}else{if(aV!=null){return}}if(a5!=""){a5=new NDXParseAndEncodeQualifier(aJ,ARKWGetStringByIdx(aJ,7),ARKWGetStringByIdx(aJ,6),ARKWGetStringByIdx(aJ,17),a5).result}var bb={label:"",ids:[],vals:[]};if(getuserSearches_NS(aJ)!=null){if(getuserSearches_NS(aJ).SaveRecent(aJ,aN.mFields,aV,bd)){bb=getuserSearches_NS(aJ).lastSearch}}quickReportParamSearch="";quickReportRegularSearch="";quickReportAdvancedSearchQual="";if(bd!=""){quickReportAdvancedSearchQual=bd}var a4;for(a4 in aN.mFields){if((aV!=null)&&(a4 in aV)){if(quickReportParamSearch.length>0){quickReportParamSearch+="/"}quickReportParamSearch+=a4+"/$"+aV[a4]+"$"}else{if(a4 in getForm_NS(aJ).displayOnlyFields){continue}var a9=F(aJ,a4);var a7=a9.GetScreenValue();quickReportRegularSearch+=a4+"/"+a7.length+"/"+a7+"/"}}if(aM<100){return{c:{t:aS,f:aS.LoadResultsList,a:[aM,aO,aN,a5,getForm_NS(aJ).currentFormVuiId,bb.label,bb.ids,bb.vals,aY]},n:{f:C,a:[aJ,aM]}}}},a:[a2,aR]}}}this.QueryEntry=ai;function ak(aN,aP){var aK=-1;var aJ=0;var aL=[];while((aK=aN.indexOf("'",aJ))!=-1){aJ=aN.indexOf("'",aK+1);if(aJ==-1){break}if(aN.charAt(aJ+1)=="'"){aJ+=1}else{aL.push(aN.substring(aK+1,aJ));aJ+=1}}var aS=[];var aO=getFields_NS(aP);var aQ=-1;for(var aM in aO){var aR=aO[aM];if(aR.mHaveVisualCharacteristics&&((aR.mDataType==13||aR.mDataType==7||aR.mDataType==14)&&(aQ=aL.indexOf(aR.GLabel()))!=-1)){aS.push(aR.GLabel());aL.splice(aQ,1);if(aL.length==0){break}}}return aS}function k(aJ,aK){if(getWindowArgs_NS(aJ)&&"eid" in getWindowArgs_NS(aJ)){delete getWindowArgs_NS(aJ).eid}HidePromptBar();if(aK.cs==1&&aK.ns==5){return{n:{f:ExecuteWorkflow,a:[aJ,16]}}}return{c:{f:ExecuteWorkflow,a:[aJ,16]},n:{f:ad,a:[aJ,0],e:R,ea:[aJ,aK,false]}}}this.EventUndisplay=aB;function aB(aJ,aK){if(1020 in getFields_NS(aJ)){var aL=getFields_NS(aJ)[1020].getPrevARSelection();if((aL!=null&&aL>0)||(getStateMgr_NS(aJ).mWindowIsClosing)){return{c:{f:ExecuteWorkflow,a:[aJ,65536],e:Y,ea:[aJ,aK]}}}}return false}function aA(aJ,aK){return{c:{f:ad,a:[aJ,1]}}}function Y(aJ,aK,aM){if((aJ instanceof WorkflowException)&&aJ.hasMessages()){D(aM);var aL=getFields_NS(aK)[1020];return{n:{f:function(){return{c:{f:WC_DisplayMessage,a:[aK,aJ.getLStatus()]},n:{t:aL,f:aL.RestoreResultsListToPrevSelection,a:[]}}}}}}throw aJ}function ad(aJ,aK){if(aK.ab==1){return}return{c:{f:DTable_DoEntryChange,a:[aJ,aK]},n:{f:DAttachmentPool_DoEntryChange,a:[aJ,true]}}}function E(aJ,aL){for(var aM in getTemplateFields_NS(aJ)){var aK=getTemplateFields_NS(aJ)[aM];if(aK!=null){getCurWFC_NS(aJ).AddCallback(aK,aK.setContents,[])}}}function ay(aJ,aM){if(aM.cs==1&&aM.ns==5){buildResultListEntry(aJ,getForm_NS(aJ).reqIdStr,aM.ns);Field_LoadEntry(aJ,getForm_NS(aJ).entry,false,true,getForm_NS(aJ).reqIdStr);return}var aL=getFields_NS(aJ)[1020];var aN=aL.GetRow();if(aN==-1){Field_Clear(aJ,true);Field_ClearChanged(aJ)}else{if("e" in aL.mResult&&(aL.mResult.eid==aL.mResult.r[aN].i)){Field_LoadEntry(aJ,aL.mResult.e,false,true,aL.mResult.eid);delete aL.mResult.e}else{var aK=Field_QueryLoadEntry(aJ,aL.mResult.r[aN].i,false,true);if("e" in aL.mResult){delete aL.mResult.e}return aK}}}function B(aJ,aL){var aM=false;if(typeof getForm_NS(aJ).procGetEntry!="undefined"){aM=getForm_NS(aJ).procGetEntry}if(!getForm_NS(aJ).UseResultsListPane||!f){var aK=getFields_NS(aJ)[1020];aK.SVis(true)}if(aM==false&&!f&&getForm_NS(aJ).UseResultsListPane){ShowResultsListPane(aJ)}if(aM){getForm_NS(aJ).procGetEntry=false}}function az(aJ,aL){var aK=getFields_NS(aJ)[1020];aK.SVis(false);if(!f&&getForm_NS(aJ).UseResultsListPane){HideResultsListPane(aJ)}if(typeof aL.nss=="undefined"){return}if(!((aL.cs==5&&aL.nss.ns==6)||(aL.cs==6&&aL.nss.ns==5)||(aL.cs==6&&aL.nss.ns==6))){aK.Clear()}}function aD(aJ){g();if(ag(aJ)){P(aJ)}return{c:{f:V,a:[aJ]},n:{f:J,a:[aJ],e:W,ea:[aJ]}}}this.Submit=aD;function W(aM,aJ){if((aM instanceof WorkflowException)&&aM.hasMessages()){var aL=aM.getStatus();for(var aK=0;aK<aM.mArg.length;aK++){if(aL[aK].n==307||aL[aK].n==326||aL[aK].n==9424){if(aK==0){this.highlightedFlds=[]}var aN=parseInt(aL[aK].a);if(F(aJ,aN) instanceof DataField&&F(aJ,aN).GVis()){F(aJ,aN).HighlightBorder()}}}}throw aM}function V(aJ){HidePromptBar();return ExecuteWorkflow(aJ,4)}this.highlightedFlds=[];this.ClearHighlight=I;this.HandleException=W;function I(aJ){if(getStateMgr_NS(aJ).highlightedFlds.length>0){for(var aK=0;aK<getStateMgr_NS(aJ).highlightedFlds.length;aK++){F(aJ,getStateMgr_NS(aJ).highlightedFlds[aK]).RemoveHighlightBorder()}}}function J(aJ){I(aJ);var aL=Field_BuildList(aJ,new FieldList(aJ),true,false,true,true,true,true);var aK=aL.Push({qual:""},ARKWGetStringByIdx(aJ,7),ARKWGetStringByIdx(aJ,6),6,4,false,true);var aM={n:{f:ax,a:[aJ]}};if(ARPrefsGetAsNumber(20109)==1){aM.c={f:function(){getCurWFC_NS(aJ).setStatus(getLocalizedMessage("Submit Successful: ID = {0}",[getForm_NS(aJ).statusReqIdStr]));aa(aJ);var aN=promptBar.msgTypeToSysMsgDest(promptBar.ARTypetoPromptType(0));var aO={t:0,m:getLocalizedMessage(9504,[getForm_NS(aJ).statusReqIdStr]),n:9504,a:null};return WC_DisplayMessage(aJ,[{mstat:aO,msgloc:aN}])}}}else{aM.c={f:function(){getCurWFC_NS(aJ).setStatus(getLocalizedMessage("Submit Successful: ID = {0}",[getForm_NS(aJ).statusReqIdStr]));aa(aJ)}}}if(aK){return{c:{t:aK,f:function(){return{c:aK.c,n:aK.n}}},n:{f:function(){return{c:aM.c,n:aM.n}}}}}else{return aM}}function ax(aJ){if(ARPrefsGetAsNumber(20101)!=2&&ar!=null){ar.Restore()}if(ARPrefsGetAsNumber(28515)==1){return{n:{f:H,a:[aJ]}}}var aK=AREventFunction(aJ,4096);if(aK){if(typeof getForm_NS(aJ).entry!="undefined"){Field_LoadEntry(aJ,getForm_NS(aJ).entry,true,false,getForm_NS(aJ).reqIdStr);getForm_NS(aJ).entry=[]}return{c:{f:ExecuteWorkflow,a:[aJ,aK]},n:{f:H,a:[aJ]}}}return{n:{f:H,a:[aJ]}}}function H(aJ){if(ARPrefsGetAsNumber(28515)==1){f=true;return{n:{t:getStateMgr_NS(aJ),f:getStateMgr_NS(aJ).ARStateChange,a:[aJ,5]}}}switch(ARPrefsGetAsNumber(20101)){case 1:return{c:{f:at,a:[aJ,true]},n:{f:function(){return{c:{f:ExecuteWorkflow,a:[aJ,262144]},n:{f:aa,a:[aJ]}}}}};case 2:for(ii in getForm_NS(aJ).systemFields){F(aJ,ii).Clear()}break;case 0:s(aJ,true);break}return{n:{f:function(){return{c:{f:ExecuteWorkflow,a:[aJ,262144]},n:{f:aa,a:[aJ]}}}}}}function am(aJ){I(aJ);g();if(ag(aJ)){P(aJ)}if((getARStateCurrent_NS(aJ)==5)){return{c:{f:z,a:[aJ]},n:{f:ab,a:[aJ],e:W,ea:[aJ]}}}else{return{n:{f:aw,a:[aJ],e:W,ea:[aJ]}}}}this.Modify=am;function z(aJ){HidePromptBar();return ExecuteWorkflow(aJ,8)}function ab(aJ){var aR=Field_BuildList(aJ,new FieldList(aJ),true,true,false,false,true,false);var aS=false;for(var aN in aR.mFields){aS=true;break}if(!aS){return{n:{f:y,a:[aJ]}}}var aO=[getDBSnapshot_NS(aJ).GetDataForID(1).toString()];var aP=getDBSnapshot_NS(aJ).ts;var aL={};var aQ=aR.PushEntry(ARKWGetStringByIdx(aJ,7),ARKWGetStringByIdx(aJ,6),aO,aP,aL,true);if(ShowWaitCursor()){return{isFromFunctionSplit:1,c:{t:aQ,f:function(){return{c:aQ.c,n:aQ.n}}},n:{f:function(){var aU=aL.req.result;if(aU.n==0){var aU={};return{c:{f:ConfirmPopup,a:[aJ,WorkflowContext_StatusToString(aJ,[{n:9299,t:1,m:null,a:null}]),aU,8|4]},n:{f:function(){if(("v" in aU.result)&&aU.result.v==1){var aW={};var aX=aR.PushEntry(ARKWGetStringByIdx(aJ,7),ARKWGetStringByIdx(aJ,6),aO,0,aW,true);if("c" in aX){return{isFromFunctionSplit:1,c:{t:aX,f:function(){return{c:aX.c,n:aX.n}}},n:{f:y,a:[aJ]}}}else{return{n:{f:y,a:[aJ]}}}}else{return}}}}}else{if(aU.n==-1){var aV={n:302,t:2,m:aU.m,a:null};var aT=promptBar.msgTypeToSysMsgDest(promptBar.ARTypetoPromptType(2));return{c:{f:WC_DisplayMessage,a:[aJ,[{mstat:aV,msgloc:aT}]]},n:{f:function(){if(1020 in getFields_NS(aJ)){Field_ClearChanged(aJ);return getFields_NS(aJ)[1020].Refresh(0,0,false)}}}}}}return{n:{f:y,a:[aJ]}}}}}}else{if(aQ.n==0){var aQ={};return{c:{f:ConfirmPopup,a:[aJ,WorkflowContext_StatusToString(aJ,[{n:9299,t:1,m:null,a:null}]),aQ,8|4]},n:{f:function(){if(("v" in aQ.result)&&aQ.result.v==1){var aT={};aR.PushEntry(ARKWGetStringByIdx(aJ,7),ARKWGetStringByIdx(aJ,6),aO,0,aT,true);return{n:{f:y,a:[aJ]}}}else{return}}}}}else{if(aQ.n==-1){var aM={n:302,t:2,m:aQ.m,a:null};var aK=promptBar.msgTypeToSysMsgDest(promptBar.ARTypetoPromptType(2));return{c:{f:WC_DisplayMessage,a:[aJ,[{mstat:aM,msgloc:aK}]]},n:{f:function(){if(1020 in getFields_NS(aJ)){Field_ClearChanged(aJ);return getFields_NS(aJ)[1020].Refresh(0,0,false)}}}}}}return{n:{f:y,a:[aJ]}}}}function y(aJ){aa(aJ);h(aJ);getCurWFC_NS(aJ).setStatus(getLocalizedMessage("Modify Successful"));return{c:{f:ae,a:[aJ]},n:{f:aa,a:[aJ]}}}function h(aJ){var aL=getFields_NS(aJ)[1020];for(var aK in aL.mLastRowSelections){if(getResultsListPane_NS(aJ).GVis()==true){var aM=aL.FishOutTR(parseInt(aK));if(aM!=null){aM.style.fontStyle="italic"}}}}function aw(aK){var aO=Field_BuildList(aK,new FieldList(aK),true,false,true,false,true,false);var aN=getFields_NS(aK)[1020];var aJ=[];for(var aM in aN.mLastRowSelections){aJ.push(aN.TagFromRowNo(parseInt(aM)))}var aP;if(aJ.length==1){aP=getLocalizedMessage("This operation will modify 1 entry. Continue?")}else{aP=getLocalizedMessage("This operation will modify {0} entries. Continue?",[aJ.length])}var aL={};return{c:{f:ConfirmPopup,a:[aK,aP,aL,4|8]},n:{f:function(){if("v" in aL.result&&aL.result.v==1){aa(aK);var aR={};var aQ=aO.PushEntry(ARKWGetStringByIdx(aK,7),ARKWGetStringByIdx(aK,6),aJ,0,aR,false);h(aK);if(ShowWaitCursor()){return{isFromFunctionSplit:1,c:{t:aQ,f:function(){return{c:aQ.c,n:aQ.n}}},n:{f:O,a:[aK,aJ.length]}}}else{O(aK,aJ.length)}}}}}}function O(aJ,aK){if(aK==1){msg=getLocalizedMessage("1 entry modified")}else{msg=getLocalizedMessage("{0} entries modified",[aK])}getCurWFC_NS(aJ).setStatus(msg)}function ae(aJ){if(getForm_NS(aJ).entry&&getForm_NS(aJ).entry.length>0){Field_LoadEntry(aJ,getForm_NS(aJ).entry,false,false,getForm_NS(aJ).reqIdStr);getForm_NS(aJ).entry=[]}return ExecuteWorkflow(aJ,2048)}function au(aJ){if("TbSave" in getForm_NS(aJ)){return getForm_NS(aJ).TbSave}else{return(1001 in getFields_NS(aJ))}}this.IsSaveAllowed=au};setStateMgr_NS(d,b)}function ExecuteWorkflow(d,b,f){if(typeof b=="number"){b=AREventFunction(d,b,f)}if(b){return getCurWFC_NS(d).execute({t:b.h,f:b.f,a:[d]})}}var MessageTypes={1:{i:"exclamation",m:getLocalizedMessage("BMC Remedy User - Warning")},0:{i:"info",m:getLocalizedMessage("BMC Remedy User - Note")},2:{i:"error",m:getLocalizedMessage("BMC Remedy User - Error")},3:{i:"error",m:getLocalizedMessage("BMC Remedy User - Error")}};function MessagePopup(d,b){var f=WorkflowContext_StatusToString(d,b);return weOpenModalPopup(d,(AbsContextPath+"resources/html/MessagePopup.html"),"Message",{title:MessageTypes[b[0].t].m,status:b,msg:f,image:MessageTypes[b[0].t].i,btn:2,appss:GetAppStyleSheet("../../"),acc:0,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(d,7),schema:ARKWGetStringByIdx(d,6),view:ARKWGetStringByIdx(d,17),cacheid:getFormDataHolderById(d).cacheid},{},[380,175])}function ConfirmPopup(b,g,d,f){return weOpenModalPopup(b,(AbsContextPath+"resources/html/MessagePopup.html"),"Confirm",{title:getLocalizedMessage("Confirm Save Request"),image:"exclamation",status:null,msg:g,btn:f,appss:GetAppStyleSheet("../../"),acc:0,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},d,[380,175])}function AccTooltip(b,d){}function SessTimeoutPopup(b,g,d,f){return weOpenModalPopup(b,(AbsContextPath+"resources/html/MessagePopup.html"),"Confirm",{title:"Session Timeout",image:"exclamation",status:null,msg:g,btn:f,appss:GetAppStyleSheet("../../"),acc:0,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},d,[380,175])}var PREFS;function ARPrefsReplaceAll(b){PREFS=b}function ARPrefsGetAsString(b){if(!(b in PREFS)){return null}return PREFS[b]}function ARPrefsSetAsString(d,b){PREFS[d]=b}function ARPrefsGetAsNumber(d){if(!(d in PREFS)){return null}var b=PREFS[d];return parseInt(b)}function ARPrefsSetAsNumber(d,b){PREFS[d]=b+""}function ARPrefsSetAsNull(b){PREFS[b]=null}function ARPrefsSet(b,h,d,g){if(!d){d=""}if(!g){g=""}var f=new NDXSetARUserPreference(b,h,d,g);return f.result}var VP;function ARPrefsGet(b,k,d){if(!(k in PREFS)){if(!d){d=""}var f=new NDXGetARUserPreference(b,k,d)}var h=PREFS[k];if(d&&h){h=h.toString();VP=new RegExp(d+"=([^\n]*)\n","m");var g=h.match(VP);h=g[1]}return h}function ARPrefsRefresh(d,b){new NDXRefreshARUserPreferences(d,b)}NDXRequest.prototype.constructor=NDXRequest;function GET_XML_HTTP(){var d;try{d=new XMLHttpRequest()}catch(b){try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}}return d}function NDXRequest(b){if(arguments.length){this.init(b)}}function MarshallArgs(s){var w=[];w.push("/");w.push(s[0]);w.push("/");var b={string:function(y,z){y.push(z.length);y.push("/");y.push(z)},"boolean":function(y,z){y.push("1");y.push("/");y.push(z?"1":"0")},number:function(y,A){var z=""+A;y.push(""+z.length);y.push("/");y.push(z)}};for(var k=1;k<s.length;++k){var v=s[k];if(typeof v=="undefined"){continue}if(v instanceof Array){var d=v.length;var o=[];o.push(d);o.push("/");if(d>0){var u=b[typeof v[0]];for(var h=0;h<d;++h){u(o,v[h])}}var g=o.join("");b.string(w,g)}else{b[typeof v](w,v)}}var f=w.join("");f=(f.length-1)+f;return f}NDXRequest.XMLHTTPOpen=function(f,h,k,d,b,g){if(!xmlHttpGET||(xmlHttpGET&&((h.length+k.length+d.length+g.length)>2047))){f.open("POST",h,b);return true}else{f.open("GET",h+k+d+g,b);return false}};NDXRequest.prototype.windowID=null;NDXRequest.prototype.init=function(){var args=Array.prototype.slice.call(arguments);var windowID=this.windowID=args[1];args.splice(1,1);var finalbuff=MarshallArgs(args);var svr=0;var uid=args[0]+Math.floor(Math.random()*1000000);TIMELINE.start("NDX_SYNC"+uid);var retry=false;var i=0;do{var fetcher;fetcher=GET_XML_HTTP();var finalbuffuri;if(!retry){finalbuffuri=encodeURIComponent(finalbuff)}else{retry=false}var ctxtpath=(AbsContextPath+"BackChannel/"),param="?param=",sToken="&sToken=";if(args[0]=="GetHTMLScriptForViewField"){ctxtpath=(AbsContextPath+"CachedBackChannel/")}if(window.sTok!=null&&(args[0]!="GetHTMLScriptForViewField")){sToken=sToken+window.sTok}else{sToken=""}var isPOST=NDXRequest.XMLHTTPOpen(fetcher,ctxtpath,param,finalbuffuri,false,sToken);if(!isPOST){finalbuff=null;sToken=null}fetcher.setRequestHeader("Content-type","text/plain; charset=UTF-8");fetcher.setRequestHeader("AtssoRedirectStatusCode",278);fetcher.setRequestHeader("AtssoReturnLocation",location.href);try{var d=new Date();if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(d)+" */+HTTP call")}if(sToken!=null&&finalbuff!=null&&(args[0]!="GetHTMLScriptForViewField")){fetcher.send(finalbuff+sToken)}else{fetcher.send(finalbuff)}}catch(e){var http_error=WorkflowContext_GenerateHttpError(fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:http_error,a:null}])}svr=parseInt(fetcher.getResponseHeader("srt")||0);var d=new Date();if(fetcher.readyState==4&&fetcher.status==200&&fetcher.responseText){if(fetcher.responseText.indexOf(9201)==-1&&!(finalbuffuri!=null&&((finalbuffuri.toString().indexOf("35/SessionExcludedTableAutoRefreshCall")>-1)||(finalbuffuri.toString().indexOf("35%2FSessionExcludedTableAutoRefreshCall")>-1)))){initSessionTimeoutCounter()}if(fetcher.responseText.indexOf("this.result=")==-1&&fetcher.responseText.indexOf("getCurWFC_NS(this.windowID).status")==-1&&fetcher.responseText.indexOf("retry=")==-1){LogAndAlert(getLocalizedMessage(9421,null,null));throw new WorkflowException(this.windowID,0,[])}else{var throwWorkflowException=false;var savee;try{eval(fetcher.responseText)}catch(e){savee=e;if(e instanceof WorkflowException){throwWorkflowException=true}}if((typeof this.cacheIDRefCount!="undefined")){var oldRef;var newRef;for(var x in this.cacheIDRefCount){oldRef=getCookie(x);newRef=this.cacheIDRefCount[x];if(typeof newRef!="undefined"&&oldRef<newRef){if(typeof oldRef!="undefined"&&oldRef!=null&&throwWorkflowException){savee.appendStatus([{n:9508,t:2,m:getLocalizedMessage(9508),a:null}]);break}setCookie(x,newRef,null,"/",null)}}}if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(d)+" */-HTTP call")}if(throwWorkflowException){throw savee}}}else{if(fetcher.readyState==4&&fetcher.status==278){LogAndAlert(getLocalizedMessage(9421,null,null));var gotoUrl=document.location.href;gotoUrl=gotoUrl.substring(gotoUrl.indexOf("://")+3);gotoUrl=gotoUrl.substring(gotoUrl.indexOf("/"),gotoUrl.indexOf("?"));if(window.sTok!=null){document.location.href=RelContextPath+"shared/logout.jsp?goto="+gotoUrl+"&sToken="+window.sTok}else{document.location.href=RelContextPath+"shared/logout.jsp?goto="+gotoUrl}throw new WorkflowException(this.windowID,0,[])}else{if(typeof isbackChannelRetryRequired!="undefined"&&isbackChannelRetryRequired==true&&i<1){if(openPingDialog(this.RunningSign)==true){retry=true;i=i+1}else{var http_error=WorkflowContext_GenerateHttpError(fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:http_error,a:null}]);i=i+1}}else{var http_error=WorkflowContext_GenerateHttpError(fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:http_error,a:null}])}}}}while(retry&&i<=1);TIMELINE.end("NDX_SYNC"+uid,null,svr)};NDXRequest.prototype.result=null;NDXRequest.prototype.GetResult=function(){return this.result};NDXRequest.prototype.Override=function(f){var b=confirm(WorkflowContext_StatusToString(this.windowID,f)+"\n"+getLocalizedMessage("Do you wish to override?"));if(b==false){var d=new NDXSetOverride(this.windowID,false);throw new WorkflowException(this.windowID,0,[])}var d=new NDXSetOverride(this.windowID,true);return true};NDXRequest.prototype.fetcher=null;NDXRequest.prototype.AsyncBC=function(){var w=Array.prototype.slice.call(arguments);w.splice(1,1);var k=MarshallArgs(w);this.uid=w[0]+Math.floor(Math.random()*1000000);TIMELINE.start("NDX_ASYNC"+this.uid);this.finalbuff=k;var b=false;do{this.fetcher=GET_XML_HTTP();var o;if(!b){o=encodeURIComponent(k)}else{b=false}var y=(AbsContextPath+"BackChannel/"),g="?param=",h="&sToken=";if(w[0]=="GetHTMLScriptForViewField"){y=(AbsContextPath+"CachedBackChannel/")}if(window.sTok!=null&&(w[0]!="GetHTMLScriptForViewField")){h=h+window.sTok}else{h=""}var z=NDXRequest.XMLHTTPOpen(this.fetcher,y,g,o,true,h);if(!z){k=null;h=null}var f=this;this.fetcher.onreadystatechange=function(){f.AsyncBCCallback.call(f)};this.fetcher.setRequestHeader("Content-type","text/plain; charset=UTF-8");this.fetcher.setRequestHeader("AtssoRedirectStatusCode",278);this.fetcher.setRequestHeader("AtssoReturnLocation",location.href);try{var v=new Date();if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(v)+" */+HTTP call")}if(h!=null&&k!=null&&(w[0]!="GetHTMLScriptForViewField")){this.fetcher.send(k+h)}else{this.fetcher.send(k)}f.fetcher=this.fetcher}catch(s){var u=WorkflowContext_GenerateHttpError(this.fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:u,a:null}])}}while(b)};NDXRequest.prototype.RunningSign=null;NDXRequest.prototype.showRunning=function(){var f=document.createElement("DIV");f.className="PageLoadProgress";f.style.display="inline";f.style.zIndex=nextZIndex+1;if(typeof WaitCursorInnerHTML!="undefined"){var b=WaitCursorInnerHTML.replace(/imageContextPath/,AbsContextPath+"shared/images");var k=b.indexOf("</img>");var h=b.slice(0,k+6);var g=b.slice(k+6,b.length);var d=h+getLocalizedMessage(g);f.innerHTML="<div class='loadingContainer'><nobr>"+d+"</nobr></div>"}else{f.innerHTML="<div class='loadingContainer'><nobr><img class='loadingImage' src='"+AbsContextPath+"resources/images/Progress_NonModal-circle.gif'/><span class='loadingText'>"+getLocalizedMessage("Loading...")+"</span></nobr></div>"}document.body.style.cursor="wait";document.body.appendChild(f);this.RunningSign=f};NDXRequest.prototype.hideRunning=function(){document.body.style.cursor="auto";document.body.removeChild(this.RunningSign)};GlobalShowRunning=function(){var b=null;if(ShowWaitCursor()){b=new NDXRequest();if(!b.RunningSign){b.showRunning()}}return b};NDXRequest.prototype.redirectPassword=function(b,d,f){Field_ClearChanged(this.windowID);if(getCurWFC_NS(this.windowID)!=null){getCurWFC_NS(this.windowID).pushEntryIntoCurrentStack({a:[b,this.windowID],f:function(g,h){var k=allocWindowID_NS();weOpen(k,h,g,"_self","",null,null,true,false);throw new WorkflowException(h,0,[])}});getCurWFC_NS(this.windowID).pushEntryIntoCurrentStack({f:ARACTMessage,a:[this.windowID,0,f,false,d]})}};NDXRequest.prototype.AsyncBCCallback=function(){if(this.fetcher.readyState==4){var theText;var d=new Date();if(this.fetcher.status==200&&this.fetcher.responseText){if(this.fetcher.responseText.indexOf("this.result=")==-1&&this.fetcher.responseText.indexOf("getCurWFC_NS(this.windowID).status")==-1&&this.fetcher.responseText.indexOf("retry=")==-1){LogAndAlert(getLocalizedMessage(9421,null,null));throw new WorkflowException(this.windowID,0,[])}else{theText=this.fetcher.responseText}}else{if(this.fetcher.readyState==4&&this.fetcher.status==278){LogAndAlert(getLocalizedMessage(9421,null,null));var gotoUrl=document.location.href;gotoUrl=gotoUrl.substring(gotoUrl.indexOf("://")+3);gotoUrl=gotoUrl.substring(gotoUrl.indexOf("/"),gotoUrl.indexOf("?"));if(window.sTok!=null){document.location.href=RelContextPath+"shared/logout.jsp?goto="+gotoUrl+"&sToken="+window.sTok}else{document.location.href=RelContextPath+"shared/logout.jsp?goto="+gotoUrl}throw new WorkflowException(this.windowID,0,[])}else{if(typeof isbackChannelRetryRequired!="undefined"&&isbackChannelRetryRequired==true){if(openPingDialog(this.RunningSign)==true){theText="var retry = true;"}else{var http_error=WorkflowContext_GenerateHttpError(this.fetcher.status);theText="getCurWFC_NS("+this.windowID+").status([{n:"+9351+",t:1,m:'"+http_error+"',a:null}]);throw new WorkflowException("+this.windowID+", 0, []);"}}else{var http_error=WorkflowContext_GenerateHttpError(this.fetcher.status);theText="getCurWFC_NS("+this.windowID+").status([{n:"+9351+",t:1,m:'"+http_error+"',a:null}]);throw new WorkflowException("+this.windowID+", 0, []);"}}}weEnableStuff(this.windowID);this.hideRunning();getCurWFC_NS(this.windowID).pushEntryIntoCurrentStack({t:this,a:[d],f:function(d){if(theText.indexOf(9201)==-1&&!(this.finalbuff!=null&&this.finalbuff.toString().indexOf("SessionExcludedTableAutoRefreshCall")>-1)){initSessionTimeoutCounter()}var throwWorkflowException=false;var savee;try{eval(theText)}catch(e){savee=e;if(e instanceof WorkflowException){throwWorkflowException=true}else{this.result={n:0};getCurWFC_NS(this.windowID).status(9514)}}if((typeof this.cacheIDRefCount!="undefined")){var oldRef;var newRef;for(var x in this.cacheIDRefCount){oldRef=getCookie(x);newRef=this.cacheIDRefCount[x];if(typeof newRef!="undefined"&&oldRef<newRef){if(typeof oldRef!="undefined"&&oldRef!=null&&throwWorkflowException){savee.appendStatus([{n:9508,t:2,m:getLocalizedMessage(9508),a:null}]);break}setCookie(x,newRef,null,"/",null)}}}if(throwWorkflowException){throw savee}if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(d)+" */-HTTP call")}if((typeof retry!="undefined")&&retry){retry=false;var fetcher;fetcher=GET_XML_HTTP();var finalbuff=this.finalbuff;var finalbuffuri=encodeURIComponent(finalbuff);var ctxtpath=(AbsContextPath+"BackChannel/"),param="?param=",sToken="&sToken=";if(window.sTok!=null){sToken=sToken+window.sTok}else{sToken=""}var isPOST=NDXRequest.XMLHTTPOpen(fetcher,ctxtpath,param,finalbuffuri,false,sToken);if(!isPOST){finalbuff=null;sToken=null}fetcher.setRequestHeader("Content-type","text/plain; charset=UTF-8");fetcher.setRequestHeader("AtssoRedirectStatusCode",278);fetcher.setRequestHeader("AtssoReturnLocation",location.href);try{var d=new Date();if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(d)+" */+HTTP call")}if(sToken!=null&&finalbuff!=null){fetcher.send(finalbuff+sToken)}else{fetcher.send(finalbuff)}}catch(e){var http_error=WorkflowContext_GenerateHttpError(fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:http_error,a:null}])}var d=new Date();if(fetcher.readyState==4&&fetcher.status==200&&fetcher.responseText){if(fetcher.responseText.indexOf(9201)==-1){initSessionTimeoutCounter()}if(fetcher.responseText.indexOf("this.result=")==-1&&fetcher.responseText.indexOf("getCurWFC_NS(this.windowID).status")==-1&&fetcher.responseText.indexOf("retry=")==-1){LogAndAlert(getLocalizedMessage(9421,null,null));throw new WorkflowException(this.windowID,0,[])}else{var throwWorkflowException=false;var savee;try{eval(fetcher.responseText)}catch(e){savee=e;if(e instanceof WorkflowException){throwWorkflowException=true}}if((typeof this.cacheIDRefCount!="undefined")){var oldRef;var newRef;for(var x in this.cacheIDRefCount){oldRef=getCookie(x);newRef=this.cacheIDRefCount[x];if(typeof newRef!="undefined"&&oldRef<newRef){if(typeof oldRef!="undefined"&&oldRef!=null&&throwWorkflowException){savee.appendStatus([{n:9508,t:2,m:getLocalizedMessage(9508),a:null}]);break}setCookie(x,newRef,null,"/",null)}}}if(throwWorkflowException){throw savee}if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(d)+" */-HTTP call")}}}else{if(fetcher.readyState==4&&fetcher.status==278){LogAndAlert(getLocalizedMessage(9421,null,null));var gotoUrl=document.location.href;gotoUrl=gotoUrl.substring(gotoUrl.indexOf("://")+3);gotoUrl=gotoUrl.substring(gotoUrl.indexOf("/"),gotoUrl.indexOf("?"));if(window.sTok!=null){document.location.href=RelContextPath+"shared/logout.jsp?goto="+gotoUrl+"&sToken="+window.sTok}else{document.location.href=RelContextPath+"shared/logout.jsp?goto="+gotoUrl}throw new WorkflowException(this.windowID,0,[])}else{var http_error=WorkflowContext_GenerateHttpError(fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:http_error,a:null}])}}}}});var svr=parseInt(this.fetcher.getResponseHeader("srt")||0);this.fetcher.onreadystatechange=function(){};this.fetcher=null;TIMELINE.end("NDX_ASYNC"+this.uid,null,svr);getCurWFC_NS(this.windowID).resume()}};NDXRequest.prototype.SendAsync=function(){var w=Array.prototype.slice.call(arguments);w.splice(1,1);var k=MarshallArgs(w);this.finalbuff=k;var b=false;do{this.fetcher=GET_XML_HTTP();var o;if(!b){o=encodeURIComponent(k)}else{b=false}var y=(AbsContextPath+"BackChannel/"),g="?param=",h="&sToken=";if(window.sTok!=null){h=h+window.sTok}else{h=""}var z=NDXRequest.XMLHTTPOpen(this.fetcher,y,g,o,true,h);if(!z){k=null;h=null}var f=this;this.fetcher.onreadystatechange=function(){};this.fetcher.setRequestHeader("Content-type","text/plain; charset=UTF-8");this.fetcher.setRequestHeader("AtssoRedirectStatusCode",278);this.fetcher.setRequestHeader("AtssoReturnLocation",location.href);try{var v=new Date();if(logTimings){LogWriteServer("&lt;HTTP&gt; /* "+FormatDate(v)+" */+HTTP call")}if(h!=null&&k!=null){this.fetcher.send(k+h)}else{this.fetcher.send(k)}f.fetcher=this.fetcher}catch(s){var u=WorkflowContext_GenerateHttpError(this.fetcher.status);getCurWFC_NS(this.windowID).status([{n:9351,t:2,m:u,a:null}])}}while(b)};var pingResult=false;function openPingDialog(h){if(typeof h!="undefined"&&h!=null){var d=h.getBoundingClientRect();var g=h.ownerDocument;var f=g.defaultView;var b=d.left+f.screenX;var k=d.top+f.screenY;window.nowOpenPingDialog="true";window.showModalDialog(AbsContextPath+"resources/html/ping.html",window,"dialogHeight:10px; dialogWidth:10px; dialogleft:"+b+"px; dialogtop:"+k+"px");if(pingDialogWindow){backChannelRetryCount=1;pauseJS(backChannelRetryInterval)}}else{window.nowOpenPingDialog="true";window.showModalDialog(AbsContextPath+"resources/html/ping.html",window,"dialogHeight:10px; dialogWidth:10px;");if(pingDialogWindow){backChannelRetryCount=1;pauseJS(backChannelRetryInterval)}}return pingResult}function setPingDialogResult(b){pingResult=b}function checkMidtierAvailability(){var b=GET_XML_HTTP();b.open("GET",AbsContextPath+"servlet/PingServlet",false);b.setRequestHeader("Content-type","text/plain; charset=UTF-8");try{b.send(null)}catch(d){}if(b.readyState==4&&b.status==200&&b.responseText){return true}return false}function pauseJS(b){b+=new Date().getTime();while(new Date().getTime()<b){try{pingDialogWindow.document.write("Loading ...")}catch(d){}}retryPing()}var backChannelRetryCount=1;function retryPing(){var b=checkMidtierAvailability();if(b==true){pingResult=true}else{if(backChannelRetryCount<=backChannelRetryFrequency){backChannelRetryCount=backChannelRetryCount+1;pauseJS(backChannelRetryInterval)}else{pingResult=false}}pingDialogWindow.close()}var pingDialogWindow=null;if(!window.showModalDialog){window.showModalDialog=function(d,E,H){try{var y=H.split(";");var k=new Array();if(document.all){for(var o=0;o<y.length-1;o++){var z=y[o].split("=");k[z[0]]=z[1]}}else{for(var o=0;o<y.length-1;o++){var z=y[o].split(":");k[z[0].toLowerCase()]=z[1]}}var v="10px",C="10px",g="100px",D="100px",b="yes",B="yes",G="no";if(k.dialogheight){v=k.dialogheight}if(k.dialogwidth){C=k.dialogwidth}if(k.dialogleft){g=k.dialogleft}if(k.dialogtop){D=k.dialogtop}if(k.resizable){b=k.resizable}if(k.center){B=k.center}if(k.status){G=k.status}var u="height = "+v+",width = "+C+",left="+g+",top="+D+",model=yes,alwaysRaised=yes,resizable= "+b+",celter="+B+",status="+G;pingDialogWindow=window.open("about","",u,null);pingDialogWindow.document.write("<div class='loadingContainer'><nobr><img class='loadingImage' src='"+AbsContextPath+"resources/images/Progress_NonModal-circle.gif'/><span class='loadingText'>"+getLocalizedMessage("Loading...")+"</span></nobr></div>");pingDialogWindow.dialogArguments=E}catch(A){}}}NDXGetEntryList.prototype=new NDXRequest();NDXGetEntryList.prototype.constructor=NDXGetEntryList;NDXGetEntryList.superclass=NDXRequest.prototype;function NDXGetEntryList(d,k,o,b,g,h,u,y,w,A,C,f,B,z,v,s){if(arguments.length){this.init("GetEntryList",d,k,o,b,g,h,u,y,w,A,C,f,B,z,v,s)}}NDXSetEntryList.prototype=new NDXRequest();NDXSetEntryList.prototype.constructor=NDXSetEntryList;NDXSetEntryList.superclass=NDXRequest.prototype;function NDXSetEntryList(f,G,E,z,w,s,D,b,g,k,C,d,v,y,o,B,h,A,u){if(arguments.length){this.init("SetEntryList",f,G,E,z,w,s,D,b,g,k,C,d,v,y,o,B,h,A,u)}}NDXGetEntry.prototype=new NDXRequest();NDXGetEntry.prototype.constructor=NDXGetEntry;NDXGetEntry.superclass=NDXRequest.prototype;function NDXGetEntry(f,s,h,g,o,d,b,k){if(arguments.length){this.init("GetEntry",f,s,h,g,o,d,b,k)}}NDXSetEntry.prototype=new NDXRequest();NDXSetEntry.prototype.constructor=NDXSetEntry;NDXSetEntry.superclass=NDXRequest.prototype;function NDXSetEntry(f,g,h,w,k,s,o,u,v,b,d){if(arguments.length){this.init("SetEntry",f,g,h,w,k,s,o,u,v,b,d)}}NDXGetSQLEntryList.prototype=new NDXRequest();NDXGetSQLEntryList.prototype.constructor=NDXGetSQLEntryList;NDXGetSQLEntryList.superclass=NDXRequest.prototype;function NDXGetSQLEntryList(d,h,k,g,z,o,f,b,v,y,u,w,s){if(arguments.length){this.init("GetSQLEntryList",d,h,k,g,z,o,f,b,v,y,u,w,s)}}NDXDeleteEntry.prototype=new NDXRequest();NDXDeleteEntry.prototype.constructor=NDXDeleteEntry;NDXDeleteEntry.superclass=NDXRequest.prototype;function NDXDeleteEntry(d,g,f,b){if(arguments.length){this.init("DeleteEntry",d,g,f,b)}}NDXCompileQualification.prototype=new NDXRequest();NDXCompileQualification.prototype.constructor=NDXCompileQualification;NDXCompileQualification.superclass=NDXRequest.prototype;function NDXCompileQualification(b,h,f,g,d){if(arguments.length){this.init("CompileQualification",b,h,f,g,d)}}NDXCompileExternalQualification.prototype=new NDXRequest();NDXCompileExternalQualification.prototype.constructor=NDXCompileExternalQualification;NDXCompileExternalQualification.superclass=NDXRequest.prototype;function NDXCompileExternalQualification(d,f,g,b,u,v,o,k,s,w,h){if(arguments.length){this.init("CompileExternalQualification",d,f,g,b,u,v,o,k,s,w,h)}}NDXServerRunProcess.prototype=new NDXRequest();NDXServerRunProcess.prototype.constructor=NDXServerRunProcess;NDXServerRunProcess.superclass=NDXRequest.prototype;function NDXServerRunProcess(b,g,h,w,s,f,d,o,k,v,y,u){if(arguments.length){this.init("ServerRunProcess",b,g,h,w,s,f,d,o,k,v,y,u)}}NDXExpandMenu.prototype=new NDXRequest();NDXExpandMenu.prototype.constructor=NDXExpandMenu;NDXExpandMenu.superclass=NDXRequest.prototype;function NDXExpandMenu(f,G,z,w,C,A,E,s,y,v,d,g,k,D,o,B,h,b,u){if(arguments.length){this.init("ExpandMenu",f,G,z,w,C,A,E,s,y,v,d,g,k,D,o,B,h,b,u)}}NDXGetMenuDefinition.prototype=new NDXRequest();NDXGetMenuDefinition.prototype.constructor=NDXGetMenuDefinition;NDXGetMenuDefinition.superclass=NDXRequest.prototype;function NDXGetMenuDefinition(b,d,g,f){if(arguments.length){this.init("GetMenuDefinition",b,d,g,f)}}NDXGetARUserPreference.prototype=new NDXRequest();NDXGetARUserPreference.prototype.constructor=NDXGetARUserPreference;NDXGetARUserPreference.superclass=NDXRequest.prototype;function NDXGetARUserPreference(d,b,f){if(arguments.length){this.init("GetARUserPreference",d,b,f)}}NDXSetARUserPreference.prototype=new NDXRequest();NDXSetARUserPreference.prototype.constructor=NDXSetARUserPreference;NDXSetARUserPreference.superclass=NDXRequest.prototype;function NDXSetARUserPreference(d,b,g,f){if(arguments.length){this.init("SetARUserPreference",d,b,g,f)}}NDXRefreshARUserPreferences.prototype=new NDXRequest();NDXRefreshARUserPreferences.prototype.constructor=NDXRefreshARUserPreferences;NDXRefreshARUserPreferences.superclass=NDXRequest.prototype;function NDXRefreshARUserPreferences(d,b){if(arguments.length){this.init("RefreshARUserPreferences",d,b)}}NDXGetURLForForm.prototype=new NDXRequest();NDXGetURLForForm.prototype.constructor=NDXGetURLForForm;NDXGetURLForForm.superclass=NDXRequest.prototype;function NDXGetURLForForm(f,v,h,o,b,u,s,d,k,g){if(arguments.length){this.init("GetURLForForm",f,v,h,o,b,u,s,d,k,g)}}NDXGetTableEntryList.prototype=new NDXRequest();NDXGetTableEntryList.prototype.constructor=NDXGetTableEntryList;NDXGetTableEntryList.superclass=NDXRequest.prototype;function NDXGetTableEntryList(d,A,y,G,s,C,B,z,w,E,D,H,b,g,v,h,u,f,k,o){if(arguments.length){this.init("GetTableEntryList",d,A,y,G,s,C,B,z,w,E,D,H,b,g,v,h,u,f,k,o)}}NDXGetQBETableEntryList.prototype=new NDXRequest();NDXGetQBETableEntryList.prototype.constructor=NDXGetQBETableEntryList;NDXGetQBETableEntryList.superclass=NDXRequest.prototype;function NDXGetQBETableEntryList(d,D,A,O,k,H,E,B,z,N,K,s,w,y,P,L,u,J,G,b,g,v,o,I,C,f,h){if(arguments.length){this.init("GetQBETableEntryList",d,D,A,O,k,H,E,B,z,N,K,s,w,y,P,L,u,J,G,b,g,v,o,I,C,f,h)}}NDXGetGuideServerAndForm.prototype=new NDXRequest();NDXGetGuideServerAndForm.prototype.constructor=NDXGetGuideServerAndForm;NDXGetGuideServerAndForm.superclass=NDXRequest.prototype;function NDXGetGuideServerAndForm(b,d,f){if(arguments.length){this.init("GetGuideServerAndForm",b,d,f)}}NDXGetCurrencyExchangeRates.prototype=new NDXRequest();NDXGetCurrencyExchangeRates.prototype.constructor=NDXGetCurrencyExchangeRates;NDXGetCurrencyExchangeRates.superclass=NDXRequest.prototype;function NDXGetCurrencyExchangeRates(b,f,d){if(arguments.length){this.init("GetCurrencyExchangeRates",b,f,d)}}NDXGetPushFieldTypes.prototype=new NDXRequest();NDXGetPushFieldTypes.prototype.constructor=NDXGetPushFieldTypes;NDXGetPushFieldTypes.superclass=NDXRequest.prototype;function NDXGetPushFieldTypes(b,g,f,d){if(arguments.length){this.init("GetPushFieldTypes",b,g,f,d)}}NDXGetServerTimestamp.prototype=new NDXRequest();NDXGetServerTimestamp.prototype.constructor=NDXGetServerTimestamp;NDXGetServerTimestamp.superclass=NDXRequest.prototype;function NDXGetServerTimestamp(b,d){if(arguments.length){this.init("GetServerTimestamp",b,d)}}NDXMarkAlert.prototype=new NDXRequest();NDXMarkAlert.prototype.constructor=NDXMarkAlert;NDXMarkAlert.superclass=NDXRequest.prototype;function NDXMarkAlert(b,h,f,d,g){if(arguments.length){this.init("MarkAlert",b,h,f,d,g)}}NDXParseAndEncodeQualifier.prototype=new NDXRequest();NDXParseAndEncodeQualifier.prototype.constructor=NDXParseAndEncodeQualifier;NDXParseAndEncodeQualifier.superclass=NDXRequest.prototype;function NDXParseAndEncodeQualifier(d,h,g,b,f){if(arguments.length){this.init("ParseAndEncodeQualifier",d,h,g,b,f)}}NDXParseAndEvaluateQualifier.prototype=new NDXRequest();NDXParseAndEvaluateQualifier.prototype.constructor=NDXParseAndEvaluateQualifier;NDXParseAndEvaluateQualifier.superclass=NDXRequest.prototype;function NDXParseAndEvaluateQualifier(d,s,o,b,k,g,f,h){if(arguments.length){this.init("ParseAndEvaluateQualifier",d,s,o,b,k,g,f,h)}}NDXGetFieldDefaults.prototype=new NDXRequest();NDXGetFieldDefaults.prototype.constructor=NDXGetFieldDefaults;NDXGetFieldDefaults.superclass=NDXRequest.prototype;function NDXGetFieldDefaults(b,g,f,d){if(arguments.length){this.init("GetFieldDefaults",b,g,f,d)}}NDXSetOverride.prototype=new NDXRequest();NDXSetOverride.prototype.constructor=NDXSetOverride;NDXSetOverride.superclass=NDXRequest.prototype;function NDXSetOverride(b,d){if(arguments.length){this.init("SetOverride",b,d)}}NDXSaveSearch.prototype=new NDXRequest();NDXSaveSearch.prototype.constructor=NDXSaveSearch;NDXSaveSearch.superclass=NDXRequest.prototype;function NDXSaveSearch(d,b,f,g,u,o,k,v,h,s){if(arguments.length){this.init("SaveSearch",d,b,f,g,u,o,k,v,h,s)}}NDXDeleteSearch.prototype=new NDXRequest();NDXDeleteSearch.prototype.constructor=NDXDeleteSearch;NDXDeleteSearch.superclass=NDXRequest.prototype;function NDXDeleteSearch(b,g,d,f){if(arguments.length){this.init("DeleteSearch",b,g,d,f)}}NDXSaveTableSettings.prototype=new NDXRequest();NDXSaveTableSettings.prototype.constructor=NDXSaveTableSettings;NDXSaveTableSettings.superclass=NDXRequest.prototype;function NDXSaveTableSettings(f,g,h,k,s,o,u,d,b){if(arguments.length){this.init("SaveTableSettings",f,g,h,k,s,o,u,d,b)}}NDXExecuteService.prototype=new NDXRequest();NDXExecuteService.prototype.constructor=NDXExecuteService;NDXExecuteService.superclass=NDXRequest.prototype;function NDXExecuteService(g,k,f,h,d,w,b,o,s,v,u){if(arguments.length){this.init("ExecuteService",g,k,f,h,d,w,b,o,s,v,u)}}NDXGetARTemplate.prototype=new NDXRequest();NDXGetARTemplate.prototype.constructor=NDXGetARTemplate;NDXGetARTemplate.superclass=NDXRequest.prototype;function NDXGetARTemplate(b,o,f,d,h,g,k){if(arguments.length){this.init("GetARTemplate",b,o,f,d,h,g,k)}}NDXGetOpenWindowURL.prototype=new NDXRequest();NDXGetOpenWindowURL.prototype.constructor=NDXGetOpenWindowURL;NDXGetOpenWindowURL.superclass=NDXRequest.prototype;function NDXGetOpenWindowURL(g,A,h,s,u,w,v,z,B,o,d,y,f,k,b){if(arguments.length){this.init("GetOpenWindowURL",g,A,h,s,u,w,v,z,B,o,d,y,f,k,b)}}NDXGetBulkTableEntryList.prototype=new NDXRequest();NDXGetBulkTableEntryList.prototype.constructor=NDXGetBulkTableEntryList;NDXGetBulkTableEntryList.superclass=NDXRequest.prototype;function NDXGetBulkTableEntryList(b,f,d){if(arguments.length){this.init("GetBulkTableEntryList",b,f,d)}}NDXSaveQuickReport.prototype=new NDXRequest();NDXSaveQuickReport.prototype.constructor=NDXSaveQuickReport;NDXSaveQuickReport.superclass=NDXRequest.prototype;function NDXSaveQuickReport(f,b,k,g,h,s,d,o,u){if(arguments.length){this.init("SaveQuickReport",f,b,k,g,h,s,d,o,u)}}NDXDeleteQuickReport.prototype=new NDXRequest();NDXDeleteQuickReport.prototype.constructor=NDXDeleteQuickReport;NDXDeleteQuickReport.superclass=NDXRequest.prototype;function NDXDeleteQuickReport(b,g,d,f){if(arguments.length){this.init("DeleteQuickReport",b,g,d,f)}}NDXModifyQuickReport.prototype=new NDXRequest();NDXModifyQuickReport.prototype.constructor=NDXModifyQuickReport;NDXModifyQuickReport.superclass=NDXRequest.prototype;function NDXModifyQuickReport(b,h,g,f,d){if(arguments.length){this.init("ModifyQuickReport",b,h,g,f,d)}}NDXGetAPITimings.prototype=new NDXRequest();NDXGetAPITimings.prototype.constructor=NDXGetAPITimings;NDXGetAPITimings.superclass=NDXRequest.prototype;function NDXGetAPITimings(d,b){if(arguments.length){this.init("GetAPITimings",d,b)}}NDXGetHTMLScriptForViewField.prototype=new NDXRequest();NDXGetHTMLScriptForViewField.prototype.constructor=NDXGetHTMLScriptForViewField;NDXGetHTMLScriptForViewField.superclass=NDXRequest.prototype;function NDXGetHTMLScriptForViewField(d,o,g,f,b,k,h){if(arguments.length){this.init("GetHTMLScriptForViewField",d,o,g,f,b,k,h)}}NDXGetOpenWindowQueryVF.prototype=new NDXRequest();NDXGetOpenWindowQueryVF.prototype.constructor=NDXGetOpenWindowQueryVF;NDXGetOpenWindowQueryVF.superclass=NDXRequest.prototype;function NDXGetOpenWindowQueryVF(f,g,h,k,s,o,v,w,u,d,b){if(arguments.length){this.init("GetOpenWindowQueryVF",f,g,h,k,s,o,v,w,u,d,b)}}NDXLoadQueryWidget.prototype=new NDXRequest();NDXLoadQueryWidget.prototype.constructor=NDXLoadQueryWidget;NDXLoadQueryWidget.superclass=NDXRequest.prototype;function NDXLoadQueryWidget(d,f,g,h,b){if(arguments.length){this.init("LoadQueryWidget",d,f,g,h,b)}}NDXSpellChecker.prototype=new NDXRequest();NDXSpellChecker.prototype.constructor=NDXSpellChecker;NDXSpellChecker.superclass=NDXRequest.prototype;function NDXSpellChecker(d,f,b){if(arguments.length){this.init("SpellChecker",d,f,b)}}NDXGetCacheIDForViewField.prototype=new NDXRequest();NDXGetCacheIDForViewField.prototype.constructor=NDXGetCacheIDForViewField;NDXGetCacheIDForViewField.superclass=NDXRequest.prototype;function NDXGetCacheIDForViewField(d,h,g,f,b){if(arguments.length){this.init("GetCacheIDForViewField",d,h,g,f,b)}}ARMap.prototype.constructor=ARMap;ARMap.MapParametersRE=new RegExp('\\s*([^=\\s;]+)\\s*=((\\s*([^";]+"[^"]*"[^";]*)*\\s*)|(\\s*("(([^"]|(""))*)")\\s*)|([^;]*))(;|$)',"g");function ARMap(b,f,d){this.windowID=b;this.mID=f;this.mValue=null;this.mVals={};this.mLength=0;this.process(d);getARMaps_NS(b)[f]=this}ARMap.prototype.process=function(d){this.mVals={};this.mLength=0;this.mValue=d;var g;while((g=ARMap.MapParametersRE.exec(this.mValue))){var b=g[1];var f=g[3]?g[3]:(g[4]?g[4]:(g[7]?g[7].replace(/\"\"/g,'"'):g[10]));if(f!=null&&f!=""){this.mVals[b]=f;this.mLength++}}};ARMap.prototype.getValue=function(b){if(b==null){return null}return this.mVals[b]};ARMap.prototype.setValue=function(b,d){if(b==null){return}if(d==null||d==""){if(this.mVals[b]!=null){this.mLength--}delete this.mVals[b];return}if(!this.mVals[b]){this.mLength++}this.mVals[b]=d;this.computeValue()};ARMap.prototype.computeValue=function(){var d="";for(var b in this.mVals){var f=this.mVals[b];d+=b;d+="=";if(f.indexOf(";")!=-1){d+='"';d+=f.replace(/\"/g,'""');d+='"'}else{d+=f}d+=";"}F(this.windowID,this.mID).SLoadEntry((d=="")?Null:new CharType(d))};ARMap.prototype.size=function(){return this.mLength};function M(d,f){if(f==null){return null}var b=(f in getARMaps_NS(d))?getARMaps_NS(d)[f]:null;if(b==null){b=new ARMap(d,f,F(d,f).G().toString())}return b}ARArray.prototype.constructor=ARArray;ARArray.ArrayParametersRE=new RegExp('((\\s*([^";]+"[^"]*"[^";]*)+\\s*)|(\\s*("(([^"]|(""))*)")\\s*)|([^;]+))(;|$)',"g");function ARArray(b,f,d){this.windowID=b;this.mID=f;this.mValue=null;this.mVals=[];this.process(d);getARArrays_NS(b)[f]=this}ARArray.prototype.process=function(d){this.mValue=d;this.mVals=[];var b;while((b=ARArray.ArrayParametersRE.exec(this.mValue))){var f=(typeof b[2]!="undefined")?b[2]:((typeof b[3]!="undefined")?b[3]:((typeof b[6]!="undefined")?b[6].replace(/\"\"/g,'"'):b[9]));if(f!=null){this.mVals.push(f)}}};ARArray.prototype.getValue=function(b){if(typeof b!="number"){if(typeof b=="string"){b=parseInt(b);if(isNaN(b)){return null}}else{return null}}b--;if(b<0||b>=this.mVals.length){return null}return this.mVals[b]};ARArray.prototype.computeValue=function(){var d="";for(var b=0;b<this.mVals.length;b++){if(this.mVals[b].indexOf(";")!=-1){d+='"';d+=this.mVals[b].replace(/\"/g,'""');d+='"'}else{d+=this.mVals[b]}d+=";"}F(this.windowID,this.mID).SLoadEntry((d=="")?Null:new CharType(d))};ARArray.prototype.append=function(b){if(b==null||b==""){return}this.mVals.push(b);this.computeValue()};ARArray.prototype.size=function(){return this.mVals.length};function ARR(b,f){if(f==null){return null}var d=(f in getARArrays_NS(b))?getARArrays_NS(b)[f]:null;if(d==null){d=new ARArray(b,f,F(b,f).G().toString())}return d}var pattern_newLn=/\n/g;var pattern_carRet=/\r/g;var pattern_carRetNewLn=/\r\n/g;var const_newLn="\n";var const_carRet="\r";var const_carRetNewLn="\r\n";function ARFuncSilentFail(){getCurWFC_NS(getCurrentWindowID_NS()).status(0)}function ARFuncUpper(b){if(b.isNull){return b}return new CharType(b.toString().toUpperCase())}function ARFuncLower(b){if(b.isNull){return b}return new CharType(b.toString().toLowerCase())}function ARFuncDate(b){if(b.isNull){return Null}return new CharType(new TimeType(b.toString()).toString(2))}function ARFuncTime(b){if(b.isNull){return Null}return new CharType(new TimeType(b.toString()).toTOD())}function ARFuncMonth(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GMonth()+1)}function ARFuncDay(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GDate())}function ARFuncYear(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GYear())}function ARFuncWeekday(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GDay()+1)}function ARFuncHour(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GHour())}function ARFuncMinute(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GMinute())}function ARFuncSecond(f){if(f.isNull){return Null}var b=ARDate.parseDateTime(new TimeType(f.toString()).toString());return new IntegerType(b.GSecond())}function ARFuncTrunc(b){return b.TRUNC()}function ARFuncRound(b){b=b.ROUND();if(b.isNull){return Null}if(b instanceof CurrencyType){return b}return new IntegerType(b)}function ARFuncConvert(){Log("ARFuncConvert() - unsupported");getCurWFC_NS(getCurrentWindowID_NS()).status(9369)}function ARFuncLength(b){return ARFuncLengthC(b)}function ARFuncSubstr(b,f,d){return ARFuncSubstrC(b,f,d)}function ARFuncLeft(d,b){return ARFuncLeftC(d,b)}function ARFuncRight(d,b){return ARFuncRightC(d,b)}function ARFuncLTrim(d){if(d.isNull){return d}var b=d.toString().trim(1,true);return(b!="")?new CharType(b):Null}function ARFuncRTrim(d){if(d.isNull){return d}var b=d.toString().trim(2,true);return(b!="")?new CharType(b):Null}function ARFuncLPad(d,f,b){return ARFuncLPadC(d,f,b)}function ARFuncRPad(d,f,b){return ARFuncRPadC(d,f,b)}function ARFuncReplace(k,h,f){if(k.isNull||h.isNull){return Null}if(h.toString()==""){return k}var v=k.toString();var u=h.toString();var o=f.toString();var y=v;var s=/\n/g;var b=/^\n$/g;var d=/\r\n/g;var g=/\r\n/g;if(v.search(d)!=-1){v=v.replace(d,"\n")}if(u.search(g)!=-1){u=u.replace(g,"\n")}var w=new RegExp(u.toRegExp(),"g");o=o.toRegExpSP();y=v.replace(w,o);return(y!="")?new CharType(y):Null}function ARFuncStrstr(d,b){return ARFuncStrstrC(d,b)}function ARFuncMin(){var b=new Array(arguments.length+1);b[0]="LT";for(var d=0;d<arguments.length;++d){b[d+1]=arguments[d]}return ARFunc_MinMax.apply(null,b)}function ARFuncMax(){var b=new Array(arguments.length+1);b[0]="GT";for(var d=0;d<arguments.length;++d){b[d+1]=arguments[d]}return ARFunc_MinMax.apply(null,b)}function ARFunc_MinMax(f){var b;for(var g=1;g<arguments.length;++g){var d=arguments[g];if(!d.isNull&&(!b||d[f](b))){b=d}}if(!b){b=Null}return b}function ARFunc_ColSumAvg(h,d){if(h instanceof JColumn){if(h.IsTimeRelatedField()){return Null}var o=h.getTable();var f=0;var g=o.GetRow();var u=new RealType(0);if(h.GetType()==12){var s=h.GetDataField();u=new CurrencyType("0",s);u.mCurCode=s.GetDefaultCurrency();u.mPrecision=s.GetPrecision(u.mCurCode);if(s.mFunctional==null||s.mFunctional[u.mCurCode]==null){u.mCurCode=null}}for(var b=0;b<o.GetRows();++b){o.SetRow(b);var k=h.G();if(!k.isNull){if(u.mCurCode==null&&k.type==12){u.mCurCode=k.mCurCode}u.ADD(u,k);++f}}o.SetRow(g);if(f==0){return Null}if(d){u.DIV(u,new RealType(f))}return u}else{if(h==DummyField){return Null}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9368)}}}function ARFuncColSum(b){return ARFunc_ColSumAvg(b,false)}function ARFuncColAvg(b){return ARFunc_ColSumAvg(b,true)}function ARFuncColCount(o){if(o instanceof JColumn){var h=o.getTable();if(!h.mResult){return Null}var g=0;var f=h.GetRow();for(var d=0;d<h.GetRows();++d){h.SetRow(d);var b=o.G();if(!b.isNull){++g}}h.SetRow(f);return new IntegerType(g)}else{if(o instanceof DTable){if(!o.mResult){return Null}var k=o.GetRows();return new IntegerType(k)}else{if(o==DummyField){return Null}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9368)}}}}function ARFunc_ColMinMax(o,f){if(o instanceof JColumn){var k=o.getTable();if(k.GetRows()==0){return Null}var h=k.GetRow();var b;for(var g=0;g<k.GetRows();++g){k.SetRow(g);var d=o.G();if(!d.isNull&&(!b||d[f](b))){b=d}}k.SetRow(h);if(!b){b=Null}return b}else{if(o==DummyField){return Null}else{getCurWFC_NS(getCurrentWindowID_NS()).status(9368)}}}function ARFuncColMin(b){return ARFunc_ColMinMax(b,"LT")}function ARFuncColMax(b){return ARFunc_ColMinMax(b,"GT")}function ARFuncDateAdd(d,f,b){if(d.isNull||f.isNull||b.isNull){return Null}d=d.toString();f=new IntegerType(f.toInteger());b=b.toDate();if(ARFuncIsDatepartDay(d)){return b.ADD(b,f)}else{if(ARFuncIsDatepartWeek(d)){return b.ADDWEEKS(f)}else{if(ARFuncIsDatepartMonth(d)){return b.ADDMONTHS(f)}else{if(ARFuncIsDatepartYear(d)){return b.ADDYEARS(f)}}}}return Null}function ARFuncDateDiff(f,d,b){if(f.isNull||d.isNull||b.isNull){return Null}f=f.toString();d=d.toDate();b=b.toDate();if(ARFuncIsDatepartDay(f)){return new IntegerType(b.toInteger()-d.toInteger())}else{if(ARFuncIsDatepartWeek(f)){return new IntegerType(Math.floor((b.toInteger()-d.toInteger())/7))}}return Null}function ARFuncDateName(d,b){if(d.isNull||b.isNull){return Null}d=d.toString();var f=ARDate.parseDate(b.toString());if(f==null){return Null}if(ARFuncIsDatepartMonth(d)){return new CharType(ARDate.MonthLabel(f.GMonth()))}else{if(ARFuncIsDatepartWeekday(d)){return new CharType(f.DayLong())}}return Null}function ARFuncDateNum(d,b){if(d.isNull||b.isNull){return Null}d=d.toString();var f=ARDate.parseDateTime(b.toString());if(f==null){return Null}if(ARFuncIsDatepartYear(d)){return new IntegerType(f.GYear())}else{if(ARFuncIsDatepartMonth(d)){return new IntegerType(f.GMonth()+1)}else{if(ARFuncIsDatepartDay(d)){return new IntegerType(f.GDate())}else{if(ARFuncIsDatepartWeek(d)){return new IntegerType(f.GWeekNumber())}else{if(ARFuncIsDatepartWeekday(d)){return new IntegerType(f.GDay()+1)}}}}}return Null}function ARFuncCurrConvert(f,k,d){if(f.isNull||k.isNull||d.isNull){return Null}if(!(f instanceof CurrencyType)){if(f.mValue.length<4||!isNaN(f.mValue)){return Null}var h=f.mValue.substring(0,f.mValue.length-3);h=h.replace(/\s+$/g,"");var g=f.mValue.substring(f.mValue.length-3);g=g.replace(/\s+$/g,"");var b=2;if(h.indexOf(".")!=-1){b=h.split(".")[1].length}f=new CurrencyType(h,b);f.mCurCode=g}return f.CurrConvert(k.toString(),d.toInteger())}function ARFuncCurrSetDate(d,b){if(d.isNull||b.isNull){return Null}return d.CurrSetDate(b.toTime().toInteger())}function ARFuncCurrSetType(b,d){if(b.isNull||d.isNull){return Null}return b.CurrSetType(d)}function ARFuncCurrSetValue(b,d){if(b.isNull||d.isNull){return Null}return b.CurrSetValue(d.toDecimal())}function ARFuncLengthC(b){if(b.isNull){return b}return new IntegerType(b.toString().length)}function ARFuncLeftC(h,g){if(h.isNull||g.isNull){return Null}var d=h.toString();var b=g.toInteger();var f=d.substring(0,b);return(f!="")?new CharType(f):Null}function ARFuncRightC(h,g){if(h.isNull||g.isNull){return Null}var d=h.toString();var b=g.toInteger();var f=d.substring(d.length-b);return(f!="")?new CharType(f):Null}function ARFuncLPadC(k,f,d){if(k.isNull||f.isNull||d.isNull){return Null}var s=k.toString();var b=f.toInteger();var o=d.toString();if(o==""){return k}var u=o;var g=b-s.length;while(g>u.length){u+=o}var h=u.substring(0,g)+s;return(h!="")?new CharType(h):Null}function ARFuncRPadC(k,f,d){if(k.isNull||f.isNull||d.isNull){return Null}var s=k.toString();var b=f.toInteger();var o=d.toString();if(o==""){return k}var u=o;var g=b-s.length;while(g>u.length){u+=o}var h=s+u.substring(0,g);return(h!="")?new CharType(h):Null}function ARFuncStrstrC(g,f){if(g.isNull||f.isNull){return Null}var d=g.toString();var b=f.toString();if(d.indexOf(const_carRetNewLn)!=-1){d=d.replace(pattern_carRet,"")}if(b.indexOf(const_carRetNewLn)!=-1){b=b.replace(pattern_carRet,"")}return new IntegerType(d.indexOf(b))}function ARFuncSubstrC(o,k,h){if(o.isNull||k.isNull){return Null}var d=o.toString();var s=k.toInteger();var b=d.length;if(s<0||s>b){return Null}if(h&&h instanceof Datatype&&!(h.isNull)){var g=h.toInteger();if((g<s&&g>=0)||(g+1)==s){return Null}if(g>=s&&g<b){b=g}}var f=d.substring(s,b+1);return(f!="")?new CharType(f):Null}function ARFuncEncrypt(){Log("ARFuncEncrypt() - unsupported");getCurWFC_NS(getCurrentWindowID_NS()).status(9369)}function ARFuncDecrypt(){Log("ARFuncDecrypt() - unsupported");getCurWFC_NS(getCurrentWindowID_NS()).status(9369)}function ARFuncIsDatepartYear(b){b=b.toLowerCase();return(b=="year"||b=="yyyy"||b=="yy")}function ARFuncIsDatepartMonth(b){b=b.toLowerCase();return(b=="month"||b=="mm"||b=="m")}function ARFuncIsDatepartDay(b){b=b.toLowerCase();return(b=="day"||b=="md"||b=="dd")}function ARFuncIsDatepartWeek(b){b=b.toLowerCase();return(b=="week"||b=="wk"||b=="ww")}function ARFuncIsDatepartWeekday(b){b=b.toLowerCase();return(b=="weekday"||b=="wd")}function ARFuncTemplate(){var d=arguments[0];if(d instanceof Datatype){if(d.isNull){return Null}d=d.toString()}var b=getCurrentWindowID_NS();var g=T(b,d);if(!g){return Null}for(var f=1;f<(arguments.length-1);f+=2){var k=arguments[f];if(k instanceof Datatype){k=k.toString()}var h=arguments[f+1];if(h instanceof Datatype){h=h.toString()}g.S(k,h)}return new CharType(g.process(b))}function ARFuncHover(b){var h=b.mValue;var g=getCurrentWindowID_NS();var d=hoverState.getHoverFID(g,h);if(d==-1||d!=h){return new CharType("")}var f=hoverState.getHoverValue(g,h);return new CharType(f)}function ARFuncSelectedRowCount(b){var f=F(getCurrentWindowID_NS(),b.mValue);var g=0;if(f&&f.mPrimaryRowSelection){for(var d in f.mRowSelections){g++}}return new IntegerType(g)}function ARFuncDroppedRowIndex(b){var f=b.mValue;var d=F(getCurrentWindowID_NS(),f);if(d&&"mMouseUpRowSelection" in d){return new IntegerType(d.mMouseUpRowSelection+1)}else{return new IntegerType(0)}}function ARFuncDroppedColumnIndex(b){var f=b.mValue;var d=F(getCurrentWindowID_NS(),f);if(d&&"mMouseUpColSelection" in d){return new IntegerType(d.mMouseUpColSelection+1)}else{return new IntegerType(0)}}function ARFuncMapGet(g,f){if(g==null||f==null){return Null}if(f instanceof Datatype){f=f.toString()}var b=M(getCurrentWindowID_NS(),g);if(b==null){return Null}var d=b.getValue(f);return(typeof d!="undefined"&&d!=null&&d!="")?new CharType(d):Null}function ARFuncListGet(g,b){if(g==null||b==null){return Null}if(b instanceof Datatype){b=b.toInteger()}var f=ARR(getCurrentWindowID_NS(),g);if(f==null){return Null}var d=f.getValue(b);return(typeof d!="undefined"&&d!=null&&d!="")?new CharType(d):Null}function ARFuncListSize(d){if(d==null){return null}var b=ARR(getCurrentWindowID_NS(),d);if(b==null){b=M(getCurrentWindowID_NS(),d)}return(b==null)?new IntegerType(0):new IntegerType(b.size())}function ARFuncVisibleRows(g){if(g==null){return Null}if(g!=null&&g instanceof Datatype&&g.isNull){return Null}var f=new IntegerType(0);var d=F(getCurrentWindowID_NS(),g);if(d!=null&&d instanceof DTable){if(!d.IsRefreshed()){return f}var b=d.getActualDisplayChunkSize();return new IntegerType(b)}return Null}function MenuElement(b,d,h,g,f,k){this.mSubMenuMap=g;this.mDef=h;this.mSerial=d;this.mEncode=f;this.windowID=b;this.mctrlfld=k}MenuElement.prototype.mW=MenuElement.prototype.mH=MenuElement.prototype.mRowH=MenuElement.prototype.mRowCnt=MenuElement.prototype.mScrollDir=MenuElement.prototype.mScrollTarget=MenuElement.prototype.mRowsPerScreen=MenuElement.prototype.mOpenPref=MenuElement.prototype.mMinScrollY=0;MenuElement.prototype.mElement=MenuElement.prototype.mScrollTimer=MenuElement.prototype.mHighlightedElement=null;MenuElement.prototype.mNeedToScroll=false;MenuElement.prototype.BuildAndMeasure=function(V,N,C){if(this.mElement!=null){return}var R=this.mSerial;var d=document.createElement("DIV");d.className="MenuOuter";d.setAttribute("armenuelementserial",""+R);d.style.zIndex=++nextZIndex;d.style.left="-2000px";var G=[];G.push("<DIV class=MenuScrollUp>&#9650;</DIV>");G.push("<DIV class=MenuTableContainer><TABLE class=MenuTable cellpadding=0 cellspacing=0><TBODY class=MenuTableBody>");var k="<TR class=MenuTableRow>",v="<TR class=MenuTableRowDisabled>";var A="<TD class=MenuEntryName nowrap";var g='">',K=">",J='</TD><TD class=MenuEntryNoSub ARValue="',W='" arbtnid="',y="</TD></TR>";var B="</TD><TD class=MenuEntrySub arsubmenu=";var D="&#9658;";for(var L in this.mDef){var Q=this.mDef[L];if(Q.v==null){Q.v=Q.l}var f=("s" in Q&&Q.s==0)?true:false;if(f){G.push(v)}else{G.push(k)}G.push(A);var u=(typeof Q.v!="string");var E=(this.mEncode?Q.l.ValidatorUnEscape().HTMLEncode():Q.l);if(u){G.push(K);G.push(E);G.push(B);if(!("s" in Q&&Q.s==0)){G.push(L)}G.push(K);G.push(D)}else{G.push(K);G.push(Q.l==""?"&nbsp;":E);G.push(J);if(typeof Q.v=="string"&&Q.v.charAt(0)=="\t"){G.push("\\")}G.push(this.mEncode?Q.v.ValidatorUnEscape().HTMLEncode():Q.v);if(Q.cId||this.mctrlfld){var P=(Q.cId?Q.cId:this.mctrlfld);G.push(W);G.push(P)}G.push(g)}G.push(y)}if(C){G.push(k);G.push(A);G.push(K);G.push(getLocalizedMessage("(clear)").HTMLEncode());G.push(J);G.push(g)}G.push("</TBODY></TABLE></DIV><DIV class=MenuScrollDown>&#9660;</DIV>");d.innerHTML=G.join("");document.body.appendChild(d);this.mElement=d;var s=d.childNodes[0];var I=d.childNodes[2];var U=d.childNodes[1];var S=U.firstChild;var b=U.firstChild.firstChild;var z=S.offsetWidth,O=S.offsetHeight;if(V==3&&z<N){z=N}S.style.width=s.style.width=I.style.width=z+"px";s.style.visibility=I.style.visibility="hidden";z+=2;O+=2;d.style.width=z+"px";this.mW=z;this.mH=O;var o=b.firstChild;if(o==null){this.mRowCnt=0;this.mRowH=0;return}var H=o;while(H.nextSibling&&this.mRowH==0){this.mRowH=H.nextSibling.firstChild.offsetTop-H.firstChild.offsetTop;H=H.nextSibling}if(this.mRowH==0){this.mRowH=o.firstChild.offsetHeight}this.mRowCnt=o.parentNode.childNodes.length};MenuElement.prototype.Scroll=function(b){if(!this.mNeedToScroll){return}this.mScrollDir=b;this.ScrollTimeout()};MenuElement.prototype.ScrollToRow=function(f){if(!this.mNeedToScroll){return}var b=0;for(;f;f=f.previousSibling,b++){}var d=-Math.floor(this.mScrollTarget/this.mRowH);if(b<=d){this.DoScroll((d-b+1)*this.mRowH)}else{if(b>=d+this.mRowsPerScreen){var g=Math.floor(b-(d+this.mRowsPerScreen));this.DoScroll(-g*this.mRowH)}}};MenuElement.prototype.ScrollTimeout=function(){this.DoScroll(this.mScrollDir*this.mRowH);var b=(this.mScrollTimer==null);this.mScrollTimer=setTimeout(function(){OpenedMenu.mElementStack[OpenedMenu.mElementStack.length-1].ScrollTimeout()},b?150:20)};MenuElement.prototype.DoScroll=function(d){this.mScrollTarget+=d;this.mScrollTarget=(this.mScrollTarget<this.mMinScrollY?this.mMinScrollY:this.mScrollTarget);this.mScrollTarget=(this.mScrollTarget>0?0:this.mScrollTarget);var b=this.mElement.childNodes[1];b.style.top=this.mScrollTarget+20+"px"};MenuElement.prototype.EndScroll=function(){if(this.mScrollTimer!=null){clearTimeout(this.mScrollTimer);this.mScrollTimer=null}};MenuElement.prototype.Close=function(){if(this.mScrollTimer!=null){clearTimeout(this.mScrollTimer)}var b=this.mElement;this.UnHighlightElement();if(OpenedMenu.mAnimate&&this.mSerial==0&&typeof AnimMgr!="undefined"){AnimMgr.WipeOutMenu(b,OpenedMenu)}else{b.style.visibility="hidden"}OpenedMenu.mElementStack.pop();if(OpenedMenu!=null){if(!OpenedMenu.mElementStack.length){OpenedMenu.Close()}}};function GetMenuElemCoords(w,d,z,g,f){var A=w;var h=ComputeElementPosition(A,document.body,0,0);var s=h.x;var k=h.y;var o=document.body.scrollTop;var b=document.body.scrollLeft;var v=window.innerWidth+b;var u=s;if(d==0){s+=w.offsetWidth+z}else{if(d==1){k+=w.offsetHeight}else{if(d==3){k+=w.offsetHeight}else{if(d==2){s=u-(f+g)+w.offsetWidth+z}else{}}}}if(g!=0){if(s+f>v&&d!=2){d=2;s=u-(f+g)+w.offsetWidth+z}else{if(s<b&&d!=0){d=0;s=u+(w.offsetWidth+z)}}}k=(k<o?o:k);s=(s<b?b:s);if(k<0){k=0}return{x:s,y:k,open_pref:d}}MenuElement.prototype.Open=function(k,H,A,b,s,D,B){this.mZIndex=s;this.BuildAndMeasure(H,k.offsetWidth,B);var h=GetMenuElemCoords(k,H,A,b,this.mW);var w=h.x,v=h.y;if(D!=null){w+=D.x;v+=D.y}this.mOpenPref=h.open_pref;this.mNeedToScroll=false;var C=this.mElement;var I=document.body.scrollTop;var o=window.innerHeight+I;var f=o-I;var E=this.mH<f?this.mH:f;if(this.mH>E){this.mNeedToScroll=true;C.style.height=E+"px";var u=C.childNodes[0],G=C.childNodes[1],z=C.childNodes[2];u.style.height=z.style.height=20+"px";u.style.visibility=z.style.visibility="inherit";G.style.top=20+"px";var g=E-20*2-2;if(g<this.mRowH){g=this.mRowH}g-=g%this.mRowH;this.mRowsPerScreen=g/this.mRowH;E=20*2+g+2;z.style.top=E-20-2+"px";this.mMinScrollY=-((this.mRowCnt-this.mRowsPerScreen)*this.mRowH)}if(v+E>=o){v=o-E}C.style.height=E+"px";var d=document.body.scrollLeft;var J=window.innerWidth+d;if(w+this.mW>=J){w=J-this.mW}OpenedMenu.mElementStack.push(this);if(OpenedMenu.mAnimate&&this.mSerial==0&&typeof AnimMgr!="undefined"){AnimMgr.WipeInMenu(C)}else{C.style.visibility="inherit"}C.style.top=v+"px";C.style.left=(w<0?0:w)+"px"};MenuElement.prototype.HighlightElement=function(f){this.UnHighlightElement();this.mHighlightedElement=f;var b="Hover";for(var d=f;d;d=d.nextSibling){if(d.className.indexOf(b)==-1){d.className+=b}}OpenedMenu.EnsureTopElement(this.mSerial);this.focusHighlightedElement()};MenuElement.prototype.focusHighlightedElement=function(){if(this.mFocusTimeout){clearTimeout(this.mFocusTimeout)}this.mFocusTimeout=null;var b=this.mHighlightedElement};MenuElement.prototype.CheckOpenSubMenu=function(){if(this.mHighlightedElement==null){return}var d=this.mHighlightedElement;if(d.nextSibling&&d.nextSibling.getAttribute("arsubmenu")){var b=parseInt(d.nextSibling.getAttribute("arsubmenu"));b=this.mSubMenuMap[b];if(!OpenedMenu.ElementAtTop(b)){OpenedMenu.OpenLevel(b,d.nextSibling,this.mOpenPref==2?2:0,2,this.mW,false)}}};MenuElement.prototype.UnHighlightElement=function(){if(this.mHighlightedElement==null){return}var g=this.mHighlightedElement;var d="Hover";for(var f=g;f;f=f.nextSibling){var b=f.className.indexOf(d);if(b!=-1){f.className=f.className.substr(0,b)}}this.mHighlightedElement=null};MenuElement.prototype.HandleKeyEvent=function(f){var d=f.key;if(d==37){if(this.mSerial!=0){this.Close();if(OpenedMenu&&OpenedMenu.mElementStack.length>0){OpenedMenu.mElementStack[OpenedMenu.mElementStack.length-1].focusHighlightedElement()}}}else{if(d==38){this.AdvanceHighlight(-1)}else{if(d==39){this.CheckOpenSubMenu();OpenedMenu.mElementStack[OpenedMenu.mElementStack.length-1].AdvanceHighlight(1)}else{if(d==40){this.AdvanceHighlight(1)}else{if(d==27){Menu_Close()}else{if(d==13){this.CheckOpenSubMenu();OpenedMenu.CheckClick();f.element.blur()}else{if(d==9){this.focusHighlightedElement()}else{var b;if(f.mEventObject.key!="undefined"){b=f.mEventObject.key.charCodeAt(0)}if(b!="undefined"&&b>=32&&b<255){this.AdvanceHighlightToCharacter(b);return true}if(f.element.className.indexOf("dropdown")!=-1){return true}return false}}}}}}}return true};MenuElement.prototype.AdvanceHighlightToCharacter=function(s){var h=this.mHighlightedElement;if(h==null){return}var f=String.fromCharCode(s);f=f.toLowerCase();var k=h.parentNode,o=k,g=o.parentNode.childNodes[o.parentNode.childNodes.length-1];do{var d=k.firstChild;var b=d.firstChild;if(b!=null&&b.length>0&&(b.data.charAt(0).toLowerCase()==f)){this.HighlightElement(k.firstChild);this.ScrollToRow(k)}k=k.previousSibling;if(k==null){k=g}}while(k!=o)};MenuElement.prototype.CheckClick=function(){var d=this.mHighlightedElement;if(d==null||d.parentNode==null||d.parentNode.className=="MenuTableRowDisabled"){return null}var b=d.nextSibling.getAttribute("arvalue");if(b.length>1&&b.substr(0,2)=="\\\t"){b=b.substr(1)}return b};MenuElement.prototype.AdvanceHighlight=function(f){var g=this.mHighlightedElement;if(g==null){var b=this.mElement.childNodes[1];h=b.firstChild.firstChild.firstChild}else{var h=g.parentNode;if(f==1){h=h.nextSibling;if(h==null){h=g.parentNode.parentNode.firstChild}}else{if(f==-1){h=h.previousSibling;if(h==null){var d=g.parentNode.parentNode.childNodes;h=d[d.length-1]}}}}this.HighlightElement(h.firstChild);this.ScrollToRow(h)};MenuElement.prototype.HandleMouseEvent=function(d,h){var g=h.element;var f=g.className;if(f==null){return}if(d==1){if(g.tagName!="TD"||f.indexOf("MenuEntry")==-1){return}this.EndScroll();g=g.parentNode.firstChild;this.HighlightElement(g);this.CheckOpenSubMenu()}else{if(d==0){if(f.indexOf("MenuEntry")!=-1){OpenedMenu.CheckClick()}}else{if(d==2){if(g.tagName!="DIV"&&(f!="MenuScrollDown"||f!="MenuScrollUp")){return}var b=(f=="MenuScrollUp")?1:-1;OpenedMenu.EnsureTopElement(this.mSerial);this.Scroll(b)}else{if(d==3){if(g.tagName!="DIV"&&(f!="MenuScrollDown"||f!="MenuScrollUp")){return}OpenedMenu.EnsureTopElement(this.mSerial);this.EndScroll()}else{}}}}return};Menu.prototype.constructor=Menu;function Menu(b,d){if(arguments.length){this.init(b,d)}}Menu.prototype.init=function(b,d){this.windowID=b;this.mMenuDef=d;this.mElements=[];this.mElementStack=[];this.mSerialCnt=0;this.mZIndex=30100;this.mField=DummyField;this.mIFrameStack=[];this.mXAdjust=0;this.mYAdjust=0;this.mAnimate=true};Menu.prototype.ElementAtTop=function(b){return(this.mElementStack[this.mElementStack.length-1].mSerial==b)};Menu.prototype.openBoxMenu=function(o,f){var b=getLocalizedMessage("(no entries in menu)");var v=getLocalizedMessage("(clear)");var g={addClear:f,menuMsgs:gMenuMessages,menuMsgArgs:gMenuMsgArgs,menu:this,noent:b,clr:v};var u="";if(this.mField){if(this.mField!=DummyField&&(typeof this.mField.GLabelOrName!="undefined")){var h=this.mField.GLabelOrName();u=(h==null)?(this.mName?this.mName:""):h}else{if(this.mName){u=this.mName}}}var d=this.windowID;var s=this.mField;var k={};return{n:{f:function(){if(k.result.retval){if(OpenedMenu==null){OpenedMenu=this}return{n:{f:function(){OpenedMenu=null},a:[OpenedMenu]},c:{f:OpenedMenu.HandleSelection,t:OpenedMenu,a:[k.result.retval+""]}}}else{return{n:{f:function(){OpenedMenu=null},a:[OpenedMenu]}}}},a:[k],t:this},c:{f:function(){return MenuBoxPopup(d,o,u,g,k)}}}};Menu.prototype.OpenPopup=function(f,d,g,b){this.RecurBuild(this.mMenuDef);if(typeof g=="number"){this.mZIndex=g}this.mSerialCnt=0;OpenedMenu=this;OpenedMenu.OpenLevel(0,f,d,0,0,b)};Menu.prototype.OpenListBox=function(f,d,g,b){return{n:{f:this.openBoxPopup,t:this,a:[f,d,g,b]}}};Menu.prototype.Open=function(g,f,k,d){var b=1;var h=this.useMenuTypePref();var o=this.getMenuPrefType();if(h&&o!=0){if(o==3){b=this.evalSmartMenu()}else{b=o}}if(b!=1){b=this.checkIfDummyMenu(b)}if(b==1){return{n:{f:this.OpenPopup,t:this,a:[g,f,k,d]}}}else{return{n:{f:this.OpenListBox,t:this,a:[g,f,k,d]}}}};function Menu_Close(){if(OpenedMenu!=null){OpenedMenu.Close()}OpenedMenu=null}function Menu_SortLevel(b){b.sort(function(f,d){return f.l.localeCompare(d.l)})}Menu.prototype.Close=function(){for(var b=this.mElementStack.length-1;b>=0;--b){this.mElementStack[b].Close()}};Menu.prototype.checkIfDummyMenu=function(b){if(this.mMenuDef!=null&&this.mMenuDef.length==1){if(this.mMenuDef[0].l==getLocalizedMessage("Loading...")){return 1}}return b};Menu.prototype.removeElements=function(){if(this.mElementStack.length!=0){return}else{for(var b in this.mElements){if(this.mElements[b].mElement!=null){document.body.removeChild(this.mElements[b].mElement)}}this.mElements=[]}};Menu.prototype.EnsureTopElement=function(b){var d=this.mElementStack;while(d[d.length-1].mSerial!=b){d[d.length-1].Close()}};Menu.prototype.CheckClick=function(){var d=this.mElementStack;var b=d[d.length-1].CheckClick();if(typeof CharFieldMenu!="undefined"&&this instanceof CharFieldMenu&&this.mQueryReturnedNoValues&&b.length!=0){Menu_Close();return}if(b!=null&&b!=getLocalizedMessage("Loading...")){Menu_Close();this.HandleSelection(b)}};Menu.prototype.OpenLevel=function(g,h,d,k,f,b){this.mElements[g].Open(h,d,k,f,this.mZIndex,(g==0?{x:this.mXAdjust,y:this.mYAdjust}:null),b)};Menu.prototype.CloseLevel=function(){this.mElementStack[this.mElementStack.length-1].Close()};Menu.prototype.RecurBuild=function(h,d){var k=this.mSerialCnt++,g={};for(var b in h){var f=h[b];if(typeof f.v!="string"){g[b]=this.mSerialCnt;var o=(d?d:f.cId);this.RecurBuild(f.v,o)}}this.mElements[k]=new MenuElement(this.windowID,k,h,g,this.doEncode(),d)};Menu.prototype.doEncode=function(){var b=this.mField.mID;return(b==112||b==104||(b>=2000&&b<=2199))};Menu.prototype.contains=function(g,f){if(f&&f.length>0){for(var b in f){var d=f[b];if((g==d.l)||(d.v instanceof Array&&this.contains(g,d.v))){return true}}}return false};Menu.prototype.getMenuPrefType=function(){return ARPrefsGetAsNumber(20105)};Menu.prototype.useMenuTypePref=function(){if(typeof CharFieldMenu!="undefined"&&this instanceof CharFieldMenu){return true}else{return false}};Menu.prototype.walkMenuDef=function(g,f){for(var d in g){if(g[d].v instanceof Array){f.levels++;if(f.levels>=f.maxLevels){return 2}else{var b=this.walkMenuDef(g[d].v,f);if(b==2){return b}else{if(f.items>=f.maxItems){return 2}f.levels=0}}}else{f.items++;if(f.items>=f.maxItems){return 2}}}return 1};Menu.prototype.evalSmartMenu=function(){var f=ARPrefsGetAsNumber(23240);if(isNaN(f)||f==null||f<=0){f=200}var b=ARPrefsGetAsNumber(23241);if(isNaN(b)||b==null||b<=0){b=4}if(this.mMenuDef.length>=f){return 2}var d={items:0,levels:0,maxItems:f,maxLevels:b};return this.walkMenuDef(this.mMenuDef,d)};Menu.prototype.openBoxPopup=function(f,d,g,b){OpenedMenu=this;return{n:{f:this.openBoxMenu,a:[f,b],t:this}}};CharFieldMenu.prototype=new Menu();CharFieldMenu.prototype.constructor=CharFieldMenu;CharFieldMenu.superclass=Menu.prototype;function CharFieldMenu(d,b){if(arguments.length){this.init(d,b)}}CharFieldMenu.prototype.init=function(d,b){CharFieldMenu.superclass.init.call(this,d,b.mval);this.mField=null;this.mQueryReturnedNoValues=b.novals};CharFieldMenu.prototype.Open=function(f,d,b){this.mField=f;return{n:{f:CharFieldMenu.superclass.Open,t:this,a:[d,3,30100,b]}}};CharFieldMenu.prototype.HandleSelection=function(b){this.mField.HandleMenuSelection(b);promptBar.setToClear();if("mColid" in this.mField){if(getCurWFC_NS(this.windowID)!=null){return{n:{f:ExecuteWorkflow,a:[this.windowID,128,this.mField.mColid]}}}else{new WorkflowContext(this.windowID,{f:ExecuteWorkflow,a:[this.windowID,128,this.mField.mColid]})}}else{if(getCurWFC_NS(this.windowID)!=null){return{n:{f:ExecuteWorkflow,a:[this.windowID,128,this.mField.mID]}}}else{new WorkflowContext(this.windowID,{f:ExecuteWorkflow,a:[this.windowID,128,this.mField.mID]})}}this.mField=null};function ARMenu(d,f,b){this.mMenuName=f;this.mMenuData=("novals" in b)?b.mval:b;this.mCharFieldMenu=null;if(this.mMenuData!=null&&this.mMenuData instanceof Object&&"novals" in b){this.mCharFieldMenu=new CharFieldMenu(d,b)}getARMenuCache_NS(d)[this.mMenuName]=this;this.cfid=null;this.FieldMap={}}ARMenu.prototype.addField=function(b){this.FieldMap[b]=new ACMenu()};ARMenu.prototype.getAttribute=function(b,d){return this.FieldMap[b][d]};ARMenu.prototype.setAttribute=function(b,f,d){return this.FieldMap[b][f]=d};ARMenu.prototype.isACReloadable=function(){this.updateState();return this.getAttribute(this.cfid,"state")==1&&this.getAttribute(this.cfid,"typeState")==1||this.mMenuData.r!=2||this.getAttribute(this.cfid,"arautocak")==0||this.mMenuData.t!=4||this.getAttribute(this.cfid,"arautocnc")=="err"||this.isRecovering()};ARMenu.prototype.isValidSearchMenu=function(){return this.mMenuData.r==2&&this.getAttribute(this.cfid,"arautocak")>0&&this.mMenuData.t==4&&this.getAttribute(this.cfid,"arautocnc")!="err"};ARMenu.prototype.checkPause=function(b){if(this.getAttribute(this.cfid,"lastKeystrokeMs")-b<1000){this.setAttribute(this.cfid,"typeState",2)}else{this.setAttribute(this.cfid,"typeState",1)}this.setAttribute(this.cfid,"lastKeystrokeMs",b)};ARMenu.prototype.setState=function(b){if(this.getAttribute(this.cfid,"state")==3){return}this.setAttribute(this.cfid,"state",b)};ARMenu.prototype.updateState=function(f){if(this.getAttribute(this.cfid,"state")==3){return}if(f){this.setState(f);return}if(!this.getAttribute(this.cfid,"acField")){return}if(!this.getAttribute(this.cfid,"acField").mInputNode.value){this.setState(0);this.setAttribute(this.cfid,"fText","");return}var b=this.getAttribute(this.cfid,"acField").mInputNode.value.length;if(this.getAttribute(this.cfid,"direction")==-1){if(b<this.getAttribute(this.cfid,"fText").length){this.setAttribute(this.cfid,"fText","")}}if(b==0){this.setState(0)}else{var d=this.isFull();if(this.getAttribute(this.cfid,"tItems")==0){if(this.getAttribute(this.cfid,"direction")==1){if(d&&b>this.getAttribute(this.cfid,"foundPosition")){this.setState(2)}else{this.setState(1)}}else{if(d&&b>this.getAttribute(this.cfid,"foundPosition")){this.setState(2)}else{this.setState(1)}}}else{if(!d){this.setState(1)}}}switch(this.getAttribute(this.cfid,"state")){case 0:if(b>=this.getAttribute(this.cfid,"arautocak")){this.setState(1)}break;case 1:if(b<this.getAttribute(this.cfid,"arautocak")){this.setState(0)}break;case 2:if(b<this.getAttribute(this.cfid,"arautocak")){this.setState(0)}break;default:break}};ARMenu.getMenu=function(b,d){return getARMenuCache_NS(b)[d]};function getMenuDataFromRequest(windowID,menu_name,definfo,rmserver,filter){var menu=getARMenuCache_NS(windowID)[menu_name];if(menu==null){handleMenuAbsent(menu_name);return{novals:false,mval:[],tItems:-1}}if(menu.cfid){if(!menu.isACReloadable()&&filter!=null){menu.setAttribute(menu.cfid,"requestLoad",false);return{novals:false,mval:[],tItems:-1}}if(menu.isRecovering()&&filter==""&&menu.isValidSearchMenu()){menu.setAttribute(menu.cfid,"requestLoad",false);return{novals:false,mval:[],tItems:-1}}menu.setAttribute(menu.cfid,"requestLoad",true)}var rs=ARKWGetStringByIdx(windowID,7),rf=ARKWGetStringByIdx(windowID,6),q={qual:"",fieldids:[],fieldvals:[],fieldtypes:[]};var fieldids=[],fieldvals=[],fieldtypes=[],keyids=[],keyvals=[],keytypes=[];if(rmserver){rs=ExpandServerName(windowID,rmserver)}else{if("s" in definfo){rs=ExpandServerName(windowID,definfo.s)}}if("f" in definfo){rf=ExpandSchemaName(windowID,definfo.f)}if("q" in definfo){eval("q="+definfo.q);q=ExpandQualifier(windowID,q,rf,rs)}if("ids" in definfo){fieldids=definfo.ids;FieldList.PopulateValueAndTypeArrays(windowID,fieldids,fieldvals,fieldtypes)}if("kwds" in definfo){keyids=definfo.kwds;FieldList.PopulateValueAndTypeArrays(windowID,definfo.kwds,keyvals,keytypes)}var server=((rmserver)?rmserver:ARKWGetStringByIdx(windowID,7));filter=filter||"";var arautocmbField;var arautoc;if(menu.cfid&&menu.getAttribute(menu.cfid,"acField")){arautocmbField=menu.getAttribute(menu.cfid,"acField").mInputNode.getAttribute("arautocmb");arautoc=menu.getAttribute(menu.cfid,"acField").mInputNode.getAttribute("arautoc")}else{arautocmbField="0";arautoc="0"}var arautocmb=arautocmbField==null?"":arautocmbField;var req=new NDXExpandMenu(windowID,menu_name,server,ARKWGetStringByIdx(windowID,6),rs,rf,q.qual,filter,arautoc,arautocmb,q.fieldids,q.fieldvals,q.fieldtypes,fieldids,fieldvals,fieldtypes,keyids,keyvals,keytypes);var res=req.result;return res}function getMenuData(d,g,b,k,f){if("armfid" in b){var h=new MenuParser(d,b);return h.getMenuDef()}return getMenuDataFromRequest(d,g,b,k,f)}function ARMenu_Get(g,s,b,d){var k=getARMenuCache_NS(g);var h=((b)?b:ARKWGetStringByIdx(g,7));if(!(s in k)){k[s]=null;new NDXGetMenuDefinition(g,s,h,getFormContext(g).formName)}if(k[s]==null){handleMenuAbsent(s);return}var v=!(s in k);var u=v?null:k[s].mCharFieldMenu;if(u==null){var o=k[s].mMenuData;var f=getARMenuCache_NS(g)[s];var y=f.acPreloadData;if(y!=null){f.acPreloadData=null;return y}res=getMenuData(g,s,o,b,d);if(f.cfid){f.setAttribute(f.cfid,"tItems",parseInt(res.tItems))}else{}u=new CharFieldMenu(g,res);try{if(f.cfid!=null&&f.getAttribute(f.cfid,"arautocak")==0&&d==""&&(FormEvent.lastMouseDownEvent!=null&&FormEvent.lastMouseDownEvent.element!=null&&FormEvent.lastMouseDownEvent.element.nodeName!="TEXTAREA")){f.acPreloadData=u}}catch(w){}if("q" in o){ARKWSetLASTCOUNT(g,u.mQueryReturnedNoValues?0:res.mval.length)}if("r" in o&&o.r==1){f.mCharFieldMenu=u}}else{var f=ARMenu.getMenu(g,s);if(f==null){handleMenuAbsent(s);return}if(f.cfid){f.setState(3)}}return u}function isNoEntryMenu(b){if(b.mMenuDef.length==1){var f=b.mMenuDef[0].l.ValidatorUnEscape();var d=getLocalizedMessage("(no entries in menu)");if(f==d){return true}}return false}function getNoEntryMenu(b){var f={};f.novals=true;var d=getLocalizedMessage("(no entries in menu)");f.mval=new Array();f.mval[0]={l:d,v:null};return new CharFieldMenu(b,f)}function ACMenu(){this.state=0;this.src=null;this.acField=null;this.arautocak=1;this.lastKeystrokeMs=0;this.typeState=0;this.timer=null;this.dataCompleted=false;this.fText="";this.foundPosition=-1;this.preLen=0;this.direction=1;this.tItems=-1;this.isLoadByMenu=false}ARMenu.prototype.isRecovering=function(){var b=false;if(this.getAttribute(this.cfid,"acField")&&this.getAttribute(this.cfid,"acField").acdirtyfocus){b=this.getAttribute(this.cfid,"acField").acdirtyfocus}return(this.getAttribute(this.cfid,"state")>=1&&this.getAttribute(this.cfid,"ac_kw_len")==-1)&&b};ARMenu.prototype.reload=function(){var d=0;if(this.mMenuName==undefined||!this.isACReloadable()){return}var o=this.mMenuName;this.setAttribute(this.cfid,"tItems",-1);this.mCharFieldMenu=null;var s=this.getAttribute(this.cfid,"acField").mInputNode.getAttribute("arautocmb");var g=(s!=null)&&(s=="1");var h=this.getAttribute(this.cfid,"acField").mInputNode.getAttribute("arautoc");var f;if(this.isRecovering()){if(this.getAttribute(this.cfid,"state")==1){f=this.getAttribute(this.cfid,"acField").mInputNode.value}else{if(this.getAttribute(this.cfid,"state")==2){f=this.getAttribute(this.cfid,"fText")}else{if(this.getAttribute(this.cfid,"state")==3){if(this.getAttribute(this.cfid,"isLoadByMenu")){if(this.acField.isSearchOnly()){if(getARStateCurrent_NS(this.windowID)==4){ARMenu_Open(this.getAttribute(this.cfid,"acField"),this.getAttribute(this.cfid,"acField").GMenu(),this.getAttribute(this.cfid,"acField").mInputNode,this.getAttribute(this.cfid,"acField").isSearchOnly());return}else{ARMenu_Open(this.getAttribute(this.cfid,"acField"),this.getAttribute(this.cfid,"acField").GMenu(),this.getAttribute(this.cfid,"acField").mInputNode,false);return}}else{ARMenu_Open(this.getAttribute(this.cfid,"acField"),this.getAttribute(this.cfid,"acField").GMenu(),this.getAttribute(this.cfid,"acField").mInputNode,this.getAttribute(this.cfid,"acField").isDropDown());return}}else{f=""}}}}}else{f=this.getAttribute(this.cfid,"acField").mInputNode.value}var b=listOfMenuLeafValuesForField(this.getAttribute(this.cfid,"acField"),g,f);if(this.getAttribute(this.cfid,"acField").mAutoCompleteCreated){this.getAttribute(this.cfid,"acField").mInputNode.actb_autoCompleted=false;if(b!=null){actb_values=(b.acValues!=null)?b.acValues:new Array();actb_keywords=(b.acLabels!=null)?b.acLabels:b.acValues;actb_lengths=(b.acLabelLengths!=null)?b.acLabelLengths:new Array();this.setAttribute(this.cfid,"ac_kw_len",actb_keywords.length)}var k=this.getAttribute(this.cfid,"acField")}if(this.getAttribute(this.cfid,"acType")==0){this.updateState(2)}};ARMenu.prototype.isFull=function(){return this.getAttribute(this.cfid,"state")==3||this.getAttribute(this.cfid,"fText")!=""&&this.getAttribute(this.cfid,"acField").mInputNode.value.indexOf(this.getAttribute(this.cfid,"fText"))==0};ARMenu.prototype.reInit=function(){window.acField=this.getAttribute(this.cfid,"acField")};function handleMenuAbsent(b){window.status=getLocalizedMessage("Menu "+b+" is invalid.")}function ARMenu_Open(u,h,o,v){var f=u.windowID;var k;if(h!=""){var d=getARMenuCache_NS(f)[h];if(d==null){new NDXGetMenuDefinition(u.windowID,h,ARKWGetStringByIdx(u.windowID,7),getFormContext(u.windowID).formName);d=getARMenuCache_NS(f)[h];d.cfid=u.mID;d.addField(u.mID)}if(d==null){handleMenuAbsent(h);return}if(!d.cfid){d.cfid=u.mID;d.addField(u.mID)}k=ARMenu_Get(f,h);d.setState(3);d.getAttribute(d.cfid,"isLoadByMenu",true);d.setAttribute(d.cfid,"arautocak",parseInt(u.mInputNode.getAttribute("arautocak")));var g;var b;if(d.getAttribute(d.cfid,"acField")){b=d.getAttribute(d.cfid,"acField").mInputNode.getAttribute("arautoc");g=d.getAttribute(d.cfid,"acField").mInputNode.getAttribute("arautocmb")}else{b="0";g="0"}var w=(g!=null)&&(g=="1");var s=new Object();s.acLabelLengths=new Array();s.acLabels=new Array();s.acValues=new Array();appendMenuLeafPathElements(k.mMenuDef,"",s,w);if(s!=null){actb_values=(s.acValues!=null)?s.acValues:new Array();actb_keywords=(s.acLabels!=null)?s.acLabels:s.acValues;actb_lengths=(s.acLabelLengths!=null)?s.acLabelLengths:new Array();d.getAttribute(d.cfid,"ac_kw_len",actb_keywords.length)}}else{k=getNoEntryMenu(f)}if(k){if(k.mMenuDef.length>0){if(isNoEntryMenu(k)){v=false}return{n:{f:k.Open,t:k,a:[u,o,v]}}}else{window.status=getLocalizedMessage("No Menu Items to Display",null,"Menu Open")}}else{window.status=getLocalizedMessage("No Menu to Display",null,"Menu Open")}}SimpleMenu.prototype=new Menu();SimpleMenu.prototype.constructor=SimpleMenu;SimpleMenu.superclass=Menu.prototype;var DummyField=null;function SimpleMenu(b,f,d){if(arguments.length){this.init(b,f,d)}}SimpleMenu.prototype.init=function(b,f,d){SimpleMenu.superclass.init.call(this,b,d);this.mField=f;this.mName="Popup Menu"};SimpleMenu.prototype.Open=function(b){if(getCurWFC_NS(this.windowID)==null){SimpleMenu.superclass.Open.call(this,b,3,nextZIndex++,false)}else{return{n:{f:SimpleMenu.superclass.Open,t:this,a:[b,3,nextZIndex++,false]}}}};SimpleMenu.prototype.HandleSelection=function(b){this.mField.value=b;this.mField.focus()};MenuParser.prototype.constructor=MenuParser;function MenuParser(g,d){this.windowID=g;this.menuDef=null;this.MLABELVALUEDELIM="\\";this.MSUBDELIM="\t";this.MCOMMENT="#";this.retARerr=0;this.maxLevel=0;var k=d.armfid;var b=null;var h=getFields_NS(g)[k];if(h!=null){if("GetScreenValAsPrimitive" in h){b=h.GetScreenValAsPrimitive()}else{b=h.G();b=b.toString()}}if(b==null||b.length==0){this.menuStr=null}else{this.menuStr=b;this.parseMenuData()}}MenuParser.prototype.subLevels=function(f){var h=f;var g=0;var d=true;var b=0;while(d){b=h.indexOf(this.MSUBDELIM,b);if(b==-1){d=false}else{b++;g++}}return g};MenuParser.prototype.menuTrim=function(d){var f=d;f=f.replace(/^[ ]+/,"");for(var b=f.length-1;b>=0;b--){if(f.charAt(b)==" "){f=f.substring(0,b)}else{break}}return f};MenuParser.prototype.parseMenuData=function(){this.maxLevel=0;var f=this.menuStr;f=f.replace(/\r\n/g,"\n");var s=f.split("\n");var h=new Array();var k=0;var u=0;for(var g=0;g<s.length;g++){if(s[g].length==0){continue}if(s[g].indexOf(this.MCOMMENT)==0){continue}var o=s[g].indexOf(this.MLABELVALUEDELIM);var d=new Array();if(o>=0){d[0]=s[g].substring(0,o);d[0]=this.menuTrim(d[0]);d[1]=(o+1==s[g].length)?"":s[g].substring(o+1);d[1]=this.menuTrim(d[1]);if(d[1].length<=0){d[1]=undefined}}else{d[0]=this.menuTrim(s[g])}var b=this.subLevels(d[0]);d[0]=d[0].trim(1);if(d[0].length<=0){continue}if(g==0&&b>0){this.retARerr=130;return}if(b>0&&b==u+1){u=b}else{if(b>0&&b<u){u=b}else{if(b==0){u=0}else{if(b==u){}else{continue}}}}if(u>15){this.retARerr=321;return}if(u>this.maxLevel){this.maxLevel=u}var v=new Object();v.level=u;v.l=d[0];v.v=(d.length>1)?d[1]:d[0];h[k++]=v}this.maxLevel++;if(h.length>0){this.menuDef=h}else{this.menuStr=null}};MenuParser.prototype.getMenuStruct=function(){var s=new Array(this.maxLevel);for(var h=0;h<this.maxLevel;h++){s[h]=-1}var g=new Array(this.maxLevel);for(var f=0;f<this.maxLevel;f++){g[f]=null}var u=new Object();var v=new Array();u.novals=false;u.mval=v;g[0]=u.mval;var d=0;for(var k=0;k<this.menuDef.length;k++){var o=this.menuDef[k].level;var w=new Object();if(o>d){w.l=this.menuDef[k].l;w.v=this.menuDef[k].v;var b=o-1;s[o]++;g[o]=new Array();g[b][s[b]].v=g[o];g[b][s[b]].v[s[o]]=w;d=o}else{if(d>0&&o==d){w.l=this.menuDef[k].l;w.v=this.menuDef[k].v;var b=o-1;s[o]++;g[b][s[b]].v[s[o]]=w}else{s[o]++;w.l=this.menuDef[k].l;w.v=this.menuDef[k].v;g[o][s[o]]=w;if(o<d){for(var y=d;y>o;y--){s[y]=-1}}d=o}}}return u};MenuParser.prototype.genNoEntryMenu=function(){var d=new Object();d.novals=true;var b=getLocalizedMessage("(no entries in menu)");d.mval=new Array();d.mval[0]={l:b,v:null};return d};MenuParser.prototype.getMenuRes=function(){if(this.menuStr==null){return this.genNoEntryMenu()}else{if(this.retARerr!=0){var b="error "+this.retARerr;switch(this.retArerr){case 130:b=getLocalizedMessage("Error with an entry in the character menu");break;case 383:b=getLocalizedMessage("File menu contains too many items on one level (maximum 1000)");break}if(getCurWFC_NS(this.windowID)!=null){getCurWFC_NS(this.windowID).status([{cId:0,t:2,m:b,n:this.retArerr,a:null}])}if(getCurWFC_NS(this.windowID)!=null){getCurWFC_NS(this.windowID).status([])}}else{return this.getMenuStruct()}}};MenuParser.prototype.getMenuDef=function(){return this.getMenuRes()};function StatusHistoryPopup(b,d){var f=getLocalizedMessage("Status History -- {0} #{1}",[ARKWGetStringByIdx(b,6),F(b,1).G().toString()]);return weOpenModalPopup(b,(AbsContextPath+"resources/html/StatusHistoryPopup.html"),"StatusHistory",{title:f,history:d,appss:GetAppStyleSheet("../../"),AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},{},[512,200])}JMenuItem.prototype=new Field();JMenuItem.prototype.constructor=JMenuItem;JMenuItem.superclass=Field.prototype;function JMenuItem(g,f,d){if(arguments.length){this.init(g,f,d)}}JMenuItem.prototype.init=function(h,g,f){JMenuItem.superclass.init.call(this,h,g,f);this.SVis((this.mObj.v==1)?true:false);this.SAccess(this.mObj.s);var k="artbl"+this.mObj.pnt;if(typeof getARMenus_NS(h)[k]=="undefined"){getARMenus_NS(h)[k]=[]}var d=getARMenus_NS(h)[k];if(typeof d[this.mObj.mp]=="undefined"){d[this.mObj.mp]=[]}d[this.mObj.mp][this.mObj.p]=this.mID};JMenuItem.prototype.UpdateLabel=function(b){this.mObj.lbl=b};JMenuItem.prototype.UpdateMenu=function(b){if(b==null||b=="$NULL$"){this.mCFCache.m=null}};JMenuItem.prototype.DoSet=function(b){this.mObj.v=new CharType(b)};JMenuItem.prototype.G=function(b){return this.mObj.v};DControl.prototype=new Field();DControl.prototype.constructor=DControl;DControl.superclass=Field.prototype;JControl.prototype=new Field();JControl.prototype.constructor=JControl;JControl.superclass=Field.prototype;TPAControl.prototype=new Field();TPAControl.prototype.constructor=TPAControl;TPAControl.superclass=Field.prototype;DOMFieldFactories.Control=function(b,f,d){return new DControl(b,f,d)};function DControl(g,f,d){if(arguments.length){this.init(g,f,d)}}DControl.prototype.mDOMField=DControl.prototype.mHaveVisualCharacteristics=true;DControl.prototype.init=function(g,f,d){DControl.superclass.init.call(this,g,f,d);if(this.mObj.firstChild){for(var h=this.mObj.firstChild;h;h=h.nextSibling){if(h.nodeType==1&&h.className.indexOf("btntextdiv")!=-1){this.mTextElement=h.firstChild;if(this.mObj.className.indexOf("btnflt")!=-1){h.firstChild.style.marginTop="-6px"}if(this.mObj.className.indexOf("btnurl")!=-1){h.firstChild.style.textDecoration="underline"}return}}}};var FormActionButtonFlags={1001:{c:(1<<4)|(1<<2)|(1<<5)|(1<<3)|(1<<6),f:FormAction_Submit},1002:{c:(1<<1)|(1<<2)|(1<<5)|(1<<3)|(1<<6),f:FormAction_Query},1003:{c:(1<<1)|(1<<4)|(1<<2)|(1<<3),f:FormAction_Modify},1006:{c:(1<<5)|(1<<3)|(1<<6),f:FormAction_Clear},1007:{c:(1<<5)|(1<<2)|(1<<3)|(1<<6),f:FormAction_SetToDefaults},1008:{c:0,f:FormAction_ShowHelp},1009:{c:(1<<2),f:FormAction_NewSearch},1010:{c:(1<<2),f:FormAction_NewRequest},1011:{c:(1<<1)|(1<<4)|(1<<2)|(1<<6),f:FormAction_ShowStatusHistory},1012:{c:0,f:FormAction_OpenHomePage},1004:{c:(1<<1)|(1<<4)|(1<<2)|(1<<3),f:FormAction_ModifyAll},1013:{c:0,f:FormAction_SavedSearches},1014:{c:0,f:FormAction_QuickReports}};var ApplyButtonIDs={1:1001,5:1003,6:1003};DControl.prototype.Clear=function(){};DControl.prototype.MouseSelectable=false;DControl.prototype.UpdateAccess=function(f,d){if(this.mID in FormActionButtonFlags&&!d&&(FormActionButtonFlags[this.mID].c&(1<<getARStateCurrent_NS(this.windowID)))){return}if(d){this.mCFCache.a=f}var b=(f==3);if(f==1){if((typeof this.mID!="undefined")&&(typeof getDefaults_NS(this.windowID)[this.mID]!="undefined")&&(typeof getDefaults_NS(this.windowID)[this.mID].a!="undefined")){b=(getDefaults_NS(this.windowID)[this.mID].a==3)}}FakeButton_SetDisable(this.mObj,b)};DControl.prototype.GetFocusElement=function(){return this.mObj};DControl.prototype.GetFocusElementForEvent=function(b){if(this.GetNestedFocusability()){return this.mObj}return null};DControl.prototype.ResizeTo=function(d,b){};DControl.prototype.mHaveStoredData=false;DControl.prototype.GetLastElement=function(){return this.mObj};function DControl_DirtyFlagChanged(b,d){var f=ApplyButtonIDs[getARStateCurrent_NS(b)];if(f){F(b,f).UpdateAccess(d?2:3,true)}if("Toolbar_DirtyFlagChanged" in window){Toolbar_DirtyFlagChanged(b,d)}}JFieldFactories.Control=function(b,f,d){return new JControl(b,f,d)};function JControl(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAFieldFactories.Control=function(b,f,d){return new TPAControl(b,f,d)};function TPAControl(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAControl.prototype.DOMMouseOver=JControl.prototype.DOMMouseOver=DControl.prototype.DOMMouseOver=function(b){return hoverState.eventMouseOver(b)};TPAControl.prototype.DOMMouseMove=JControl.prototype.DOMMouseMove=DControl.prototype.DOMMouseMove=function(b){return hoverState.eventMouseMove(b)};TPAControl.prototype.DOMMouseOut=JControl.prototype.DOMMouseOut=DControl.prototype.DOMMouseOut=function(b){return hoverState.eventMouseOut(b)};DControl.prototype.DOMClick=function(d){hoverState.clearTracking();if(this.GAccess()==3){return}var b=[];if(this.mID in FormActionButtonFlags){b.push({f:FormActionButtonFlags[this.mID].f,a:[this.windowID]})}var f=this.windowID;b.push({f:function(){hoverState.btnClickE()}});b.push({f:ExecuteWorkflow,a:[f,1,this.mID]});b.push({f:function(){hoverState.btnClickS(d)}});if(this.mID in FormActionButtonFlags){return getCurWFC_NS(this.windowID).executeAll(b)}else{return{n:b}}};TPAControl.prototype.DOMClick=function(d,g){hoverState.clearTracking();if(this.GAccess()==3){return}var b=[];if(g in FormActionButtonFlags){b.push({f:FormActionButtonFlags[g].f,a:[this.windowID]})}var f=this.windowID;b.push({f:function(){hoverState.btnClickE()}});b.push({f:ExecuteWorkflow,a:[this.windowID,1,g]});b.push({f:function(){hoverState.btnClickS(d)}});if(g in FormActionButtonFlags){return getCurWFC_NS(this.windowID).executeAll(b)}else{return{n:b}}};function DControl_UpdateFormActionButtons(b){if(typeof rtfEditor!="undefined"&&rtfEditor&&rtfEditor.IsVisible()){rtfEditor.Close(false)}var f=0;for(var h in FormActionButtonFlags){if(h in getFields_NS(b)){f=(1<<getARStateCurrent_NS(b));var d=((FormActionButtonFlags[h].c&(f))==0);if(h==1011&&!getFields_NS(b)[15]){d=false}else{if(h==1003&&getFields_NS(b)[h].mObj.className.indexOf("btnd")!=-1){d=false}}getFields_NS(b)[h].UpdateAccess(d?2:3,true)}}var g=true;if((getFields_NS(b)[1003])&&(f==32)&&(getFields_NS(b)[1003].mObj.className.indexOf("btnd")==-1)){d=true;getFields_NS(b)[1003].UpdateAccess(d?2:3,true);g=false}else{if((getFields_NS(b)[1001])&&(f==2)){d=true;getFields_NS(b)[1001].UpdateAccess(d?2:3,true)}}if("Toolbar_UpdateFormActionButtons" in window){Toolbar_UpdateFormActionButtons(b)}if(g){DControl_DirtyFlagChanged(b,getFieldChanged_NS(b))}}DNavBarItem.prototype=new Field();DNavBarItem.prototype.constructor=DNavBarItem;DNavBarItem.superclass=Field.prototype;var NavItemFactories={};DOMFieldFactories.NavBarItem=function(b,f,d){return new DNavBarItem(b,f,d)};function DNavBarItem(g,f,d){if(arguments.length){this.init(g,f,d)}}DNavBarItem.prototype.mDOMField=DNavBarItem.prototype.mHaveVisualCharacteristics=true;DNavBarItem.prototype.Clear=function(){};DNavBarItem.prototype.MouseSelectable=false;DNavBarItem.prototype.mHaveStoredData=false;DNavBarItem.prototype.mContainFields=true;DNavBarItem.prototype.init=function(g,f,d){DNavBarItem.superclass.init.call(this,g,f,d);this.mNavMode=this.mObj.getAttribute("navmode");if(!this.mNavMode){this.mNavMode=0}this.mViewTypeObj=NavItemFactories[this.mNavMode](this);this.mViewTypeObj.getStyleFromChildOf=function(o,k){if(o){var u=null;var s=null;var h=o.getElementsByTagName("span");for(var b=0;b<h.length;b++){s=h[b];u=(document.defaultView.getComputedStyle(s,null).getPropertyValue(k));if(u){return colorValue(u)}}}return null}};DNavBarItem.prototype.DOMClick=function(b){return this.mViewTypeObj.DOMClick(b)};DNavBarItem.prototype.SetSelected=function(){this.mViewTypeObj.SetSelected()};DNavBarItem.prototype.setStyle=function(b){this.mViewTypeObj.setStyle(b)};DNavBarItem.prototype.Reset=function(b){this.mViewTypeObj.Reset(b)};DNavBarItem.prototype.MakeItemVisible=function(){this.mViewTypeObj.MakeItemVisible()};DNavBarItem.prototype.DOMMouseOver=function(b){this.mViewTypeObj.DOMMouseOver(b)};DNavBarItem.prototype.DOMMouseMove=function(b){this.mViewTypeObj.DOMMouseMove(b)};DNavBarItem.prototype.DOMMouseOut=function(b){this.mViewTypeObj.DOMMouseOut(b)};DNavBarItem.prototype.UpdateVis=function(b){this.mViewTypeObj.UpdateVis(b)};DNavBarItem.prototype.UpdateAccess=function(b){this.mViewTypeObj.UpdateAccess(b)};DNavBarItem.prototype.GetFocusElement=function(){return this.mViewTypeObj.GetFocusElement()};DNavBarItem.prototype.GetFocusElementForEvent=function(b){return this.mViewTypeObj.GetFocusElementForEvent(b)};DNavBarItem.prototype.TabableElementSelector=function(b){return this.mViewTypeObj.TabableElementSelector(b)};DNavBarItem.prototype.GetNestedFocusability=function(){if(this.GAccess()==3||this.mObj.getAttribute("separator")==1){return false}if(typeof this.mID=="number"){return DNavBarItem.superclass.GetNestedFocusability.call(this)}return null};function getGradientImage(d,b){var f=document.createElement("IMG");d.appendChild(f);f.className="GrImg";f.alt="";f.src=b}DNavBarItem.prototype.GColour=function(){return this.mViewTypeObj.GColour()};DNavBarItem.prototype.UpdateColour=function(b){this.mViewTypeObj.UpdateColour(b);if(this.mNavMode==1&&b){DNavBarItem.superclass.UpdateColour.call(this,b)}};DNavBarItem.prototype.UpdateLabel=function(b){this.mViewTypeObj.UpdateLabel(b);DNavBarItem.superclass.UpdateLabel.call(this,b)};DNavBarItem.prototype.UpdateFont=function(b){this.mViewTypeObj.UpdateFont(b);DNavBarItem.superclass.UpdateFont.call(this,b)};DNavBarItem.prototype.SetStatus=function(b){this.mViewTypeObj.SetStatus(b)};TradNavItem.prototype.constructor=TradNavItem;NavItemFactories["0"]=function(b){return new TradNavItem(b)};function TradNavItem(b){if(arguments.length){this.init(b)}}TradNavItem.prototype.mDOMField=TradNavItem.prototype.mHaveVisualCharacteristics=true;TradNavItem.prototype.init=function(k){this.mParentObj=k;this.mObj=k.mObj;this.mID=k.mID;this.mStatus=this.mObj.getAttribute("status");var f=this.mObj.parentNode;var h=this.mObj;if(h.className.indexOf("VNavLevel1")!=-1){if(h.getAttribute("gcolor")!=null&&h.getAttribute("color")!=null&&h.getAttribute("gtype")!=null){var g=h.getAttribute("gcolor");var o=h.getAttribute("color");var b=h.getAttribute("gtype");var d=RelContextPath+"bmc_border.gif?c="+o+"&g="+g+"&t="+b;getGradientImage(h,d)}}while(f!=null&&(f.tagName=="DIV"||f.tagName=="DL")){if(f.getAttribute("artype")=="VertNavBar"||f.getAttribute("artype")=="HorzNavBar"){this.mContainer=F(this.mParentObj.windowID,f.getAttribute("arid"));break}f=f.parentNode}if(this.mStatus!=null){if(this.mObj.nextSibling!=null&&this.mObj.nextSibling.getAttribute("id")==("sub-"+this.mID)){this.mChildObj=this.mObj.nextSibling}this.mParentObj.mTextElement=this.mObj.childNodes[0]}else{if(f!=null&&f.getAttribute("artype")=="HorzNavBar"){this.mParentObj.mTextElement=this.mObj.childNodes[1].childNodes[0]}else{this.mParentObj.mTextElement=this.mObj.childNodes[0]}if(this.mParentObj.mTextElement!=null&&this.mParentObj.mTextElement.nodeType!=1){this.mParentObj.mTextElement=null}if(this.mObj.className.match(/\S*NavSelected\S*/)!=null){this.MakeItemVisible()}}};TradNavItem.prototype.DOMClick=function(f){hoverState.clearTracking();if(typeof f!="undefined"){f.StopBubbling();f.StopDefault()}if(this.mParentObj.GAccess()==3||this.mObj.getAttribute("separator")==1){return}this.DOMMouseOut(null);if(this.mStatus!=null){this.SetStatus(this.mStatus=="open"?"close":"open")}var d=[];var b=(this.mContainer.GetSelected()==this.mID)?this.mContainer.FireWorkflowOnSelectedItem():true;if(this.mContainer.SelectItemOnClick()){this.mContainer.SetSelected(this)}if(b){var g={f:ExecuteWorkflow,a:[this.mParentObj.windowID,1,this.mID]};if(this.mID in FormActionButtonFlags){d.push({f:FormActionButtonFlags[this.mID].f,a:[this.mParentObj.windowID]});d.push(g);return getCurWFC_NS(this.mParentObj.windowID).executeAll(d)}else{return{c:g}}}};TradNavItem.prototype.SetSelected=function(){if(this.mObj.getAttribute("status")==null&&this.mObj.getAttribute("separator")!=1){this.mContainer.SetSelected(this);this.MakeItemVisible()}};TradNavItem.prototype.MakeItemVisible=function(){var b,d=this.mObj.getAttribute("parentid");while(d!=null&&d>0){b=F(this.mParentObj.windowID,d);if(b instanceof DNavBarItem){b.SetStatus("open")}d=b.mObj.getAttribute("parentid")}};TradNavItem.prototype.setStyle=function(d){if(this.mObj.className.indexOf("VNavParent")!=-1){return}var b=(this.mObj.getAttribute("type")=="vert"?" VNavHover":" HNavHover");if(this.mObj.className.indexOf("VNavSelected")!=-1){b=" VNavSelectedHover"}if(d){this.mObj.className=this.mObj.className+b}else{this.mObj.className=this.mObj.className.replace(b,"")}};TradNavItem.prototype.DOMMouseOver=function(b){hoverState.eventMouseOver(b);if(this.mParentObj.GAccess()==3||this.mObj.getAttribute("separator")==1){return}this.setStyle(true)};TradNavItem.prototype.DOMMouseMove=function(b){hoverState.eventMouseMove(b)};TradNavItem.prototype.DOMMouseOut=function(b){hoverState.eventMouseOut(b);if(this.mParentObj.GAccess()==3||this.mObj.getAttribute("separator")==1){return}this.setStyle(false)};TradNavItem.prototype.SetStatus=function(d){var h=this.mObj.firstChild;var k="&#9660";var g="&#9658";var o=h.firstChild;if(this.mStatus!="open"&&d=="open"){this.mStatus="open";o.innerHTML="";var v="\u25BC";var u=document.createTextNode(v);o.appendChild(u);this.mChildObj.style.visibility="inherit";var s=this.mParentObj.GetParent();var b=F(this.mParentObj.windowID,s.mContainerID);while(b){if(b instanceof DPage&&b.mFillModel&&b.mState==1&&b.mFit){b.getChildScroll(s)}b=b.GetParent()}if(typeof AnimMgr!="undefined"&&document.documentMode){var f=this.mChildObj;setTimeout(function(){AnimMgr.WipeInNav(f)},100)}else{this.mChildObj.style.display="block"}}else{if(this.mStatus!="close"&&d=="close"){this.mStatus="close";o.innerHTML="";var v="\u25BA";var u=document.createTextNode(v);o.appendChild(u);if(typeof AnimMgr!="undefined"){AnimMgr.WipeOutNav(this.mChildObj)}else{this.mChildObj.style.display="none";this.mChildObj.style.visibility="hidden"}}}};TradNavItem.prototype.UpdateVis=function(b){if(!this.mHaveVisualCharacteristics||(b&&this.mObj.style.visibility=="inherit")||(!b&&this.mObj.style.visibility=="hidden")){return}if(this.mChildObj!=null&&this.mStatus=="open"){this.mChildObj.style.display=(b?"block":"none");this.mChildObj.style.visibility=(b?"inherit":"hidden")}if(this.mObj.getAttribute("type")=="vert"){this.mObj.style.display=(b?"block":"none")}else{this.mObj.style.display=(b?"inline":"none")}this.mObj.style.visibility=(b?"inherit":"hidden")};TradNavItem.prototype.MouseSelectable=false;TradNavItem.prototype.UpdateAccess=function(d){var b=(this.mObj.getAttribute("type")=="vert"?" VNavDisabled":" HNavDisabled");if(d==3){this.mObj.className+=b;if(this.mStatus=="open"){this.SetStatus("close")}}else{this.mObj.className=this.mObj.className.replace(b,"")}this.mParentObj.mCFCache.a=d};TradNavItem.prototype.GetFocusElement=function(){return this.mObj};TradNavItem.prototype.GetFocusElementForEvent=function(b){if(this.GetNestedFocusability()){return this.mObj}return null};TradNavItem.prototype.TabableElementSelector=function(b){if(b.tagName=="A"){if(!b.style||b.style.visibility!="hidden"){return b}}return null};TradNavItem.prototype.GetNestedFocusability=function(){return this.mParentObj.GetNestedFocusability()};TradNavItem.prototype.GColour=function(){return this.getStyleFromChildOf(this.mObj,"color")};TradNavItem.prototype.UpdateColour=function(f){if(f){var d=this.mObj.getElementsByTagName("span");for(var b=0;b<d.length;b++){d[b].style.color=f}}};TradNavItem.prototype.UpdateLabel=function(d){if(this.mContainer instanceof DVertNavBar){var b=this.mObj.getElementsByTagName("span");if(b.length==2){this.mParentObj.mTextElement=b[1]}else{this.mParentObj.mTextElement=b[0]}}};TradNavItem.prototype.UpdateFont=function(d){if(this.mContainer instanceof DVertNavBar){var b=this.mObj.getElementsByTagName("span");if(b.length==2){this.mParentObj.mTextElement=b[1]}else{this.mParentObj.mTextElement=b[0]}}};FlyoutItem.prototype.constructor=FlyoutItem;NavItemFactories["1"]=function(b){return new FlyoutItem(b)};function FlyoutItem(b){if(arguments.length){this.init(b)}}FlyoutItem.prototype.mDOMField=FlyoutItem.prototype.mHaveVisualCharacteristics=true;FlyoutItem.prototype.init=function(k){this.mParentObj=k;this.mObj=k.mObj;this.mID=k.mID;this.mStatus=this.mObj.getAttribute("status");this.mNavMode=this.mObj.getAttribute("navmode");this.mLevel=this.mObj.getAttribute("lvl");var f=this.mObj.parentNode.parentNode;var h=this.mObj;if(h.className.indexOf("root_menu")!=-1){if(h.getAttribute("gcolor")!=null&&h.getAttribute("color")!=null&&h.getAttribute("gtype")!=null){var g=h.getAttribute("gcolor");var o=h.getAttribute("color");var b=h.getAttribute("gtype");var d=RelContextPath+"bmc_border.gif?c="+o+"&g="+g+"&t="+b;getGradientImage(h,d)}}while(f!=null&&(f.tagName=="DIV")){if((f.getAttribute("artype")=="VertNavBar")||(f.getAttribute("artype")=="AppList")){this.mContainer=F(this.mParentObj.windowID,f.getAttribute("arid"));break}f=f.parentNode}if(this.mStatus!=null){this.mNeedToScroll=false;this.mTextElement=this.mObj.childNodes[0].childNodes[0];this.mChildObj=this.mObj.childNodes[1]}else{this.mTextElement=this.mObj.childNodes[0].childNodes[0];if(this.mTextElement!=null&&this.mTextElement.nodeType!=1){this.mTextElement=null}}this.mParentObj.mTextElement=this.mTextElement};var EXTENSION_HEIGHT=25;FlyoutItem.prototype.CreateExtensions=function(){if(this.mNeedToScroll){return}var u=ComputeElementPosition(this.mObj,getFormElements_NS(this.mParentObj.windowID)["FormContainer"],0,0);var v=u.y;var A=this.mObj.childNodes[1].firstChild;this.mRowCnt=0;if(A==null){this.mRowCnt=0;this.mRowH=0;return -1}this.mRowH=A.offsetHeight;if(A.parentNode.childNodes.length>0){this.mRowCnt=A.parentNode.childNodes.length/2}if(this.mRowH==0){this.mRowH=25}this.mH=this.mRowCnt*this.mRowH;var d=25;this.mNeedToScroll=true;var f=this.mObj.childNodes[1];var w=getFormElements_NS(this.mParentObj.windowID)["FormContainer"].scrollTop;var s=getFormElements_NS(this.mParentObj.windowID)["FormContainer"].clientHeight+w;var h=s-w;var g=1;if(v<(h/2)){h=h-v;g=0}else{h=v}var z=this.mH<h?this.mH:h;if(this.mH>z){var b=z-2-EXTENSION_HEIGHT;if(b<this.mRowH){b=this.mRowH}b-=b%this.mRowH;this.mRowsPerScreen=Math.floor((b)/this.mRowH);var o=new Array();createFlyout(f,this.mRowsPerScreen*2,this.mRowsPerScreen*2,f,o,false);for(var k=0;k<o.length;k++){f.removeChild(o[k])}setHandlers(this.mParentObj.windowID,this.mObj);FlyoutReInit(this.mParentObj.windowID,this.mObj)}return g};function createFlyout(g,d,y,b,s,v){var z=d+y;if((z+1)==g.childNodes.length){z+=1}var k;var h;if(v){k=0;h="root"}else{k=g.childNodes[0].getAttribute("lvl");k=parseInt(k,10)%2;h="lvl"+k}var u=document.createElement("a");u.className="btn";u.href="javascript:";u.style.zIndex="1";var B=document.createElement("span");B.className="navLabel "+h;B.innerHTML="Show Next >>>";u.appendChild(B);var D=document.createElement("DIV");D.style.overflow="visible";D.className="flyout";D.style.borderRight="1px solid #196697";D.style.left="0px";D.style.zIndex=g.childNodes[0].style.zIndex;var f=0;for(var o=d;o<z;o++){if(o<g.childNodes.length&&g.childNodes[o].tagName=="DIV"){var C=g.childNodes[o].cloneNode(true);D.appendChild(C);s.push(g.childNodes[o]);f++}}var A=y/2-f;if(A>0){D.appendChild(createDummyItems(h,k,A+1))}if(z<g.childNodes.length){createFlyout(g,z,y,D,s)}var w=document.createElement("DIV");w.className="ext item "+h;w.style.overflow="visible";w.style.height=g.childNodes[0].clientHeight;D.style.zIndex=g.childNodes[0].style.zIndex;D.style.backgroundColor=g.childNodes[0].style.backgroundColor;w.style.backgroundColor=g.childNodes[0].style.backgroundColor;w.setAttribute("lvl",k);w.appendChild(u);w.appendChild(D);b.appendChild(w)}function createDummyItems(f,b,d){var g=document.createElement("DIV");g.className="dummy item "+f;g.style.overflow="visible";g.style.height=25*d+"px";g.setAttribute("lvl",b);return g}function FlyoutReInit(b,g){var f=g;while(1){var d;if(f.nodeType==1&&(d=f.getAttribute("arid"))){getFields_NS(b)[d].Reset(f)}if(f.firstChild){f=f.firstChild}else{while(!f.nextSibling){f=f.parentNode;if(f==g){return}}f=f.nextSibling}}}FlyoutItem.prototype.Reset=function(b){this.mObj=b;this.mTextElement=this.mObj.childNodes[0].childNodes[0];this.mParentObj.mTextElement=this.mTextElement;if(this.mStatus!=null){this.mChildObj=this.mObj.childNodes[1]}};FlyoutItem.prototype.DOMClick=function(f){if(f.element.nodeType==1){hoverState.clearTracking()}if(typeof f!="undefined"){f.StopBubbling();f.StopDefault()}if(this.mParentObj.GAccess()==3||this.mObj.getAttribute("separator")==1){return}this.DOMMouseOut(null);if(this.mStatus!=null){this.SetStatus(this.mStatus=="open"?"close":"open")}var d=[];var b=(this.mContainer.GetSelected()==this.mID)?this.mContainer.FireWorkflowOnSelectedItem():true;if(this.mContainer.SelectItemOnClick()){this.mContainer.SetSelected(this)}if(b){var g={f:ExecuteWorkflow,a:[this.mParentObj.windowID,1,this.mID]};if(this.mID in FormActionButtonFlags){d.push(g);d.push({f:FormActionButtonFlags[this.mID].f,a:[this.mParentObj.windowID]});return getCurWFC_NS(this.mParentObj.windowID).executeAll(d)}else{return{c:g}}}};FlyoutItem.prototype.SetSelected=function(){};FlyoutItem.prototype.MakeItemVisible=function(){};FlyoutItem.prototype.setStyle=function(b){if(b){this.applyStyle()}else{this.removeStyle()}};FlyoutItem.prototype.getHorzDirection=function(){var h=true;var g=ComputeElementPosition(this.mObj,getFormElements_NS(this.mParentObj.windowID)["FormContainer"],0,0);var b=g.x;var f=getFormElements_NS(this.mParentObj.windowID)["FormContainer"].clientWidth;var d=b+this.mObj.offsetWidth+this.mObj.childNodes[1].offsetWidth;if(d>f){h=false}return h};FlyoutItem.prototype.getVertDirection=function(){var d=ComputeElementPosition(this.mObj,getFormElements_NS(this.mParentObj.windowID)["FormContainer"],0,0);var k=d.y;var h=this.mObj.childNodes[1].firstChild;if(h==null){return 0}this.mRowH=h.offsetHeight;if(h.parentNode.childNodes.length>0){this.mRowCnt=h.parentNode.childNodes.length/2}if(this.mRowH==0){this.mRowH=25}this.mH=this.mRowCnt*this.mRowH;var f=getFormElements_NS(this.mParentObj.windowID)["FormContainer"].scrollTop;var b=getFormElements_NS(this.mParentObj.windowID)["FormContainer"].clientHeight+f;var g=windowh=b-f;windowh=windowh-k;if(this.mH<windowh){return 0}if(this.mH<k){return 1}return -1};function getLastSibling(f){var d=0;for(var b=0;b<f.childNodes.length;b++){if(f.childNodes[b].nodeType==1){d=b}}return d}FlyoutItem.prototype.applyStyle=function(){var h=" VNavHover"+(this.mLevel%2);if(this.mObj.className.indexOf(h)==-1){this.mObj.className=this.mObj.className+h}if(this.mLevel>0){if(this.mLevel%2==1){this.mObj.style.backgroundColor=this.mContainer.mLvlevenbkcolor;this.mTextElement.style.color=this.mContainer.mSublvlcolor}else{this.mObj.style.backgroundColor=this.mContainer.mLvloddbkcolor;this.mTextElement.style.color=this.mContainer.mToptxtcolor}}if((this.mLevel>0)&&(this.mTextElement.className.indexOf(h)==-1)){this.mTextElement.className=this.mTextElement.className+h}if(this.mLevel>0){if(this.mObj.previousSibling==null){this.mObj.style.borderTop="none"}else{this.mObj.style.borderTop="1px solid #196697"}if(this.mObj.nextSibling.nextSibling==null){this.mObj.style.borderBottom="none"}else{this.mObj.style.borderBottom="1px solid #196697"}}else{this.mObj.style.borderTop="1px solid #196697";this.mObj.style.borderBottom="1px solid #196697"}if(this.mObj.childNodes[1]){var k=" menuhover"+(this.mLevel%2);if(this.mLevel>0&&this.mObj.className.indexOf(k)==-1){this.mObj.className=this.mObj.className+" menuhover"+(this.mLevel%2)}this.mObj.childNodes[1].style.display="block";this.mObj.childNodes[1].style.visibility="visible";this.mObj.childNodes[1].style.position="absolute";var f=0;var d=this.getVertDirection();if(d==0){this.mObj.childNodes[1].style.top="-1px"}else{if(d==1){this.mObj.childNodes[1].style.bottom="-1px";f=getLastSibling(this.mObj.childNodes[1])}else{var g=this.CreateExtensions();if(g==0){this.mObj.childNodes[1].style.top="-1px"}else{if(g==1){this.mObj.childNodes[1].style.bottom="-1px";f=getLastSibling(this.mObj.childNodes[1])}else{return}}}}var b=this.mContainer.mLvlevenbkcolor;if(this.mLevel%2==0){b=this.mContainer.mLvloddbkcolor}this.mObj.childNodes[1].childNodes[f].style.height=this.mObj.clientHeight;if(this.getHorzDirection()){this.mObj.childNodes[1].style.left="0px";this.mObj.childNodes[1].style.marginLeft="100%";this.mObj.childNodes[1].style.marginRight="0px";this.mObj.childNodes[1].childNodes[f].style.borderLeft="1px solid "+b}else{this.mObj.childNodes[1].style.left="auto";this.mObj.childNodes[1].style.right="0px";this.mObj.childNodes[1].style.marginLeft="0px";this.mObj.childNodes[1].style.marginRight="100%";this.mObj.childNodes[1].childNodes[f].style.borderRight="1px solid "+b}if(this.mStatus&&this.mStatus!="open"){this.mStatus="open"}}};FlyoutItem.prototype.removeStyle=function(){var b=" VNavHover"+(this.mLevel%2);if(this.mObj.childNodes[1]&&this.mLevel>0){this.mObj.className=this.mObj.className.replace(" menuhover"+(this.mLevel%2),"")}this.mObj.className=this.mObj.className.replace(b,"");if(this.mLevel>0){if(this.mLevel%2==0){this.mObj.style.backgroundColor=this.mContainer.mLvlevenbkcolor;this.mTextElement.style.color=this.mContainer.mSublvlcolor}else{this.mObj.style.backgroundColor=this.mContainer.mLvloddbkcolor;this.mTextElement.style.color=this.mContainer.mToptxtcolor}}if(this.mLevel>0){this.mTextElement.className=this.mTextElement.className.replace(b,"");if(this.mObj.previousSibling){this.mObj.style.borderTop="none"}if(this.mObj.nextSibling){this.mObj.style.borderBottom="none"}}else{this.mObj.style.borderBottom="1px solid #FFFFFF"}};FlyoutItem.prototype.DOMMouseOver=function(b){if(b.element.nodeType==1){hoverState.eventMouseOver(b)}if(typeof this.mID=="number"&&this.GetFocusElementForEvent()==null){return}this.setStyle(true)};FlyoutItem.prototype.DOMMouseMove=function(b){if(b.element.nodeType==1){hoverState.eventMouseMove(b)}};FlyoutItem.prototype.DOMMouseOut=function(b){if(this.mParentObj.GAccess()==3||this.mObj.getAttribute("separator")==1){return}this.setStyle(false)};FlyoutItem.prototype.SetStatus=function(b){if(this.mStatus!="open"&&b=="open"){this.mStatus="open";this.setStyle(true)}else{if(this.mStatus!="close"&&b=="close"){this.mStatus="close";this.setStyle(false);closeFlyout(this.mObj)}}};FlyoutItem.prototype.UpdateVis=function(b){if(!this.mHaveVisualCharacteristics||(b&&this.mObj.style.visibility=="inherit")||(!b&&this.mObj.style.visibility=="hidden")){return}if(this.mChildObj!=null&&this.mStatus=="open"){this.mChildObj.style.display=(b?"block":"none");this.mChildObj.style.visibility=(b?"inherit":"hidden")}this.mObj.style.display=(b?"block":"none");this.mObj.style.visibility=(b?"inherit":"hidden")};FlyoutItem.prototype.MouseSelectable=false;FlyoutItem.prototype.UpdateAccess=function(d){var b=" VNavDisabled";if(d==3){this.mObj.className+=b;if(this.mStatus=="open"){this.SetStatus("close")}}else{this.mObj.className=this.mObj.className.replace(b,"")}this.mParentObj.mCFCache.a=d};FlyoutItem.prototype.GetFocusElement=function(){return this.mObj};FlyoutItem.prototype.GetFocusElementForEvent=function(b){if(this.GetNestedFocusability()){return this.mObj}return null};FlyoutItem.prototype.GetHoverValue=function(b){return""};FlyoutItem.prototype.TabableElementSelector=function(b){return null};FlyoutItem.prototype.GetNestedFocusability=function(){return this.mParentObj.GetNestedFocusability()};FlyoutItem.prototype.GColour=function(){return this.getStyleFromChildOf(this.mObj,"color")};FlyoutItem.prototype.UpdateColour=function(b){};FlyoutItem.prototype.UpdateLabel=function(b){};FlyoutItem.prototype.UpdateFont=function(b){};DVertNavBar.prototype=new Field();DVertNavBar.prototype.constructor=DVertNavBar;DVertNavBar.superclass=Field.prototype;DOMFieldFactories.VertNavBar=function(b,f,d){return new DVertNavBar(b,f,d)};function DVertNavBar(g,f,d){if(arguments.length){this.init(g,f,d)}}DVertNavBar.prototype.mDOMField=DVertNavBar.prototype.mHaveVisualCharacteristics=true;DVertNavBar.prototype.init=function(g,f,d){DVertNavBar.superclass.init.call(this,g,f,d);this.mSelected=this.mObj.getAttribute("initvalue");this.mNavMode=this.mObj.getAttribute("navmode");this.mTopbkcolor=this.mObj.getAttribute("topbkcolor");this.mLvlevenbkcolor=this.mObj.getAttribute("lvlevenbkcolor");this.mLvloddbkcolor=this.mObj.getAttribute("lvloddbkcolor");this.mToptxtcolor=this.mObj.getAttribute("oddlvltxtcolor");this.mSublvlcolor=this.mObj.getAttribute("evenlvltxtcolor");if(this.mToptxtcolor==""){this.mToptxtcolor="#FFFFFF"}if(this.mSublvlcolor==""){this.mSublvlcolor="#196697"}if(this.mNavMode==1){this.inFill=false;if(this.mObj.getAttribute("arcontainerid")){this.inFill=true}if(this.mObj.getAttribute("arparentid")){this.mContainerID=this.mObj.getAttribute("arparentid");if(this.inFill==false){this._top=this.mObj.style.top;this._left=this.mObj.style.left}}var h=ComputeElementPosition(this.mObj,document.getElementById("FormContainer"),0,0);this.mObj.style.zIndex=999999-h.x;setHandlers(g,this.mObj)}};DVertNavBar.prototype.Clear=function(){};DVertNavBar.prototype.MouseSelectable=false;DVertNavBar.prototype.GetFocusElement=function(){return this.mObj};DVertNavBar.prototype.GetFocusElementForEvent=function(b){if(this.GetNestedFocusability()){return this.mObj}return null};DVertNavBar.prototype.GetSelected=function(){return this.mSelected};DVertNavBar.prototype.mHaveStoredData=false;DVertNavBar.prototype.mContainFields=true;DVertNavBar.prototype.TabableElementSelector=function(b){return null};DVertNavBar.prototype.Reconstruct=function(){var f=this.mObj.childNodes[0];var u=f.firstChild;if(u==null){return}var o=0;var h=u.offsetHeight;if(u.parentNode.childNodes.length>0){o=u.parentNode.childNodes.length/2}if(h==0){h=25}var s=o*h;if(s>this.mObj.clientHeight){var b=this.mObj.clientHeight-2-h;if(b<h){b=h}b-=b%h;var d=Math.floor((b)/h);var k=new Array();createFlyout(f,d*2,(o-d)*2,f,k,true);for(var g=0;g<k.length;g++){f.removeChild(k[g])}}};function setHandlers(b,f){var g=f.getElementsByTagName("DIV");for(var d=0;d<g.length;d++){if(g[d].className.indexOf("flyout")>=0){if(g[d].parentNode.className.indexOf("FlyoutContainer")>=0){if(!this.mContainerID){g[d].parentNode.onmouseover=function(){moveFlyout(this,b)};g[d].parentNode.onmouseout=function(){restoreFlyout(this,b)}}continue}g[d].parentNode.onmouseover=function(){showFlyout(this)};g[d].parentNode.onmouseout=function(){closeFlyout(this)}}}}function closeFlyoutItem(b){if(b.parentNode&&b.parentNode.parentNode&&b.parentNode.parentNode.parentNode&&b.parentNode.parentNode.className.indexOf("flyout")!=-1){closeFlyout(b.parentNode.parentNode.parentNode)}}function moveFlyout(k,b){var g=Field_FromElement(k);if(g){clearTimeout(g.flyoutTimeout);if(typeof g.mContainerID!="undefined"){var h=g.mObj;if(h.parentNode.id!="FormContainer"){var d=ComputeElementPosition(h,getFormElements_NS(b)["FormContainer"],0,0);h.style.top=d.y+"px";h.style.left=d.x+"px";h.style.position="absolute";getFormElements_NS(b)["FormContainer"].appendChild(h)}}}}function restoreFlyout(g,b){var d=Field_FromElement(g);if(d){var h=d;if(typeof h.mContainerID!="undefined"){d.flyoutTimeout=setTimeout(function(){if(h.mObj.parentNode.id=="FormContainer"){if(h.inFill){h.mObj.style.top="auto";h.mObj.style.left="auto";h.mObj.style.position="relative"}else{h.mObj.style.top=h._top;h.mObj.style.left=h._left;h.mObj.style.position="absolute"}F(h.windowID,h.mContainerID).mPageBody.appendChild(h.mObj)}},3)}}}function showFlyout(k){var d=Field_FromElement(k);if(k.className.indexOf("ext")==-1){if(d){if(typeof d.mID=="number"&&d.GetFocusElementForEvent()==null){return}d=d.mViewTypeObj;var b=" VNavHover"+(d.mLevel%2);if(d.mObj.className.indexOf(b)==-1){d.mObj.className=d.mObj.className+b}if(d.mLevel%2==1){d.mObj.style.backgroundColor=d.mContainer.mLvlevenbkcolor;d.mTextElement.style.color=d.mContainer.mSublvlcolor}else{d.mObj.style.backgroundColor=d.mContainer.mLvloddbkcolor;d.mTextElement.style.color=d.mContainer.mToptxtcolor}if((d.mLevel>0)&&(d.mTextElement.className.indexOf(b)==-1)){d.mTextElement.className=d.mTextElement.className+b}if(d.mLevel>0){if(d.mObj.previousSibling==null){d.mObj.style.borderTop="none"}else{d.mObj.style.borderTop="1px solid #196697"}if(d.mObj.nextSibling.nextSibling==null){d.mObj.style.borderBottom="none"}else{d.mObj.style.borderBottom="1px solid #196697"}}else{d.mObj.style.borderTop="1px solid #196697";d.mObj.style.borderBottom="1px solid #196697"}if(d.mObj.childNodes[1]){var g=" menuhover"+(d.mLevel%2);if(d.mLevel>0&&d.mObj.className.indexOf(g)==-1){d.mObj.className=d.mObj.className+" menuhover"+(d.mLevel%2)}d.mObj.childNodes[1].style.display="block";d.mObj.childNodes[1].style.visibility="visible"}}}else{var h=k.getElementsByTagName("div")[0];h.style.display="block";h.style.visibility="visible";h.style.position="absolute";h.style.left="1px";h.style.marginLeft="100%";h.style.bottom="-1px"}}function closeFlyout(g){if(typeof g.className=="undefined"){return}if(g.className.indexOf("ext")==-1){var b=Field_FromElement(g);if(b){b.mObj.style.backgroundColor=b.mViewTypeObj.mContainer.mTopbkcolor;b.setStyle(false);if(b.mStatus&&b.mStatus!="close"){b.mStatus="close"}}}var d=g.getElementsByTagName("div")[0];if(d){d.style.display="none";d.style.visibility="hidden"}}DVertNavBar.prototype.DOMClick=function(b){if(this.GAccess()==3){return}var d={f:ExecuteWorkflow,a:[this.windowID,1,this.mID]};return{c:d}};DVertNavBar.prototype.FireWorkflowOnSelectedItem=function(){if(this.mObj.getAttribute("workflowonselected")==1){return true}return false};DVertNavBar.prototype.SelectItemOnClick=function(){if(this.mObj.getAttribute("selectonclick")==1){return true}return false};DVertNavBar.prototype.SetSelected=function(b){if(b.mID==this.mSelected){return}if(this.mSelected){var d=F(this.windowID,this.mSelected).mObj;if("className" in d){d.className=d.className.replace(" VNavSelected"," ")}}b.mObj.className=b.mObj.className.replace("VNavLeaf","VNavLeaf VNavSelected");this.mSelected=b.mID};DVertNavBar.prototype.ResizeTo=function(f,b){if(f<this.mMinWidth){this.mObj.style.width=this.mMinWidth+"px"}else{if(f>this.mMaxWidth){this.mObj.style.width=this.mMaxWidth+"px"}else{this.mObj.style.width=Math.round(f*(this.perWidth/100))+"px"}}if(this.mObj.style.height=="auto"){return}var d=Math.round(b*(this.perHeight/100));if(d<this.mMinHeight){this.mObj.style.height=this.mMinHeight+"px"}else{if(d>this.mMaxHeight){this.mObj.style.height=this.mMaxHeight+"px"}else{this.mObj.style.height=Math.round(b*(this.perHeight/100))+"px"}}var g=F(this.windowID,this.mContainerID);if(g instanceof DPage&&g.mFillModel&&g.mState==1&&g.mFit){g.getChildScroll(this)}};DVertNavBar.prototype.getScrollheight=function(){var b=0;var d=this.mObj;if(d.scrollHeight>d.offsetHeight){b=d.scrollHeight-d.offsetHeight}return b};DVertNavBar.prototype.getScrollwidth=function(){var b=0;var d=this.mObj;if(d.scrollWidth>d.offsetWidth){b=d.scrollWidth-d.offsetWidth}return b};DHorzNavBar.prototype=new Field();DHorzNavBar.prototype.constructor=DHorzNavBar;DHorzNavBar.superclass=Field.prototype;DOMFieldFactories.HorzNavBar=function(b,f,d){return new DHorzNavBar(b,f,d)};function DHorzNavBar(g,f,d){if(arguments.length){this.init(g,f,d)}}DHorzNavBar.prototype.mDOMField=DHorzNavBar.prototype.mHaveVisualCharacteristics=true;DHorzNavBar.prototype.init=function(g,f,d){DHorzNavBar.superclass.init.call(this,g,f,d);this.mSelected=this.mObj.getAttribute("initvalue")};DHorzNavBar.prototype.Clear=function(){};DHorzNavBar.prototype.MouseSelectable=false;DHorzNavBar.prototype.FireWorkflowOnSelectedItem=function(){if(this.mObj.getAttribute("workflowonselected")==1){return true}else{return false}};DHorzNavBar.prototype.SelectItemOnClick=function(){if(this.mObj.getAttribute("selectonclick")==1){return true}else{return false}};DHorzNavBar.prototype.GetSelected=function(){return this.mSelected};DHorzNavBar.prototype.mHaveStoredData=false;DHorzNavBar.prototype.mContainFields=true;DHorzNavBar.prototype.TabableElementSelector=function(b){return null};DHorzNavBar.prototype.DOMClick=function(b){if(this.GAccess()==3){return}var d={f:ExecuteWorkflow,a:[this.windowID,1,this.mID]};return{c:d}};DHorzNavBar.prototype.GetFocusElement=function(){return this.mObj};DHorzNavBar.prototype.GetFocusElementForEvent=function(b){if(this.GetNestedFocusability()){return this.mObj}return null};DHorzNavBar.prototype.SetSelected=function(b){if(b.mID==this.mSelected){return}if(this.mSelected){var d=F(this.windowID,this.mSelected).mObj;d.className=d.className.replace("HNavSelected","HNavItem")}b.mObj.className=b.mObj.className.replace("HNavItem","HNavSelected");this.mSelected=b.mID};DHorzNavBar.prototype.ResizeTo=function(d,b){if(this.mObj.style.width!=this.perWidth+"%"){this.mObj.style.width=this.perWidth+"%"}};DChar.prototype=new DataField();DChar.prototype.constructor=DChar;DChar.superclass=DataField.prototype;JChar.prototype=new Field();JChar.prototype.constructor=JChar;JChar.superclass=Field.prototype;TPAChar.prototype=new Field();TPAChar.prototype.constructor=TPAChar;TPAChar.superclass=Field.prototype;DOMFieldFactories.Char=function(b,f,d){return new DChar(b,f,d)};function DChar(b,f,d){if(arguments.length){this.init(b,f,d)}}DChar.prototype.init=function(g,b,f){this.mInputNode=f.childNodes[2];this.mRTF=$(this.mInputNode).hasClass("rtf");if(this.mRTF){RichTextWidget.loadSkinCSS()}this.mDisplayAsText=$(this.mInputNode).hasClass("dat");this.mRTFAttachmentFieldID=-1;var o=this.mInputNode.getAttribute("arpool");if(o!=null){this.mRTFAttachmentFieldID=parseInt(o)}this.mRTFJoinIndex=-1;var h=this.mInputNode.getAttribute("arindx");if(h!=null){this.mRTFJoinIndex=parseInt(h)}this.mRTFAdvanced=this.mRTF&&((this.mInputNode.getAttribute("artf")!=null)?true:false);this.mExternalURLFieldID=-1;var v=$(this.mInputNode).attr("arexturl");if(v!=null){this.mExternalURLFieldID=parseInt(v);this.mExternalURLFieldLabel=$(this.mInputNode).attr("arextlabel");this.mExternalURLFieldWidth=parseInt($(this.mInputNode).attr("arextwidth"),10)}this.mbShowURL=(this.mInputNode.getAttribute("arshowurl")!=null)?true:false;this.mEncryptDataAtRest=(this.mInputNode.getAttribute("arencryptdataatrest")!=null&&this.mInputNode.getAttribute("arencryptdataatrest")=="1")?true:false;if(this.mRTF){var s=this;this.mInputNode.focus=function(){if(s.GAccess()!=1){s.ShowRTF(s.mInputNode)}};this.mInputNode.dir="ltr"}this.mOrgValue="";this.mMaxLen=this.mInputNode.getAttribute("maxlen");this.mAutoCompleteCreated=false;DChar.superclass.init.call(this,g,b,f);var u=this.mInputNode.getAttribute("armenu");if(u&&u.length>0){this.mbShowURL=null;this.mHasMenu=true}if(this.mbShowURL){var f=this.mObj;f=f.firstChild;while(1){if(f.nodeType==1&&f.tagName=="DIV"&&f.className.indexOf("text")!=-1){break}if(!f.nextSibling){break}f=f.nextSibling}this.mDivEditBox=f;this.mDivEditBox.dir="ltr";this.mInputNode.onblur=DChar.convert}if(this.mRTF){var k=YAHOO.util.Dom;this.mSingleLine=$(this.mInputNode).hasClass("sr");var d=this.mInputNode.getAttribute("arautosize");if(d==null||typeof d=="undefined"){d="0"}this.mAutoSizeHeight=!this.mSingleLine&&(d=="1"||d=="3");this.mAutoSizeWidth=!this.mSingleLine&&(d=="2"||d=="3");var d=this.mInputNode.getAttribute("armaxwidth");if(d==null||typeof d=="undefined"){this.mMaxWidth=0}else{this.mMaxWidth=parseInt(d)}var d=this.mInputNode.getAttribute("armaxheight");if(d==null||typeof d=="undefined"){this.mMaxHeight=0}else{this.mMaxHeight=parseInt(d)}this.mMinWidth=parseInt(k.getStyle(this.mInputNode,"width"),10);this.mMinHeight=parseInt(k.getStyle(this.mInputNode,"height"),10);this.InitInputNode()}};DChar.convert=FormEvent.Trampoline(function(b){var g=Field_FromElement(b.element);var d=g.GetValue();if(g.mOrgValue!=d){g.SetValue(d);g.FieldValChanged();g.mOrgValue=d}});TPAChar.prototype.ConvertPrimitiveToDataType=JChar.prototype.ConvertPrimitiveToDataType=DChar.prototype.ConvertPrimitiveToDataType=function(b){return new CharType(b)};DChar.prototype.FromUIInput=function(f,d,b){if(b){f=ExpandString(this.windowID,f,2|4,this.mID,10)}f=f.trim(1|2);if(f==""){return Null}return new CharType(f)};DChar.prototype.ConvertDTForS=DChar.prototype.ConvertDTForSLE=function(b){if(b.type==4){return b}return new CharType(b.toString())};DChar.prototype.UpdateMenu=function(d){if(d==null){return}var b=this.GMenu();if((b&&b=="$NULL$")||d=="$NULL$"){var f=this.mObj.firstChild;while(true){if(f.firstChild){f=f.firstChild}else{while(!f.nextSibling){f=f.parentNode;if(f==this.mObj){return}}f=f.nextSibling}if(f.className&&f.className.indexOf("menu")!=-1){f.style.visibility=((d=="$NULL$")?"hidden":"inherit");break}}}};JChar.prototype.UpdateAccess=function(b){if(this instanceof DChar){DChar.superclass.UpdateAccess.call(this,b)}if(this.isDropDown()){if(this.mInputNode){this.mInputNode.readOnly=true}}if(this.mInputNode){this.mInputNode.actb_autoCompleteEnabled=(b==2)}};TPAChar.prototype.isDropDown=JChar.prototype.isDropDown=DChar.prototype.isDropDown=function(){if(!this.mInputNode){return false}return this.mInputNode.getAttribute("mdd")=="1"};TPAChar.prototype.isRTF=JChar.prototype.isRTF=DChar.prototype.isRTF=function(){return this.mRTF};TPAChar.prototype.isRTFAdvanced=JChar.prototype.isRTFAdvanced=DChar.prototype.isRTFAdvanced=function(){return this.mRTFAdvanced};TPAChar.prototype.getRTFAttachmentFieldID=JChar.prototype.getRTFAttachmentFieldID=DChar.prototype.getRTFAttachmentFieldID=function(){return this.mRTFAttachmentFieldID};TPAChar.prototype.getExternalURLFieldID=JChar.prototype.getExternalURLFieldID=DChar.prototype.getExternalURLFieldID=function(){return this.mExternalURLFieldID};TPAChar.prototype.getExternalURLFieldLabel=JChar.prototype.getExternalURLFieldLabel=DChar.prototype.getExternalURLFieldLabel=function(){if(this.mExternalURLFieldLabel&&this.mExternalURLFieldLabel.length){return this.mExternalURLFieldLabel}return"..."};TPAChar.prototype.getExternalURLFieldWidth=JChar.prototype.getExternalURLFieldWidth=DChar.prototype.getExternalURLFieldWidth=function(){if(this.mExternalURLFieldWidth){return this.mExternalURLFieldWidth}return 0};DChar.prototype.GTrim=JChar.prototype.GTrim=TPAChar.prototype.GTrim=function(){var d=this.G();if(d==CharNull||d.isNull){return d}var b=d.toPrimitive();if(b==""){return CharNull}b=b.trim(1|2);if(b==""){return CharNull}return this.ConvertPrimitiveToDataType(b)};TPAChar.prototype.checkMenuChanged=function(){var g=this.GMenu();if(g!=null){var f=getFields_NS(this.windowID)[this.mColid];if(f!=null){if(f.mObj.lcl){var d=getFields_NS(this.windowID)[f.mObj.fid];if(d!=null){var b=d.mCFCache.m;if(b!=g){f.mCFCache.m=b;this.SMenu(b)}}}}}};TPAChar.prototype.verifyAddClear_2=JChar.prototype.verifyAddClear_2=DChar.prototype.verifyAddClear_2=function(f){var d=[];if(this.isSearchOnly()){if(getARStateCurrent_NS(this.windowID)==4){d.push({f:ARMenu_Open,a:[this,this.GMenu(),f,this.isSearchOnly()]})}else{d.push({f:ARMenu_Open,a:[this,this.GMenu(),f,false]})}}else{d.push({f:ARMenu_Open,a:[this,this.GMenu(),f,this.isDropDown()]})}d.push({f:Menu_Close,a:[]});var b=this.windowID;setTimeout(function(){new WorkflowContext(b,d,true)},50);return{n:{f:ARMenu_Open,a:[this,"DummyLoadingMenu",f,false]}}};TPAChar.prototype.verifyAddClear=JChar.prototype.verifyAddClear=DChar.prototype.verifyAddClear=function(b,d){if(this instanceof TPAChar){this.checkMenuChanged()}if(d){return this.verifyAddClear_2(b)}else{if(this.isSearchOnly()){if(getARStateCurrent_NS(this.windowID)==4){return{n:{f:ARMenu_Open,a:[this,this.GMenu(),b,this.isSearchOnly()]}}}else{return{n:{f:ARMenu_Open,a:[this,this.GMenu(),b,false]}}}}else{return{n:{f:ARMenu_Open,a:[this,this.GMenu(),b,this.isDropDown()]}}}}};TPAChar.prototype.isSearchOnly=JChar.prototype.isSearchOnly=DChar.prototype.isSearchOnly=function(){if(this.mInputNode.getAttribute("searchOnly")=="1"){return true}else{return false}};DChar.prototype.mDataType=4;DChar.prototype.mMaxLen=0;JFieldFactories.Char=function(b,f,d){return new JChar(b,f,d)};function JChar(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAFieldFactories.Char=function(b,f,d){return new TPAChar(b,f,d)};function TPAChar(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAChar.prototype.G=JChar.prototype.G=function(){var b=this.mObj.v;if(b.isNull||b.toString()==""){return CharNull}else{if(b.type==4){return b}else{this.mObj.v=new CharType(b);return this.mObj.v}}};DChar.prototype.encrypt=function(){if(this!=undefined&&this!=null&&this.mEncryptDataAtRest!=undefined&&this.mEncryptDataAtRest==true){return this.ConvertPrimitiveToDataType(this.G().toString().replace(/./g,"*"))}return this.G()};TPAChar.prototype.DoSet=TPAChar.prototype.DoSLoadEntry=JChar.prototype.DoSet=JChar.prototype.DoSLoadEntry=function(d){var f={hasKeyword:false,hasTemporalKeyword:false};var b=ExpandString(this.windowID,d.toString(),2|4|8,this.mID,this.mDataType,f);if(f.hasTemporalKeyword){this.mObj.v=(d.isNull)?CharNull:d}else{if((this.mDataType==4)&&!f.hasKeyword){this.mObj.v=(d.isNull)?CharNull:d}else{this.mObj.v=new CharType(b)}}if(this instanceof JChar){this.SetDirty()}};TPAChar.prototype.mHaveStoredData=DChar.prototype.mHaveStoredData=JChar.prototype.mHaveStoredData=true;TPAChar.prototype.SetScreenValue=JChar.prototype.SetScreenValue=function(d){do{if(!(this.mInputNode)){Assert("(Char.js:275) this.mInputNode")}}while(0);if(this.isRTF()){this.SetRTFVal(d)}else{this.mInputNode.value=d}var b=new FormEvent(this.windowID,this.mParentid);b.element=this.mInputNode;getFields_NS(this.windowID)[this.mParentid].FieldValChanged(b,d)};TPAChar.prototype.FieldValChanged=function(b){var d=this.GetScreenValAsPrimitive(b);if(typeof d=="undefined"||this.mPrimVal==d){return}this.mPrimVal=d;if(d==""){this.mDataVal=(this.mDataType==4)?CharNull:Null}else{var f={hasKeyword:false,hasTemporalKeyword:false};d=ExpandString(this.windowID,d,2|4,this.mID,this.mDataType,f);if(f.hasTemporalKeyword){this.mDataVal=null}else{if(d==""){if(f.hasKeyword){this.mDataVal=(this.mDataType==4)?CharNullType.KEYWORD_CHAR_NULL:NullType.KEYWORD_NULL}else{this.mDataVal=(this.mDataType==4)?CharNull:Null}}else{this.mDataVal=this.ConvertPrimitiveToDataType(d)}}}this.DoSet(this.mDataVal)};TPAChar.prototype.GetScreenValAsPrimitive=function(d){if(d!=null){return d.element.value}if(this.mInputNode==null){if(d==null){return""}else{var b=d.element.parentNode;this.mInputNode=b.childNodes[2];if(this.mInputNode==null){return""}this.mMaxLen=this.mInputNode.getAttribute("maxlen")}}if(this.isRTF()){return this.GetRTFVal()}else{return this.mInputNode.value}};TPAChar.prototype.SetDirty=function(){return};TPAChar.prototype.GetScreenValue=function(){if(this.isRTF()){var b=this.GetIFrameDoc();if(b&&b.firstChild){return b.firstChild.innerHTML}}return this.G().toString()};DChar.prototype.DoSet=function(d){if(this.mRTF){var b=currentRTFPopup&&currentRTFPopup.IsEditing(this.mID);var g=rtfEditor&&rtfEditor.IsEditing(this.mID);if(b||g){var f="";if(d&&!d.isNull){d=this.ConvertDTForS(d);f=d.toString()}if(b){currentRTFPopup.UpdateText(f);return}else{if(g){rtfEditor.UpdateText(f);return}}}}DChar.superclass.DoSet.call(this,d)};TPAChar.prototype.UpdateAccess=DChar.prototype.UpdateAccess=function(h){if(this instanceof DChar){if(this.mbShowURL||this.mRTF){var f=h==3,b=h==1;var k=this.mObj;k.className=k.className.replace(SACCESSRE,"");if(f){k.className+=" dfd"}var d=this.mInputNode;if(this.mbShowURL){d=this.mDivEditBox}var g="transparent";if(!this.mDisplayAsText){g=((b)?getARFieldROBg_NS(this.windowID):"#fff")}$(d).css("background-color",g);$(d).find(".rtf_text").css("background-color",g);if(this.mbShowURL){this.mInputNode.style.backgroundColor=g}this.mInputNode.disabled=f;this.mInputNode.readOnly=b}else{DChar.superclass.UpdateAccess.call(this,h);if(this.mCharEditBox){CharEditBoxPopup_UpdateAccess(this.mCharEditBox)}}}if(this.isDropDown()){if(this.mInputNode){this.mInputNode.readOnly=true}}if(this.mInputNode){this.mInputNode.actb_autoCompleteEnabled=(h==2)}if(this.mRTF){if(this.mInputNode){this.mInputNode.readOnly=true}}};TPAChar.prototype.DOMKeyPress=DChar.prototype.DOMKeyPress=function(d){if(this instanceof TPAChar){var b=d.element.parentNode;this.mInputNode=b.childNodes[2];this.mMaxLen=this.mInputNode.getAttribute("maxlen")}if(d.key==13){var f=this.mInputNode;var g=false;if("actb_autoCompleted" in f){if(f.actb_autoCompleted){g=true;f.actb_autoCompleted=false}}if(!g&&(d.shift||(f.getAttribute("Rows")==1)||f.tagName=="INPUT")){d.StopDefault();return{c:{t:this,f:DChar.superclass.DOMKeyPress,a:[d]}}}else{}}else{checkLength(d,this.windowID,this.mInputNode,this.mMaxLen)}};TPAChar.prototype.DOMKeyDown=DChar.prototype.DOMKeyDown=function(d){if(this.GAccess()==3){return}if(this instanceof TPAChar){var b=d.element.parentNode;this.mInputNode=b.childNodes[2];this.mMaxLen=this.mInputNode.getAttribute("maxlen")}if(d.key==40&&d.alt){var f=d.element;if(f){if(this.GMenu()){if(this.GAccess()!=1){return{c:{f:ExecuteWorkflow,a:[this.windowID,64,this.mID]},n:{a:[f],t:this,f:function(h){var g;g=this.isDropDown()?this.mInputNode:h;this.verifyAddClear(g,false)}}}}}}}else{if(d.key!=13&&d.key!=16){checkLength(d,this.windowID,this.mInputNode,this.mMaxLen)}}};function appendMenuLeafPathElements(s,k,o,g){var h;for(h=0;h<s.length;++h){if(s[h].v&&s[h].v instanceof Array&&s[h].v.length>0){var f=s[h].l;if(k!=null&&k.length>0){f=k+"/"+f}appendMenuLeafPathElements(s[h].v,f,o,g)}else{var d=(s[h].v)?s[h].v:s[h].l;if(typeof d==="string"){d=d.HTMLDecode().ValidatorUnEscape()}else{d=""}var u;if(g){u=s[h].l}else{u=d}o.acValues.push(d);o.acLabelLengths.push(u.HTMLDecode().ValidatorUnEscape().length);var b=u;if(k!=null&&k.length>0){b+=" <i>("+k+")</i>"}o.acLabels.push(b.HTMLDecode().ValidatorUnEscape())}}}function listOfMenuLeafValuesForField(o,b,f){if(!o.GMenu()){return null}if(!o.mInputNode){return null}var k=null;var d=new Object();d.acLabelLengths=new Array();d.acLabels=new Array();d.acValues=new Array();try{var h=o.GMenu();var s=ARMenu.getMenu(o.windowID,h);if(s==null){new NDXGetMenuDefinition(o.windowID,h,ARKWGetStringByIdx(o.windowID,7),getFormContext(o.windowID).formName);s=ARMenu.getMenu(o.windowID,h);s.cfid=o.mID;s.addField(o.mID)}if(s==null){handleMenuAbsent(h);return null}setActbProps(o,s);k=ARMenu_Get(o.windowID,o.GMenu(),null,f)}catch(g){return d}if(!k){return null}if(!k.mMenuDef){return null}appendMenuLeafPathElements(k.mMenuDef,"",d,b);return d}function setActbProps(b,f){b.menu=f;f.cfid=b.mID;if(!f.FieldMap[b.mID]){f.addField(b.mID);f.setAttribute(f.cfid,"acField",b);f.setAttribute(f.cfid,"arautocak",parseInt(b.mInputNode.getAttribute("arautocak")));f.setAttribute(f.cfid,"arautoctt",parseInt(b.mInputNode.getAttribute("arautoctt")));var d=b.mInputNode.getAttribute("arautocmb");if(d){if(f.mMenuData.l==1){f.setAttribute(f.cfid,"arautocnc","err")}}else{if(f.mMenuData.v==1){f.setAttribute(f.cfid,"arautocnc","err")}}}else{f.setAttribute(f.cfid,"acField",b)}}TPAChar.prototype.ActivateInPlaceEditor=DChar.prototype.ActivateInPlaceEditor=function(b){if(this.isRTF()&&this.GAccess()!=1&&this.mInputNode!=null&&!FakeButton_Find(b.element)){if(currentRTFPopup!=null&&currentRTFPopup.IsVisible()){currentRTFPopup.OnOK()}var d=b.element;if(IsRTFElemEditable(d)){this.ShowRTF(this.mInputNode)}}};TPAChar.prototype.DOMFocus=DChar.prototype.DOMFocus=function(d){if(d.element&&this instanceof TPAChar){var f=FakeButton_Find(d.element);if(f){var b=f.parentNode;this.mInputNode=b.childNodes[2];this.mMaxLen=this.mInputNode.getAttribute("maxlen")}}return{c:{t:this,f:DChar.superclass.DOMFocus,a:[d]},n:{t:this,f:function(){if(this.mInputNode!=null){var o=this.mInputNode.getAttribute("arautoc");this.mInputNode.hasFocus=true;var k=(o!=null)&&(o=="1"||o=="2");var v=this.mInputNode.getAttribute("arautocmb");var h=(v!=null)&&(v=="1");if(k&&this.mHasMenu!=false){this.mInputNode.actb_autoCompleteEnabled=(this.GAccess()==2);var g=listOfMenuLeafValuesForField(this,h,"");if(this.menu){if(this.menu.mCharFieldMenu||(!this.mAutoCompleteCreated)||(this instanceof TPAChar)){actb(this);this.mAutoCompleteCreated=true;if(this.menu.getAttribute(this.menu.cfid,"requestLoad")){this.menu.setState(3)}}else{this.menu.reInit()}if(this.mAutoCompleteCreated){this.mInputNode.actb_autoCompleted=false;if(g!=null){actb_values=(g.acValues!=null)?g.acValues:new Array();actb_keywords=(g.acLabels!=null)?g.acLabels:g.acValues;actb_lengths=(g.acLabelLengths!=null)?g.acLabelLengths:new Array();this.menu.setAttribute(this.menu.cfid,"ac_kw_len",actb_keywords.length);if(ARMenu.getMenu(this.windowID,this.menu.mMenuName).getAttribute(this.menu.cfid,"tItems")==-1){this.menu.setAttribute(this.menu.cfid,"tItems",actb_lengths.length);this.menu.setAttribute(this.menu.cfid,"ac_kw_len",-1)}}actb_firstText=(o=="1");var s=this;actb_completionListener=function(w){s.mDataVal.mValue=w.value;promptBar.setToClear();new WorkflowContext(s.windowID,{f:ExecuteWorkflow,a:[s.windowID,128,s.mID]})}}}else{handleMenuAbsent(" of field "+this.mInputNode.id)}}else{actb_keywords=[];actb_values=[];actb_lengths=[];var u=getARMenuCache_NS(this.windowID)[this.GMenu()];if(u){u.cfid=this.mID;if(!u.FieldMap[this.mID]){u.addField(this.mID)}if(this.isDropDown()&&this.GAccess()!=1){if(getARStateCurrent_NS(this.windowID)==4){this.mInputNode.readOnly=false}else{this.mInputNode.readOnly=true}}}}}if(this instanceof TPAChar){this.mDOMField=true}}}}};TPAChar.prototype.DOMBlur=DChar.prototype.DOMBlur=function(b){delete getARMaps_NS(this.windowID)[this.mID];delete getARArrays_NS(this.windowID)[this.mID];if(this.isRTF()){if(this.mRTFAttachmentFieldID>0&&this.mRTFAttachmentFieldID in getFields_NS(this.windowID)){var f=getFields_NS(this.windowID)[this.mRTFAttachmentFieldID];var d=this;setTimeout(function(){var k=d.GetIFrameDoc();GlobalVerifyAttachments(d.windowID,k,f);f=null;d=null},10)}RTF_Close(true)}if(this.mInputNode!=null){var h=this.mInputNode.getAttribute("arautoc");this.mInputNode.hasFocus=false;var g=(h!=null)&&(h=="1"||h=="2");if(g&&this.menu){this.acdirtyfocus=true;if(this.menu.FieldMap[this.mID]){setTimeout("this.removeACFieldReference",100);this.menu.setAttribute(this.menu.cfid,"ac_kw_len",-1)}}}if(this instanceof TPAChar){this.mDOMField=true}return DChar.superclass.DOMBlur.call(this,b)};DChar.prototype.removeACFieldReference=function(){this.menu.setAttribute(this.mID,"acField",null)};function GlobalVerifyAttachments(d,v,y){try{if(y!=null&&v!=null){var h=[];var w=v.getElementsByTagName("img");for(var g=0;g<w.length;g++){var f=w[g];if(f){var k=f.getAttribute("arattid");if(k!=null&&k.length>0){var z=parseInt(k);h[z]=true}}}var u=y.GetUsedRowIds();if(u&&u.length>0){for(var g=0;g<u.length;g++){var s=u[g];if(h==null||h.length==0||!(s in h)){if(s in getFields_NS(d)){var b=getFields_NS(d)[s];new WorkflowContext(d,{f:function(){var A={};return b.Delete(A)},t:self})}}}}}}catch(o){}}TPAChar.prototype.DOMClick=DChar.prototype.DOMClick=function(d){DChar.superclass.DOMClick.call(this,d);if(this.GAccess()==3){return}var g=FakeButton_Find(d.element);if(g){this.HideRTF(true);if(this instanceof TPAChar){var b=g.parentNode;this.mInputNode=b.childNodes[2];this.mMaxLen=this.mInputNode.getAttribute("maxlen")}if($(g).hasClass("menu")&&this.GMenu()!=null){if(this.GAccess()!=1){return{c:{f:ExecuteWorkflow,a:[this.windowID,64,this.mID]},n:{a:[g],t:this,f:function(o){var k;k=this.isDropDown()?this.mInputNode:o;return{n:{f:this.verifyAddClear,t:this,a:[k,true]}}}}}}}else{if($(g).hasClass("richtext")){if(currentRTFPopup&&currentRTFPopup.IsVisible()){currentRTFPopup.OnOK()}var h=this.mInputNode.getAttribute("id");if(!this.mRichTextEditBox){if(useLegacyRTFEditor){this.mRichTextEditBox=GetRTFPopup(this)}else{this.mRichTextEditBox=GetRTFPopupCK(this)}if(this instanceof TPAChar){this.mRichTextEditBox.ShowPopup(g,3,g.offsetHeight+3,false)}else{var f=this;setTimeout(function(){f.mRichTextEditBox.ShowPopup(g,0,g.offsetHeight,false)},0)}}else{this.mRichTextEditBox.SetFocus()}}else{if($(g).hasClass("expand")||$(g).hasClass("edit")){if(!this.mCharEditBox){this.mCharEditBox=new CharEditPopup(this);this.mCharEditBox.SetOrigin();this.mCharEditBox.SetContents();if(this.mCharEditBox.isOldChild!=undefined){this.mCharEditBox.SetFocus()}else{if(this instanceof TPAChar){this.mCharEditBox.ShowPopup(g,3,g.offsetHeight+3,true)}else{this.mCharEditBox.ShowPopup(g,0,g.offsetHeight,true)}}}else{this.mCharEditBox.SetFocus()}}else{if($(g).hasClass("fileupload")){if(this.GAccess()==1){return}if(!this.mFileEditBox){this.mFileEditBox=new FileEditPopup(this);this.mFileEditBox.SetOrigin();this.mFileEditBox.SetContents();if(this instanceof TPAChar){this.mFileEditBox.ShowPopup(g,3,g.offsetHeight+3,true)}else{this.mFileEditBox.ShowPopup(g,0,g.offsetHeight,true)}}else{this.mFileEditBox.SetFocus()}}}}}}else{if(this.isDropDown()&&this.GAccess()!=1){if(getARStateCurrent_NS(this.windowID)!=4){return this.DOMClick_HandleExpandMenu()}}else{this.ActivateInPlaceEditor(d)}}};TPAChar.prototype.DOMMouseDown=DChar.prototype.DOMMouseDown=function(b){DChar.superclass.DOMMouseDown.call(this,b);if(this.isDropDown()&&this.GAccess()!=1){if(getARStateCurrent_NS(this.windowID)==4){this.mInputNode.readOnly=false}else{this.mInputNode.readOnly=true}}};TPAChar.prototype.DOMClick_HandleExpandMenu=DChar.prototype.DOMClick_HandleExpandMenu=function(){var d=[];d.push({t:this,f:this.DOMClick_Menu,a:[]});d.push({f:Menu_Close,a:[]});var b=this.windowID;setTimeout(function(){new WorkflowContext(b,d)},50);return{n:{f:ARMenu_Open,a:[this,"DummyLoadingMenu",this.mInputNode,false]}}};TPAChar.prototype.DOMClick_Menu=DChar.prototype.DOMClick_Menu=function(){return{c:{f:ExecuteWorkflow,a:[this.windowID,64,this.mID]},n:{t:this,f:function(){if(this.isSearchOnly()){if(getARStateCurrent_NS(this.windowID)==4){ARMenu_Open(this,this.GMenu(),this.mInputNode,this.isSearchOnly())}else{return{n:{f:ARMenu_Open,a:[this,this.GMenu(),this.mInputNode,false]}}}}else{return{n:{f:ARMenu_Open,a:[this,this.GMenu(),this.mInputNode,this.isDropDown()]}}}}}}};function findEXPCOLTD(b){var d=b;while(d.parentNode){d=d.parentNode;if(d.tagName=="TD"){return d}}return null}function IsRTFElemEditable(f,d,k){var b=f.getAttribute("id");var h=(f.tagName=="IMG"&&(f.className.indexOf("expTitleImage")!=-1||(b!=null&&b.substr(0,15)=="img_expSection_")));if(f.tagName=="A"||h){if(h){var g=findEXPCOLTD(f);if(g!=null){collapse_twisty(0,g,d,k)}}return false}while(f&&f.className!=undefined&&f.className.indexOf("rtf_text")==-1){if(f.parentNode!=null&&f.parentNode.tagName=="A"){return false}f=f.parentNode}return true}TPAChar.prototype.InsertAtCaret=DChar.prototype.InsertAtCaret=function(b,g){if(this.isRTF()){var d=b.innerHTML;if(d!=null&&d!=""){g=" "+g}var f=this.GetIFrameDoc();if(f){if(f.tagName!="DIV"){var h=f.body.innerHTML;f.body.innerHTML=h+g}else{var h=f.firstChild.innerHTML;f.firstChild.innerHTML=h+g}}}else{DChar.superclass.InsertAtCaret.call(this,b,g)}};TPAChar.prototype.HandleMenuSelection=DChar.prototype.HandleMenuSelection=function(k){var f=this.mInputNode;var h=f.getAttribute("mstyle");var g=this.isRTF()?f.innerHTML:f.value;if(h==2){this.isRTF()?this.SetRTFVal(k):f.value=k}else{if(g!=null&&g!=""){k=" "+k}if(f.className.indexOf("dat")!=-1){var d=g+k;this.isRTF()?f.innerHTML=d:f.value=d}else{this.InsertAtCaret(f,k)}}if(this instanceof DChar){if(g!=k){delete getARMaps_NS(this.windowID)[this.mID];delete getARArrays_NS(this.windowID)[this.mID];this.FieldValChanged();this.SetDirty(f)}}else{if(g!=k){var b=new FormEvent(this.windowID,this.mParentid);b.element=f;getFields_NS(this.windowID)[this.mParentid].FieldValChanged(b,k);this.SetDirty(f)}}};function checkLength(s,f,o,g){if(getARStateCurrent_NS(f)==4){return}if(!(s.ctrl&&s.key==17)&&s.key!=46&&s.key!=8&&s.key!=36&&s.key!=35&&s.key!=39&&s.key!=37&&s.key!=45&&g!=0){var k=false;if(document.selection){var d=document.selection.createRange().duplicate();k=d.text.length>0}else{if("selectionStart" in o){var b=o.selectionStart,h=o.selectionEnd;k=(b!=h)}}var u=null;if(o&&o.className.indexOf("DivEditor")>=0){u=getInnerText(o)}else{if(this.isRTF&&this.isRTF()){u=o.innerHTML}else{u=o.value}}if(!k&&u&&u.length>=g){s.StopDefault();return}}}DChar.prototype.TabableElementSelector=function(b){if((b.tagName=="A"&&b.className&&b.className.indexOf("btn")>=0)||b.tagName=="INPUT"||b.tagName=="TEXTAREA"||(b.tagName=="DIV"&&b.className.indexOf("text")>=0)){if(!b.style||b.style.visibility!="hidden"){return b}}return null};DChar.prototype.innerText=function(){return getInnerText(this.mDivEditBox)};DChar.prototype.updateInnerHTML=function(g){var f=this.mDivEditBox;f.innerHTML=g;var b=f.getElementsByTagName("a");for(var d=0;d<b.length;d++){if(f.contentEditable=="true"){b[d].onmouseover=function(){f.contentEditable=false};b[d].onmouseout=function(){f.contentEditable=true}}b[d].href=b[d].innerHTML;var h=b[d].href.indexOf("#")==0;if(h){b[d].target=""}else{b[d].target="_blank"}}this.FieldValChanged()};DChar.prototype.UpdateROColour=function(){if(this.mbShowURL||this.mRTF){var b=this.mInputNode;if(this.mbShowURL){b=this.mDivEditBox}if(b.className.indexOf("dat")==-1){b.style.backgroundColor=getARFieldROBg_NS(this.windowID)}}else{DChar.superclass.UpdateROColour.call(this)}};DChar.prototype.SetValue=function(b){if(b&&b.length>0){if(this.isRTF()){b=this.SetRTFVal(b)}else{this.mInputNode.value=b}convertPlainToFormattedText(b,this.mDivEditBox);this.mDivEditBox.style.visibility="";this.mInputNode.style.visibility="hidden"}else{this.mInputNode.value=b;this.mDivEditBox.innerHTML="";this.mDivEditBox.style.visibility="hidden";this.mInputNode.style.visibility=""}this.mPrimVal=b};DChar.prototype.GetValue=function(){if(this.mDivEditBox&&this.mDivEditBox.style.visibility=="visible"){return this.innerText()}if(this.isRTF()){return this.GetRTFVal()}return this.mInputNode.value};DChar.prototype.GetFocusElement=function(){if("mFocusElement" in this){return this.mFocusElement}var d=this.mObj,b=d;while(1){if((b.nodeType==1)&&((b.tagName=="INPUT")||(b.tagName=="TEXTAREA")||(b.tagName=="IMG")||(b.tagName=="DIV"&&b.className.indexOf("text")>=0))){this.mFocusElement=b;return b}if(b.firstChild){b=b.firstChild}else{while(!b.nextSibling){b=b.parentNode;if(b==d){this.mFocusElement=null;return null}}b=b.nextSibling}}};TPAChar.prototype.GetIFrameDoc=function(){if(typeof this.mRowPos!="undefined"&&this.mRowPos>=0){var d="div_"+this.windowID+"_"+this.mColid+"_"+this.mRowPos;var b=$("#"+d);if(b&&b.length>0){return b.parent()[0]}}return null};function getInnerText(d){var f=d.innerHTML;f=f.replace(/<[br]\/?[^>]+>/gi,"\n");f=f.replace(/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/gi,"\t");f=f.replace(/&nbsp;/gi," ");f=f.replace(/&quot;/g,'"');var b=/<\/?[^>]+>/gi;f=f.replace(b,"");f=f.replace(/&lt;/g,"<");f=f.replace(/&gt;/g,">");f=f.replace(/&amp;/g,"&");return f}function convertPlainToFormattedText(d,b){d=d.replace(/</g,"&lt;");d=d.replace(/>/g,"&gt;");d=d.replace(/\"/g,"&quot;");b.innerHTML="";convertPlainToURL(d,b)}function convertPlainToURL(w,v){w=w.replace(/<br>/g,"\n");w=w.replace(/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/g,"\t");w=w.replace(/&nbsp;/g," ");var g="((ftp|www|http|https|gopher|mailto|news|nntp|telnet|wais|files|prospero|aim|webcal)[:|.][A-Za-z0-9/](([A-Za-z0-9$#_.+!*\\[\\]'(),;/?:@&~=-])|%[A-Fa-f0-9]{2})+)";var h=new RegExp(g,"gim");var b=w.replace(h,"{url_marker}");var d=b.split("{url_marker}");var s=w.match(h);var y=new Array();var o=w;var f=j=0;while(o){if(o.search(h)==0){var k=new Array();k.push("<a target='_blank' href=\"");if(s[f].indexOf("www.")==0){k.push("http://")}k.push(s[f]);k.push('">');k.push(s[f]);k.push("</a>");y.push(k.join(""));no=s[f].length;f++;if(no==null){continue}o=o.replace(o.substring(0,no),"")}else{var u=d[j];u=u.replace(/\n/g,"<br>");u=u.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");u=u.replace(/ /g,"&nbsp;");var k=new Array();k.push("<SPAN>");k.push(u);k.push("</SPAN>");y.push(k.join(""));len=d[j].length;j++;if(len==null){continue}o=o.replace(o.substring(0,len),"")}}v.innerHTML=y.join("");setTimeout(function(){refreshListeners(v)},10)}function updateInnerHTML(b,d){b.innerHTML=d;refreshListeners(b)}function refreshListeners(f){var b=f.getElementsByTagName("a");for(var d=0;d<b.length;d++){if(b[d].onmouseover==null){if(f.contentEditable=="true"){b[d].onmouseover=function(){f.style.cursor="pointer"};b[d].onmouseout=function(){f.style.cursor="text"};b[d].onclick=function(){window.open(this.href)}}b[d].target="_blank";if(b[d].innerHTML.indexOf("www.")==0){b[d].href="http://"+b[d].innerHTML}}}}function convertPlainToURLFlash(v){var g="((ftp|www|http|https|gopher|mailto|news|nntp|telnet|wais|file|prospero|aim|webcal)[:.A-Za-z0-9/](([A-Za-z0-9$_.+!*(),;/?:@&~=-])|%[A-Fa-f0-9]{2})+)";var h=new RegExp(g,"gim");var b=v.replace(h,"___");var d=b.split("___");var s=v.match(h);var w=new Array();var o=v;var f=j=0;while(o){if(o.search(h)==0){var k=new Array();k.push("<a target='_blank' href='");if(s[f].indexOf("www.")==0){k.push("http://")}k.push(s[f]);k.push("'><u><font color='#0000FF'>");k.push(s[f]);k.push("</font></u></a>");w.push(k.join(""));no=s[f].length;f++;if(no==null){continue}o=o.replace(o.substring(0,no),"")}else{var u=d[j];u=u.replace(/\n/g,"<br>");u=u.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");var k=new Array();k.push(u);w.push(k.join(""));len=d[j].length;j++;if(len==null){continue}o=o.replace(o.substring(0,len),"")}}return w.join("")}function removeHTMLTags(d){if(d){if(document.all){d=d.replace(/&(lt|gt);/g,function(f,g){return(g=="lt")?"<":">"});d=d.replace(/<\/?[^>]+(>|$)/g,"");return d.replace(/\r/g,"\n")}else{var b=document.createElement("div");b.innerHTML=d;return b.textContent}}}function validateURL(b){var d=getCurrentWindowID_NS();if(b!="undefined"&&b.length>0){if(!isUrl(b)){var g=getLocalizedMessage(9289);var f={n:9289,t:2,m:g,a:null};throw new WorkflowException(d,0,[{mstat:f,msgloc:null}])}}}function isUrl(d){var b=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return b.test(d)}DGroup.prototype=new DChar();DGroup.prototype.constructor=DGroup;DGroup.superclass=DChar.prototype;JGroup.prototype=new JChar();JGroup.prototype.constructor=JGroup;JGroup.superclass=JChar.prototype;TPAGroup.prototype=new TPAChar();TPAGroup.prototype.constructor=TPAGroup;TPAGroup.superclass=TPAChar.prototype;DOMFieldFactories.Group=function(b,f,d){return new DGroup(b,f,d)};function DGroup(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAGroup.prototype.ConvertPrimitiveToDataType=DGroup.prototype.ConvertPrimitiveToDataType=function(d){var b=Group_Validate(this.windowID,this.mID,ExpandString(this.windowID,d,2|4),true);return new CharType(b.v)};DGroup.prototype.ConvertDTForS=DGroup.prototype.ConvertDTForSLE=function(d){var b=Group_Validate(this.windowID,this.mID,ExpandString(this.windowID,d.toString(),2|4),true);if(b.w){getCurWFC_NS(this.windowID).status([{t:1,n:9305,m:null,a:this.GLabelOrName()}])}return new CharType(b.v)};DGroup.prototype.SToScreen=function(f,d){if(f.isNull){this.mInputNode.value=""}else{var b=Group_Validate(this.windowID,this.mID,f.toString(),false);if(b.v){this.mInputNode.value=b.v;this.SetDirty(this.mInputNode)}}};DGroup.prototype.Validate=function(){var b=Group_Validate(this.windowID,this.mID,ExpandString(this.windowID,this.mInputNode.value,2|4),true);if(b.w){return{t:2,n:9305,m:null,a:this.GLabelOrName()}}return null};DGroup.prototype.mNeedSpecialSetToScreen=true;function ValidateGroup(f,b){var d=null;if(f!=null&&f[b]!=null){d=f[b]}return d}function getGroupId(b,g,d){var f=ValidateGroup(getGInfo_NS(b).gNameIdMap,d);if(f==null&&g!=104){f=ValidateGroup(getGInfo_NS(b).cNameIdMap,d)}return f}function getRoleId(b,g,d){if(g==112||(g>=60000&&g<=60999)){for(var f in getGInfo_NS(b).rIdNameMap){if(d==getGInfo_NS(b).rIdNameMap[f]){return f}}}return null}function getLabel(b,g){var d;var f=/\b\d+\b/;if(f.test(g)){d=getGInfo_NS(b).getLabel(g);if(d&&d instanceof Object){return d[0]}}return d}function IsValidGroup(b,k,h,d){var o=getRoleId(b,k,h);if(o==null){o=getGroupId(b,k,h)}if(o!=null){return(d)?o:h}if(!d){var f=getLabel(b,h);if(f){return f}}if(k!=104){var g=/'[^']*'/;if(g.test(h)){return h}}return(isNaN(h)?null:h)}function Group_Validate_UsingSemiColon(f,k,w,h){var u={},y="",d="";var g=w.split(";");if(g!=null){for(var o=0;o<g.length;o++){var b=g[o].trim(1|2);if(b==""){continue}d=IsValidGroup(f,k,b,h);if(!d){if(b.lastIndexOf(" ")!=-1){var s=Group_Validate_UsingSpace(f,k,b,h);d=s.v;if(h){if(d.charAt(d.length-1)==";"){d=d.substring(0,d.length-1)}}}else{u.w=true;d=g[o]}}if(y!=""){y+=(h)?";":" "}y+=d}if(h){y+=";"}}u.v=y;return u}function Group_Validate_UsingSpace(f,k,y,h){var s={},z="",d="";var w=y;var b=0,o=y.length,g;while(true){if(b>o){break}g=w.substring(b,o)+"";d=IsValidGroup(f,k,g.trim(1|2),h);if(!d){var u=g.lastIndexOf(" ");if(u!=-1){o=b+u;continue}s.w=true;d=g}if(z!=""){z+=(h)?";":" "}z+=d;b=o+1;o=y.length}if(h){z+=";"}s.v=z;return s}function Group_Validate(b,o,h,f){var g={},d=h;if(h.length>0){if(h.lastIndexOf(";")!=-1){return Group_Validate_UsingSemiColon(b,o,h,f)}else{if(h.lastIndexOf(" ")!=-1){return Group_Validate_UsingSpace(b,o,h,f)}else{var k=IsValidGroup(b,o,h,f);if(k){d=k;if(f){d+=";"}}else{g.w=true}}}}g.v=d;return g}JFieldFactories.Group=function(b,f,d){return new JGroup(b,f,d)};function JGroup(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAFieldFactories.Group=function(b,f,d){return new TPAGroup(b,f,d)};function TPAGroup(b,f,d){if(arguments.length){this.init(b,f,d)}}JGroup.prototype.G=function(){var b=this.mObj.v;if(this.mObj.w||b.isNull||b.toString()==""){return CharNull}this.mObj.v=new CharType(this.mObj.v);return this.mObj.v};JGroup.prototype.DoSet=JGroup.prototype.DoSLoadEntry=function(d){d=d.toString();var b=Group_Validate(this.windowID,this.mID,d,true);if(b.w){getCurWFC_NS(this.windowID).status([{t:1,n:9305,m:null,a:this.GLabelOrName()}])}this.mObj=b;this.SetDirty()};var DatatypeMap={Attachment:11,Char:4,Currency:12,Date:13,Decimal:10,DefaultKW:1,Diary:5,Display:43,Enum:6,Group:4,Integer:2,Keyword:1,Null:0,Real:3,StatusHistory:4,TOD:14,Time:7,View:42};JColumn.prototype=new Field();JColumn.prototype.constructor=JColumn;JColumn.superclass=Field.prototype;function JColumn(g,f,d){if(arguments.length){this.init(g,f,d)}}JColumn.prototype.mHaveVisualCharacteristics=true;JColumn.prototype.mIsPageDataField=false;JColumn.prototype.init=function(k,h,f){this.mData=null;JColumn.superclass.init.call(this,k,h,f);this.mCFCache.v=true;this.mIsPageDataField=(this.mObj.template!=null)&&(this.mObj.template!="");this.mRTF=false;this.mRTFAttachmentFieldID=-1;if(this.mIsPageDataField){this.mCFCache.l=this.mObj.lbl;if(this.mObj.template.indexOf(" rtf ")!=-1){var d=document.createElement("TEMP");d.innerHTML=this.mObj.template;if(d.firstChild&&d.firstChild.childNodes&&d.firstChild.childNodes.length>1){var o=d.firstChild.childNodes[2];this.mRTF=(o.className.indexOf("rtf")!=-1);var g=o.getAttribute("arpool");if(g!=null){this.mRTFAttachmentFieldID=parseInt(g)}this.mRTFAdvanced=this.mRTF&&((o.getAttribute("artf")!=null)?true:false)}}}};JColumn.prototype.UpdateVis=function(b){getFields_NS(this.windowID)[this.mObj.pnt].SColVis(this.mObj.dataidx,b)};JColumn.prototype.UpdateLabel=function(b){getFields_NS(this.windowID)[this.mObj.pnt].SColLabel(this.mObj.dataidx,b)};JColumn.prototype.instantiateField=function(){if(!("dataidx" in this.mObj)){return}var b=getFields_NS(this.windowID)[this.mObj.pnt];if(b.mResult){var h=b.mResult.f[this.mObj.dataidx];if((h.t in JFieldFactories)||(this.mIsPageDataField&&(h.t in TPAFieldFactories))){if(this.mData){var d=h.dt;if("t" in this.mData){d=this.mData.t}h.v=Datatype_Factory({t:d,v:this.mData.p,a:h.a})}else{h.v=Null}if(this.mIsPageDataField){if((h.t=="Enum")&&("et" in this.mObj)&&(this.mObj.et==0)){this.mField=TPAFieldFactories[h.t+"Sel"](this.windowID,0,h)}else{this.mField=TPAFieldFactories[h.t](this.windowID,0,h)}this.mField.cmid=this.mID;this.mField.mCFCache=new CFCacheObj();this.mField.mParentid=this.mObj.pnt;this.mField.mColid=this.mID;if(this.mRTF){this.mField.mRTF=this.mRTF}if(this.mRTFAttachmentFieldID){this.mField.mRTFAttachmentFieldID=this.mRTFAttachmentFieldID}if(this.mRTFAdvanced){this.mField.mRTFAdvanced=this.mRTFAdvanced}if("m" in this.mCFCache){this.mField.mCFCache.m=this.mCFCache.m}if("a" in this.mCFCache){this.mField.mCFCache.a=this.mCFCache.a}if("l" in this.mCFCache){this.mField.mCFCache.l=this.mCFCache.l}var g=this.getTable();if(g){this.mField.mRowPos=g.GetRow()}}else{this.mField=JFieldFactories[h.t](this.windowID,0,h)}}}};JColumn.prototype.G=function(){if(!this.mField){this.instantiateField()}if(this.mField){if(this.mIsPageDataField&&this.mField.mObj.t=="View"){var d=getFields_NS(this.windowID);var g=d[this.mObj.pnt].GetRow();if(g>=0&&d[this.mObj.pnt].mResult){var f=d[this.mObj.pnt].mResult.r[g].d[this.mObj.dataidx].vt;if(f!=null){return new CharType(f)}return Null}}var b=this.mField.G();if(this.mObj.distyp==2&&!b.isNull&&typeof(b.mValue)=="string"){b.mValue=b.mValue.HTMLDecode()}return b}return Null};JColumn.prototype.GP=function(){if(!this.mField){this.instantiateField()}if(this.mField){if(this.mIsPageDataField&&this.mField.mObj.t=="View"){var d=getFields_NS(this.windowID);var f=d[this.mObj.pnt].GetRow();if(f>=0&&d[this.mObj.pnt].mResult){return new CharType(d[this.mObj.pnt].mResult.r[f].d[this.mObj.dataidx].vt)}}if(this.mField.mObj.t=="Enum"){var b=this.mField.GP()}else{b=this.mField.G()}return b}return Null};JColumn.prototype.DoSet=JColumn.prototype.DoSLoadEntry=function(k){if(!this.mField){this.instantiateField()}if(this.mField){var b=getFields_NS(this.windowID)[this.mObj.pnt];var h=b.GetRow();if(h>=0&&h<b.GetRows()){var f=getFieldChanged_NS(this.windowID);this.mField.S(k);if(b instanceof DPageArray&&this.mField.mObj.t=="Enum"&&k.type!=6){var g=this.findHtmlObject(h,this.mObj.dataidx);if((g!=null)&&(typeof this.mField.iterate!="undefined")){this.mField.iterate(function(u,o){var s=u.nextSibling.firstChild.data;if(k.mValue==s){u.checked=true}else{u.checked=false}},g)}}if(!f){Field_ClearChangedFromRunProcess(this.windowID)}var d=b.mResult.r[b.GetRow()];if((!("mXXXDirty" in d))||(d.mXXXDirty!=2&&d.mXXXDirty!=3)){b.mResult.r[b.GetRow()].mXXXDirty=1}if(b instanceof DTreeView){this.mData.p=this.mField.G().toString()}else{this.mData.p=this.mField.mObj.v}this.mData.v=this.mField.G().toString();this.mData.t=(this.mField.mObj.v.isNull)?0:this.mField.mObj.dt;if(this.mIsPageDataField&&this.mField.mObj.t=="View"){this.mObj.v=this.mField.val;b.mResult.r[h].d[this.mObj.dataidx].vt=this.mField.val.toString()}if((b instanceof DPageArray)&&(this.mData.t==6)){this.mData.p=this.mField.mObj.v.mValue}else{b.DataChanged()}if(typeof AnimMgr!="undefined"&&this.mIsPageDataField){b.mHighlight=[];b.mHighlight.push({r:h,c:this.mObj.dataidx})}}}};JColumn.prototype.findHtmlObject=function(d){var b=getFields_NS(this.windowID)[this.mObj.pnt];return b.findHtmlObject(d,this.mObj.dataidx)};JColumn.prototype.GetDataPortion=function(){var d=getFields_NS(this.windowID)[this.mObj.pnt];var g=d.GetRow();var b=this.findHtmlObject(g);if(b!=null){var f=b.getElementsByTagName("input");if(f.length==0){f=b.getElementsByTagName("textarea")}return f[0]}return null};JColumn.prototype.GetNestedFocusability=function(){var b=this.GetParent();if(b==null){b=F(this.mObj.windowID,this.mObj.pnt)}return(((this.mObj.edit=="1")||this.mIsPageDataField)&&(this.GAccess()!=3)&&this.GVis()&&(b==null||b.GetNestedFocusability()&&!(b instanceof DTreeView)))};JColumn.prototype.GetFocusElement=function(){if(this.GetNestedFocusability()){return this.GetDataPortion()}else{return null}};JColumn.prototype.mHaveStoredData=false;JColumn.prototype.GDefault=function(){return null};JColumn.prototype.Clear=function(){};JColumn.prototype.Refresh=function(){if(this.mField){var b=getFields_NS(this.windowID)[this.mObj.pnt];if(b.mResult){var d=b.mResult.f[this.mObj.dataidx];if(d.t!=this.mField.type){delete this.mField}else{}}}};JColumn.prototype.Update=function(k,g){this.mData=k;if(this.mData&&typeof this.mData!="undefined"&&this.mRTF&&this.mData.p!="undefined"&&this.mData.p){this.mData.p=updateRtfHtml(this.windowID,this.mData.p,g)}if(this.mField){if(this.mData){var b=getFields_NS(this.windowID)[this.mObj.pnt];var h=b.mResult.f[this.mObj.dataidx];var d=h.dt;if("t" in this.mData){d=this.mData.t}this.mField.mObj.v=Datatype_Factory({t:d,v:this.mData.p,a:h.a})}else{this.mField.mObj.v=Null}}};JColumn.prototype.getTable=function(){var b=F(this.windowID,this.mObj.pnt);return b};JColumn.prototype.GetSorter=function(){if(!this.mField){this.instantiateField()}return this.mField.GetSorter()};JColumn.prototype.IsTimeRelatedField=function(){if(!this.mField){this.instantiateField()}return(this.mField instanceof JDate||this.mField instanceof JTime||this.mField instanceof JTOD)};JColumn.prototype.GetType=function(){if("dataidx" in this.mObj){var b=getFields_NS(this.windowID)[this.mObj.pnt];if(b.mResult){var d=b.mResult.f[this.mObj.dataidx];if(d.t in DatatypeMap){return DatatypeMap[d.t]}}}return 0};JColumn.prototype.GetDataField=function(){if(!this.mField){this.instantiateField()}return this.mField};JColumn.prototype.DOMClick=function(b){if(typeof rtfEditor!="undefined"&&rtfEditor!=null&&rtfEditor.mEditing!=null&&rtfEditor.mEditing!=b.element){this.HideRTF(true)}var d=this.GetDataField();if((d instanceof TPAInteger)||(d instanceof TPADecimal)||(d instanceof TPAReal)){return}if((d instanceof TPAControl)||(d instanceof TPAEnumSel)||(d instanceof TPAEnum)){return d.DOMClick(b,this.mID)}if(d.isRTF&&d.isRTF()&&!d.mInputNode&&b.element){var f=b.element;while(f&&f.parentNode&&(f.tagName!="DIV"||(f.tagName=="DIV"&&!($(f).hasClass("rtf")&&$(f).hasClass("text"))))){f=f.parentNode}d.mInputNode=f}return d.DOMClick(b)};JColumn.prototype.DOMMouseDown=function(b){var d=this.GetDataField();if(d instanceof TPAInteger){return d.DOMMouseDown(b,this.mID)}};JColumn.prototype.DOMMouseUp=function(b){var d=this.GetDataField();if(d instanceof TPAInteger){return d.DOMMouseUp(b,this.mID)}};JColumn.prototype.DOMMouseOut=function(b){var d=this.GetDataField();if(d instanceof TPAInteger){return d.DOMMouseOut(b,this.mID)}};JColumn.prototype.DOMKeyPress=function(b){var d=this.GetDataField();if(d instanceof TPAChar){return d.DOMKeyPress(b)}};JColumn.prototype.DOMKeyDown=function(b){var d=this.GetDataField();if(d instanceof TPAChar){return d.DOMKeyDown(b)}};JColumn.prototype.getRowInScroll=function(b){var d=this.getTable();return d.getRowInScroll(b)};JColumn.prototype.hasImgRef=function(){if(this.mObj.irv!=undefined){return true}else{return false}};JColumn.prototype.getImgW=function(b){if(this.mObj.irv!=undefined){var d=this.mObj.irv[b];if(d!=null&&d.irw!=undefined){return d.irw}}return 0};JColumn.prototype.getImgH=function(b){if(this.mObj.irv!=undefined){var d=this.mObj.irv[b];if(d!=null&&d.irh!=undefined){return d.irh}}return 0};JColumn.prototype.getImgURL=function(b){if(this.mObj.irv!=undefined){var d=this.mObj.irv[b];if(d!=null){return(d.ir=="")?null:d.ir}}return null};JColumn.prototype.getImgFid=function(){if(this.mObj.irv!=undefined&&this.mObj.irf!=undefined){return this.mObj.irf}else{return 0}};JColumn.prototype.getImgAltT=function(b){if(this.mObj.irv!=undefined){var d=this.mObj.irv[b];if(d!=null&&d.iat!=undefined){return d.iat}}return null};JColumn.prototype.getImgFType=function(b){if(this.mObj.irv!=undefined){var d=this.mObj.irv[b];if(d!=null){return(d.irf=="")?null:d.irf}}return null};JColumn.prototype.hasCellColor=function(){if(this.mObj.ccf!=undefined){return true}else{return false}};JColumn.prototype.getCColorFid=function(){if(this.mObj.ccf!=undefined&&this.mObj.cc!=undefined){return this.mObj.ccf}else{return 0}};JColumn.prototype.getCColor=function(d){if(this.mObj.cc!=undefined){var b=this.mObj.cc[d];return b}return null};JColumn.prototype.isRTFAdvanced=function(){return this.mRTFAdvanced};JColumn.prototype.isRTF=function(){return this.mRTF};JColumn.prototype.getRTFAttachmentFieldID=function(){return this.mRTFAttachmentFieldID};JColumn.prototype.DOMFocus=function(b){if(!this.mIsPageDataField){if(this.mObj.edit==0||this.mData==null){return}return JColumn.superclass.DOMFocus.call(this,b)}var d=this.GetDataField();if(d){FocusMgr.mCurFocusElement=this.GetDataPortion();return d.DOMFocus(b)}};JColumn.prototype.DOMBlur=function(b){if(!this.mIsPageDataField){if(this.mObj.edit==0||this.mData==null){return}return JColumn.superclass.DOMBlur.call(this,b)}var d=this.GetDataField();if(d){return d.DOMBlur(b)}};JColumn.prototype.FieldValChanged=function(d,g){var f=this.GetDataField();if(typeof g=="undefined"&&(f instanceof TPAEnum||f instanceof TPAEnumSel)){return}var b=f.FieldValChanged(d,g);if(f.mDataVal!=null){if(typeof g=="undefined"&&(f instanceof TPATime||f instanceof TPADate||f instanceof TPATOD)){return b}this.DoSet(f.mDataVal)}return b};JColumn.prototype.GetHoverValue=function(h){var u=this.getTable();var v=null;if(h.element.className=="BaseTableInner"){v=this.getRowInScroll(h)}else{if(u.mObj.getAttribute("artype")=="TreeView"){var o=h.element.id;if(o==null){return""}var b=o.indexOf("TN");if(b!=-1){o=o.substring(b)}var k=TreeNode.findNodeWithID(u.mTreeNode,o);if(k==null){return""}var s=k.startRow;var f=k.column;for(p=0;p<u.mColFields.length;p++){if(u.mColFields[p].mID==this.mID){f=p}}var g=u.GetData();if(g.length>0){return g[s].d[f].v}else{return""}}else{v=u.MapUIX(h.element)}}if(v==null){return""}var u=this.getTable();var d=u.getColNum(this.mID);if(d==-1){return""}var g=u.GetData();return g[v].d[d].v};DInteger.prototype=new DataField();DInteger.prototype.constructor=DInteger;DInteger.superclass=DataField.prototype;JInteger.prototype=new Field();JInteger.prototype.constructor=JInteger;JInteger.superclass=Field.prototype;TPAInteger.prototype=new Field();TPAInteger.prototype.constructor=TPAInteger;TPAInteger.superclass=Field.prototype;DOMFieldFactories.Integer=function(b,f,d){return new DInteger(b,f,d)};function DInteger(b,f,d){if(arguments.length){this.init(b,f,d)}}DInteger.prototype.init=function(b,h,g){if(g.getAttribute("artype")=="Integer"){var d=g.childNodes[2];this.mInputNode=d.childNodes[1];var f=d.getElementsByTagName("a");if(f.length>1){this.mSpinnerUp=f[0];this.mSpinnerUp.href="#";this.mSpinnerDown=f[1];this.mSpinnerDown.href="#"}}this.min=this.mInputNode.getAttribute("armin");this.max=this.mInputNode.getAttribute("armax");if(!this.min){this.min=-2147483647}else{this.min=parseInt(this.min)}if(!this.max){this.max=2147483647}else{this.max=parseInt(this.max)}DInteger.superclass.init.call(this,b,h,g)};DInteger.prototype.ConvertPrimitiveToDataType=function(b){return this.FromUIInput(b,false,false)};DInteger.prototype.FieldValChanged=function(){DInteger.superclass.FieldValChanged.call(this);if(!this.mDataVal.isNull){this.SetSpinnerState(this.mDataVal.toInteger())}};TPAInteger.prototype.FromUIInput=JInteger.prototype.FromUIInput=DInteger.prototype.FromUIInput=function(g,f,d){if(d){g=ExpandString(this.windowID,g,2|4,this.mID,2)}if(g==""){return Null}g=g.trim(1|2);if(f){var b=/^[+-]?[0-9]+$/;if(!b.test(g)){throw ({t:2,n:9375,m:null,a:'"'+g+'": '+this.GLabelOrName()})}var h=parseFloat(g);if(h<-2147483647||h>2147483647){throw ({t:2,n:9272,m:null,a:""+-2147483647+","+2147483647+" : "+this.GLabelOrName()})}}return new IntegerType(g)};TPAInteger.prototype.FieldValChanged=function(b){var d=this.GetScreenValAsPrimitive(b);if(typeof d=="undefined"||this.mPrimVal==d){return}if(d!=""||typeof d=="undefined"||typeof this.mPrimVal=="undefined"){this.mDataVal=new IntegerType(d)}this.mPrimVal=d;this.DoSet(this.mDataVal)};TPAInteger.prototype.GetScreenValAsPrimitive=function(d){if(d!=null){return d.element.value}if(this.mInputNode==null){if(d==null){return""}else{var b=d.element.parentNode;this.mInputNode=b.childNodes[2];if(this.mInputNode==null){return""}}}return this.mInputNode.value};DInteger.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var g=this.mInputNode.value;g=ExpandString(this.windowID,g,2|4,this.mID,2);if(g==""){return Null}var d=Field.GetQBEOperator(g);if(d==null){var b=this.Validate();if(b){throw (b)}return this.G()}else{var f=this.FromUIInput(g.substring(d.length).trim(1),true,false);return new CharType(d+f.toPrimitive())}};TPAInteger.prototype.ConvertDTForS=TPAInteger.prototype.ConvertDTForSLE=JInteger.prototype.ConvertDTForS=JInteger.prototype.ConvertDTForSLE=DInteger.prototype.ConvertDTForS=DInteger.prototype.ConvertDTForSLE=function(b){if(b.isNull||b.type==2){return b}var b=b.toInteger();if(!b.isNull){b=new IntegerType(b)}return b};DInteger.prototype.Validate=function(){try{var d=this.FromUIInput(this.mInputNode.value,true,true);return Integer_Validate(this,d,this.min,this.max)}catch(b){return b}};DInteger.prototype.mDataType=2;JFieldFactories.Integer=function(b,f,d){return new JInteger(b,f,d)};function JInteger(b,f,d){if(arguments.length){this.init(b,f,d)}}JInteger.prototype.init=function(b,f,d){JInteger.superclass.init.call(this,b,f,d);if(!("min" in this.mObj)){this.mObj.min=-2147483647}if(!("max" in this.mObj)){this.mObj.max=2147483647}};TPAFieldFactories.Integer=function(b,f,d){return new TPAInteger(b,f,d)};function TPAInteger(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAInteger.prototype.init=function(b,f,d){TPAInteger.superclass.init.call(this,b,f,d);if(!("min" in this.mObj)){this.mObj.min=-2147483647}if(!("max" in this.mObj)){this.mObj.max=2147483647}};TPAInteger.prototype.G=JInteger.prototype.G=function(){var b=this.mObj.v;if(b.isNull||b.type==2){return b}else{this.mObj.v=new IntegerType(b);return this.mObj.v}};TPAInteger.prototype.DoSet=TPAInteger.prototype.DoSLoadEntry=JInteger.prototype.DoSet=JInteger.prototype.DoSLoadEntry=function(d){this.mObj.v=(d.isNull)?Null:d;if(this.mInputNode!=null){var b;if(d.isNull){this.mDataVal=Null;b=""}else{d=this.ConvertDTForS(d);b=d.toString();if(b==""){this.mDataVal=Null}else{this.mDataVal=d}}this.mPrimVal=b;this.mInputNode.value=b;return}this.SetDirty()};TPAInteger.prototype.Validate=JInteger.prototype.Validate=function(){return Integer_Validate(this,this.G(),this.mObj.min,this.mObj.max)};TPAInteger.prototype.GetSorter=JInteger.prototype.GetSorter=function(){return"(ls=parseInt(lhs),rs=parseInt(rhs),(isNaN(ls)?0:ls)-(isNaN(rs)?0:rs))"};DInteger.prototype.mHaveStoredData=TPAInteger.prototype.mHaveStoredData=JInteger.prototype.mHaveStoredData=true;function Integer_Validate(g,h,d,b){var f=g.IsDirty();if(!f){return null}if(!h.isNull){h=h.toInteger();if(h<d||h>b){return{t:2,n:9272,m:null,a:"Range is "+d+"-"+b+" : "+g.GLabelOrName()}}}return null}DInteger.prototype.HighlightBorder=function(){var b=this.mInputNode.parentNode;b.className+=" bHighlight";getStateMgr_NS(this.windowID).highlightedFlds.push(this.mID)};DInteger.prototype.RemoveHighlightBorder=function(){this.mInputNode.parentNode.className=this.mInputNode.parentNode.className.replace("bHighlight","")};TPAInteger.prototype.DOMMouseOut=DInteger.prototype.DOMMouseOut=function(b,d){hoverState.eventMouseOut(b);if(this.GAccess()!=2){return false}var f=FakeButton_Find(b.element);if(f){if(this instanceof TPAInteger){this.mInputNode=f.parentNode.childNodes[1];this.Spin(0,true,d)}else{this.Spin(0)}}};TPAInteger.prototype.DOMMouseUp=DInteger.prototype.DOMMouseUp=function(b,d){if(this.GAccess()!=2){return false}var f=FakeButton_Find(b.element);if(f){if(this instanceof TPAInteger){this.mInputNode=f.parentNode.childNodes[1];this.Spin(0,true,d)}else{this.Spin(0)}promptBar.setToClear();return ExecuteWorkflow(this.windowID,2,this.mID)}};TPAInteger.prototype.DOMMouseDown=DInteger.prototype.DOMMouseDown=function(b,d){if(this.GAccess()!=2){return false}var f=FakeButton_Find(b.element);if(f){if(this instanceof TPAInteger){this.mInputNode=f.parentNode.childNodes[1];if(f.className.indexOf("spinnerup")!=-1){this.Spin(1,true,d)}else{if(f.className.indexOf("spinnerdown")!=-1){this.Spin(-1,true,d)}}}else{if(f.className.indexOf("spinnerup")!=-1){this.Spin(1,true)}else{if(f.className.indexOf("spinnerdown")!=-1){this.Spin(-1,true)}}}}};TPAInteger.prototype.DOMKeyDown=DInteger.prototype.DOMKeyDown=function(b){if(this.GAccess()!=2){return}var g=b.key;if(g==13||g==16||g==17||b.ctrl){return}var k=/^[\+\-0-9]{0,10}$/;var o=this.mInputNode;var f=(o.getAttribute("arspinner")!=null)?true:false;if(g==8||g==46||g==37||g==39){return}if(g==38||g==40){b.StopDefault();this.Spin((g==38)?1:-1,false)}else{var h="";switch(g){case 189:h="-";break;case 109:h="-";break;case 187:h="+";break;case 107:h="+";break;default:h=String.fromCharCodeWithNumPad(g)}var d=this.mInputNode.value+h;if(f&&!k.test(d)){b.StopDefault()}}};function DInteger_DoSpin(f,b,d){F(b,f).Spin(d,true)}function TPAInteger_DoSpin(h,b,d){var g=F(b,h);if(typeof g.mField!="undefined"){g.mField.Spin(d,true,h)}}DInteger.prototype.Spin=function(d,b){if(d==0){if(this.mSpinTimeout){clearTimeout(this.mSpinTimeout)}}else{if(b){this.mSpinTimeout=setTimeout("DInteger_DoSpin("+this.mID+","+this.windowID+","+d+")",250)}var g=new IntegerType();g.ADD(this.G(),new IntegerType(d));var f=g.toInteger();this.S(g);this.SetSpinnerState(f)}};DInteger.prototype.SetSpinnerState=function(f){if(this.mSpinnerUp&&this.mSpinnerDown){var d=false;var b=false;if(f<=this.min){d=true}if(f>=this.max){b=true}FakeButton_SetDisable(this.mSpinnerDown,d);FakeButton_SetDisable(this.mSpinnerUp,b)}};TPAInteger.prototype.Spin=function(g,b,d){if(g==0){var h=F(this.windowID,d);if((typeof h!="undefined")&&(typeof h.mField!="undefined")&&h.mField.mSpinTimeout){clearTimeout(h.mField.mSpinTimeout)}}else{if(b){this.mSpinTimeout=setTimeout("TPAInteger_DoSpin("+d+","+this.windowID+","+g+")",250)}var k=new IntegerType();k.ADD(this.G(),new IntegerType(g));this.S(k)}};DDate.prototype=new DataField();DDate.prototype.constructor=DDate;DDate.superclass=DataField.prototype;JDate.prototype=new Field();JDate.prototype.constructor=JDate;JDate.superclass=Field.prototype;TPADate.prototype=new Field();TPADate.prototype.constructor=TPADate;TPADate.superclass=Field.prototype;Date.prototype.UnixTimestamp=function(){return Math.floor(this.valueOf()/1000)};DOMFieldFactories.Date=function(b,f,d){return new DDate(b,f,d)};function DDate(g,f,d){if(arguments.length){this.init(g,f,d)}}DDate.prototype.init=function(b,f,d){if(d.className.indexOf("queryFieldInner")!=-1){this.mInputNode=d.firstElementChild;this.windowID=b}else{this.mInputNode=d.childNodes[2]}DDate.superclass.init.call(this,b,f,d)};TPADate.prototype.ConvertPrimitiveToDataType=DDate.prototype.ConvertPrimitiveToDataType=function(f){var b=this.FromUIInput(f,false,false);return b};DDate.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var g=this.mInputNode.value;g=ExpandString(this.windowID,g,2|4,this.mID,13);if(g==""){return Null}var d=Field.GetQBEOperator(g);if(d==null){var b=this.Validate();if(b){throw (b)}return this.G()}else{var f=this.FromUIInput(g.substring(d.length).trim(1),true,false);return new CharType(d+f.toPrimitive())}};TPADate.prototype.FromUIInput=DDate.prototype.FromUIInput=function(g,f,d){if(d){g=ExpandString(this.windowID,g,2|4,this.mID,13)}g=g.trim(1|2);if(g==""){return Null}var b=ARDate.parseDate(g);if(b==null){if(f&&!g.isNumeric()){throw ({t:2,n:9376,m:null,a:this.GLabelOrName()})}g=parseInt(g,10);if(isNaN(g)){g=0}else{if(g<0){g=0}else{if(g>5373120){g=5373120}}}}else{if(f&&b.year==1582&&b.month==9&&(b.date>4&&b.date<15)){throw ({t:2,n:9376,m:null,a:this.GLabelOrName()})}g=b.GDays()}return new DateType(g)};TPADate.prototype.ConvertDTForS=JDate.prototype.ConvertDTForS=DDate.prototype.ConvertDTForS=DDate.prototype.ConvertDTForSLE=function(b){if(b.isNull||b.type==13){return b}else{if(ARKWIsKeywordString(this.windowID,b)){return new CharType(b.toString())}else{b=b.toDate();if(!b.isNull){b.set(b.toInteger())}return b}}};DDate.prototype.Validate=function(){try{return Date_Validate(this,this.FromUIInput(this.mInputNode.value,true,true))}catch(b){b.a=this.GLabel();return b}};DDate.prototype.mHaveStoredData=true;DDate.prototype.mDataType=13;TPADate.prototype.ValidatePopupValue=JDate.prototype.ValidatePopupValue=DDate.prototype.ValidatePopupValue=function(b){b=new DateType(b.GDays());return Date_Validate(this,b)};TPADate.prototype.SetFromPopup=JDate.prototype.SetFromPopup=DDate.prototype.SetFromPopup=function(d){if(this instanceof TPADate){var b=new FormEvent(this.windowID,this.mParentid);b.element=this.mInputNode;getFields_NS(this.windowID)[this.mParentid].FieldValChanged(b,new DateType(d.GDays()));this.DoSet(new DateType(d.GDays()))}else{this.S(new DateType(d.GDays()))}};JFieldFactories.Date=function(b,f,d){return new JDate(b,f,d)};function JDate(g,f,d){if(arguments.length){this.init(g,f,d)}}TPAFieldFactories.Date=function(b,f,d){return new TPADate(b,f,d)};function TPADate(g,f,d){if(arguments.length){this.init(g,f,d)}}TPADate.prototype.G=JDate.prototype.G=function(){var b=this.mObj.v;if(b.isNull||b.type==13){return b}else{if(b.type==4){b=ExpandString(this.windowID,b.toString(),2|4,this.mID,this.mDataType)}this.mObj.v=new DateType(b);return this.mObj.v}};TPADate.prototype.DoSet=JDate.prototype.DoSet=function(d){if(d.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,d)){this.mObj.v=new CharType(d.toString())}else{d=d.toDate();if(!d.isNull){d.set(d.toInteger())}this.mObj.v=d}}if(this.mInputNode!=null){var b;if(this.mObj.v.isNull){b=""}else{b=this.ConvertDTForS(this.mObj.v).toString()}this.mPrimVal=b;this.mInputNode.value=b;return}this.SetDirty()};JDate.prototype.Validate=function(){return Date_Validate(this,this.G())};TPADate.prototype.Validate=function(){try{return Date_Validate(this,this.FromUIInput(this.mInputNode.value,true,true))}catch(b){b.a=this.GLabel();return b}};function Date_Validate(d,f){var b=false;if(typeof d.mLastChanged=="undefined"){b=true}else{b=d.mLastChanged&&getField_LastCleared_NS(d.windowID)<=d.mLastChanged}if(!b){return null}if(!f.isNull){if(f.valueAdjusted){return{t:2,n:9376,m:null,a:d.GLabelOrName()}}}return null}TPADate.prototype.mHaveStoredData=JDate.prototype.mHaveStoredData=true;TPADate.prototype.FieldValChanged=function(b,f){var d;if(f){d=this.ConvertDTForS(f).toString()}else{d=this.GetScreenValAsPrimitive(b)}if(this.mPrimVal==d){return}this.mPrimVal=d;if(d==""){this.mDataVal=(this.mDataType==13)?TimeNull:Null}else{var g={hasKeyword:false,hasTemporalKeyword:false};d=ExpandString(this.windowID,d,2|4,this.mID,this.mDataType,g);if(d==""){if(g.hasKeyword){this.mDataVal=(this.mDataType==13)?TimeNullType.KEYWORD_TIME_NULL:NullType.KEYWORD_NULL}else{this.mDataVal=(this.mDataType==13)?TimerNull:Null}}else{this.mDataVal=this.ConvertPrimitiveToDataType(d)}}f=this.mDataVal;if(f.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,f)){this.mObj.v=new CharType(f.toString())}else{f=f.toDate();if(!f.isNull){f.set(f.toInteger())}this.mObj.v=f}}this.SetDirty();this.SaveGlobalData()};TPADate.prototype.GetScreenValAsPrimitive=function(d){if(this.mInputNode==null){if(d==null){return""}else{var b=d.element.parentNode;this.mInputNode=b.childNodes[2];if(this.mInputNode==null){return""}this.mMaxLen=this.mInputNode.getAttribute("maxlen")}}return this.mInputNode.value};TPADate.prototype.DOMClick=DDate.prototype.DOMClick=function(f){DDate.superclass.DOMClick.call(this,f);if(this.GAccess()==3){return}var h=FakeButton_Find(f.element);if(h){if(h.className.indexOf("expand")!=-1){var d=null;if(this instanceof TPADate){d=h.parentNode;this.mInputNode=d.childNodes[2]}var g=this.GAccess()==1;if(getOpenDIVPopup_NS(this.windowID)&&getOpenDIVPopup_NS(this.windowID).mModal){return}var b=new TimePopup(this,false,true,true,g,d);if(this instanceof TPADate){return b.ShowPopup(h,3,h.offsetHeight+3)}else{return b.ShowPopup(h,0,h.offsetHeight)}}else{this.mInputNode.focus()}}};DTOD.prototype=new DataField();DTOD.prototype.constructor=DTOD;DTOD.superclass=DataField.prototype;JTOD.prototype=new Field();JTOD.prototype.constructor=JTOD;JTOD.superclass=Field.prototype;TPATOD.prototype=new Field();TPATOD.prototype.constructor=TPATOD;TPATOD.superclass=Field.prototype;DOMFieldFactories.TOD=function(b,f,d){return new DTOD(b,f,d)};function DTOD(g,f,d){if(arguments.length){this.init(g,f,d)}}DTOD.prototype.init=function(b,f,d){if(d.className.indexOf("queryFieldInner")!=-1){this.mInputNode=d.firstElementChild;this.windowID=b}else{this.mInputNode=d.childNodes[2]}DTOD.superclass.init.call(this,b,f,d)};TPATOD.prototype.ConvertPrimitiveToDataType=DTOD.prototype.ConvertPrimitiveToDataType=function(b){return this.FromUIInput(b,false,false)};DTOD.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var g=this.mInputNode.value;g=ExpandString(this.windowID,g,2|4,this.mID,14);g=g.trim(1|2);if(g==""){return Null}var d=Field.GetQBEOperator(g);if(d==null){var b=this.Validate();if(b){throw (b)}return this.G()}else{var f=this.FromUIInput(g.substring(d.length).trim(1),true,false);return new CharType(d+f.toPrimitive())}};TPATOD.prototype.FromUIInput=DTOD.prototype.FromUIInput=function(g,f,d){if(d){g=ExpandString(this.windowID,g,2|4,this.mID,14)}g=g.trim(1|2);if(g==""){return Null}var b=ARDate.parseTime(g);if(b==null){if(f&&!g.isNumeric()){throw ({t:2,n:9376,m:null,a:this.GLabelOrName()})}g=parseInt(g,10);if(isNaN(g)){g=0}else{if(g<24){g*=3600}else{if(g>86399){g=86399}}}}else{g=b.GTimeOfDay()}return new TODType(g)};TPATOD.prototype.ConvertDTForS=JTOD.prototype.ConvertDTForS=DTOD.prototype.ConvertDTForS=DTOD.prototype.ConvertDTForSLE=function(b){if(b.isNull||(b.type==14&&!(b instanceof TODKWType))){return b}else{if(ARKWIsKeywordString(this.windowID,b)){return new CharType(b.toString())}else{return b.toTOD()}}};DTOD.prototype.Validate=function(){try{return TOD_Validate(this,this.FromUIInput(this.mInputNode.value,true,true))}catch(b){b.a=this.GLabel();return b}};DTOD.prototype.HandleMenuSelection=function(b){};TPATOD.prototype.ValidatePopupValue=JTOD.prototype.ValidatePopupValue=DTOD.prototype.ValidatePopupValue=function(b){b=new TODType((b.GHour()*3600)+(b.GMinute()*60)+b.GSecond());return TOD_Validate(this,new TODType(b))};TPATOD.prototype.SetFromPopup=JTOD.prototype.SetFromPopup=DTOD.prototype.SetFromPopup=function(d){if(this instanceof TPATOD){var b=new FormEvent(this.windowID,this.mParentid);b.element=this.mInputNode;getFields_NS(this.windowID)[this.mParentid].FieldValChanged(b,new TODType((d.GHour()*3600)+(d.GMinute()*60)+d.GSecond()));this.DoSet(new TODType((d.GHour()*3600)+(d.GMinute()*60)+d.GSecond()))}else{this.S(new TODType((d.GHour()*3600)+(d.GMinute()*60)+d.GSecond()))}};DTOD.prototype.mHaveStoredData=true;DTOD.prototype.mDataType=14;JFieldFactories.TOD=function(b,f,d){return new JTOD(b,f,d)};function JTOD(g,f,d){if(arguments.length){this.init(g,f,d)}}TPAFieldFactories.TOD=function(b,f,d){return new TPATOD(b,f,d)};function TPATOD(g,f,d){if(arguments.length){this.init(g,f,d)}}TPATOD.prototype.G=JTOD.prototype.G=function(){var b=this.mObj.v;if(b.isNull||b.type==14){return b}else{if(b.type==4){b=ExpandString(this.windowID,b.toString(),2|4,this.mID,this.mDataType)}this.mObj.v=new TODType(b);return this.mObj.v}};TPATOD.prototype.DoSet=TPATOD.prototype.DoSLoadEntry=JTOD.prototype.DoSet=JTOD.prototype.DoSLoadEntry=function(d){if(d.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,d)){this.mObj.v=new CharType(d.toString())}else{this.mObj.v=d.toTOD()}}if(this.mInputNode!=null){var b;if(this.mObj.v.isNull){b=""}else{b=this.ConvertDTForS(this.mObj.v).toString()}this.mPrimVal=b;this.mInputNode.value=b;return}this.SetDirty()};JTOD.prototype.Validate=function(){var b=this.G();if(b.isNull){return null}return TOD_Validate(this,b)};TPATOD.prototype.Validate=function(){try{return TOD_Validate(this,this.FromUIInput(this.mInputNode.value,true,true))}catch(b){b.a=this.GLabel();return b}};function TOD_Validate(d,f){var b=false;if(typeof d.mLastChanged=="undefined"){b=true}else{b=d.mLastChanged&&getField_LastCleared_NS(d.windowID)<=d.mLastChanged}if(!b){return null}if(!f.isNull){if(f.valueAdjusted){return{t:2,n:9376,m:null,a:d.GLabelOrName()}}}return null}TPATOD.prototype.mHaveStoredData=JTOD.prototype.mHaveStoredData=true;TPATOD.prototype.FieldValChanged=function(b,f){var d;if(f){d=this.ConvertDTForS(f).toString()}else{d=this.GetScreenValAsPrimitive(b)}if(this.mPrimVal==d){return}this.mPrimVal=d;if(d==""){this.mDataVal=(this.mDataType==14)?TimeNull:Null}else{var g={hasKeyword:false,hasTemporalKeyword:false};d=ExpandString(this.windowID,d,2|4,this.mID,this.mDataType,g);if(d==""){if(g.hasKeyword){this.mDataVal=(this.mDataType==14)?TimeNullType.KEYWORD_TIME_NULL:NullType.KEYWORD_NULL}else{this.mDataVal=(this.mDataType==14)?TimerNull:Null}}else{this.mDataVal=this.ConvertPrimitiveToDataType(d)}}f=this.mDataVal;if(f.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,f)){this.mObj.v=new CharType(f.toString())}else{this.mObj.v=f.toTOD()}}this.SetDirty();this.SaveGlobalData()};TPATOD.prototype.GetScreenValAsPrimitive=function(d){if(this.mInputNode==null){if(d==null){return""}else{var b=d.element.parentNode;this.mInputNode=b.childNodes[2];if(this.mInputNode==null){return""}this.mMaxLen=this.mInputNode.getAttribute("maxlen")}}return this.mInputNode.value};TPATOD.prototype.DOMClick=DTOD.prototype.DOMClick=function(f){DTOD.superclass.DOMClick.call(this,f);if(this.GAccess()==3){return}var h=FakeButton_Find(f.element);if(h){if(h.className.indexOf("expand")!=-1){var d=null;if(this instanceof TPATOD){d=h.parentNode;this.mInputNode=d.childNodes[2]}var g=this.GAccess()==1;if(getOpenDIVPopup_NS(this.windowID)&&getOpenDIVPopup_NS(this.windowID).mModal){return}var b=new TimePopup(this,true,false,false,g,d);if(this instanceof TPATOD){return b.ShowPopup(h,3,h.offsetHeight+3)}else{return b.ShowPopup(h,0,h.offsetHeight)}}else{this.mInputNode.focus()}}};DDecimal.prototype=new DataField();DDecimal.prototype.constructor=DDecimal;DDecimal.superclass=DataField.prototype;JDecimal.prototype=new Field();JDecimal.prototype.constructor=JDecimal;JDecimal.superclass=Field.prototype;TPADecimal.prototype=new Field();TPADecimal.prototype.constructor=TPADecimal;TPADecimal.superclass=Field.prototype;DOMFieldFactories.Decimal=function(b,f,d){return new DDecimal(b,f,d)};function DDecimal(g,f,d){if(arguments.length){this.init(g,f,d)}}DDecimal.prototype.init=function(b,f,d){this.mInputNode=d.childNodes[2];DDecimal.superclass.init.call(this,b,f,d)};DDecimal.prototype.mHaveStoredData=true;DDecimal.prototype.ConvertPrimitiveToDataType=function(b){return this.FromUIInput(b,false,false)};DDecimal.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var g=this.mInputNode.value;g=ExpandString(this.windowID,g,2|4,this.mID,10);g=g.trim(1|2);if(g==""){return Null}var d=Field.GetQBEOperator(g);if(d==null){var b=this.Validate();if(b){throw (b)}return this.G()}else{var f=this.FromUIInput(g.substring(d.length).trim(1),true,false);return new CharType(d+f.toPrimitive())}};DDecimal.prototype.FromUIInput=function(h,g,b){if(b){h=ExpandString(this.windowID,h,2|4,this.mID,10)}h=h.trim(1|2);if(h==""){return Null}h=LCDecimalToEn_US(h,g);var f=parseInt(this.mInputNode.getAttribute("arprecision"));try{h=new BigDecimal(h);if(h.scale()<f){h=h.setScale(f)}}catch(d){if(g){throw ({t:2,n:9374,m:null,a:this.GLabelOrName()})}else{h=new BigDecimal("0")}}return new DecimalType(h,f)};DDecimal.prototype.ConvertDTForS=DDecimal.prototype.ConvertDTForSLE=function(d){if(d.isNull){return d}else{var b=parseInt(this.mInputNode.getAttribute("arprecision"));if(d instanceof DecimalType&&d.mPrecision==b){return d}return new DecimalType(DecimalType.Round(d.toDecimal(),b),b)}};TPADecimal.prototype.GDefault=DDecimal.prototype.GDefault=JDecimal.prototype.GDefault=function(){if("d" in getDefaults_NS(this.windowID)[this.mID]){return(new DecimalType(new BigDecimal(getDefaults_NS(this.windowID)[this.mID].d)))}else{return(Null)}};DDecimal.prototype.mDataType=10;DDecimal.prototype.Validate=function(){var g=this.mInputNode;var d=new BigDecimal(g.getAttribute("armin"));var b=new BigDecimal(g.getAttribute("armax"));try{var h=this.FromUIInput(g.value,true,true);return Decimal_Validate(this,h,d,b)}catch(f){f.a+=": "+this.GLabel();return f}};JFieldFactories.Decimal=function(b,f,d){return new JDecimal(b,f,d)};function JDecimal(g,f,d){if(arguments.length){this.init(g,f,d)}}JDecimal.prototype.init=function(b,f,d){JDecimal.superclass.init.call(this,b,f,d);if(!("p" in this.mObj)){this.mObj.p=2}};TPAFieldFactories.Decimal=function(b,f,d){return new TPADecimal(b,f,d)};function TPADecimal(g,f,d){if(arguments.length){this.init(g,f,d)}}TPADecimal.prototype.init=function(b,f,d){TPADecimal.superclass.init.call(this,b,f,d);if(!("p" in this.mObj)){this.mObj.p=2}};TPADecimal.prototype.mHaveStoredData=JDecimal.prototype.mHaveStoredData=true;TPADecimal.prototype.G=JDecimal.prototype.G=function(){var b=this.mObj.v;if(b instanceof NullType){return b}else{if(b.type==10){b.mPrecision=this.mObj.p;return b}else{this.mObj.v=new DecimalType(b,this.mObj.p);return this.mObj.v}}};TPADecimal.prototype.DoSet=TPADecimal.prototype.DoSLoadEntry=JDecimal.prototype.DoSet=JDecimal.prototype.DoSLoadEntry=function(b){this.mObj.v=(b.isNull)?Null:b;this.SetDirty()};TPADecimal.prototype.Validate=JDecimal.prototype.Validate=function(){var b=this.G();if(b.isNull){return null}return Decimal_Validate(this,b,new BigDecimal(this.mObj.min),new BigDecimal(this.mObj.max))};function Decimal_Validate(g,h,d,b){var f=g.mLastChanged&&getField_LastCleared_NS(g.windowID)<=g.mLastChanged;if(!f||h.isNull){return null}h=h.toDecimal();if(d.compareTo(h)>0||b.compareTo(h)<0){return{t:2,n:9272,m:null,a:""+d+","+b+" : "+g.GLabelOrName()}}return null}DCurrency.prototype=new DataField();DCurrency.prototype.constructor=DCurrency;DCurrency.superclass=DataField.prototype;JCurrency.prototype=new Field();JCurrency.prototype.constructor=JCurrency;JCurrency.superclass=Field.prototype;TPACurrency.prototype=new Field();TPACurrency.prototype.constructor=TPACurrency;TPACurrency.superclass=Field.prototype;CurrencyMenu.prototype=new Menu();CurrencyMenu.prototype.constructor=CurrencyMenu;CurrencyMenu.superclass=Menu.prototype;function CurrencyMenu(d,b){if(arguments.length){this.init(d,b)}}CurrencyMenu.prototype.init=function(d,b){CurrencyMenu.superclass.init.call(this,d.windowID,b);this.mField=d};CurrencyMenu.prototype.Open=function(b){return{n:{f:CurrencyMenu.superclass.Open,t:this,a:[b,3,30100,false]}}};CurrencyMenu.prototype.HandleSelection=function(b){this.mField.HandleMenuSelection(b);promptBar.setToClear();new WorkflowContext(this.windowID,{f:ExecuteWorkflow,a:[this.windowID,2,this.mField.mID]})};DOMFieldFactories.Currency=function(b,f,d){return new DCurrency(b,f,d)};DCurrency.prototype.mIsComplexField=true;function DCurrency(g,f,d){if(arguments.length){this.init(g,f,d)}}DCurrency.prototype.init=function(windowID,id,n){this.mInputNode=n.childNodes[2];var menudef=eval(this.mInputNode.getAttribute("arallowablecur"));this.mAllowable={};if(menudef.length==0){this.mMenuDef=currencyMenu;this.mAllowable=getcurrencyCodes_NS(windowID);for(var i in getcurrencyCodes_NS(windowID)){this.mDefaultCurrency=i;this.mDefaultPrecision=getcurrencyCodes_NS(windowID)[i].p;break}}else{for(var i=0;i<menudef.length;++i){var label="";if(menudef[i].v in getcurrencyCodes_NS(windowID)){label=" - "+getcurrencyCodes_NS(windowID)[menudef[i].v].l}menudef[i].l=menudef[i].v+label.HTMLEncode();this.mAllowable[menudef[i].v]={p:menudef[i].p,l:label};if(menudef[i].d=="1"){this.mDefaultCurrency=menudef[i].v;this.mDefaultPrecision=menudef[i].p}}this.mMenuDef=menudef}if(this.mMenuDef.length==0){this.mDefaultCurrency="";this.mDefaultPrecision=2}menudef=eval(this.mInputNode.getAttribute("arfunctionalcur"));this.mFunctional={};for(var i=0;i<menudef.length;++i){this.mFunctional[menudef[i].v]=menudef[i].p}DCurrency.superclass.init.call(this,windowID,id,n);var hEvents=[16777216,8388608,4194304];hasHoverEvt=false;var evt=null;for(var i=0;i<hEvents.length;i++){idx=i;evt=AREventFunction(windowID,hEvents[i],this.mID);if(evt!=null){hasHoverEvt=true;break}}this.mHasHoverEvt=hasHoverEvt};DCurrency.prototype.ConvertPrimitiveToDataType=function(b){return this.FromUIInput(b,false,false)};DCurrency.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var f=this.mInputNode.value;f=ExpandString(this.windowID,f,2|4,this.mID,12);f=f.trim(1|2);if(f==""){return Null}var b=Field.GetQBEOperator(f);if(b==null){return this.G()}else{var d=this.FromUIInput(f.substring(b.length).trim(1),true,false);return new CharType(b+d.toPrimitive())}};DCurrency.prototype.DoSLoadEntry=function(b){this.mDataVal=b;var d=b.toString();this.mPrimVal=d;this.mInputNode.value=d;this.SetDirty(this.mInputNode)};TPACurrency.prototype.FromUIInput=JCurrency.prototype.FromUIInput=DCurrency.prototype.FromUIInput=function(o,k,f){if(f){o=ExpandString(this.windowID,o,2|4,this.mID,12)}o=o.trim(1|2);if(o==""){return Null}var d=/.*([A-Z][A-Z][A-Z])\s*$/;var b="";if(o.match(d)){b=o.replace(d,"$1")}d=/(.*)[A-Z][A-Z][A-Z]\s*$/;o=o.replace(d,"$1");o=o.trim(1|2);o=LCDecimalToEn_US(o,k);try{o=new BigDecimal(o)}catch(h){if(k){throw ({t:2,n:9374,m:null,a:'"'+o+'"'})}else{o=null}}if(o!=null&&b==""){b=this.mDefaultCurrency}var g=this.GetPrecision(b);o=new CurrencyType(o,g);o.mCurCode=b;if(this.mDate==null||typeof(this.mDate)=="undefined"){this.mDate=new Date().UnixTimestamp()}o.mDate=this.mDate;return o};TPACurrency.prototype.GetPrecision=JCurrency.prototype.GetPrecision=DCurrency.prototype.GetPrecision=function(b){if(b in this.mAllowable){return this.mAllowable[b].p}return 2};TPACurrency.prototype.ConvertDTForS=JCurrency.prototype.ConvertDTForS=DCurrency.prototype.ConvertDTForS=DCurrency.prototype.ConvertDTForSLE=function(d){if(d.type==12){var b=d.mCurCode;if(!b||b==""){b=this.mDefaultCurrency}this.mDate=d.mDate;this.mFunc={};d=new CurrencyType(d,this);d.mValue=((d.mValue==null)?null:DecimalType.Round(d.mValue,d.mPrecision));d.mCurCode=b;d=this.SetFunctionals(d);return d}else{if(d.toString() in this.mAllowable){return new CharType(d.toString())}else{d=d.toCurrency(this);if(d.mValue==null){return Null}if(!d.mCurCode||d.mCurCode==""){d.mCurCode=this.mDefaultCurrency;d.mPrecision=this.mDefaultPrecision}d=this.SetFunctionals(d);return d}}};TPACurrency.prototype.SetFunctionals=JCurrency.prototype.SetFunctionals=DCurrency.prototype.SetFunctionals=function(b){b.mFunc={};for(var d in this.mFunctional){b.mFunc[d]={p:this.mFunctional[d]}}if(!(b.mCurCode in this.mAllowable)){b=b.CurrConvert(this.mDefaultCurrency,b.mDate,this.GetPrecision(this.mDefaultCurrency))}else{b=b.CurrSetDate(b.mDate)}return b};DCurrency.prototype.mHaveStoredData=true;DCurrency.prototype.mDataType=12;TPACurrency.prototype.Validate=JCurrency.prototype.Validate=DCurrency.prototype.Validate=function(){var g=this.mInputNode;if(!g){return null}var d=new BigDecimal(g.getAttribute("armin"));var b=new BigDecimal(g.getAttribute("armax"));try{var h=this.FromUIInput(g.value,true,true);if(h.isNull){return null}return Currency_Validate(this,h,d,b)}catch(f){f.n=9325;f.a+=": "+this.GLabel();return f}};TPACurrency.prototype.GDefault=DCurrency.prototype.GDefault=JCurrency.prototype.GDefault=function(){if("d" in getDefaults_NS(this.windowID)[this.mID]){return new CharType(En_USRealToLC(ExpandString(this.windowID,""+getDefaults_NS(this.windowID)[this.mID].d,2)))}else{if((getARStateCurrent_NS(this.windowID)==1)){var b=ARPrefsGetAsString(20130);if(b){return(this.IsAllowable(b)?new CharType(ARPrefsGetAsString(20130)):Null)}else{if(this.GetInitialCurrency()!=null){return(new CharType(this.GetInitialCurrency()))}}}return Null}};DCurrency.prototype.IsAllowable=function(b){return b in this.mAllowable};TPACurrency.prototype.IsAllowable=JCurrency.prototype.IsAllowable=function(b){return b in this.mObj.a};DCurrency.prototype.GetInitialCurrency=function(){return this.mInputNode.getAttribute("ic")};TPACurrency.prototype.GetInitialCurrency=JCurrency.prototype.GetInitialCurrency=function(){if("ic" in this.mObj){return this.mObj.ic}return null};CurrencyPopup.prototype=new DIVPopup();CurrencyPopup.prototype.constructor=CurrencyPopup;CurrencyPopup.superclass=DIVPopup.prototype;function CurrencyPopup(b){if(arguments.length){this.init(b)}}CurrencyPopup.prototype.PopupStyle="DIVPopupNoHdr";CurrencyPopup.prototype.PopupBodyStyle="DIVPopupBodyNoHdr";CurrencyPopup.prototype.init=function(b){this.mField=b;CurrencyPopup.superclass.init.call(this,b.windowID,true,true,false,false,false);this.SetSize(250,215)};CurrencyPopup.prototype.ShowPopup=function(f,d,b){var h=this.mField.G();var k='<div class="scrollCur"><table class="CurTable">';if(typeof(this.mField.mDate)!="undefined"&&this.mField!=null&&this.mField.mDate>=0&&!h.isNull){var g=new TimeType(this.mField.mDate);k+="<tr><td nowrap colspan=2 height=25px align=top>"+getLocalizedMessage("Value based on {0}",[g.toString()])+"</td></tr>"}for(var s in this.mField.mFunctional){k+="<tr><td class=CurSym>"+s+"</td><td class=CurVal>";if(h.mFunc&&typeof(h.mFunc)=="object"&&s in h.mFunc&&"v" in h.mFunc[s]&&h.mFunc[s].v!=null){var o=DecimalType.Round(h.mFunc[s].v,h.mFunc[s].p);k+=En_USDecimalToLC(o.toString())}k+="</td></tr>"}k+="</table></div>";this.SetContents(null,k);CurrencyPopup.superclass.ShowPopup.call(this,f,d,b,true)};CurrencyPopup.prototype.Buttons=[{t:getLocalizedMessage("Close"),f:"OnClose",id:"ardivpcl"}];CurrencyPopup.prototype.OnClose=function(){this.HidePopup(true)};CurrencyPopup.prototype.HidePopup=function(b){CurrencyPopup.superclass.HidePopup.call(this,true)};CurrencyPopup.prototype.ShowSingle=function(){return false};CurrencyPopup.prototype.GetTitleBarHTML=function(b){return""};TPACurrency.prototype.HandleMenuSelection=DCurrency.prototype.HandleMenuSelection=function(h){h=h.substring(0,3);var g=this.mInputNode.value;g=g.trim(1|2);if(g==""){this.SetScreenValue(h);if(!(this instanceof TPACurrency)){this.SetDirty(this.mInputNode)}return}var b=/(.*)[A-Z,a-z][A-Z,a-z][A-Z,a-z]$/;if(g.match(b)){g=g.replace(b,"$1")}g=g.trim(1|2);try{g=new BigDecimal(LCDecimalToEn_US(g))}catch(d){g=null}if(g!=null){var f=this.mAllowable[h].p;g=new DecimalType(g,f).toString()+" "+h}else{g=h}this.SetScreenValue(g);if(!(this instanceof TPACurrency)){this.SetDirty(this.mInputNode)}};DCurrency.prototype.IsAllowable=function(b){return b in this.mAllowable};JFieldFactories.Currency=function(b,f,d){return new JCurrency(b,f,d)};TPAFieldFactories.Currency=function(b,f,d){return new TPACurrency(b,f,d)};TPACurrency.prototype.mIsComplexField=JCurrency.prototype.mIsComplexField=true;function JCurrency(g,f,d){if(arguments.length){this.init(g,f,d)}}function TPACurrency(g,f,d){if(arguments.length){this.init(g,f,d)}}JCurrency.prototype.init=function(b,g,f){JCurrency.superclass.init.call(this,b,g,f);if(!("p" in this.mObj)){this.mObj.p=2}if(!("a" in this.mObj)){this.mObj.a={};for(var d in getcurrencyCodes_NS(b)){if(!("d" in this.mObj)){this.mObj.d=d}this.mObj.a[d]=getcurrencyCodes_NS(b)[d].p}}};TPACurrency.prototype.init=function(b,g,f){TPACurrency.superclass.init.call(this,b,g,f);if(!("p" in this.mObj)){this.mObj.p=2}if(!("a" in this.mObj)){this.mObj.a={};for(var d in getcurrencyCodes_NS(b)){if(!("d" in this.mObj)){this.mObj.d=d}this.mObj.a[d]=getcurrencyCodes_NS(b)[d].p}}};TPACurrency.prototype.SetScreenValue=JCurrency.prototype.SetScreenValue=function(b){this.mInputNode.value=b;this.FieldValChanged()};TPACurrency.prototype.mHaveStoredData=JCurrency.prototype.mHaveStoredData=true;TPACurrency.prototype.G=JCurrency.prototype.G=function(){var b=this.mObj.v;if(b.isNull){return Null}if(b.type!=12){b=new CurrencyType(b,this,true)}if(b.mCurCode==null||b.mCurCode==""){b.mCurCode=this.mObj.d}if(!(b.mCurCode in this.mObj.a)){return Null}else{this.mObj.v.mFunc={};for(var d in this.mObj.f){this.mObj.v.mFunc[d]={p:this.mObj.f[d]}}b=b.CurrSetDate(b.getDate())}b.mPrecision=this.GetPrecision(b.mCurCode);return b};TPACurrency.prototype.GetDefaultCurrency=JCurrency.prototype.GetDefaultCurrency=function(){return this.mObj.d};TPACurrency.prototype.GetPrecision=JCurrency.prototype.GetPrecision=function(b){if("a" in this.mObj&&b in this.mObj.a){return this.mObj.a[b]}return 2};TPACurrency.prototype.DoSet=TPACurrency.prototype.DoSLoadEntry=JCurrency.prototype.DoSet=JCurrency.prototype.DoSLoadEntry=function(b){this.mObj.v=(b.isNull)?Null:b;if(!(this instanceof TPACurrency)){this.SetDirty()}};TPACurrency.prototype.IsAllowable=JCurrency.prototype.IsAllowable=function(b){return b in this.mObj.a};function Currency_Validate(g,h,d,b){var f=g.mLastChanged&&getField_LastCleared_NS(g.windowID)<=g.mLastChanged;if(!f){return null}var k=h.toDecimal();if(d.compareTo(k)>0||b.compareTo(k)<0){return{t:2,n:9272,m:null,a:""+d+","+b+" : "+g.GLabelOrName()}}if(g.IsAllowable(h.mCurCode)){return null}return{t:2,n:9326,m:null,a:""+g.G().toString()+" : "+g.GLabelOrName()}}var CurrencyRatios={};function GetExchangeRates(f,b){var d=false;if(f in CurrencyRatios&&b in CurrencyRatios[f]){var h=CurrencyRatios[f][b].expires;if(h>new Date().UnixTimestamp()){d=true}}if(d){return CurrencyRatios[f][b]}else{var g;if(getCurWFC_NS(getCurrentWindowID_NS())){g=new NDXGetCurrencyExchangeRates(getCurrentWindowID_NS(),f,b).GetResult()}else{new WorkflowContext(getCurrentWindowID_NS(),{f:function(){g=new NDXGetCurrencyExchangeRates(getCurrentWindowID_NS(),f,b).GetResult()}})}if(!(f in CurrencyRatios)){CurrencyRatios[f]={}}CurrencyRatios[f][b]=g;return g}}DCurrency.prototype.EqualsDefaultValue=function(b){var d=this.GDefault();if(d==null){return false}if((!("d" in getDefaults_NS(this.windowID)[this.mID]))&&d instanceof CharType){return this.mInputNode.value.trim(1|2)==d.toString()}return DCurrency.superclass.EqualsDefaultValue.call(this,b)};TPACurrency.prototype.DOMClick=DCurrency.prototype.DOMClick=function(evt){DCurrency.superclass.DOMClick.call(this,evt);if(this.GAccess()==3){return}var e=FakeButton_Find(evt.element);if(e){if((this instanceof TPACurrency)){this.mInputNode=e.parentNode.childNodes[2];var menudef=eval(this.mInputNode.getAttribute("arallowablecur"));this.mAllowable={};if(menudef.length==0){this.mMenuDef=currencyMenu;this.mAllowable=currencyCodes;for(var i in currencyCodes){this.mDefaultCurrency=i;this.mDefaultPrecision=currencyCodes[i].p;break}}else{for(var i=0;i<menudef.length;++i){var label="";if(menudef[i].v in currencyCodes){label=" - "+currencyCodes[menudef[i].v].l}menudef[i].l=menudef[i].v+label.HTMLEncode();this.mAllowable[menudef[i].v]={p:menudef[i].p,l:label};if(menudef[i].d=="1"){this.mDefaultCurrency=menudef[i].v;this.mDefaultPrecision=menudef[i].p}}this.mMenuDef=menudef}if(this.mMenuDef.length==0){this.mDefaultCurrency="";this.mDefaultPrecision=2}menudef=eval(this.mInputNode.getAttribute("arfunctionalcur"));this.mFunctional={};for(var i=0;i<menudef.length;++i){this.mFunctional[menudef[i].v]=menudef[i].p}}if(e.className.indexOf("menu")!=-1&&this.GAccess()!=1){if(!this.mMenu){var menudef=this.mMenuDef;var uimenudef=[];for(var i=0;i<menudef.length;++i){uimenudef.push({v:menudef[i].l,l:menudef[i].l})}this.mMenu=new CurrencyMenu(this,uimenudef);if(this instanceof TPACurrency){this.mMenu.mXAdjust=3;this.mMenu.mYAdjust=3}}return{n:{f:this.mMenu.Open,t:this.mMenu,a:[e]}}}else{if(e.className.indexOf("expand")!=-1){if(this instanceof TPACurrency){if(this.Validate()==null){try{var val=this.FromUIInput(this.mInputNode.value,true,true);if(val.isNull){val=this.G()}this.S(val)}catch(err){return}}}else{if(this.Validate()==null){this.S(this.G())}}if(this instanceof TPACurrency){new CurrencyPopup(this).ShowPopup(e,3,e.offsetHeight+3)}else{new CurrencyPopup(this).ShowPopup(e,0,e.offsetHeight)}}else{this.mInputNode.focus()}}}};DCurrency.prototype.DOMMouseOver=function(b){DCurrency.superclass.DOMMouseOver.call(this,b);if(this.mHasHoverEvt){return}var g=b.element;while(g&&!(g.tagName=="INPUT")){g=g.offsetParent}if(g!=null){var h=this.mInputNode.value;var d=/^(.*)([A-Z][A-Z][A-Z])$/;if(h.match(d)){var f=h.replace(d,"$2");if(f in this.mAllowable){g.setAttribute("title",h.replace(d,"$1")+" "+this.mAllowable[f].l)}else{g.setAttribute("title",h)}}else{g.setAttribute("title",h)}}};DCurrency.prototype.DOMBlur=function(b){if(this.Validate()==null){var d=this.G();if(!d.isNull){this.S(d)}}return DCurrency.superclass.DOMBlur.call(this,b)};DDiary.prototype=new DataField();DDiary.prototype.constructor=DDiary;DDiary.superclass=DataField.prototype;DOMFieldFactories.Diary=function(b,f,d){return new DDiary(b,f,d)};function DDiary(g,f,d){if(arguments.length){this.init(g,f,d)}getFormContext(g).DiaryFields.push(this)}DDiary.prototype.init=function(b,g,f){this.mInputNode=f.childNodes[2];this.mbShowURL=(this.mInputNode.getAttribute("arshowurl")!=null)?true:false;DDiary.superclass.init.call(this,b,g,f);if(this.mbShowURL){var d=this.mObj;d=d.firstChild;while(1){if(d.nodeType==1&&d.tagName=="DIV"&&d.className.indexOf("text")!=-1){break}if(!d.nextSibling){break}d=d.nextSibling}this.mDivEditBox=d;this.mDivEditBox.dir="ltr";this.mInputNode.onblur=DChar.convert}};DDiary.prototype.ConvertPrimitiveToDataType=JDiary.prototype.ConvertPrimitiveToDataType=function(b){return new CharType(b)};DDiary.prototype.FromUIInput=function(f,d,b){if(b){f=ExpandString(this.windowID,f,2|4,this.mID,10)}f=f.trim(1|2);if(f==""){return Null}return new CharType(f)};DDiary.prototype.SetHistory=function(b){if(this.mHistory!=b){this.UpdateExpandImage(b!=null);this.mHistory=b;if(this.mCharEditBox&&this.mCharEditBox.mDiv){CharEditBoxPopup_UpdateHistory(this.mCharEditBox,b==null?"":b)}}};DDiary.prototype.DoSLoadEntry=function(b){if(b.isNull){this.SetHistory(null)}DDiary.superclass.DoSLoadEntry.call(this,b)};DDiary.prototype.ConvertDTForSLE=function(b){this.mDeferred=false;if(b instanceof DiaryType){this.SetHistory(b.toString());if(((getARStateCurrent_NS(this.windowID)==1||getARStateCurrent_NS(this.windowID)==4)&&ARPrefsGetAsNumber(20101)==2)){return this.G()}else{return CharNull}}this.SetHistory(null);return this.ConvertDTForS(b)};DDiary.prototype.ConvertDTForS=function(b){if(b.type==4){return b}return new CharType(b.toString())};DDiary.prototype.GDefault=function(){var b=DDiary.superclass.GDefault.call(this);this.SetHistory(null);return b};DDiary.prototype.Clear=function(){var b=this.mID;if((b>=1000000&&b<=1999999)||(b>=3000000&&b<=3999999)||b==1576||b==1575){return}DDiary.superclass.Clear.call(this);this.SetHistory(null)};DDiary.prototype.mHaveStoredData=true;DDiary.prototype.GetHistory=function(){if(!this.mDeferred){return this.mHistory}var b=getCurWFC_NS(this.windowID).notes;getCurWFC_NS(this.windowID).notes=[];var g=new NDXGetEntry(this.windowID,this.mServer,this.mSchema,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),window.name,this.mEntry,[this.mID],false);var f=g.result;getCurWFC_NS(this.windowID).notes=b;this.mHistory="";if(f instanceof Array){if(f.length>0){for(var d=0;d<f.length;d++){if(f[d].t){if(f[d].t==5){this.SetHistory(f[d].v);break}}}}}this.mDeferred=false;return this.mHistory};DDiary.prototype.GTrim=JDiary.prototype.GTrim=function(){var d=this.G();if(d==CharNull||d.isNull){return d}var b=d.toPrimitive();if(b==""){return CharNull}b=b.trim(1|2);if(b==""){return CharNull}return this.ConvertPrimitiveToDataType(b)};DDiary.prototype.mDataType=4;JDiary.prototype=new Field();JDiary.prototype.constructor=JDiary;JDiary.superclass=Field.prototype;function JDiary(g,f,d){if(arguments.length){this.init(g,f,d)}getFormContext(g).DiaryFields.push(this)}JDiary.prototype.mHaveStoredData=true;JDiary.prototype.G=function(){if(this.mDeferred){var f=new NDXGetEntry(this.windowID,this.mServer,this.mSchema,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),window.name,this.mEntry,[this.mID],false);var b=f.result;if(b instanceof Array){if(b.length>0){var d=Datatype_Factory(b[0]);this.SLoadEntry(d)}}else{}this.mDeferred=false}var g=this.mObj.v;if(g.isNull||g.toString()==""){return CharNull}else{if(g.type==4){return g}else{this.mObj.v=new CharType(g);return this.mObj.v}}};JDiary.prototype.DoSLoadEntry=function(b){if(b instanceof DiaryType){this.mObj.v=Null}else{this.mObj.v=b}this.mDeferred=false};JDiary.prototype.Clear=function(){this.mDeferred=false;JDiary.superclass.Clear.call(this)};JDiary.prototype.DoSet=function(d){var f={hasKeyword:false,hasTemporalKeyword:false};var b=ExpandString(this.windowID,d.toString(),2|4|8,this.mID,this.mDataType,f);if(f.hasTemporalKeyword){this.mObj.v=(d.isNull)?CharNull:d}else{if((this.mDataType==4)&&!f.hasKeyword){this.mObj.v=(d.isNull)?CharNull:d}else{this.mObj.v=new CharType(b)}}this.SetDirty();this.mDeferred=false};DDiary.prototype.mDeferred=JDiary.prototype.mDeferred=false;DDiary.prototype.Defer=function(f,d,b){if(this.mID in getForm_NS(this.windowID).displayOnlyFields){this.mDeferred=false;return}if(!((getARStateCurrent_NS(this.windowID)==1||getARStateCurrent_NS(this.windowID)==4)&&ARPrefsGetAsNumber(20101)==2)){this.S(Null)}this.mHistory="";this.mServer=f;this.mSchema=d;this.mEntry=b;this.mDeferred=true;this.UpdateExpandImage(true)};JDiary.prototype.Defer=function(f,d,b){if(this.mID in getForm_NS(this.windowID).displayOnlyFields){this.mDeferred=false;return}this.S(Null);this.mServer=f;this.mSchema=d;this.mEntry=b;this.mDeferred=true};DDiary.SetDiaryFieldsDeferred=function(b,k,g,d){for(var h in getFormContext(b).DiaryFields){getFormContext(b).DiaryFields[h].Defer(k,g,d)}};DDiary.prototype.SetValue=function(b){if(b&&b.length>0){this.mInputNode.value=b;convertPlainToFormattedText(b,this.mDivEditBox);this.mDivEditBox.style.visibility="visible";this.mInputNode.style.visibility="hidden"}else{this.mInputNode.value=b;this.mDivEditBox.innerHTML="";this.mDivEditBox.style.visibility="hidden";this.mInputNode.style.visibility=""}this.mPrimVal=b};DDiary.prototype.GetValue=function(){if(this.mDivEditBox&&this.mDivEditBox.style.visibility=="visible"){return this.innerText()}return this.mInputNode.value};DDiary.prototype.updateInnerHTML=function(g){var f=this.mDivEditBox;f.innerHTML=g;var b=f.getElementsByTagName("a");for(var d=0;d<b.length;d++){if(f.contentEditable=="true"){b[d].onmouseover=function(){f.contentEditable=false};b[d].onmouseout=function(){f.contentEditable=true}}b[d].target="_blank";b[d].href=b[d].innerHTML}this.FieldValChanged()};DDiary.prototype.innerText=function(){return getInnerText(this.mDivEditBox)};DDiary.prototype.TabableElementSelector=function(b){if((b.tagName=="A"&&b.className&&b.className.indexOf("btn")>=0)||b.tagName=="INPUT"||b.tagName=="TEXTAREA"){if(!b.style||b.style.visibility!="hidden"){return b}}return null};DDiary.prototype.UpdateROColour=function(){if(this.mbShowURL){this.mInputNode.style.backgroundColor=getARFieldROBg_NS(this.windowID);this.mDivEditBox.style.backgroundColor=getARFieldROBg_NS(this.windowID)}else{DDiary.superclass.UpdateROColour.call(this)}};DDiary.prototype.UpdateAccess=function(f){if(this.mbShowURL){var d=f==3,b=f==1;var g=this.mObj;g.className=g.className.replace(SACCESSRE,"");if(d){g.className+=" dfd"}this.mDivEditBox.style.backgroundColor=(b?getARFieldROBg_NS(this.windowID):"");this.mInputNode.disabled=d;this.mInputNode.readOnly=b;this.mInputNode.style.backgroundColor=(b?getARFieldROBg_NS(this.windowID):"")}else{DDiary.superclass.UpdateAccess.call(this,f)}};DDiary.prototype.DOMClick=function(b){DDiary.superclass.DOMClick.call(this,b);if(this.GAccess()==3){return}var d=FakeButton_Find(b.element);if(d){if(d.className.indexOf("diary")!=-1){if(!this.mCharEditBox){this.mCharEditBox=new CharEditPopup(this);this.mCharEditBox.SetOrigin(b);this.mCharEditBox.SetContents();this.mCharEditBox.ShowPopup(d,0,d.offsetHeight,true)}else{this.mCharEditBox.SetFocus()}}}};DDiary.prototype.DOMKeyPress=function(b){if(b.key==13){if(b.shift||(this.mInputNode.getAttribute("Rows")==1)){b.StopDefault();return{c:{t:this,f:DDiary.superclass.DOMKeyPress,a:[b]}}}else{}}};DDiary.prototype.UpdateExpandImage=function(b){var d=this.mObj.firstChild;while(d&&(!d.childNodes[1]||d.childNodes[1].tagName!="IMG")){d=d.nextSibling}if(d){d=d.childNodes[1];if(b){d.src=d.src.replace(/diary_empty/,"diary_full")}else{d.src=d.src.replace(/diary_full/,"diary_empty")}}};DReal.prototype=new DataField();DReal.prototype.constructor=DReal;DReal.superclass=DataField.prototype;JReal.prototype=new Field();JReal.prototype.constructor=JReal;JReal.superclass=Field.prototype;TPAReal.prototype=new Field();TPAReal.prototype.constructor=TPAReal;TPAReal.superclass=Field.prototype;DOMFieldFactories.Real=function(b,f,d){return new DReal(b,f,d)};function DReal(b,f,d){if(arguments.length){this.init(b,f,d)}}DReal.prototype.init=function(b,f,d){this.mInputNode=d.childNodes[2];DReal.superclass.init.call(this,b,f,d)};DReal.prototype.mHaveStoredData=true;DReal.prototype.mDataType=3;DReal.prototype.ConvertPrimitiveToDataType=function(b){return this.FromUIInput(b,false,false)};DReal.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var g=this.mInputNode.value;g=ExpandString(this.windowID,g,2|4,this.mID,3);g=g.trim(1|2);if(g==""){return Null}var d=Field.GetQBEOperator(g);if(d==null){var b=this.Validate();if(b){throw (b)}return this.G()}else{var f=this.FromUIInput(g.substring(d.length).trim(1),true,false);return new CharType(d+f.toPrimitive())}};DReal.prototype.ConvertDTForS=DReal.prototype.ConvertDTForSLE=function(d){var b=parseInt(this.mInputNode.getAttribute("arprecision"));if((d.type==3)&&d.mPrecision==b){return d}return new RealType(d.toReal(),b)};TPAReal.prototype.GDefault=DReal.prototype.GDefault=JReal.prototype.GDefault=function(){if("d" in getDefaults_NS(this.windowID)[this.mID]){return(new RealType(getDefaults_NS(this.windowID)[this.mID].d))}else{return(Null)}};DReal.prototype.FromUIInput=function(f,d,b){if(b){f=ExpandString(this.windowID,f,2|4,this.mID,3)}f=f.trim(1|2);if(f==""){return Null}return new RealType(LCRealToEn_US(f,d),parseInt(this.mInputNode.getAttribute("arprecision")))};DReal.prototype.Validate=function(){var g=this.mInputNode;var d=g.getAttribute("armin");var b=g.getAttribute("armax");try{var h=this.FromUIInput(g.value,true,true);return Real_Validate(this,h,d,b)}catch(f){f.a+=": "+this.GLabel();return f}};JFieldFactories.Real=function(b,f,d){return new JReal(b,f,d)};function JReal(g,f,d){if(arguments.length){this.init(g,f,d)}}JReal.prototype.init=function(b,f,d){JReal.superclass.init.call(this,b,f,d);if(!("p" in this.mObj)){this.mObj.p=6}};TPAFieldFactories.Real=function(b,f,d){return new TPAReal(b,f,d)};function TPAReal(g,f,d){if(arguments.length){this.init(g,f,d)}}TPAReal.prototype.init=function(b,f,d){TPAReal.superclass.init.call(this,b,f,d);if(!("p" in this.mObj)){this.mObj.p=6}};TPAReal.prototype.mHaveStoredData=JReal.prototype.mHaveStoredData=true;TPAReal.prototype.G=JReal.prototype.G=function(){var b=this.mObj.v;if(b instanceof NullType){return b}else{if(b.type==3){b.mPrecision=this.mObj.p;return b}else{this.mObj.v=new RealType(b,this.mObj.p);return this.mObj.v}}};TPAReal.prototype.DoSet=TPAReal.prototype.DoSLoadEntry=JReal.prototype.DoSet=JReal.prototype.DoSLoadEntry=function(b){this.mObj.v=(b.isNull)?Null:b;this.SetDirty()};TPAReal.prototype.Validate=JReal.prototype.Validate=function(){var b=this.G();if(b.isNull){return null}return Real_Validate(this,b,this.mObj.min,this.mObj.max)};function Real_Validate(g,h,d,b){var f=g.IsDirty();if(!f||h.isNull){return null}h=h.toReal();if(h<d||h>b){return{t:2,n:9272,m:null,a:""+d+","+b+" : "+g.GLabelOrName()}}return null}AsyncField.prototype=new Field();AsyncField.prototype.constructor=AsyncField;AsyncField.superclass=Field.prototype;function AsyncField(b,f,d){if(arguments.length){this.init(b,f,d)}}AsyncField.prototype.init=function(f,o,k){AsyncField.superclass.init.call(this,f,o,k);this.mAsyncMode=0;this.mAsyncDirty=0;this.mUIInstantiated=false;this.mAsyncQueue=[];this.SetAsync(1);if(k.style.visibility=="hidden"||k.style.display=="none"){if(!(this instanceof DPageHolder&&this.mFloat==2)){this.SetAsync(1)}}var b=true;var d=null;d=k.parentNode;while(d&&b){if(d.nodeType==1&&d.getAttribute("arid")){b=false}else{d=d.parentNode}}this.mParentField=null;if(!b){var g=d.getAttribute("arid");var h=F(f,g);if(h instanceof DPage){this.mParentField=g;if(!h.IsVisible()){this.SetAsync(1)}if(h.mState==0){this.SetAsync(1)}}}this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty);getAsyncFields_NS(f).push(this)};AsyncField.prototype.SetAsync=function(b){if(this.mAsyncMode==0&&b==1){this.mAsyncDirty=0}else{if(this.mAsyncMode==1&&b==-1){this.FlushAsyncQueue()}}this.mAsyncMode+=b};AsyncField.prototype.FlushAsyncQueue=function(){};function AsyncField_IncrAsyncRef(b,h,g){var f=getAsyncFields_NS(b);for(var d in f){if(f[d].mParentField==h){f[d].SetAsync(g)}}}function AsyncField_DecrAsyncRef(b){var f=getAsyncFields_NS(b);for(var d in f){f[d].SetAsync(-1)}}BaseTable.prototype=new AsyncField();BaseTable.prototype.constructor=BaseTable;BaseTable.superclass=AsyncField.prototype;BaseTable.prototype.mFtrObj=BaseTable.prototype.mHdrObj=BaseTable.prototype.mHdrLObj=BaseTable.prototype.mFtrLObj=BaseTable.prototype.mHdrRObj=BaseTable.prototype.mInnerObj=BaseTable.prototype.mChunkOuter=BaseTable.prototype.mFtrRObj=BaseTable.prototype.mColHdrObj=BaseTable.prototype.mDataTableObj=null;BaseTable.prototype.mDOMField=BaseTable.prototype.mHaveVisualCharacteristics=true;BaseTable.prototype.mDirtyColumns=false;BTColData.prototype.mWidth=BTColData.prototype.mOrgWidth=BTColData.prototype.mBarX=BTColData.prototype.mX=0;BTColData.prototype.mHeader=BTColData.prototype.mBar=BTColData.prototype.mColumn=BTColData.prototype.mType=null;BTColData.prototype.mSortDir=1;BTColData.prototype.mPrimarySort=false;BTColData.prototype.mVisible=true;function BTColData(b){this.mDataCol=b}BTColData.prototype.SetVisibility=function(d,b){if(d==this.mVisible){return}if(b.mFixedHeader){this.mHeader.style.visibility=(d?"inherit":"hidden");this.mBar.style.visibility=(d?"inherit":"hidden")}this.mPrimarySort=false;this.mVisible=d};BaseTable.prototype.RestoreColData=function(d){if(!d instanceof Array||d.length!=this.mColDatas.length){return}var h={};var g={};for(var f in d){if(!(f in this.mColDatas)){return}var b=d[f];if(!("dc" in b)||!(b.dc in this.mColDatas)||!("w" in b)||!("ps" in b)||!("sd" in b)){return}h[this.mColDatas[f].mDataCol]=this.mColDatas[f].mVisible;g[this.mColDatas[f].mDataCol]=this.mColDatas[f].mHeader}for(var f in d){this.mColDatas[f].mDataCol=d[f].dc;this.mColDatas[f].mWidth=d[f].w;this.mColDatas[f].mOrgWidth=0;this.mColDatas[f].mPrimarySort=d[f].ps;this.mColDatas[f].mSortDir=d[f].sd;this.mColDatas[f].mVisible=h[d[f].dc];this.mColDatas[f].mHeader=g[f];this.mColDatas[f].SetLabel(this.mColInfo[f].heading);this.mColDatas[f].mType=this.mColFields[f].mObj.t}if(!this.mHScroll){this.ScaleSizes()}this.mFirstLayout=true;this.ApplyData()};BaseTable.prototype.ResetColData=function(){var d=[],g=this.GetInitialColumnWidths();for(var f in this.mColDatas){var b=g[f]<0?0:g[f];d[f]={dc:parseInt(f),w:b,ps:false,sd:-1}}this.mSortOrder=[];this.RestoreColData(d)};BaseTable.prototype.GetColData=function(){var d=[];for(var b in this.mColDatas){var f=this.mColDatas[b];d[b]={dc:f.mDataCol,w:f[b].mWidth,ps:f.mPrimarySort,sd:f.mSortDir}}return d};BaseTable.prototype.SColVis=function(b,f){for(var d=0;d<this.mColCnt;++d){if(this.mColDatas[d].mDataCol==b){this.mColDatas[d].SetVisibility(f,this);this.mDirtyColumns=true;return}}};BaseTable.prototype.SColLabel=function(b,f){for(var d in this.mColDatas){if(this.mColDatas[d].mDataCol==b){this.mColDatas[d].SetLabel(f);this.mDirtyColumns=true;return}}};BaseTable.prototype.ScaleSizes=function(){var h=0,g=false,s=1,o=0,d=0;var u=[];for(var k in this.mColDatas){u[k]=1;o=this.mColDatas[k].mOrgWidth-this.mColDatas[k].mWidth;if(o<0){o=-o}if(this.mColDatas[k].mWidth<=1&&this.mColDatas[k].mWidth>0){u[k]=u[k]|2}if(o<1&&this.mColDatas[k].mOrgWidth>0){this.mColDatas[k].mWidth=this.mColDatas[k].mOrgWidth}else{if(this.mColDatas[k].mWidth<=0){u[k]=0;this.mColDatas[k].mWidth=this.mColDatas[k].mOrgWidth}else{this.mColDatas[k].mOrgWidth=this.mColDatas[k].mWidth}}}for(var k in this.mColDatas){if(this.mColDatas[k].mVisible&&(u[k]&1)==1){if(k==0){d=1}h+=this.mColDatas[k].mWidth}}var b=this.mInner.clientWidth?(this.mInner.offsetWidth-this.mInner.clientWidth):0;if(this.colCheck==1){b=b+25}if(this.mGroup&&d==1){b=b+16}s=(this.mWidth-b)/h;if(this.mWidth<(this.mColDatas.length*5)){return}var v=0;for(var k in this.mColDatas){var f=this.mColDatas[k];f.mOrgWidth=f.mWidth*s;f.mWidth=Math.floor(f.mOrgWidth);v=v+(f.mOrgWidth-f.mWidth);if((v>=1)||(k==this.mColDatas.length-1&&v>=0.5)){f.mWidth=f.mWidth+1;v=v-1}if(u[k]==0){f.mWidth=0}if((u[k]&2)==2&&f.mWidth<1){v=v-1+f.mWidth;f.mWidth=1}}};function BaseTable(g,k,h,f,d){if(arguments.length){this.init(g,k,h,f,d)}}BaseTable.prototype.MakeTableTitle=function(d){var b=this.GLabel();if(b==null){b=""}return b};function BaseTable_OnScroll(b){var d=Field_FromElement(b.element);if(d){d.UpdateScrollOffset();if(typeof rtfEditor!="undefined"&&rtfEditor!=null&&rtfEditor.mEditing!=null){rtfEditor.UpdatePos()}}}BaseTable.prototype.init=function(f,d,o,h,g,b){BaseTable.superclass.init.call(this,f,d,o);this.mSelRow=g;this.mCurrentCol=-1;this.mParent=null;this.mFixedHeader=h;this.mRowsPresent=0;this.mFirstLayout=true;this.mHScroll=b;this.mAccHScroll=false;this.mColDragInfo=null;this.mLastNonShiftedRowSelection=this.mLastRowSelection=-1;this.mPrimaryRowSelection=this.mARRowSelection=null;this.mRowSelections=[];this.mColDatas=[];this.mMouseUpRowSelection=-1;this.mMouseUpColSelection=-1;var s=this.GetColumnInfo();this.mColCnt=s.length;for(var k=0;k<this.mColCnt;++k){this.mColDatas.push(new BTColData(k));if(this.mColFields){this.mColDatas[k].mType=this.mColFields[k].mObj.t}}};BaseTable.prototype.getHoverEvtList=function(){return[16777216,8388608,4194304]};BaseTable.prototype.hoverEvtonChildren=function(){var f=false;for(var d=0;d<this.mColFields.length;d++){var b=AREventFunction(this.windowID,16777216,this.mColFields[d].mID);if(b!=null){f=true;break}}return f};BaseTable.prototype.Unload=function(){};BaseTable.prototype.MultiSelected=function(){for(var b in this.mLastRowSelections){if(this.mLastRowSelections[b]!="SelPrimary"){return true}}return false};BaseTable.prototype.SecondarySelected=function(d){for(var b in this.mLastRowSelections){if(b==d){if(this.mLastRowSelections[b]=="SelSecondary"){return true}}}return false};BaseTable.prototype.actList=function(){var d=new Array();for(var b=0;b<arguments.length;b++){d.push(arguments[b])}return d};BaseTable.prototype.SynchRLDetails=function(){if(this.mPrimaryRowSelection==null){Field_Clear(this.windowID,true);Field_ClearChanged(this.windowID);formDisableStuff(this.windowID)}else{formEnableStuff(this.windowID)}};BaseTable.prototype.MapUIXToData=function(f){var d=0,b=0;for(;b<this.mColDatas.length;++b){if(this.mColDatas[b].mVisible){++d}if(d==f+1){break}}if(d!=f+1){return null}return this.mColDatas[b].mDataCol};BaseTable.prototype.TagFromRowNo=function(b){return b};BaseTable.prototype.RowNoFromTag=function(b){return parseInt(b)};BaseTable.prototype.ARRowSelected=function(g,f,k,h){};BaseTable.prototype.ARRowCleared=function(){};BaseTable.prototype.ARDrillDown=function(f,d){};BaseTable.prototype.SetPrimarySelection=function(g,f,d,s){if(this.GetData().length<=0){return}var o=this.mARRowSelection;var k=this.mPrimaryRowSelection;if(s){this.ClearSelections(true)}var b=this.TagFromRowNo(g);this.mRowSelections[b]=true;this.mPrimaryRowSelection=b;this.mLastNonShiftedRowSelection=g;this.mARRowSelection=g+1;this.mLastRowSelection=g;if(typeof DTreeView!="undefined"&&this instanceof DTreeView){this.mRow=g}var h=false;if(k==this.mPrimaryRowSelection){h=true}if(h==false){this.Clearoutfields()}return{n:{t:this,a:[f,d,o,h],f:this.ARRowSelected}}};BaseTable.prototype.ClearSelections=function(b){this.mRowSelections=[];this.mPrimaryRowSelection=null;if(b){this.mLastNonShiftedRowSelection=-1;this.mARRowSelection=0;this.ARRowCleared()}};BaseTable.prototype.EORSelections=function(u,g,k){var d=this.TagFromRowNo(u);this.mLastNonShiftedRowSelection=u;if(d in this.mRowSelections&&!g){var o=0;for(var h in this.mRowSelections){o++}delete this.mRowSelections[d];o--;if(d==this.mPrimaryRowSelection&&o>0){var f=null;for(var h in this.mRowSelections){f=h;break}if(f!=null){var s=this.RowNoFromTag(f);this.mARRowSelection=s+1;return{c:{f:this.SetPrimarySelection,t:this,a:[s,true,true,false]}}}}if(o==0){this.ClearSelections(true)}}else{this.mRowSelections[d]=true;var b=this.mARRowSelection;var o=0;for(var h in this.mRowSelections){o++}if(o==1){this.mARRowSelection=u+1;return{c:{f:this.SetPrimarySelection,t:this,a:[u,true,true,true]}}}}};BaseTable.prototype.FillSelections=function(f,k,d,g){if(g){this.ClearSelections(false)}this.mLastRowSelection=f;if(k>=0){var h=(f<k?-1:1),b=false;while(!b){this.mRowSelections[this.TagFromRowNo(k)]=true;k+=h;b=(h==-1)?k<f:k>f}}else{this.mLastNonShiftedRowSelection=d}if(this.mPrimaryRowSelection!=null){delete this.mRowSelections[this.mPrimaryRowSelection]}this.mPrimaryRowSelection=this.TagFromRowNo(d)};BaseTable.prototype.FillAllSelections=function(){if(this.GetData().length==0){return}this.mLevel=-1;var d=this.mARRowSelection;var b=[];b.push({t:this,f:function(){var f=this.mCurrentRow;var g=(this.mPrimaryRowSelection==null)?true:false;if(g){f=0}else{this.mPrimaryRowSelection=null}this.FillSelections(this.GetData().length-1,0,f,true);if(g){this.mARRowSelection=1}}});return{n:b}};BaseTable.prototype.Resort=function(d,b){this.ApplyData()};BaseTable.prototype.SetDefaultSizes=function(){var f=this.mColDatas,d=this.GetInitialColumnWidths();for(var b=0;b<this.mColCnt;++b){f[b].mWidth=(d[b]<0?0:d[b]);if(b==this.mColCnt-1&&this.mHScroll&&f[b].mWidth>0*2){f[b].mWidth-=0}}};BaseTable.prototype.getTemplateForField=function(b){return};BaseTable.prototype.getTemplateHeightForField=function(b){return};BaseTable.prototype.getFieldIDForColumn=function(b){return};BaseTable.prototype.hasImgRefs=function(){return false};BaseTable.prototype.hasVisImgRefs=function(){return false};BaseTable.prototype.getVisImgRefs=function(b){return[]};BaseTable.prototype.hasCellColor=function(){return false};BaseTable.prototype.getCellColor=function(f){var d=[];for(var b=0;b<this.mColCnt;++b){if(this.mColDatas[b].mVisible){d[b]=""}}return d};BaseTable.prototype.addRowToData=function(g){var b=this.mResult.f.length;var o=genUniqueId(this);var k={i:o,d:[],rc:-1};if(b>0){for(var f=0;f<b-1;f++){k.d.push({v:"",t:0,p:""})}if(this instanceof DTreeView){k.d.push({v:"&nbsp;",t:0,p:""})}else{k.d.push({v:"",t:0,p:""})}}var d={},h=0;if(g==(this.GetData().length+1)){this.mResult.idmap[o]=g-1}else{for(f in this.mResult.idmap){if(h<g-1){h++;d[f]=this.RowNoFromTag(f)}else{if(h==g-1){d[o]=h;d[f]=++h;h++}else{if(h>g-1){d[f]=h++}}}}this.mResult.idmap=d}if(this.mResult.r.length==0){this.mResult.r[0]=k}else{this.mResult.r.splice(g-1,0,k)}this.mResult.r[g-1].mXXXDirty=2};function genUniqueId(b){if(!b.mNextIdx){b.mNextIdx=b.GetData().length}return"rid_"+b.mNextIdx++}function getImgRefStrAuto(d,h,k){var f=F(d,h);if(f==null){return""}if(((typeof DTreeView!="undefined")&&(typeof DTable!="undefined"))&&(f instanceof DTable||f instanceof DTreeView)){var v=f.mARRowSelection;if(v!=null&&v!=0){if(f.mResult!=undefined){var g=f.mResult.r[v-1];if(g!=null&&(!g.mXXXDirty||g.mXXXDirty!=3)&&g.irv!=undefined){var u=F(d,k);if(u instanceof JColumn&&u.hasImgRef()){var s=u.getImgFid();var b=g.irv[s];if(b==""){b=-1}var o=u.getImgURL(b);if(o==null){o=""}return o}}}}}return""}function getCellColorAuto(d,h,k){var f=F(d,h);if(f==null){return""}if(typeof DTable!="undefined"&&f instanceof DTable){var v=f.mARRowSelection;if(v!=null&&v!=0){if(f.mResult!=undefined){var g=f.mResult.r[v-1];if(g!=null&&(!g.mXXXDirty||g.mXXXDirty!=3)&&g.ccV!=undefined){var u=F(d,k);if(u instanceof JColumn&&u.hasCellColor()){var s=u.getCColorFid();var o=g.ccV[s];if(o==""){o=-1}var b=u.getCColor(o);if(b==null){b=""}return b}}}}}return""}BaseTable.prototype.hasCellColor=function(){return false};BaseTable.prototype.getImgRefIds=function(){return new Array()};BaseTable.prototype.getCColorIds=function(){return new Array()};function getImgRefRootStrAuto(b,d){var f=F(b,d);if(f==null){return""}if(typeof DTreeView!="undefined"&&f instanceof DTreeView){var g=f.getRootImgURL();if(g==null){return""}else{return g}}return""}BaseTable.prototype.initResults=function(){this.mResult={};this.mResult.f=new Array();for(var d=0;d<this.mColFields.length;d++){var f=F(this.windowID,this.mColFields[d].mID).mObj;this.mResult.f[d]={};this.mResult.f[d].t=f.t;this.mResult.f[d].dt=f.dt;if("e" in f){this.mResult.f[d].e=new Array();for(var b in f.e){this.mResult.f[d].e[b]=f.e[b].l}}}this.mResult.r=new Array();this.mResult.idmap={};this.mResult.q='{qual:""}';this.mResult.n=0;this.mResult.start=0};BaseTable.prototype.collectDirtyRows=function(){var v="";var b="{";var o=0;if(this.mResult){var h=this.mResult;var s=this.GetData().length;var u=h.f.length;for(var k=0;k<s;k++){if(h.r[k].mXXXDirty){b+=o>0?",":"r:[";b+='{i:"'+h.r[k].i+'"';if(h.r[k].mXXXDirty!=3){b+=",v:[";for(var g=0;g<u;g++){var d;if(h.f[g].dt==13){var f=ARDate.parseDate(h.r[k].d[g].v);if(f){d=""+f.GDays()}else{d=""}}else{if(h.f[g].dt==7||h.f[g].dt==14){var f=ARDate.parseDateTime(h.r[k].d[g].v);if(f){d=""+ARDate.parseDateTime(h.r[k].d[g].v).GTimestamp()}else{d=""}}else{d=""+h.r[k].d[g].v}}b+=(d=="&nbsp;"||d.length==0)?'""':'"'+d+'"';if(g!=u-1){b+=","}}b+="]"}b+="}";o++}}}if(o>0){b+="]";b+=",t:"+this.mID;b+=',s:"'+ExpandServerName(this.windowID,this.mObj.getAttribute("arserver"))+'"';b+=',ts:"'+ExpandSchemaName(this.windowID,this.mObj.getAttribute("arschema"))+'"';b+=', cs:"'+ARKWGetStringByIdx(this.windowID,6)+'"';b+=',vu:"'+ARKWGetStringByIdx(this.windowID,17)+'"'}b+="}";if(b.length>2){return b}else{return null}};BaseTable.prototype.clearDeleted=function(){var k=this.mResult.r;var b=k.length;var o=[],f={},d=0;for(var g=0;g<b;g++){var h=k[g];if(h.mXXXDirty&&h.mXXXDirty==3){if(h.i in this.mRowSelections){delete this.mRowSelections[h.i];if(this.mPrimaryRowSelection==h.i){this.mPrimaryRowSelection=null;this.mARRowSelection=0;this.mCurrentRow=-1}}}else{o.push(h);f[h.i]=d++}}if(this.mPrimaryRowSelection==null){for(var d in this.mRowSelections){this.mPrimaryRowSelection=d;break}}if(this.mPrimaryRowSelection!=null){this.mCurrentRow=f[this.mPrimaryRowSelection];this.mARRowSelection=this.mCurrentRow+1}this.mResult.r=o;this.mResult.idmap=f};BaseTable.prototype.Clearoutfields=function(){return};BaseTable.prototype.calRowSel=function(b){var f=this.mLastRowSelection;if(b<0){for(var d=f+b;d>=0;d--){if((!this.mResult.r[d].mXXXDirty)||(this.mResult.r[d].mXXXDirty!=3)){return d}}}else{for(var d=f+b;d<this.mResult.r.length;d++){if((!this.mResult.r[d].mXXXDirty)||(this.mResult.r[d].mXXXDirty!=3)){return d}}}return this.mLastRowSelection};BTColData.prototype.SetLabel=function(b){if(this.mHeader&&this.mHeader.firstChild){this.mHeader.firstChild.data=b}};function BaseTable_DragHandler(f){var d=f.srcElement.getAttribute("artableid");var b=f.srcElement.getAttribute("arwindowid");getFields_NS(b)[d].DragHandler(f)}BaseTable.prototype.DOMMouseOver=function(b){if(window.hoverState){hoverState.eventMouseOver(b)}if(this.mHasHoverEvt){return}var d=b.element;while(d&&!(d.tagName=="TD"||d.tagName=="DIV")){d=d.offsetParent}if(d!=null&&(d.className.indexOf("BaseTableCell")!=-1||d.className.indexOf("BaseTableHeader")!=-1)){if(d.parentNode.className.indexOf("SelPrimary")==-1&&d.parentNode.className.indexOf("SelSecondary")==-1){d.parentNode.className+=" Rollover"}else{if(d.parentNode.className.indexOf("SelPrimary")!=-1){d.parentNode.className+=" SelPrimaryRollover"}else{if(d.parentNode.className.indexOf("SelSecondary")!=-1){d.parentNode.className+=" SelSecondaryRollover"}}}if(d.firstChild&&d.firstChild.nodeType==1&&d.firstChild.firstChild&&d.firstChild.firstChild.firstChild&&d.firstChild.firstChild.firstChild.nodeType==3){if(d.offsetWidth<d.firstChild.firstChild.offsetWidth){d.setAttribute("title",d.firstChild.firstChild.firstChild.data)}else{d.setAttribute("title","")}}else{if(d.firstChild&&d.firstChild.nodeType==3){if(d.offsetWidth<d.scrollWidth){d.setAttribute("title",d.firstChild.data)}else{d.setAttribute("title","")}}}}};BaseTable.prototype.DOMMouseMove=function(b){if(window.hoverState){hoverState.eventMouseOver(b)}};BaseTable.prototype.DOMMouseOut=function(b){if(window.hoverState){hoverState.eventMouseOut(b)}var d=b.element;while(d&&!(d.tagName=="TD"||d.tagName=="DIV")){d=d.offsetParent}if(d!=null&&(d.className.indexOf("BaseTableCell")!=-1||d.className.indexOf("BaseTableHeader")!=-1)){if(d.parentNode.className.indexOf("SelPrimaryRollover")!=-1){d.parentNode.className=d.parentNode.className.replace(/SelPrimaryRollover/g,"")}else{if(d.parentNode.className.indexOf("SelSecondaryRollover")!=-1){d.parentNode.className=d.parentNode.className.replace(/SelSecondaryRollover/g,"")}else{if(d.parentNode.className.indexOf("Rollover")!=-1){d.parentNode.className=d.parentNode.className.replace(/Rollover/g,"")}}}d.parentNode.className=d.parentNode.className.replace(/\s+$/g,"")}};BaseTable.prototype.DOMMouseUp=function(b){var d=this.MapUIXY(b.element);if(d){this.mMouseUpRowSelection=d.y;this.mMouseUpColSelection=d.x}else{this.mMouseUpRowSelection=-1;this.mMouseUpColSelection=-1}};BaseTable.prototype.SyncCaret=function(b,d){if(b.className!="BaseTableInlineEdit"||this.mCurrentCol==-1){return}var g=this.FishOutTR(d);if(g!=null){var f=g.childNodes[this.mCurrentCol].lastChild;f.focus()}};BaseTable.prototype.DOMKeyDown=function(f){if(this.mRowsPresent==0){return}if(f.key==13||f.key==32){if(f.element.isContentEditable){return}if(this.mPrimaryRowSelection==null){return}f.StopDefault();return this.ARDrillDown({x:0,y:this.RowNoFromTag(this.mPrimaryRowSelection)},false)}else{if((f.key==38||f.key==40)&&this.mSelRow!=1){f.StopDefault();var g=(f.key==38?-1:1);var h;if(this.mPrimaryRowSelection==null){h=0}else{h=this.calRowSel(g)}h=(h<0?0:h);h=(h>=this.mRowsPresent?this.mRowsPresent-1:h);var b=[];if(f.shift&&this.mSelRow==0){return{c:{f:this.FillSelections,t:this,a:[h,this.mLastNonShiftedRowSelection,this.mLastNonShiftedRowSelection<0?0:this.mLastNonShiftedRowSelection,true]},n:{t:this,f:this.ApplySelections,a:[true,false]}}}else{b.push({f:function(){this.SyncCaret(f.element,h)},t:this});b.push({t:this,f:this.ApplySelections,a:[true,false]});b.push({f:this.SetPrimarySelection,t:this,a:[h,true,true,true]});b.push({f:function(){this.mLastRowSelection=h;this.mLastNonShiftedRowSelection=h},t:this});return{n:b}}}else{if((f.key==65&&f.ctrl)&&this.mSelRow!=1){f.StopDefault();return{c:{f:this.FillAllSelections,t:this},n:{f:this.ApplySelections,a:[true,false],t:this}}}else{if(f.element.className!="BaseTableInlineEdit"&&f.element.className!="BaseTableInlineNumEdit"&&!(typeof DPageArray!="undefined"&&typeof this=="DPageArray")&&!(f.element.isContentEditable!="undefined"&&f.element.isContentEditable==true)){var d=String.fromCharCode(f.key);if(d==null){return}d=d.toLowerCase();var h=this.jumpKeyCalRowSel(d);if(h==-1){return}var b=[];b.push({f:function(){this.SyncCaret(f.element,h)},t:this});b.push({t:this,f:this.ApplySelections,a:[true,false]});b.push({f:this.SetPrimarySelection,t:this,a:[h,true,true,true]});b.push({f:function(){this.mLastRowSelection=h;this.mLastNonShiftedRowSelection=h},t:this});return{n:b}}}}}};BaseTable.prototype.DragHandler=function(B){var C=B.srcElement;var o=B.mx+this.mScrollLeft;if(C.className.indexOf("BaseTableBar")!=-1){var b=(C.getAttribute("arselbar")!=null)?true:false;var h=parseInt(C.getAttribute("arcolumnid"));if(!b){}var g=(b)?this.mAccmX:this.mColDatas[h].mX;var y=(b)?this.mAccmWidth:this.mColDatas[h].mWidth;if(B.state==0){var w=(g+0)-this.mScrollLeft;B.dragContext.SetDragBounds(w,null,w+(y-11),null)}else{if(B.original||(!B.original&&B.state==2)){var s=(b)?this.mAccmWidth+o-this.mAccBarWidth:this.mColDatas[h].mWidth+o-this.mColDatas[h].mBarX-1;if(s<0){s=0}if(b){this.mAccmWidth=s}else{if(s<=this.mInner.offsetWidth){this.mColDatas[h].mWidth=s}}this.ApplySizes();this.UpdateScrollOffset()}}}else{var h=null;if(B.state==0){for(var z=0;z<this.mColDatas.length&&h==null;++z){if(o>=this.mColDatas[z].mX&&o<(this.mColDatas[z].mX+this.mColDatas[z].mWidth)&&this.mColDatas[z].mVisible){h=z}}this.mColDragInfo={mLeft:-1,mRight:-1,mOrigCol:h,mCol:h};this.SetColHeaderStyles(false)}else{if(B.state==1){var E=999999999,k=null;for(var z=0;z<this.mColDatas.length;++z){if(this.mColDatas[z].mVisible){var v=Math.abs(o-this.mColDatas[z].mX);if(v<E){E=v;h=z}k=z}}if(k!=null){var v=Math.abs(o-(this.mColDatas[k].mX+this.mColDatas[k].mWidth));if(v<E){E=v;h=k+1;for(var z=h;z<this.mColCnt;z++){h+=1}}}var D=h-1,f=h;while(D in this.mColDatas&&!this.mColDatas[D].mVisible){--D}this.SetColHeaderStyles(true);this.mColDragInfo.mLeft=f;this.mColDragInfo.mRight=D;this.mColDragInfo.mCol=h;this.SetColHeaderStyles(false)}else{this.SetColHeaderStyles(true);if(B.state==2){var d=this.mColDragInfo.mOrigCol,A=this.mColDragInfo.mCol;var u=[];for(var z=0;z<this.mColCnt;++z){if(z==A){u.push(this.mColDatas[d])}if(z!=d){u.push(this.mColDatas[z])}}if(u.length==this.mColCnt-1){u.push(this.mColDatas[d])}this.mColDatas=u;this.mDirtyColumns=true;this.ApplyData()}this.mColDragInfo=null}}}};BaseTable.prototype.SetColHeaderStyles=function(b){var d=this.mColDragInfo.mLeft,f=this.mColDragInfo.mRight;if(d in this.mColDatas&&this.mColDatas[d].mHeader){this.mColDatas[d].mHeader.className=b?"BaseTableHeader":"BaseTableHeaderDragL"}if(f in this.mColDatas&&this.mColDatas[f].mHeader){this.mColDatas[f].mHeader.className=b?"BaseTableHeader":"BaseTableHeaderDragR"}};BaseTable.prototype.Resize=function(h,d){this.mObj.style.height=d+"px";if(this.mHdrObj!=null&&this.mFtrObj!=null){var o=22,k=22;var f=d-o-k;if(!this.mHdrLObj.firstChild&&!this.mHdrRObj.firstChild&&this.mChunkOuter==null&&!this.mObj.getAttribute("arentretstr")&&!this.mObj.getAttribute("arnotrefstr")){this.mHdrObj.style.visibility="hidden";this.mHdrObj.style.display="none";this.mInnerObj.style.top="0px";f+=o}else{this.mHdrObj.style.visibility="inherit"}this.mFtrObj.style.top=(d-k)+"px";if(!this.mFtrLObj.firstChild&&!this.mFtrRObj.firstChild){this.mFtrObj.style.visibility="hidden";this.mFtrObj.style.display="none";f+=k}else{this.mFtrObj.style.visibility="inherit"}if(f<0){f=0}this.mInnerObj.style.height=f+"px";this.mObj.style.width=h+"px";if(h<0){h=0}this.mInnerObj.style.width=h+"px";this.mFtrObj.style.width=this.mHdrObj.style.width=h+"px";this.mHdrObj.firstChild.style.width=this.mFtrObj.firstChild.style.width=h+"px";d=f}this.mHeight=d;this.mOuter.style.height=this.mHeight+"px";if(this.mFixedHeader){var f=this.mHeight-16;this.mInner.style.height=(f<0?0:f)+"px"}else{this.mInner.style.height=this.mHeight+"px"}this.mWidth=h;this.mOuter.style.width=this.mInner.style.width=this.mWidth+"px";if(this.mColHdrObj!=null){var b=0;for(var g=0;g<this.mColCnt;++g){if(this.mColDatas[g].mVisible){b+=this.mColDatas[g].mWidth}}this.mColHdrObj.style.width=(this.mWidth>b?this.mWidth:b)+"px";this.UpdateScrollOffset()}if(!this.mHScroll){this.ScaleSizes()}this.ApplySizes()};BaseTable.prototype.UpdateScrollOffset=function(){this.mScrollLeft=this.mInner.scrollLeft;if(this.mFixedHeader){this.mColHdrObj.style.left=-this.mScrollLeft+"px"}};BaseTable.prototype.InstantiateUI=function(d){this.mParent=d;var b=[];b.push("<DIV class='BaseTableOuter' draghandler='BaseTable_DragHandler'>");if(this.mFixedHeader){this.BuildColumnHeaders(b)}b.push("<DIV class='BaseTableInner'></DIV></DIV>");this.mScrollLeft=0;this.mParent.innerHTML=b.join("");this.mOuter=this.mParent.firstChild;if(this.mFixedHeader){this.RefreshHeaderRefs();this.mInner=this.mOuter.childNodes[1]}else{this.mInner=this.mOuter.firstChild}if(this.mFixedHeader){this.mInner.style.top=16+"px"}this.mInner.onscroll=FormEvent.Trampoline(BaseTable_OnScroll)};BaseTable.prototype.DOMClickActionBase=function(b,k){if(this.GAccess()==3){return this.actList(0)}var g=b.element;while(g.nodeType!=1||(g.tagName!="DIV"&&g.tagName!="TR")){g=g.parentNode}if(k){if(g.className=="BaseTableHeader"){return this.actList(1)}}var h=b.element;var d=false;if(k){if(h.tagName=="INPUT"&&h.className.indexOf("btn")!=-1){d=true}if(h.tagName=="INPUT"&&h.type=="checkbox"&&h.className!="colcheck"){return this.actList(3)}}if(h.tagName=="INPUT"&&h.type=="checkbox"&&h.className!="colcheck"){return this.actList(2)}if(!k&&h.tagName=="INPUT"&&h.type=="image"&&h.className.indexOf("btn")!=-1){this.eventTimeStamp=0;if(b.mEventObject){this.eventTimeStamp=b.mEventObject.timeStamp}var f=this.actList(2);f.push(3);return f}else{if(k&&h.tagName=="INPUT"&&h.type=="image"&&h.className.indexOf("btn")!=-1){if(!this.eventTimeStamp){var f=this.actList(2);f.push(3);return f}this.eventTimeStamp=0;return this.actList(0)}}var o=this.MapUIX(b.element);if(o==null){return this.actList(0)}if(g.tagName=="TR"){if(b.shift&&(b.ctrl||b.meta)){return this.actList(0)}if(!b.ctrl&&!b.shift&&!b.meta){if(this.mSelRow==1){return this.actList(0)}else{if(k&&d){return this.actList(2)}else{if(k&&b.element.tagName=="INPUT"&&b.element.className=="colcheck"){return this.actList(4)}else{if(!k){if(b.element.tagName=="INPUT"&&b.element.className=="colcheck"){return this.actList(0)}if(this.mPrimaryRowSelection==null){return this.actList(3)}if(o==this.RowNoFromTag(this.mPrimaryRowSelection)&&!this.MultiSelected()){return this.actList(0)}if(this.mRowSelections[this.mResult.r[this.mMouseDownRowSelection].i]==true){return this.actList(0)}return this.actList(3)}}}if(this.mPrimaryRowSelection==null||o!=this.RowNoFromTag(this.mPrimaryRowSelection)){if(k&&d){return this.actList(2)}else{if(!k){return this.actList(3)}}}else{if(k&&d){return this.actList(2)}else{if(!k){return this.actList(4)}}}}}if(k&&(b.ctrl||b.meta)){if(this.mSelRow==1||this.mSelRow==2){if(h.tagName=="INPUT"&&h.type=="checkbox"&&h.className=="colcheck"){h.value="off"}return this.actList(0)}else{return this.actList(4)}}else{if(!k&&b.shift){if(this.mSelRow==1||this.mSelRow==2){return this.actList(0)}else{if(this.mPrimaryRowSelection==null){return this.actList(3)}else{return this.actList(5)}}}else{if(k&&b.shift&&b.element.tagName=="INPUT"&&b.element.className=="colcheck"){if(this.mSelRow==1||this.mSelRow==2){return this.actList(0)}else{return this.actList(5)}}}}}if(k&&!b.shift&&o!=this.RowNoFromTag(this.mPrimaryRowSelection)){return this.actList(3)}return this.actList(0)};BaseTable.prototype.getSortColumn=function(f){var b=f;while(b.nodeType!=1||(b.tagName!="DIV"&&b.tagName!="TR")){b=b.parentNode}var d=-1;if(b.className=="BaseTableHeader"){d=b.getAttribute("ardatacol");if(d!=null){d=parseInt(d)}}if(typeof d=="number"){return d}return -1};BaseTable.prototype.DOMDragStart=function(b){if(b.ctrl){if(this.mSelRow==1||this.mSelRow==2){return{}}else{return this.DOMActionProcessor(b,this.actList(8))}}};BaseTable.prototype.DOMActionProcessor=function(g,b){if(window.hoverState){hoverState.clearTracking()}var C=g.element;var d=null;var v=[];for(var z=0;z<b.length;z++){switch(b[z]){case 1:var h=this.getSortColumn(C);if(h!=-1){var E;for(var z in this.mColDatas){var u=this.mColDatas[z];if(u.mDataCol==h){if(this.mColInfo[h].sort==0||this.mColInfo[h].lcl==true||("dLen" in this.mColInfo[h]&&(this.mColInfo[h].dLen==0||this.mColInfo[h].dLen>255))){return}E=u;if(!u.mPrimarySort){u.mPrimarySort=true}else{u.mSortDir=-u.mSortDir}}else{u.mPrimarySort=false}}v.push({f:function(){return this.Resort(E.mDataCol,E.mSortDir)},t:this})}break;case 2:v.push({f:function(){hoverState.btnClickE()}});if(d==null){d=this.MapUIXY(g.element)}if(d==null){return}var o=this.getFieldIDForColumn(d.x);if(o){v.push({f:ExecuteWorkflow,a:[this.windowID,1,o]})}v.push({f:function(){hoverState.btnClickS(g)}});break;case 3:case 6:if(d==null){d=this.MapUIXY(g.element)}if(d==null){return}var k=d.y;this.mCurrentCol=d.x;if(this.mID==1020){v.push({t:this,f:this.SynchRLDetails,a:[]})}v.push({t:this,f:this.ApplySelections,a:[true,false]});v.push({f:this.SetPrimarySelection,t:this,a:[k,true,true,true]});v.push({f:function(){this.mLastRowSelection=k;this.mLastNonShiftedRowSelection=k},t:this});break;case 4:case 8:if(d==null){d=this.MapUIXY(g.element)}if(d==null){return}var k=d.y;this.mCurrentCol=d.x;var y=false;if(this.mID==1020){v.push({t:this,f:this.SynchRLDetails,a:[]})}var D=false;if(b[z]!=4){D=true}var B=false;if(g.element.tagName=="INPUT"&&g.element.className=="colcheck"){B=true;if(g.element.checked==true){var w=0;for(var z in this.mLastRowSelections){w++;if(z==k){D=true}}if(w==1&&k+1==this.mARRowSelection){break}}}v.push({t:this,f:this.ApplySelections,a:[y,true]});if(this.mSelRow==2){v.push({f:this.SetPrimarySelection,t:this,a:[k,true,true,true]})}v.push({f:function(){this.mLastRowSelection=k},t:this});v.push({f:this.EORSelections,t:this,a:[k,D,B]});break;case 5:if(d==null){d=this.MapUIXY(g.element)}if(d==null){return}var k=d.y;this.mCurrentCol=d.x;var y=false;var s=k;var f=(this.mPrimaryRowSelection!=null)?this.RowNoFromTag(this.mPrimaryRowSelection):-1;var A=(this.mPrimaryRowSelection!=null)?this.RowNoFromTag(this.mPrimaryRowSelection):k;v.push({t:this,f:this.ApplySelections,a:[y,false]});v.push({f:function(){this.mLastRowSelection=k},t:this});v.push({f:this.FillSelections,t:this,a:[s,f,A,true]});break;case 7:if(d==null){d=this.MapUIXY(g.element)}if(d==null){return}v.push({f:function(){return this.ARDrillDown(d,false)},t:this});break}}return{n:v}};BaseTable.prototype.DOMMouseDown=function(b){var d=this.MapUIXY(b.element);if(d){this.mMouseDownRowSelection=d.y}else{this.mMouseDownRowSelection=-1}var f=this.DOMClickActionBase(b,false);return this.DOMActionProcessor(b,f)};BaseTable.prototype.DOMClick=function(b,d){var d=this.DOMClickActionBase(b,true);return this.DOMActionProcessor(b,d)};BaseTable.prototype.DOMDoubleClick=function(b){var d=this.MapUIXY(b.element);if(d==null){return}return this.ARDrillDown(d,false)};BaseTable.prototype.GetFocusElementForEvent=function(b){var d=b.element;if(this.GetNestedFocusability()){if((d.tagName=="A")||(d.tagName=="INPUT")||(d.tagName=="IMG")){return d}else{while(d&&(d.nodeType!=1||(d.tagName!="DIV"&&d.tagName!="TR"))){d=d.parentNode}if(d&&((d.className=="BaseTableColHeaders"||d.className=="BaseTableBar"||d.className=="BaseTableHeader")||(d.getAttribute("arrow")!=null))){return b.element}}return this.GetFocusElement()}};BaseTable.prototype.GetFocusElement=function(){var d=(this.mPrimaryRowSelection==null)?0:this.RowNoFromTag(this.mPrimaryRowSelection);var b=this.FishOutTR(d);if(b==null){if(this.mOuter!=null){return this.mOuter}return this.mObj}return b};BaseTable.prototype.TabableElementSelector=function(f){if(f.tagName=="A"){var d=FakeButton_Find(f);if(d!=null){return FakeButton_TabableElementSelector(d)}else{return null}}if(f.tagName=="INPUT"){var b=f.parentNode;while(b&&b.tagName!="TR"){b=b.parentNode}if(b&&b==this.GetFocusElement()){return f}}else{if((f.tagName=="TR")&&(this.GetFocusElement()==f)){return f}else{if((accessibilityPref==2||accessibilityPref==1)&&f.tagName=="TABLE"&&f.className&&f.className=="BaseTable"){return f}}}return null};BaseTable.prototype.MapUIX=function(d){var f,b=0,g=null;while(d&&d.tagName!="TR"){if(d.tagName=="TD"){g=d}d=d.parentNode}if(d&&d.getAttribute("arrow")!=null&&g!=null){f=parseInt(d.getAttribute("arrow"))}else{return null}if(f>=this.mRowsPresent){return null}else{return f}};BaseTable.prototype.MapUIXY=function(d){var f,b=0,g=null;while(d&&d.tagName!="TR"){if(d.tagName=="TD"){g=d}d=d.parentNode}if(d&&d.getAttribute("arrow")!=null&&g!=null){f=parseInt(d.getAttribute("arrow"))}else{return null}if(f>=this.mRowsPresent){return null}while(g.previousSibling){g=g.previousSibling;++b}if(this.colCheck==1){b-=1}if(b>=this.mColCnt){return null}return{y:f,x:b}};BaseTable.prototype.FishOutTR=function(h){if(h<0||h>=this.mRowsPresent||this.mDataTableObj==null){return null}if(this.mDataTableObj.lastChild==null){return null}var d=this.mDataTableObj.lastChild;if(!this.mGroup){return d.childNodes[h+((this.mHiddenColHdrPresent)?1:0)]}else{for(var b=0;b<d.childNodes.length;b++){var g=d.childNodes[b];if(g&&g.getAttribute("arrow")!=null){var f=parseInt(g.getAttribute("arrow"));if(f==h){return g}}}return null}};BaseTable.prototype.ApplySelections=function(G,R){var w=this.FishOutTR(0),d={};var P=0;if(w!=null){var H=-1;for(var X in this.mRowSelections){if(!this.mResult.r[this.RowNoFromTag(X)].mXXXDirty||this.mResult.r[this.RowNoFromTag(X)].mXXXDirty!=3){d[this.RowNoFromTag(X)]="SelSecondary";P++}}if(this.mPrimaryRowSelection!=null){H=this.RowNoFromTag(this.mPrimaryRowSelection);if(!this.mResult.r[H].mXXXDirty||this.mResult.r[H].mXXXDirty!=3){d[H]="SelPrimary"}}var E={},K=0;for(var X in this.mLastRowSelections){if(!(X in d)){E[X]="";++K}}for(var X in d){if(d[X]!=this.mLastRowSelections[X]){E[X]=d[X];++K}}var o;if(K>1750){for(var J=0;w;w=w.nextSibling,++J){if(J in E){w.className=E[J]}}}else{var v=w.parentNode,L=this.mHiddenColHdrPresent?1:0;for(var V=L;V<v.childNodes.length;V++){var Z=v.childNodes[parseInt(V)];var C=Z.getAttribute("arrow");if(C==null){continue}if(typeof E[C]!="undefined"){if(this.mGroup){var h=Z.className;h=h.replace(/SelPrimary/g,"");h=h.replace(/SelSecondary/g,"");h=h.replace(/Rollover/g,"");h=h.replace(/\s+$/g,"");h=h+" "+E[C];Z.className=h}else{var Q=E[C];Z.className=Q;if(this.colCheck==1&&Q.length==0){Z.firstChild.firstChild.checked=false}}var Y=Z.getElementsByTagName("TD");for(var U=0;U<Y.length;U++){if(Y[U].className.indexOf("editT")!=-1){var f=Y[U].getElementsByTagName("NOBR");if(Z.className=="SelPrimary"){var g=document.createElement("A");g.className="btn btn3d DropMenu TableBtn";g.style.display="inline";g.innerHTML='<img id="tmenu"class="btnimg" alt="" src="'+RelContextPath+'resources/images/field_menu.gif">';g.style.cssFloat="right";g.style.styleFloat="right";var A=f[0].childNodes[0];f[0].insertBefore(g,A);Y[U].style.border="none"}else{if(Z.className==""){var y=f[0].getElementsByTagName("A");if(y[0]!=null){f[0].removeChild(y[0])}Y[U].style.border="none"}}}}}}}}if(!R){if(this.colCheck==1){for(var S in this.mLastRowSelections){Z=v.childNodes[parseInt(S)+1];if(typeof Z!="undefined"){Z.firstChild.firstChild.checked=false}}}}this.mLastRowSelections=d;if(this.colCheck==1){var N=0;for(var S in this.mLastRowSelections){N++}if(N>0){for(var S in this.mLastRowSelections){Z=v.childNodes[parseInt(S)+1];if(typeof Z!="undefined"){Z.firstChild.firstChild.checked=true}}if(this.mSelRow==0){if(N==this.mRowsPresent){this.mColHdrObj.firstChild.firstChild.checked=true}else{this.mColHdrObj.firstChild.firstChild.checked=false}}}if(N==1&&this.mSelRow==0){this.mColHdrObj.firstChild.firstChild.checked=false}}if(G&&H>=0&&this.mObj.style.display!="none"){var Z=this.FishOutTR(H);if(Z!=null){var b=Z.offsetHeight,O=0,u=this.mInner.clientHeight;var Y=Z.getElementsByTagName("TD");for(X=0;X<Y.length;X++){if(Y[X].className.indexOf("editT")!=-1){var f=Y[X].getElementsByTagName("NOBR");var g=f[0].getElementsByTagName("A");if(typeof g=="undefined"){var aa=document.createElement("A");aa.className="btn btn3d DropMenu TableBtn";aa.style.display="inline";aa.innerHTML='<img id="tmenu"class="btnimg" alt="" src="'+RelContextPath+'resources/images/field_menu.gif">';f[0].appendChild(aa)}Y[X].style.border="none"}}while(Z!=this.mInner){O+=Z.offsetTop;Z=Z.parentNode}if(O<this.mInner.scrollTop){this.mInner.scrollTop=O}else{var B=this.mInner.scrollTop+u,W=O+b;if(W>=B){this.mInner.scrollTop=W-u}}}}if(this.mID==1020&&this.mFtrRObj){if(P==1){var z=getLocalizedMessage("{0} row selected",[P])}else{var z=getLocalizedMessage("{0} rows selected",[P])}if(this.mPrimaryRowSelection){var I=getLocalizedMessage("Number {0} of {1}",[this.mARRowSelection,this.mRowsPresent]);z=I+"  |  "+z}NodeWrite(this.mFtrRObj,z)}if(this.mFromAddRow&&this.mGroup&&H>=0){var w=this.FishOutTR(H);if(w.className.indexOf("child-of-")>=0&&w.className.indexOf("SelPrimary")>=0){var s=w.className.substring(9,w.className.length-11);while(w&&w.previousSibling){w=w.previousSibling;if(w&&(w.className.indexOf("branch")>=0||w.className.indexOf("parent")>=0||w.className.indexOf("emptyGroup")>=0||w.getAttribute("id")==s)){var D=w.getAttribute("id");$("#T"+this.mID+" #"+D).treetable("expandNode",D);w=null}}}this.mFromAddRow=false}};BaseTable.prototype.BuildColumnHeaders=function(z){var k=this.GetColumnInfo();var D="BaseTableColHeaders";var G="BaseTableHeader";if(this.mIsPopup){D="BaseTableColHeaders PopupTableColHeaders";G="BaseTableHeader PopupTableHeader"}z.push("<DIV class='"+D+"'>");var v="<DIV class='"+G+"' draggable=1 arwindowid='"+this.windowID+"' artableid=",b=" arhelp='",K=" ardatacol=",d=">",s="</DIV>";var J="<DIV class='BaseTableBar' draggable=1 dragHandler='BaseTable_DragHandler' arwindowid='"+this.windowID+"' artableid=",o=" arcolumnid=",I="><DIV></DIV></DIV>";var H=" style='";var C="  background: -webkit-gradient(linear, left top, left bottom, from(";var A="), to(";var y="));";var w=" color:";var h="'";var g=";";if(this.colCheck==1){var f="<DIV class='"+G+"' arselbar=1 arwindowid='"+this.windowID+"' artableid=";z.push(f);z.push(this.mID);z.push(d);if(this.mSelRow==0){z.push("<input type='checkbox' class='checkboxheader' style='height:12px;width:12px;margin:0px;'/>")}z.push(s)}for(var B=0;B<this.mColCnt;++B){if(this.mColDatas[B].mVisible){z.push(v);z.push(this.mID);z.push(K);z.push(this.mColDatas[B].mDataCol);try{arhelp=this.mColFields[B].mObj.arh;if(arhelp&&arhelp!=""){z.push(b);z.push(arhelp+"'")}}catch(E){}z.push(H);if(this.mColInfo[B].colgradbkgcol!=null&&this.mColInfo[B].colgradcol!=null){z.push(C);z.push(this.mColInfo[B].colgradbkgcol);z.push(A);z.push(this.mColInfo[B].colgradcol);z.push(y)}if(this.mColInfo[B].colhdrtxtcol!=null){z.push(w);z.push(this.mColInfo[B].colhdrtxtcol);z.push(g)}z.push(h);z.push(d);z.push(k[this.mColDatas[B].mDataCol].heading.HTMLEncode());z.push(s)}}if(this.colCheck==1){var u="<DIV class='BaseTableBar' arselbar=0 artableid=";z.push(u);z.push(this.mID);z.push(I)}for(var B=0;B<this.mColCnt;++B){if(this.mColDatas[B].mVisible){z.push(J);z.push(this.mID);z.push(o);z.push(B);z.push(I)}}z.push("</DIV>")};BaseTable.prototype.RefreshHeaderRefs=function(){this.mColHdrObj=this.mFixedHeader?this.mOuter.firstChild:this.mInner.firstChild;var g="BaseTableColHeaders";var b="BaseTableHeader";if(this.mIsPopup){g="BaseTableColHeaders PopupTableColHeaders";b="BaseTableHeader PopupTableHeader"}var f=this.mColHdrObj.firstChild;if(this.colCheck==1){this.mChkHdr=f;f=f.nextSibling}for(var d=0;d<this.mColCnt;++d){if(this.mColDatas[d].mVisible){this.mColDatas[d].mHeader=f;f=f.nextSibling}else{this.mColDatas[d].mHeader=null}}if(this.colCheck==1){this.mChkBar=f;f=f.nextSibling}for(var d=0;d<this.mColCnt;++d){if(this.mColDatas[d].mVisible){this.mColDatas[d].mBar=f;f=f.nextSibling}else{this.mColDatas[d].mBar=null}}};BaseTable.prototype.ApplyData=function(){var E=[],an="<COL",aA=" />";if(!this.mFirstLayout&&this.mRowsPresent==0&&this.GetData().length==0&&!this.mDirtyColumns){return}var H=this.IsInFlowLayout();if(H){var L=this.mObj.className;if(this.GetData().length>0){if(L.indexOf("tblflow")==-1){L+=" tblflow";this.mObj.className=L;if(typeof DAttachmentPool!="undefined"&&this instanceof DAttachmentPool==true){sl=this.mInner.className;if(sl.indexOf("attpl")==-1){sl+=" attpl";this.mInner.className=sl}}}}else{this.mObj.className=L.replace("tblflow","")}}var ag=this.hasVisImgRefs();this.mDirtyColumns=false;if(!this.mFixedHeader){this.BuildColumnHeaders(E)}E.push("<TABLE ");E.push("id='T"+this.mID+"' ");encTblStr="";E.push('title="'+encTblStr+'"');var g=[];var ak=0;for(var ae=0;ae<this.mColCnt;++ae){if(this.mColDatas[ae].mVisible){ak++;g.push(an);if(typeof this.mColFields!="undefined"&&this.mColFields!=null){var s=this.mColFields[this.mColDatas[ae].mDataCol].mObj.cls;if(s!=null){g.push(" class="+s)}}g.push(aA)}}if(this.colCheck==1){ak++}E.push(" class='BaseTable'><COLGROUP cols="+ak+">");if(this.colCheck==1){E.push(an);E.push(aA)}E.push(g.join(""));E.push("</COLGROUP><TBODY>");if(this.mSortImgs!=null){for(var ae in this.mSortImgs){if(this.mSortImgs[ae].getAttribute("arindom")==1){if(this.mSortImgs[ae].parentNode!=null){this.mSortImgs[ae]=this.mSortImgs[ae].parentNode.removeChild(this.mSortImgs[ae])}this.mSortImgs[ae].setAttribute("arindom",0)}}}var au=null;for(var ae in this.mColDatas){if(this.mColDatas[ae].mPrimarySort){au=this.mColDatas[ae];break}}if(au==null&&this.mColDatas.length>0){var S=this.GetInitialRowSortOrder();if(S!=null){for(var ae in this.mColDatas){var N=this.mColDatas[ae];if(N.mDataCol==S.col){N.mPrimarySort=true;N.mSortDir=S.dir;au=N;break}}}}if(au!=null){this.SetRowSortOrder(au.mDataCol,au.mSortDir)}var w;if(this.mColDatas.length==0){w=[]}else{w=this.GetData()}this.mHiddenColHdrPresent=false;if(w.length>0){var ac=this.GetColumnInfo();var R=this.GetRowColours();var Q=this.GetBkgRowColours();var al={};var aJ=[[],[]],aN=[[],[]],A=[];var f=[[],[]];var u=[[],[]];var U='<td class="BaseTableCellColor"><input class="colcheck" type=\'checkbox\' </td>';var aw='<td class="BaseTableCellOddColor"><input class="colcheck" type=\'checkbox\' </td>';var J="CLASSNAME",aj="<TH scope=col >",ai="</TH>";var aB=false;var aa=-1;if(this.colCheck==1){A.push(aj)}A.push(ai);for(var ae=0;ae<this.mColCnt;++ae){if(this.mColDatas[ae].mVisible){var aH="left";if(typeof this.mColFields!="undefined"&&this.mColFields!=null){var o=this.mColFields[this.mColDatas[ae].mDataCol].mObj.da;if(o==1){aH="center"}else{if(o==0){aH="right"}}}A.push(aj);A.push(ac[this.mColDatas[ae].mDataCol].heading.HTMLEncode());A.push(ai);al[ae]=this.mColDatas[ae].mDataCol;var C=ac[al[ae]];var aI="";var z=this.getTemplateForField(al[ae]);if(typeof z!="undefined"){if(z.indexOf("btnurl")!=-1){f[0][ae]='<TD class="'+J+'" ';aJ[0][ae]='" valign=top>'+z;u[0][ae]="";aN[0][ae]="</TD>"}else{f[0][ae]='<TD class="'+J+'" align="'+aH+'"';aJ[0][ae]='" valign=top><NOBR>'+z;u[0][ae]="";aN[0][ae]="</NOBR></TD>"}}else{if(C.edit==2){f[0][ae]="<TD "+aI+' class="'+J+'" ';aJ[0][ae]='"><NOBR>';u[0][ae]='<INPUT type=text class=BaseTableInlineEdit contentEditable="true" style="text-align:'+aH+';" ';u[0][ae]+=' value="';aN[0][ae]='" /></NOBR></TD>'}else{pretdtag='"';pretdtag+=((aa==ae||!aB)?'scope="row" ':"");if(C.edit==1){pretdtag+=' class="'+J+' BaseTableStaticText editT">'}else{pretdtag+=' class="'+J+' BaseTableStaticText">'}aB=true;if(C.wrap&&C.edit!=1){f[0][ae]="<TD ";aJ[0][ae]=pretdtag+'<NOBR style="white-space:pre-wrap;"><SPAN>';u[0][ae]="";aN[0][ae]="</SPAN></NOBR></TD>"}else{f[0][ae]="<TD ";aJ[0][ae]=(pretdtag+'<NOBR class="dp " style="text-align:')+aH+";";aJ[0][ae]+=(';">');var aC='<span style="padding: 1px 4px;';aC+="float:"+aH+";";aC+='">';aJ[0][ae]+=((aH=="center")?("<span>"):(aC));u[0][ae]="";if(C.edit==3){u[0][ae]=("<input type=checkbox value="+C.mEnumValue);aN[0][ae]=">&nbsp;"+C.mEnumLabel}else{aN[0][ae]=""}aN[0][ae]+="</span></NOBR></TD>"}}}}}var aM="BaseTableCellColor";var am="BaseTableCellOddColor";if(this.mGroup){aM=am}if(Q!=null){aM="";am=""}for(var ae in aJ[0]){aM=aM.replace("BaseTableAlignText","");am=am.replace("BaseTableAlignText","");if(this.mColDatas[ae].mType){if(this.mColDatas[ae].mType=="Currency"||this.mColDatas[ae].mType=="Integer"||this.mColDatas[ae].mType=="Decimal"||this.mColDatas[ae].mType=="Real"){aM+=" BaseTableAlignText";am+=" BaseTableAlignText";u[0][ae]=u[0][ae].replace("BaseTableInlineEdit","BaseTableInlineNumEdit")}}f[1][ae]=f[0][ae].replace(J,"BaseTableCell "+aM);f[0][ae]=f[0][ae].replace(J,"BaseTableCellOdd "+am);aJ[1][ae]=aJ[0][ae].replace(J,"BaseTableCell "+aM);aJ[0][ae]=aJ[0][ae].replace(J,"BaseTableCellOdd "+am);u[1][ae]=u[0][ae].replace(J,"BaseTableCell "+aM);u[0][ae]=u[0][ae].replace(J,"BaseTableCellOdd "+am);aN[1][ae]=aN[0][ae].replace(J,"BaseTableCell "+aM);aN[0][ae]=aN[0][ae].replace(J,"BaseTableCellOdd "+am)}var av=[];var W=[];for(var ad=0;ad<this.mColCnt;++ad){if(this.mColDatas[ad].mVisible){av.push("content.push(prepre["+ad+"]);");av.push("content.push(cColor["+al[ad]+"]);");av.push("content.push(premap["+ad+"]);");if(ag){var z=this.getTemplateForField(al[ad]);if(typeof z!="undefined"){av.push("")}else{av.push("content.push(irArr["+al[ad]+"]);")}}av.push("content.push(postimg["+ad+"]);");if(ac[this.mColDatas[ad].mDataCol].edit==3){av.push("content.push(di.d["+al[ad]+"].v=='"+ac[al[ad]].mEnumLabel+"'?' CHECKED ':' ');")}else{if(typeof isxssEnable!="undefined"&&isxssEnable){av.push("content.push(di.d["+al[ad]+"].v.removeXssVulnerability());")}else{av.push("content.push(di.d["+al[ad]+"].v);")}}av.push("content.push(postmap["+ad+"]);")}else{if(this.mGroup&&this.mGroupOrder[0]==this.mColDatas[ad].mDataCol){if("e" in this.mColFields[ad].mObj){for(var Y in this.mColFields[ad].mObj.e){W.push(this.mColFields[ad].mObj.e[Y].l)}}}}}av=av.join("");var X="di,content,premap,postmap,prepre,postimg,cColor";if(ag){X="di,content,premap,postmap,prepre,postimg,cColor,irArr"}CompileFunction(av,X);rowfunc=CompiledFunction;this.mHiddenColHdrPresent=true;E.push('<TR class="hiddentablehdr">');E.push(A.join(""));E.push("</TR>");var aP="</TR>",V=">";var aE="<TR tabindex=0 arrow=";var ad=0,at="",O=0,aL="",aF=[];var ao=w[0].d.length;var aG="<TR class='separator'><TD colspan='"+ao+"'><hr class='separator'></TD></TR>";var P=20;var ar=13;var Z="TTT";var ay=/[~`!@#$%^&*={}\[\]\\|.,:;\/?\s]/g;var aq=0;if(R==null&&Q==null){var G=0;for(var ae=0;ae<w.length;++ae){if(!w[ae].mXXXDirty||w[ae].mXXXDirty!=3){var d;if(ag){d=this.getVisImgRefs(w[ae])}if(this.mGroup){var D=w[ae].d[this.mGroupOrder[0]].v;if(D==null||D==""){D="NULL"}if(at!=D){if(D.length*ar>P){P=D.length*ar}aL=D.replace(ay,"");if(aL==""||aL=="NULL"){aL="NULL"}aL=aL+"_"+this.mID;if(ae>0){E.push(aG)}if(at!=""){if(this.mFunc){E[O]="<span class='aggregate'>"+this.getandresetAggregate()+"</span></nobr></td>"}else{E[O]="</nobr></td>"}}aq=aL;E.push("<TR id='"+aL+"' data-tt-id='"+aL+"' name='"+D+"'><TD colspan='"+ao+"' style='padding:0.3em 1.5em'>");if(ag){E.push(d[this.mGroupOrder[0]])}E.push("<nobr><span class='folder' style='width:"+Z+"px'>"+D+"</span>");E.push("");O=E.length-1;E.push("</TR>");at=D;aF.push(at)}}var ax=this.getCellColor(w[ae]);E.push(aE);if(this.colCheck==1){E.push(G++)}else{E.push(ae)}if(this.mGroup){this.computeAggregate("COUNT",w[ae]);var aK="child-of-"+aL;E.push(" class='"+aK+"' data-tt-id='chld-"+aL+"' data-tt-parent-id='"+aq+"'")}E.push(V);if(this.colCheck==1){if(Math.floor(ae%2)==0){E.push(aw)}else{E.push(U)}}if(ag){rowfunc(w[ae],E,aJ[ad&1],aN[ad&1],f[ad&1],u[ad&1],ax,d)}else{rowfunc(w[ae],E,aJ[ad&1],aN[ad&1],f[ad&1],u[ad&1],ax)}E.push(aP);ad++}}}else{var af=[];var B=null;if(R==null){B=Q}else{if(Q==null){B=R}else{B=(R.length>Q.length?R:Q)}}for(var ae in B){var aD="<TR tabindex=0 style='";if(R!=null&&ae<R.length){aD+=R[ae]}if(Q!=null&&ae<Q.length){aD+=Q[ae]}aD+="' arrow=";af[ae]=aD}af[-1]=aE;var G=0;for(var ae=0;ae<w.length;++ae){if(!w[ae].mXXXDirty||w[ae].mXXXDirty!=3){var d;if(ag){d=this.getVisImgRefs(w[ae])}if(this.mGroup){var D=w[ae].d[this.mGroupOrder[0]].v;if(D==null||D==""){D="NULL"}if(at!=D){if(D.length*ar>P){P=D.length*ar}aL=D.replace(ay,"");if(aL==""||aL=="NULL"){aL="NULL"}aL=aL+"_"+this.mID;if(ae>0){E.push(aG)}if(at!=""){if(this.mFunc){E[O]="<span class='aggregate'>"+this.getandresetAggregate()+"</span></nobr></td>"}else{E[O]="</nobr></td>"}}aq=aL;E.push("<TR id='"+aL+"' data-tt-id='"+aL+"' name='"+D+"'><TD colspan='"+ao+"'>");if(ag){E.push(d[this.mGroupOrder[0]])}E.push("<nobr><span class='folder' style='width:"+Z+"px'>"+D+"</span>");E.push("");O=E.length-1;E.push("</TR>");at=D;aF.push(at)}}var ax=this.getCellColor(w[ae]);var v=w[ae];E.push(af[v.rc]);if(this.colCheck==1){E.push(G++)}else{E.push(ae)}if(this.mGroup){this.computeAggregate("COUNT",w[ae]);var aK="child-of-"+aL;E.push(" class='"+aK+"' data-tt-id='chld-"+aL+"' data-tt-parent-id='"+aq+"'")}E.push(V);if(this.colCheck==1){if(Math.floor(ae%2)==0){E.push(aw)}else{E.push(U)}}if(ag){rowfunc(w[ae],E,aJ[ad&1],aN[ad&1],f[ad&1],u[ad&1],ax,d)}else{rowfunc(w[ae],E,aJ[ad&1],aN[ad&1],f[ad&1],u[ad&1],ax)}E.push(aP);ad++}}}if(this.mGroup){if(this.mFunc){E[O]="<span class='aggregate'>"+this.getandresetAggregate()+"</span></nobr></td>"}else{E[O]="</nobr></td>"}for(var K in W){var az=false;for(x in aF){if(W[K]==aF[x]){az=true}}if(!az){E.push(aG);if(W[K].length*ar>P){P=W[K].length*ar}E.push("<TR class='emptyGroup' id='"+W[K]+"' name='"+W[K]+"'><TD colspan='"+ao+"'>");if(ag){E.push(d[this.mGroupOrder[0]])}E.push("<nobr><span class='folder' style='width:"+Z+"px'>"+W[K]+"</span>");if(this.mFunc){E.push("<span class='aggregate'>0</span></nobr></td>")}else{E.push("</nobr></td>")}E.push("</TR>")}}}}E.push("</TBODY></TABLE>");if(this.mGroup){this.mFolderStatus=this.getAllFolderStatus();if(P>this.mWidth){P=this.mWidth-80}var ah=E.join("");ah=ah.replace(/TTT/g,P);this.mInner.innerHTML=ah}else{this.mInner.innerHTML=E.join("")}this.mRowsPresent=w.length;this.mDataTableObj=this.mFixedHeader?this.mInner.firstChild:this.mInner.childNodes[1];if(!this.mFixedHeader){this.RefreshHeaderRefs();this.mDataTableObj.style.top=16+"px"}var I=this.mDataTableObj.lastChild;e=this.mDataTableObj.firstChild.firstChild;if(this.colCheck==1){e=e.nextSibling}var aO=this.mRowsPresent>=100;for(var ae=0;ae<this.mColCnt;++ae){if(this.mColDatas[ae].mVisible){var h=this.mColDatas[ae];h.mColumn=e;h.mBar.setAttribute("dragoriginal",aO?"":"1");if(h.mPrimarySort&&this.mSortImgs!=null){if(h.mSortDir==-1){h.mHeader.appendChild(this.mSortImgs[0]);this.mSortImgs[0].setAttribute("arindom",1)}else{h.mHeader.appendChild(this.mSortImgs[1]);this.mSortImgs[1].setAttribute("arindom",1)}}e=e.nextSibling}else{this.mColDatas[ae].mColumn=null}}for(var ae=0;ae<w.length;++ae){for(var ab=0;ab<this.mColCnt;++ab){if(w[ae].d[ab].h=="1"){var b=this.findHtmlObject(ae,ab);if(b){b.firstChild.style.visibility="hidden"}}}}this.ApplySizes();this.mLastRowSelections={};this.ApplySelections(true,false);this.mFirstLayout=false};BaseTable.prototype.checkSelDeselall=function(d){if(this.colCheck==1&&this.IsRefreshed()&&this.mChkHdr.firstChild){if(d){this.mChkHdr.firstChild.checked=true}else{this.mChkHdr.firstChild.checked=false}var b=this.mDataTableObj.lastChild;var f=b.firstChild.nextSibling;while(true){if(f==null){break}if(d){f.firstChild.firstChild.checked=true}else{f.firstChild.firstChild.checked=false}f=f.nextSibling}}};BaseTable.prototype.ApplySizes=function(){var f=this.mColCnt-1,v=this.GetColumnInfo(),z=0,o=0,b=null;while(f>=0&&(!this.mColDatas[f].mVisible||this.mColDatas[f].mWidth<=0)){--f}if(f<0){return}if(this.colCheck==1){if(this.mDataTableObj!=null&&this.mDataTableObj.firstChild!=null&&this.mDataTableObj.firstChild.firstChild!=null){var k=this.mChkHdr;var g=this.mChkBar;if(k!=null&&g!=null){k.style.left=0+"px";k.style.width=25+"px";g.style.visibility="inherit";z+=25;g.style.left=z-6+"px";var s=this.mDataTableObj.firstChild.firstChild;s.style.width=25+"px"}}}for(var u=0;u<this.mColCnt;++u){var d=this.mColDatas[u];if(this.mColDatas[u].mVisible){if(d.mColumn==null||d.mHeader==null){return}d.mHeader.style.left=z+"px";if(typeof this.mColFields!="undefined"&&this.mColFields!=null){if(this.mColFields[this.mColDatas[u].mDataCol].mObj.ha==0){d.mHeader.style.textAlign="right"}else{if(this.mColFields[this.mColDatas[u].mDataCol].mObj.ha==1){d.mHeader.style.textAlign="center"}else{if(this.mColFields[this.mColDatas[u].mDataCol].mObj.ha==2){d.mHeader.style.textAlign="left"}}}}d.mX=z;d.mBar.style.visibility=(u>=f||d.mWidth<=0?"hidden":"inherit");d.mBar.setAttribute("arcolumnid",u);d.mHeader.style.width=d.mColumn.style.width=d.mWidth+"px";z+=d.mWidth;if(u==0&&this.mGroup){d.mHeader.style.width=d.mColumn.style.width=d.mWidth+16+"px";z+=16}d.mBarX=z-6;d.mBar.style.left=d.mBarX+"px"}}this.mColHdrObj.style.width=(z>this.mWidth?z:this.mWidth)+"px";if((this.mHScroll||this.mAccHScroll)&&z>this.mWidth){this.mInner.style.overflow="auto";if(this.mRowsPresent==0&&this.mFixedHeader){var h=document.createElement("td");h.style.width=z+"px";var y=document.createElement("tr");y.appendChild(h);this.mDataTableObj.lastChild.appendChild(y)}}else{this.mInner.style.overflowY="auto";this.mInner.style.overflowX="hidden";this.mInner.scrollLeft=this.mScrollLeft=0;o=this.mInner.offsetWidth-this.mInner.clientWidth;var w=(this.mColDatas[f].mWidth+(this.mWidth-z)-o);b=(w<=0?this.mColDatas[f].mWidth:w);this.mColDatas[f].mColumn.style.width=this.mColDatas[f].mHeader.style.width=b+"px";this.mColDatas[f].mWidth=b}this.ApplyExpensivePatchup(z,f,b)};BaseTable.prototype.FindContainingDiv=function(b){while(b&&b.tagName&&(b.nodeType!=1||b.tagName!="DIV")){b=b.parentNode}return b};function TableBtn(d,g,h,b){this.name=d;this.mObj=document.createElement("A");this.mObj.className=h+" btn btn3d TableBtn";this.mObj.href="javascript:";this.mObj.disabled=false;if(b!=null){var f=d+"&nbsp;<img style=border:none alt='' src='"+b+"'>";this.mObj.innerHTML=f}else{this.mObj.appendChild(document.createTextNode(d))}g.appendChild(this.mObj)}TableBtn.prototype.SetVisibility=function(b){this.mObj.style.visibility=(b?"inherit":"hidden")};TableBtn.prototype.GetAccess=function(){return retval=this.mObj.disabled};TableBtn.prototype.IsVisible=function(){return(this.mObj.style.visibility=="hidden"?false:true)};TableBtn.prototype.SetAccess=function(b){this.mObj.disabled=!b;FakeButton_SetDisable(this.mObj,this.mObj.disabled)};TableBtn.prototype.IsDisabled=function(){return this.mObj.disabled};BaseTable.prototype.ResetCellDisplay=function(d,b){if(!isChrome()){if(d<=0){b.firstChild.style.display="none";b.style.display="none"}else{b.firstChild.style.display="";b.style.display=""}}};BaseTable.prototype.ClearDisplayNone=function(b){if(!isChrome()){if(b.style.display=="none"){b.style.display=""}}};BaseTable.prototype.ApplyExpensivePatchup=function(k,d,b){var w=this.FishOutTR(0),s=this.mColDatas,f=null,o=0;if(w==null){return}if(this.mHScroll||this.mAccHScroll){this.mDataTableObj.style.width=k+"px"}if(this.colCheck==1&&w.firstChild!="undefined"&&w.firstChild.firstChild!="undefined"){o=w.firstChild.firstChild.clientWidth}while(w!=null){var v=w.firstChild;this.ClearDisplayNone(v);if(f==null){f=0;var u=document.defaultView.getComputedStyle(v,"");if(u!=null){f=parseInt(u.getPropertyValue("padding-left"));if(isNaN(f)){f=0}}}if(this.colCheck==1){this.ResetCellDisplay(o,v);v=v.nextSibling;this.ClearDisplayNone(v)}for(var g=0;g<this.mColCnt;++g){if(s[g].mVisible&&v!=null&&(v.firstChild==null||v.firstChild.tagName!="HR")){var h;if(g==d&&b!=null){h=b-f}else{h=s[g].mWidth-f}v.style.width=v.firstChild.style.width=(h<0?0:h)+"px";this.ResetCellDisplay(h,v);v=v.nextSibling}}w=w.nextSibling}};BaseTable.prototype.hasRootImg=function(){return false};BaseTable.prototype.getRootImgW=function(){return 0};BaseTable.prototype.getRootImgH=function(){return 0};BaseTable.prototype.getRootImgURL=function(){return null};BaseTable.prototype.getRootImgAltT=function(){return null};BaseTable.prototype.getRootImgFType=function(){return null};BaseTable.prototype.getRootImgRef=function(b){return""};BaseTable.prototype.getImgRefCell=function(b,f,d){return""};BaseTable.prototype.getNoDragDropStyleClasses=function(){return["BaseTableHeader","BaseTableBar"]};BaseTable.prototype.computeAggregate=function(b,d){if(b=="COUNT"){this.mAggregateVal++}};BaseTable.prototype.getandresetAggregate=function(){var b=this.mAggregateVal;this.mAggregateVal=0;return b};BaseTable.prototype.IsInFlowLayout=function(){var b=false;if(("GetParent" in this)){var d=this.GetParent();if(d&&d.mObj&&d.mObj.getAttribute("arfillstyle")==2){b=true}else{if((this.mObj.getAttribute("arflowid")==0)&&this.mObj.parentNode.getAttribute("arfillstyle")==2){b=true}}}return b};BaseTable.prototype.ClearStrings=function(){if(this.mFtrRObj!=null){NodeWrite(this.mFtrRObj,"")}if(this.mHdrLObj!=null){NodeWrite(this.mHdrLObj,"")}};BaseTable.prototype.jumpKeyCalRowSel=function(b){var d=null;for(var f=0;f<this.mColDatas.length&&d==null;++f){if(this.mColDatas[f].mVisible&&this.mColDatas[f].mWidth!=0){d=this.mColDatas[f].mDataCol}}var g;if(this.mPrimaryRowSelection==null){g=0}else{g=this.mLastRowSelection}g=(g<0?0:g);g=(g>=this.mRowsPresent?this.mRowsPresent-1:g);var h;for(var f=g+1;f<this.mResult.r.length;f++){h=this.mResult.r[f].d[d].v;if((h!=null)&&h.toLowerCase().indexOf(b)==0){return f}}if(g>0){for(var f=0;f<g;f++){h=this.mResult.r[f].d[d].v;if((h!=null)&&h.toLowerCase().indexOf(b)==0){return f}}}return -1};SimpleTable.prototype=new BaseTable();SimpleTable.prototype.constructor=SimpleTable;SimpleTable.superclass=BaseTable.prototype;SimpleTable.prototype.mHaveStoredData=false;SimpleTable.prototype.MouseSelectable=false;function SimpleTable(d,o,k,b,f,h,g){if(arguments.length){this.init(d,o,k,b,f,h,g)}}SimpleTable.prototype.init=function(b,k,s,y,E,H,C){this.mResult=H;this.mSort=E;this.mColInfo=[];for(var B=0;B<this.mResult.h.length;++B){if(typeof DAttachmentPool!="undefined"&&this instanceof DAttachmentPool==true){this.mColInfo.push({heading:this.mResult.h[B],wrap:false,edit:0,colgradcol:this.mResult.colgradcol,colgradbkgcol:this.mResult.colgradbkgcol,colgradtype:this.mResult.colgradtype,colhdrtxtcol:this.mResult.colhdrtxtcol})}else{this.mColInfo.push({heading:this.mResult.h[B],wrap:false,edit:0})}}this.mIsPopup=H.isPopup;var D=document.createElement("div");var g="TableHdr";var G="TableFtr";if(this.mIsPopup){G="TableFtr PopupTableHdr";G="TableFtr PopupTableFtr"}D.className=g;s.appendChild(D);this.mHdrObj=D;D=document.createElement("div");D.className="TableInner";s.appendChild(D);this.mInnerObj=D;D=document.createElement("div");D.className=G;if(typeof DAttachmentPool!="undefined"&&this instanceof DAttachmentPool==true){var f=s.getAttribute("arhdrftrgradcol");var d=s.getAttribute("arhdrftrgradbkgcol");var A=s.getAttribute("arhdrftrgradtype");if(d==null&&f!=null){d=f}if(f!=null&&d!=null){D.style.background="-webkit-gradient("+getPoint(f,d,A)+")"}}s.appendChild(D);this.mFtrObj=D;this.mHdrObj.innerHTML="<TABLE class='TableHdr' cellpadding=0 cellspacing=0><TBODY><TR><TD NOWRAP VALIGN=middle class='TableHdrL'></TD><TD NOWRAP VALIGN=middle class='TableHdrR'></TD></TR></TBODY></TABLE>";this.mFtrObj.innerHTML="<TABLE class='TableFtr' cellpadding=0 cellspacing=0><TBODY><TR><TD NOWRAP VALIGN=middle class='TableFtrL'></TD><TD NOWRAP VALIGN=middle class='TableFtrR'></TD></TR></TBODY></TABLE>";var o=this.mHdrObj.firstChild.firstChild.firstChild;this.mHdrLObj=o.childNodes[0];this.mHdrRObj=o.childNodes[1];o=this.mFtrObj.firstChild.firstChild.firstChild;this.mFtrLObj=o.childNodes[0];this.mFtrRObj=o.childNodes[1];this.mSortOrder=[];this.mCurrentRow=-1;SimpleTable.superclass.init.call(this,b,k,s,true,y,false);if(C){var z=[this.mHdrObj.firstChild.firstChild.firstChild,this.mFtrObj.firstChild.firstChild.firstChild];for(var B=0;B<C.length;++B){C[B].node=new TableBtn(C[B].name,z[C[B].bar].childNodes[C[B].loc],C[B].name,null)}this.mButtons=C}else{this.mButtons=null}SimpleTable.superclass.InstantiateUI.call(this,this.mInnerObj);this.SetDefaultSizes();var v=s.offsetHeight;if(v==undefined){var u=s.style.height;v=parseInt(u)}if(null!=s&&typeof s!="undefined"&&s.getAttribute("artype")=="AttachmentPool"&&0==s.offsetWidth&&0==s.offsetHeight){var h=s.style.width;var w=s.style.height;this.Resize(parseInt(h),parseInt(w))}else{this.Resize(s.offsetWidth,s.offsetHeight)}this.ApplyData();this.mHasChildFields=false};SimpleTable.prototype.getHoverEvtList=function(){return[]};SimpleTable.prototype.Clear=function(){this.S(Null)};SimpleTable.prototype.DOMClick=function(b){if(this.GAccess()==3){return}var k=this.FindContainingDiv(b.element);if(k==null){return}var h="TableHdr";var g="TableFtr";if(this.mIsPopup||k.className=="TableFtr PopupTableHdr"||k.className=="TableFtr PopupTableFtr"){g="TableFtr PopupTableHdr";g="TableFtr PopupTableFtr"}if(k.className==h||k.className==g){k=b.element;if(k.tagName!="A"){return}for(var f=0;f<this.mButtons.length;++f){if(this.mButtons[f].node.mObj==k){return this.mButtons[f].func.call(this,[])}}return}var d={c:{f:SimpleTable.superclass.DOMClick,a:[b],t:this}};if(this.GLabel()==getLocalizedMessage("Selection")){d.n={f:this.ARDrillDown,t:this}}return d};SimpleTable.prototype.DOMKeyDown=function(b){if(this.GAccess()==3){return}var g=this.FindContainingDiv(b.element);if(g==null){return}var f="TableHdr";var d="TableFtr";if(this.mIsPopup||g.className=="TableFtr PopupTableHdr"||g.className=="TableFtr PopupTableFtr"){d="TableFtr PopupTableHdr";d="TableFtr PopupTableFtr"}if(g.className==f||g.className==d){return}return SimpleTable.superclass.DOMKeyDown.call(this,b)};SimpleTable.prototype.GetSelectedRow=function(){return this.RowNoFromTag(this.mPrimaryRowSelection)};SimpleTable.prototype.GetColumnInfo=function(){return this.mColInfo};SimpleTable.prototype.GetInitialColumnWidths=function(){return this.mResult.w};SimpleTable.prototype.GetData=function(){if(this.mResult){return this.mResult.r}else{return[]}};SimpleTable.prototype.SetRowSortOrder=function(f,h,b,s){if(f==this.mSortOrder.col&&h==this.mSortOrder.dir){return null}if(!this.mResult){return null}if(!this.mSort){return null}var d=false;if(b!=null){for(var k in b){d=true;this.mResult.r[k].seltag=0}if(s!=-1){this.mResult.r[s].seltag=1}}if(f==this.mSortOrder.col&&h!=this.mSortOrder.dir){this.mResult.r.reverse()}else{this.mResult.r.sort(function(v,w){return v.d[f].v.localeCompare(w.d[f].v)})}var g=-1,u=[],o;if(d){for(var k in this.mResult.r){o=this.mResult.r[k];if("seltag" in o){if(o.seltag==1){g=k}u[k]=1;delete this.mResult.r[k].seltag}}}return{rows:u,primary:g}};SimpleTable.prototype.GetInitialRowSortOrder=function(){if(this.mColCnt>0){return{col:0,dir:1}}return null};SimpleTable.prototype.GetRowColours=function(){return null};SimpleTable.prototype.GetBkgRowColours=function(){return null};SimpleTable.prototype.SetFocusToFirstRow=function(){var b=this.FishOutTR(0);if(b!=null&&b.focus){setTimeout(function(){b.focus()},150)}};SimpleTable.prototype.mSortImgs=null;DTable.prototype=new BaseTable();DTable.prototype.constructor=DTable;DTable.superclass=BaseTable.prototype;DOMFieldFactories.Table=function(b,f,d){return new DTable(b,f,d)};DTable.prototype.mHaveStoredData=false;DTable.prototype.MouseSelectable=false;function DTable(b,f,d){if(arguments.length){this.init(b,f,d)}}DTable.prototype.MeddleResultsList=function(){var b=this.mObj;if(getForm_NS(this.windowID).RLReport){b.setAttribute("arrepstr",getLocalizedMessage("Report"))}b.setAttribute("arselallstr",getLocalizedMessage("Select All"));b.setAttribute("ardeselallstr",getLocalizedMessage("DeSelect All"));if(getForm_NS(this.windowID).RLDelete){b.setAttribute("ardeletestr",getLocalizedMessage("Delete"))}b.setAttribute("arrefstr",getLocalizedMessage("Refresh"));b.setAttribute("arprefsstr",getLocalizedMessage("Preferences"));if(!isNaN(parseInt(b.getAttribute("archunkbuttons")))&&this.isChunkControlVisibleForRL()){b.setAttribute("arentretstr",getLocalizedMessage("of {3} results"))}else{b.setAttribute("arentretstr",getLocalizedMessage("{2} of {3} results"))}};DTable.prototype.Resize=function(d,b){if(this.mAsyncMode){this.mAsyncResizePending={w:d,h:b};this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty)}else{this.DoResize(d,b)}};DTable.prototype.ResizeTo=function(f,b){var d=Math.round(b*(this.perHeight/100));var g=f;if(g<this.mMinWidth){g=this.mMinWidth}else{if(g>this.mMaxWidth){g=this.mMaxWidth}}if(d<this.mMinHeight){d=this.mMinHeight}else{if(d>this.mMaxHeight){d=this.mMaxHeight}}this.Resize(g,d)};DTable.prototype.DoResize=function(d,b){DTable.superclass.Resize.call(this,d,b);var f=F(this.windowID,this.mContainerID);if(f instanceof DPage&&f.mFillModel&&f.mState==1&&f.mFit){f.getChildScroll(this)}};DTable.prototype.init=function(f,A,D){this.mGroup=false;this.expandPending=null;this.mFunc=false;this.mAggregateVal=0;var h=D.getAttribute("argroup");if(h!=null&&h!=""){this.mGroup=true;$("#T"+A).treetable({expandable:true});this.mGroupOrder=[];var u=h.split(",");for(var J=0;J<u.length;J+=2){this.mGroupOrder.push(parseInt(u[J]));this.mGroupOrder.push(parseInt(u[J+1]))}}var d=D.getAttribute("arfunc");var o=D.getAttribute("arhdrftrgradcol");var g=D.getAttribute("arhdrftrgradbkgcol");var H=D.getAttribute("arhdrftrgradtype");if(g==null&&o!=null){g=o}if(o!=null&&g!=null){if(this instanceof DPageArray){D.firstChild.style.background="-webkit-gradient("+getPoint(o,g,H)+")"}else{D.firstChild.nextSibling.nextSibling.style.background="-webkit-gradient("+getPoint(o,g,H)+")"}D.lastChild.style.background="-webkit-gradient("+getPoint(o,g,H)+")"}if(d!=null&&d!=""){this.mFunc=true;this.mFuncOrder=[];var k=d.split(",");for(var J=0;J<k.length;J+=2){this.mFuncOrder.push(parseInt(k[J]));this.mFuncOrder.push(parseInt(k[J+1]))}}if(D.getAttribute("arcols")==""){this.mColInfo=this.mColFields=[]}else{var B=D.getAttribute("arcols").split(",");var E=D.getAttribute("arcoldlen").split(",");var I=D.getAttribute("arcolwrap");if(this instanceof DPageArray!=true&&this instanceof DTreeView!=true){var w=D.getAttribute("arcolgradbkgcol");var C=D.getAttribute("arcolgradcol");var G=D.getAttribute("arcolgradtype");var K=D.getAttribute("arcolhdrtxtcol");if(C==null&&w!=null){C=w}}this.mColInfo=[];this.mColFields=[];var v="";for(var J=0;J<B.length;++J){var b=getFields_NS(f);this.mColFields[J]=b[B[J]];if(this instanceof DPageArray!=true&&this instanceof DTreeView!=true){this.mColInfo.push({sort:this.mColFields[J].mObj.sort,heading:this.mColFields[J].mObj.lbl,edit:0,wrap:(I==null?false:(I.charAt(J)=="1")),dLen:E[J],lcl:(typeof this.mColFields[J].mObj.lcl=="undefined"?false:true),colgradcol:C,colgradbkgcol:w,colhdrtxtcol:K})}else{this.mColInfo.push({sort:this.mColFields[J].mObj.sort,heading:this.mColFields[J].mObj.lbl,edit:0,wrap:(I==null?false:(I.charAt(J)=="1")),dLen:E[J],lcl:(typeof this.mColFields[J].mObj.lcl=="undefined"?false:true)})}this.mColFields[J].mObj.dataidx=J}}if(D.getAttribute("arcols")!=""){var y=D.getAttribute("arcoledit");for(var J=0;J<B.length;++J){if(y!=null){if(y.charAt(J)=="1"){if(this.mColFields[J].mObj.t.indexOf("Enum")==-1){this.mColInfo[J].edit=2}}}else{this.mColInfo[J].edit=0}}}if(!this.mGroup){this.colCheck=D.getAttribute("arcolcheck")}else{this.colCheck=0}if(D.getAttribute("arcsize")!=null){this.mChunkSize=parseInt(D.getAttribute("arcsize"))}else{this.mChunkSize=0}this.mDisplayChunkSize=null;this.mActualDisplayChunkSize=null;this.isContentClipped=false;this.mChunkPage=0;this.mServer="";this.mSchema="";DTable.superclass.init.call(this,f,A,D,(D.getAttribute("arfixhdr")=="1"),parseInt(D.getAttribute("arselrows")),!parseInt(D.getAttribute("arautofit")));if(this.mGroup){for(var J=0;J<this.mGroupOrder.length;J+=2){this.mColDatas[this.mGroupOrder[J]].mVisible=false}}if(this.mObj.getAttribute("ardbn")=="CustomResultsList"){this.MeddleResultsList()}if(this.mID==1020){this.mCFCache.v=false}this.mMode=this.mObj.getAttribute("arselinit");this.mSortOrder=[];this.mCurrentRow=-1;this.mNotRefreshed=true;this.mRefreshInterval=0;this.mPrevARSelection=null;this.mHasChildFields=true;var L=false;var s=this.getHoverEvtList();var z=null;for(var J=0;J<s.length;J++){idx=J;z=AREventFunction(f,s[J],this.mID);if(z!=null){L=true;break}}if(!L){L=this.hoverEvtonChildren()}this.mHasHoverEvt=L;getTableFields_NS(f).push(this)};DTable.prototype.isCustomResultsList=function(){return(this.mObj.getAttribute("ardbn")=="CustomResultsList")};DTable.prototype.isChunkControlVisibleForRL=function(){var b=false;if((this.mObj.getAttribute("ardbn")=="CustomResultsList"||this.mID==1020)&&this.getChunkSize()>0){b=true}return b};DTable.prototype.isChild=function(f){var d=false;for(var b=0;b<this.mColFields.length;b++){if(this.mColFields[b].mID==f){d=true;break}}return d};DTable.prototype.getColNum=function(d){for(var b=0;b<this.mColFields.length;b++){if(this.mColFields[b].mID==d){return b}}return -1};DTable.prototype.InstantiateUI=function(){var b=this.mObj;this.InstantiateUI_Part1(b);this.InstantiateUI_Part2(b)};function getPoint(d,g,h){var f=parseInt(h);var b;if(d!=null&&g!=null){if(f==0){b="linear,left top, left bottom, from("+d+"),to("+g+")"}else{if(f==1){b="linear,left top, left bottom, from("+d+"),to("+g+")"}else{if(f==2){b="linear,left center, right center, from("+d+"),to("+g+")"}else{if(f==3){b="linear,center top, center bottom, from("+d+"),color-stop(50%,"+g+"),to("+d+")"}else{b="linear,left center, right center, from("+d+"),color-stop(50%,"+g+"),to("+d+")"}}}}}return b}DTableMenu.prototype=new Menu();DTableMenu.prototype.constructor=DTableMenu;DTableMenu.superclass=Menu.prototype;function DTableMenu(b,f,d){if(arguments.length){return{n:{f:this.init,t:this,a:[b,f,d]}}}}DTableMenu.prototype.init=function(b,f,d){DTableMenu.superclass.init.call(this,b,f);this.mTable=d;this.mName=getLocalizedMessage("Table Chunk Page");return{n:{f:this.Open,t:this,a:[d.mChunkMenuBtn.parentNode,3,null,false]}}};DTableMenu.prototype.HandleSelection=function(f){var b=getCurWFC_NS(this.windowID);var d=parseInt(f);if(d!=this.mTable.mChunkPage){this.mTable.mChunkPage=d;if(b!=null){return{n:{f:this.mTable.Refresh,t:this.mTable,a:[-1,0,false]}}}else{new WorkflowContext(this.windowID,{t:this.mTable,f:this.mTable.Refresh,a:[-1,0,false]})}}else{if(this.mTable.mChunkPage>0){this.mTable.mChunkPage=this.mTable.mChunkPage-1}this.HandleSelection(f)}};DEditMenu.prototype=new Menu();DEditMenu.prototype.constructor=DEditMenu;DEditMenu.superclass=Menu.prototype;function DEditMenu(b,k,d,h,g,f){if(arguments.length){return{n:{f:this.init,t:this,a:[b,k,d,h,g,f]}}}}DEditMenu.prototype.init=function(b,k,d,h,g,f){DTableMenu.superclass.init.call(this,b,k);this.mDataX=g;this.mXY=h;this.mLastRefreshTime=f.mLastRefreshTime;this.mTable=f;return{n:{f:this.Open,t:this,a:[d,3,null,false]}}};DEditMenu.prototype.HandleSelection=function(d){var b=getCurWFC_NS(this.windowID);if(this.mTable.mLastRefreshTime!=this.mLastRefreshTime){return}if(b!=null){return{n:{f:this.HandleSelectionInt,t:this,a:[d]}}}else{new WorkflowContext(this.windowID,{t:this,f:this.HandleSelectionInt,a:[d]})}};DEditMenu.prototype.HandleSelectionInt=function(f){var d=this.mTable.GetRow();this.mTable.SetRow(this.mXY.y);if(this.mTable.mColFields[this.mDataX].mObj.t=="Char"){var b=getLocalizedMessage("(no entries in menu)");this.mTable.mColFields[this.mDataX].S((f==b||f=="")?Null:new CharType(f))}else{this.mTable.mColFields[this.mDataX].S(f==""?Null:new EnumType(f))}this.mTable.SetRow(d)};DTable.prototype.hasContextMenu=true;DTable.prototype.getImgRefIds=function(){var g=new Array();var d=0;if(this.hasImgRefs()){for(var f=0;f<this.mColFields.length;f++){if(this.mColFields[f].hasImgRef()){var b=this.mColFields[f].getImgFid();g[d]=b;d++}}}return g};DTable.prototype.getCColorIds=function(){var b=new Array();var g=0;if(this.hasCellColor()){for(var f=0;f<this.mColFields.length;f++){if(this.mColFields[f].hasCellColor()){var d=this.mColFields[f].getCColorFid();b[g]=d;g++}}}return b};DTable.prototype.LoadResultsList=function(state,qual,arg,encodedQual,vuiId,search_label,search_ids,search_vals,inlwinopen){this.mResultsListState=state;this.mChunkPage=0;if(!this.mUIInstantiated){this.GetSortPreference()}if(typeof qual=="undefined"){qual={qual:"",fieldids:[],fieldvals:[],fieldtypes:[]}}var irid=this.getImgRefIds();var ccid=this.getCColorIds();var bloadFirst=(this.mMode==0||this.mMode==1?true:false);var loadEntryId="-1";if(bloadFirst){loadEntryId="0"}this.arg=arg;if(ShowWaitCursor()&&(typeof inlwinopen=="undefined"||inlwinopen==false)){return this.RefreshTable(-1,0,false,function(start,maxrows,dataWrapper){return{isFromFunctionSplit:1,c:{t:this,f:function(){var qbe=getQBE_NS(this.windowID);if(qbe){var result=qbe;if("q" in result){eval("this.mQual="+result.q)}if(result.n>0){var fldids=[],fldvals=[],fldtypes=[];if(this.arg){this.arg.ToArrays(fldids,fldvals,fldtypes);this.arg=null}if(fldids.length==0){var refreshmode=parseInt(this.mObj.getAttribute("arselrefresh"));getUDDHolderById(this.windowID).qbe=null;return this.RefreshTable_part2(result,start,maxrows,refreshmode)}}else{getUDDHolderById(this.windowID).qbe=null;var wargs=getWindowArgs_NS(this.windowID);if(wargs!=null&&wargs.suppressNoMatch==true){wargs.suppressNoMatch=false;throw new WorkflowException(this.windowID,0,[])}else{if(wargs!=null&&wargs.noMatchMessage!=null){var matchMsg=wargs.noMatchMessage;wargs.noMatchMessage=null;getCurWFC_NS(this.windowID).status([matchMsg]);throw new WorkflowException(this.windowID,0,[])}else{getCurWFC_NS(this.windowID).status([{n:9296,t:1,m:null,a:null}]);throw new WorkflowException(this.windowID,0,[])}}}getUDDHolderById(this.windowID).qbe=null}dataWrapper.req=new NDXRequest();dataWrapper.req.windowID=this.windowID;this.AsyncGetQBETableEntryList(arg,dataWrapper,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),start,maxrows,qual,irid,ccid,encodedQual,loadEntryId,vuiId,search_label,search_ids,search_vals);dataWrapper.req.showRunning();weDisableStuff(this.windowID);return{i:1}}},n:{t:this,f:function(){if(("req" in dataWrapper)&&("result" in dataWrapper.req)){this.ShowMessageAfterLoadRL(dataWrapper.req)}}}}})}else{return this.RefreshTable(-1,0,false,function(start,maxrows){var fieldids=[],fieldvals=[],fieldtypes=[];arg.ToArrays(fieldids,fieldvals,fieldtypes);var qbe=getQBE_NS(this.windowID);if(qbe){var result=qbe;if("q" in result){eval("this.mQual="+result.q)}if(result.n>0){if(fieldids.length==0){var refreshmode=parseInt(this.mObj.getAttribute("arselrefresh"));getUDDHolderById(this.windowID).qbe=null;return this.RefreshTable_part2(result,start,maxrows,refreshmode)}getUDDHolderById(this.windowID).qbe=null}else{getUDDHolderById(this.windowID).qbe=null;var wargs=getWindowArgs_NS(this.windowID);if(wargs!=null&&wargs.suppressNoMatch==true){wargs.suppressNoMatch=false;throw new WorkflowException(this.windowID,0,[])}else{if(wargs!=null&&wargs.noMatchMessage!=null){var matchMsg=wargs.noMatchMessage;wargs.noMatchMessage=null;getCurWFC_NS(this.windowID).status([matchMsg]);throw new WorkflowException(this.windowID,0,[])}else{getCurWFC_NS(this.windowID).status([{n:9296,t:1,m:null,a:null}]);throw new WorkflowException(this.windowID,0,[])}}}}req=new NDXGetQBETableEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),start,maxrows,this.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,fieldids,fieldvals,fieldtypes,encodedQual,vuiId,loadEntryId,window.name,search_label,search_ids,search_vals,irid,ccid);this.ShowMessageAfterLoadRL(req);return req})}};DTable.prototype.ShowMessageAfterLoadRL=function(req){if("q" in req.result){eval("this.mQual="+req.result.q)}if(req.result.n==0){var wargs=getWindowArgs_NS(this.windowID);if(wargs!=null&&wargs.suppressNoMatch==true){wargs.suppressNoMatch=false;throw new WorkflowException(this.windowID,0,[])}else{if(wargs!=null&&wargs.noMatchMessage!=null){var matchMsg=wargs.noMatchMessage;wargs.noMatchMessage=null;getCurWFC_NS(this.windowID).status([matchMsg]);throw new WorkflowException(this.windowID,0,[])}else{getCurWFC_NS(this.windowID).status([{n:9296,t:1,m:null,a:null}]);throw new WorkflowException(this.windowID,0,[])}}}};DTable.prototype.Refresh=function(startrow,numrows,fromchunk,swc,isautorefreshcall){if(isautorefreshcall&&window.weDialogueName!=null){return}if(this.mID==1020&&this.mNotRefreshed){if(!(getARStateCurrent_NS(this.windowID)==4)||getStateMgr_NS(this.windowID).InTransition()){return}return{n:{f:FormAction_Query,a:[this.windowID]}}}var istack=[];if(this.mID==1020){istack.push({t:getStateMgr_NS(this.windowID),e:weDisplayWFException,ea:[this.windowID],f:getStateMgr_NS(this.windowID).ARStateChange,a:[this.windowID,this.mResultsListState]})}istack.push({f:this.RefreshTable,t:this,a:[startrow,numrows,fromchunk,function(start,maxrows,dataWrapper){var server=this.mObj.getAttribute("arserver");server=ExpandServerName(this.windowID,server);var schema=this.mObj.getAttribute("arschema");schema=ExpandSchemaName(this.windowID,schema);if(this.mServer==""){this.mServer=server}if(this.mSchema==""){this.mSchema=schema}var qual;if(typeof this.mQual!="undefined"){qual=this.mQual}else{qual=this.mObj.getAttribute("arqual");eval("qual="+qual)}var optimizeCall=false;if(this.mID!=1020){optimizeCall=IsExternQualOptimizable(this.windowID,qual)}qual=ExpandQualifier(this.windowID,qual,schema,server,optimizeCall,isautorefreshcall);if(!this.mUIInstantiated){this.GetSortPreference()}else{if(this.mServer!=server||this.mSchema!=schema){this.mServer=server;this.mSchema=schema}}var irid=this.getImgRefIds();var ccid=this.getCColorIds();var encodedQual="";if(ShowWaitCursor()&&(typeof swc=="undefined")){return{isFromFunctionSplit:1,c:{t:this,f:function(){dataWrapper.req=new NDXRequest();dataWrapper.req.windowID=this.windowID;if(this.mID==1020){var search_label="",search_ids=[],search_vals=[];this.AsyncGetQBETableEntryList(null,dataWrapper,server,schema,start,maxrows,qual,irid,ccid,encodedQual,this.mPrimaryRowSelection,getForm_NS(this.windowID).currentFormVuiId,search_label,search_ids,search_vals)}else{dataWrapper.req.AsyncBC("GetTableEntryList",this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,server,schema,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),start,maxrows,this.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,qual.fieldexterns,optimizeCall,irid,ccid,isautorefreshcall)}dataWrapper.req.showRunning();weDisableStuff(this.windowID);return{i:1}}},n:{t:this,f:function(){}}}}else{if(this.mID==1020){var fieldids=[],fieldvals=[],fieldtypes=[];var search_label="",search_ids=[],search_vals=[];var entryToLoad="-1";if(this.mPrimaryRowSelection!=null){entryToLoad=this.mPrimaryRowSelection}return new NDXGetQBETableEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,server,schema,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),start,maxrows,this.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,fieldids,fieldvals,fieldtypes,encodedQual,getForm_NS(this.windowID).currentFormVuiId,entryToLoad,window.name,search_label,search_ids,search_vals,irid,ccid)}else{if(!isautorefreshcall){isautorefreshcall="DisabledSessionExcludedTableAutoRefreshCall"}return new NDXGetTableEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,server,schema,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),start,maxrows,this.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,qual.fieldexterns,optimizeCall,irid,ccid,isautorefreshcall)}}},swc,isautorefreshcall]});if(this.mID==1020&&this.mPrimaryRowSelection!=null){istack.push({t:this,f:function(){this.mPrevARSelection=this.mARRowSelection;return{n:{f:getStateMgr_NS(this.windowID).EventUndisplay,a:[this.windowID,getStateMgr_NS(this.windowID)]}}}})}return{n:istack}};DTable.prototype.AsyncGetQBETableEntryList=function(h,E,z,w,g,B,k,o,d,y,f,b,s,C,u){var A=[],v=[],D=[];if(f==null){f="-1"}do{if(!(typeof(y)=="string")){Assert('(Table.js:636) typeof(encodedQual) == "string"')}}while(0);if(h){h.ToArrays(A,v,D)}E.req.AsyncBC("GetQBETableEntryList",this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,z,w,((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),g,B,this.mSortOrder,k.qual,k.fieldids,k.fieldvals,k.fieldtypes,A,v,D,y,b,f,window.name,s,C,u,o,d)};DTable.prototype.IsRefreshed=function(){return !this.mNotRefreshed};DTable.prototype.getMaxChunks=function(){return this.mChunkMax};DTable.prototype.ComputeMaxChunks=function(d,b,h){var f=0;f=this.ComputeChunkNumber(d);f++;if(this.getDisplayChunkSize()==0){return f}var g=this.getDisplayChunkSize();var o=b;if(this.chunkDirtyTable){if(h>g){o+=(h-g)}}var k=d+1;k+=g;while(k<=o){f++;k+=g}return f};DTable.prototype.ComputeChunkNumber=function(d){var b=0;if(this.getDisplayChunkSize()==0){return b}b=Math.floor(d/this.getDisplayChunkSize());if(b==0&&d>0){b++}else{if(d%this.getDisplayChunkSize()!=0){b++}}return b};DTable.prototype.getNewChunkStart=function(){if(this.mNotRefreshed){return 0}var b=this.ComputeChunkNumber(this.mResult.start);var g;var k;if(this.mChunkPage<=b){k=(b-this.mChunkPage)*this.getDisplayChunkSize();g=this.mResult.start-k;if(g<0){g=0}return g}else{if(b+1!=this.mChunkPage){k=(this.mChunkPage-b)*this.getDisplayChunkSize();g=this.mResult.start+k;return g}}if(!this.isContentClipped){return this.mResult.start+this.getDisplayChunkSize()}var f=this.mResult.start;var h=this.getActualDisplayChunkSize();var d=0;for(i=0;i<this.mResult.r.length;i++){if(this.mResult.r[i].mXXXDirty==3){f++}else{if(this.mResult.r[i].mXXXDirty==2){d++}else{f++;d++}}if(d>=h){break}}if(f>=this.mResult.n){f=this.mResult.start}return f};DTable.prototype.RefreshTable=function(w,h,f,A,k){LogWrite('Refresh Field "'+this.GLabelOrName()+"("+this.mID+')"');if(OpenedMenu!=null&&OpenedMenu instanceof TableContextMenu&&OpenedMenu.mTableObj==this){Menu_Close()}this.mPrevARSelection=null;this.chunkDirtyTable=false;var d,s,g=null;var y=parseInt(this.mObj.getAttribute("arselrefresh"));if(f||this.mNotRefreshed||(y!=0&&y!=1)){this.ClearSelections(true)}if(this.getDisplayChunkSize()>0){if(w>=0){d=w}else{d=this.getNewChunkStart()}if(this.mResult){var b=this.ComputeMaxChunks(d,this.mResult.n);this.mChunkMax=b;if(this.mChunkPage>=b){this.mChunkPage=b-1}}if(this.mChunkPage<0){this.mChunkPage=0}s=(h>0)?h:this.getChunkSize()}else{d=(w>=0)?w:0;s=(h>0)?h:parseInt(this.mObj.getAttribute("armaxrows"))}if(this.mNotRefreshed&&this.mSortOrder.length==0){var u=this.GetInitialRowSortOrder();if(u!=null){this.RebuildSortOrder(u.col,u.dir)}}if(ShowWaitCursor()&&(typeof k=="undefined")){var o={};return{isFromFunctionSplit:1,c:{t:this,f:function(){var B=A.call(this,d,s,o);if(B.result){o.req=B}else{return B}}},n:{t:this,f:function(){if(("req" in o)&&("result" in o.req)){var B=o.req.result;if(B==null){return}return this.RefreshTable_part2(B,d,s,y)}}}}}else{var v=A.call(this,d,s);var z=v.result;if(z==null){return}return this.RefreshTable_part2(z,d,s,y)}};DTable.prototype.TriggerEventRefresh=function(){if(this.mID!=1020){if(!getCurWFC_NS(this.windowID)){promptBar.setToClear()}return ExecuteWorkflow(this.windowID,2097152,this.mID)}};DTable.prototype.createHeaderString=function(s,g,o){var k=this.mObj.getAttribute("arentretstr");if(k!=""&&k!=null){k=k.replace(/\{0\}/,(s==0?0:o+1));var b;if(this instanceof DPageArray){b=(this.getActualDisplayChunkSize()<s)?this.getActualDisplayChunkSize():s}else{b=s}var f=o+b;k=k.replace(/\{1\}/,(s==0?0:f));var d=s;if(this.isContentClipped){if(s>0){d=this.getActualDisplayChunkSize()}}if(typeof this.getMaxChunks()=="undefined"||this.getMaxChunks()==1||this.mObj.getAttribute("archunkbuttons")==null||k.indexOf("{2}")!=0){k=k.replace(/\{2\}/,d)}else{k=k.replace(/\{2\}/,"")}k=k.replace(/\{3\}/,g);var h;if(getDefaults_NS(this.windowID)[this.mID]){if(s>1){h=getDefaults_NS(this.windowID)[this.mID].rlp?getDefaults_NS(this.windowID)[this.mID].rlp:""}else{h=getDefaults_NS(this.windowID)[this.mID].rl?getDefaults_NS(this.windowID)[this.mID].rl:""}}k=k.replace(/\{4\}/,h)}else{if(k==null){k=""}}return k};DTable.prototype.RefreshTable_part2=function(E,f,v,B){if(E.start!=null){f=E.start}if(this.mID==1020){if(E.n>h&&h<this.getChunkSize()&&E.n!=(f+v)){this.setChunkSize(h)}if(typeof E.cs!="undefined"&&E.cs!=null){this.setChunkSize(E.cs)}}else{var d=this.mObj.getAttribute("archunkbuttons")!=null;if((typeof E.cs!="undefined"&&E.cs!=null)&&d){this.setChunkSize(E.cs)}}if(this.mID==1020&&this.getDisplayChunkSize()>=0){this.mChunkPage=this.ComputeChunkNumber(f);this.mChunkMax=this.ComputeMaxChunks(f,E.n);if(this.mChunkOuter!=null){this.UpdateChunkUI(E.n)}}else{if(this.getDisplayChunkSize()>0){this.mChunkPage=this.ComputeChunkNumber(f);this.mChunkMax=this.ComputeMaxChunks(f,E.n);if(this.mChunkOuter!=null){this.UpdateChunkUI(E.n)}}}if(E.n<f+v){v=E.n-f}var h=E.r.length;if(v<=0){v=h}this.mResult=E;this.mLastRefreshTime=new Date().getTime();ARKWSetLASTCOUNT(this.windowID,E.n);var k=this.mResult.idmap;for(var o in this.mRowSelections){if(!(o in k)){delete this.mRowSelections[o]}}if(this.mPrimaryRowSelection!=null&&(!(this.mPrimaryRowSelection in k))){this.mPrimaryRowSelection=null;this.mResult.eid=null;delete this.mResult.e}this.mARRowSelection=this.mPrimaryRowSelection==null?0:this.RowNoFromTag(this.mPrimaryRowSelection)+1;this.mLastNonShiftedRowSelection=this.mLastRowSelection=this.mARRowSelection-1;this.SetRow(this.mARRowSelection-1);var A=this.mObj.getAttribute("arcoledit");for(var o=0;o<this.mColCnt;++o){if(A!=null){if(A.charAt(o)=="1"){if(E.f[o].t.indexOf("Enum")==-1){this.mColInfo[o].edit=2}else{if(E.f[o].et==2){this.mColInfo[o].edit=3;var b=E.f[o].e;for(var h in b){this.mColInfo[o].mEnumLabel=b[h];this.mColInfo[o].mEnumValue=h;break}}else{this.mColInfo[o].edit=1}}}else{if(A.charAt(o)=="2"){if(E.f[o].t.indexOf("Char")!=-1&&E.f[o].m!=null){this.mColInfo[o].edit=1}}else{this.mColInfo[o].edit=0}}}if("dLen" in E.f[o]){this.mColInfo[o].dLen=E.f[o].dLen}}var g=this.mObj.getAttribute("arserver");g=ExpandServerName(this.windowID,g);if(g!=ARKWGetStringByIdx(this.windowID,7)){for(var D=0;D<this.mColCnt;D++){if(E.f[D].t.indexOf("Char")!=-1&&E.f[D].m!=null&&(this.mColInfo[D].edit==1)){var u=E.f[D].m;var y=ARMenu_Get(this.windowID,u,g)}}}for(var o=0;o<this.mColFields.length;++o){this.mColFields[o].Refresh()}this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty);var C=E.r.length;var z="";if(this.mID==1020){if(this.getMaxChunks()==1||(this.mObj.getAttribute("archunkbuttons")==null)){this.mObj.setAttribute("arentretstr",getLocalizedMessage("{2} of {3} results"))}z=this.createHeaderString(C,E.n,f)}else{z=this.createHeaderString(C,E.n,f)}this.mAsyncQueue.push({action:2,val:z,cval:this.mChunkPage+1});if(this instanceof DTreeView){this.BuildTree()}if(this.mNotRefreshed){this.mNotRefreshed=false;if(this.GetData().length>0){if(this.mMode!=2){if(this.mMode==0){return{c:{t:this,f:this.SetPrimarySelection,a:[0,true,false,true]},n:{t:this,f:this.TriggerEventRefresh}}}else{return{c:{t:this,f:this.SetPrimarySelection,a:[0,false,false,true]},n:{t:this,f:this.TriggerEventRefresh}}}}else{return{n:{t:this,f:this.TriggerEventRefresh}}}}else{return{n:{t:this,f:this.TriggerEventRefresh}}}}else{if(this.GetData().length>0){if(this.mID==1020&&this.mChunkSize>0){var w=this.GetRow();if(w==-1){return{c:{t:this,f:this.SetPrimarySelection,a:[0,false,false,true]},n:{t:this,f:this.TriggerEventRefresh}}}else{return{n:{t:this,f:this.TriggerEventRefresh}}}}if(B==2){return{c:{t:this,f:this.S,a:[new IntegerType(1)]},n:{t:this,f:this.TriggerEventRefresh}}}else{if(B==3){return{c:{t:this,f:this.S,a:[new IntegerType(-1)]},n:{t:this,f:this.TriggerEventRefresh}}}else{if(B==0){var w=this.GetRow();this.SetRow(this.mARRowSelection-1);if(w>=this.GetData().length){w=-1}this.SetRow(w);if(this.GetRow()>-1){return{c:{f:ExecuteWorkflow,a:[this.windowID,128,this.mID]},n:{t:this,f:this.TriggerEventRefresh}}}return{n:{t:this,f:this.TriggerEventRefresh}}}else{return{n:{t:this,f:this.TriggerEventRefresh}}}}}}else{return{n:{t:this,f:this.TriggerEventRefresh}}}}};DTable.prototype.UpdateHeaderUI=function(h,f){if(this.mHdrLObj!=null){if(this.mChunkOuter==null||this.getMaxChunks()==1){this.mHdrLObj.innerHTML=h.HTMLEncode()}else{if(this.mNotRefreshed){if(this.mHdrRow.childNodes.length==3){var g=this.mHdrObj.firstChild.firstChild.firstChild;var d=this.mObj.getAttribute("archunkbuttons")!=null;if(d){g.removeChild(g.childNodes[0])}}this.mHdrLObj.innerHTML=h.HTMLEncode()}else{this.mHdrLObj.innerHTML=(this.chunkDirtyTable?"":h.HTMLEncode())}}var k=DTable.superclass.MakeTableTitle.call(this,h);if(this.mHasHoverEvt){k=""}if(this.mDataTableObj){this.mDataTableObj.title=k}}if(this.mChunkInput!=null&&!this.mNotRefreshed){var b="";if(!this.chunkDirtyTable){b=this.getStartChunkNumber()+"-"+this.getEndChunkNumber()}this.mChunkInput.value=b}};DTable.prototype.UpdateChunkUI=function(d){if(this.mChunkOuter==null){return}if(this.mHdrRow.childNodes.length==2){this.updateChunkHeader2()}var b=this.getMaxChunks();if(b==1){this.mChunkCell.style.display="none"}else{this.mChunkCell.style.display="table-cell";if(this.chunkDirtyTable){FakeButton_SetDisable(this.mChunkMenuBtn,true)}else{this.mChunkInput.className="";this.mChunkInput.className="btnimg";FakeButton_SetDisable(this.mChunkMenuBtn,false)}if(this.mChunkPage==0){FakeButton_SetDisable(this.mChunkPrevBtn,true);FakeButton_SetDisable(this.mChunkNextBtn,false)}else{if(this.mChunkPage==b-1){FakeButton_SetDisable(this.mChunkPrevBtn,false);FakeButton_SetDisable(this.mChunkNextBtn,true)}else{FakeButton_SetDisable(this.mChunkPrevBtn,false);FakeButton_SetDisable(this.mChunkNextBtn,false)}}}};DTable.prototype.Report=function(){if(!this.mResult){return}ReportSelForm=decodeURIComponent(ReportSelForm);var reportConsole=false;if(ReportConsoleForm!=null&&ReportConsoleForm.length>0){ReportConsoleForm=decodeURIComponent(ReportConsoleForm);reportConsole=true}var inmap={};var val;var schema=this.mObj.getAttribute("arschema");schema=ExpandSchemaName(this.windowID,schema);val=new CharType(schema);inmap[(reportConsole==true)?93992:2000035]={t:val.type,v:val.toPrimitive(),a:val.args()};var server=this.mObj.getAttribute("arserver");server=ExpandServerName(this.windowID,server);val=new CharType(server);inmap[(reportConsole==true)?93296:2000036]={t:val.type,v:val.toPrimitive(),a:val.args()};var qual;if(typeof this.mQual!="undefined"){qual=this.mQual}else{qual=this.mObj.getAttribute("arqual");eval("qual="+qual)}qual=ExpandQualifier(this.windowID,qual,schema,server);if(qual.qual!=""&&qual.fieldids.length>0){var req=new NDXParseAndEvaluateQualifier(this.windowID,server,schema,"",qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes);qual={qual:req.result,fieldids:[],fieldvals:[],fieldtypes:[]}}val=new CharType(qual.qual);inmap[(reportConsole==true)?93289:2000037]={t:val.type,v:val.toPrimitive(),a:val.args()};var ids=this.GetSelectedRowsByEntryId();var entryIDS=[];if(ids.length>0&&ids.length<this.mResult.n){entryIDS.push(ids[0]);for(var i=1;i<ids.length;i++){entryIDS.push(",");entryIDS.push(ids[i])}}if(entryIDS.length>0){val=new CharType(entryIDS.join(""));inmap[(reportConsole==true)?93291:2000038]={t:val.type,v:val.toPrimitive(),a:val.args()}}val=new CharType(schema);inmap[(reportConsole==true)?93297:2000050]={t:val.type,v:val.toPrimitive(),a:val.args()};var reportServer=server;var temp=ARPrefsGetAsString(24002);if(temp!=null&&temp.length>0){var semicolonIndex=temp.indexOf(";");if(semicolonIndex<0){reportServer=temp}else{if(semicolonIndex>0){reportServer=temp.substring(0,semicolonIndex)}}}return ARACTOpenDialog(this.windowID,reportServer,(reportConsole==true)?ReportConsoleForm:ReportSelForm,"",1,inmap,null,null,null)};DTable.prototype.getChunkSize=function(){return this.mChunkSize};DTable.prototype.setChunkSize=function(b){this.mChunkSize=b};DTable.prototype.getDisplayChunkSize=function(){var b=this.mChunkSize;if(this.isContentClipped){if(this.mDisplayChunkSize!=null){b=this.mDisplayChunkSize}}return b};DTable.prototype.setDisplayChunkSize=function(b){this.mDisplayChunkSize=b};DTable.prototype.getActualDisplayChunkSize=function(){var b=this.mChunkSize;if(this.isContentClipped){if(this.mActualDisplayChunkSize!=null){b=this.mActualDisplayChunkSize}}return b};DTable.prototype.setActualDisplayChunkSize=function(b){this.mActualDisplayChunkSize=b};DTable.prototype.NextChunk=function(b){if(this.getDisplayChunkSize()==0){return}this.mChunkPage+=b;return{n:{t:this,f:this.Refresh,a:[-1,0,true]}}};DTable.prototype.SelectAll=function(f){var d=[];d.push({t:this,f:function(){this.mAsyncDirty=(2>this.mAsyncDirty?2:this.mAsyncDirty)}});if(f){var b=this.mPrimaryRowSelection;d.push({t:this,f:function(){if(this.mID==1020){formEnableStuff(this.windowID)}if(this.mPrimaryRowSelection!=null){this.SetRow(this.RowNoFromTag(this.mPrimaryRowSelection))}if(this.mPrimaryRowSelection!=null&&this.mPrimaryRowSelection!=b){this.mARRowSelection=(b!=null)?this.RowNoFromTag(b)+1:this.RowNoFromTag(this.mPrimaryRowSelection)+1;return{n:{t:this,a:[true,true,b],f:this.ARRowSelected}}}}});d.push({t:this,f:this.FillAllSelections})}else{d.push({t:this,f:function(){this.mLastRowSelection=this.mLastNonShiftedRowSelection=-1;this.ClearSelections(true);this.SetRow(-1);if(this.mID==1020){Field_Clear(this.windowID,true);Field_ClearChanged(this.windowID);formDisableStuff(this.windowID)}}});if(this.mID==1020&&this.mPrimaryRowSelection!=null){d.push({t:this,f:function(){this.mPrevARSelection=this.mARRowSelection;return{n:{f:getStateMgr_NS(this.windowID).EventUndisplay,a:[this.windowID,getStateMgr_NS(this.windowID)]}}}})}}return{n:d}};DTable.prototype.Preferences=function(b,f){var d=new TableSettingsMenu(f);return{n:{f:d.Open,a:[b,3],t:d}}};DTable.prototype.MarkRead=function(b){};DTable.prototype.GetRowSelected=function(b){b=this.TagFromRowNo(b);if(this.mPrimaryRowSelection!=null&&b==this.mPrimaryRowSelection){return 2}else{if(this.mRowSelections[b]){return 1}}return 0};DTable.prototype.getVisibleRowNum=function(f){var d=0;for(var b=-1;b<f;b++){if(this.mResult.r[b+1].mXXXDirty){if(this.mResult.r[b+1].mXXXDirty!=3){d++}}else{d++}}return d};DTable.prototype.GetRowVisibility=function(f){if(f>=0&&f<this.GetData().length){if(this.mResult.r[f].mXXXDirty&&this.mResult.r[f].mXXXDirty==3){return false}if(this.isContentClipped){var b=this.getActualDisplayChunkSize();var d=this.getVisibleRowNum(f);if(d<=b){return true}else{return false}}else{return true}}return false};DTable.prototype.GetRowState=function(d){var b=this.mResult.r[d].mXXXDirty;if(typeof b=="undefined"){return 0}return b};DTable.prototype.SetRowState=function(h,f){if(this.mResult==undefined){return}if(h<-1||h>=this.GetData().length){return}var g=false;if(h==-1){var b=this.GetData().length;for(var d=0;d<b;++d){if(!g&&this.mResult.r[d].mXXXDirty!=undefined&&f!=this.mResult.r[d].mXXXDirty){if(this.mResult.r[d].mXXXDirty==2&&f==3||this.mResult.r[d].mXXXDirty==3&&f==2){g=true}}this.mResult.r[d].mXXXDirty=f}}else{if(!g&&this.mResult.r[h].mXXXDirty!=undefined&&f!=this.mResult.r[h].mXXXDirty){if(this.mResult.r[h].mXXXDirty==2&&f==3||this.mResult.r[h].mXXXDirty==3&&f==2){g=true}}else{if(!g&&this.mResult.r[h].mXXXDirty==undefined&&f==3){g=true}}this.mResult.r[h].mXXXDirty=f}if(g){this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)}};DTable.prototype.GetRows=function(){return this.GetData().length};DTable.prototype.GetSelectedRows=function(){var d=[];for(var b in this.mRowSelections){d.push(this.RowNoFromTag(b))}d.sort(function(f,g){return(f-g)});return d};DTable.prototype.SetRow=function(d){this.mCurrentRow=d;this.mARRowSelection=d+1;if(d==-1){for(var b=0;b<this.mColFields.length;++b){this.mColFields[b].Update(null,null)}}else{for(var b=0;b<this.mColFields.length;++b){this.mColFields[b].Update(this.mResult.r[d].d[b],this.mResult.r[d].i)}}};DTable.prototype.GetRow=function(){return this.mCurrentRow};DTable.prototype.DataChanged=function(){this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)};DTable.prototype.G=function(){if(this.mARRowSelection==null){return Null}return new IntegerType(this.mCurrentRow+1)};DTable.prototype.DoSet=DTable.prototype.DoSLoadEntry=function(g){if(g instanceof Datatype){g=g.toInteger()}else{if(g==""){g=0}else{g=parseInt(g)}}var h=true;var b=true;if(g<0){g=-g;h=false}if(g>100000000){g-=100000000;b=false}var d=this.GetData().length;if(g>d){g=0;h=false;b=true}if(g==0){this.ClearSelections(true);this.mAsyncDirty=(2>this.mAsyncDirty?2:this.mAsyncDirty)}else{if(this.mARRowSelection==g){return}if(b){return{c:{f:this.SetPrimarySelection,t:this,a:[g-1,h,true,true]},n:{t:this,f:function(){this.mAsyncDirty=(2>this.mAsyncDirty?2:this.mAsyncDirty)}}}}else{var f=this.GetRow();getCurWFC_NS(this.windowID).AddCallback(this,function(k){if(k>=this.GetData().length){k=-1}this.SetRow(k)},[f]);this.SetRow(g-1);if(h){return{n:{f:ExecuteWorkflow,a:[this.windowID,128,this.mID]}}}}}};DTable.prototype.GetHoverValue=function(b){if(this.mARRowSelection==null){return""}var d=this.mCurrentRow+1;return d+""};DTable.prototype.GDefault=function(){return null};DTable.prototype.Clear=function(){if(this.mNotRefreshed){return}delete this.mResult;delete this.mResultsListState;if(this.mRowsPresent>0&&typeof this.mInner!="undefined"){this.mInner.innerHTML=""}this.SetRow(-1);this.ClearSelections(true);this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty);var b=this.mObj.getAttribute("arnotrefstr");if(b==null){b=""}this.mAsyncQueue.push({action:2,val:b,cval:0});this.mNotRefreshed=true};DTable.prototype.FlushAsyncQueue=function(){if(!this.mAsyncDirty){return}if(!this.mUIInstantiated){this.InstantiateUI();this.SetDefaultSizesAndOrder();var b=gettablePrefs_NS(this.windowID);if(b!=null&&typeof b.interval[this.mID]!="undefined"){this.mRefreshInterval=b.interval[this.mID];ARRegisterTableRefreshInterval(this.windowID,this,this.mRefreshInterval)}}var f=false;try{++this.mFlushingQueue;while(this.mAsyncQueue.length){var d=this.mAsyncQueue.shift();if(d.action==0){this.mColFields[d.col].UpdateLabel(d.val)}else{if(d.action==1){this.mColFields[d.col].UpdateVis(d.val);f=true}else{if(d.action==2){this.UpdateHeaderUI(d.val,d.cval)}}}}if(this.mAsyncResizePending){this.DoResize(this.mAsyncResizePending.w,this.mAsyncResizePending.h)}if(f&&!this.mHScroll){this.ScaleSizes()}if(this.mAsyncDirty>=3){if(this instanceof DTreeView){this.BuildTree()}this.ApplyData()}else{if(this.mAsyncDirty>=2){this.ApplySelections(true,false)}}this.mAsyncDirty=0;this.mAsyncResizePending=null}finally{--this.mFlushingQueue;var g=F(this.windowID,this.mParentField);while(g){if(g instanceof DPage&&g.mFillModel&&g.mState==1&&g.mFit){g.getChildScroll(this)}g=g.GetParent()}}};DTable.prototype.UpdateAccess=function(b){if(this.mGroup&&!this.mNotRefreshed){this.ApplyData()}};DTable.prototype.SColLabel=function(b,d){if(this.mFlushingQueue>0){DTable.superclass.SColLabel.call(this,b,d)}else{this.mColInfo[b].heading=d;this.mAsyncQueue.push({action:0,col:b,val:d});this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)}};DTable.prototype.SColVis=function(b,d){if(this.mFlushingQueue>0){DTable.superclass.SColVis.call(this,b,d)}else{this.mAsyncQueue.push({action:1,col:b,val:d});this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)}};function DTable_DoEntryChange(d,h){var b=[];var f=getTableFields_NS(d);for(var g=0;g<f.length;++g){if(f[g].mObj.getAttribute("arautorefresh")&&ARPrefsGetAsNumber(20119)==1&&(h==0)){if(ExpandServerName(d,f[g].mObj.getAttribute("arserver")).length>0&&ExpandSchemaName(d,f[g].mObj.getAttribute("arschema")).length>0){b.push({t:f[g],f:DTable.prototype.Refresh,a:[-1,0,false]})}}else{if((h==1)&&f[g].mID!=1020){if(getStateMgr_NS(d).mWindowIsCopyingNew){f[g].ClearSelections(true)}else{f[g].Clear()}}}}if(b.length>0){return getCurWFC_NS(d).executeAll(b)}}DTable.prototype.Snapshot=function(f,d,b){var g=DTable.superclass.Snapshot.call(this,f,d,b);if(g.d){g.d=""+(-g.d)}return g};DTable.prototype.RebuildSortOrder=function(f,d){var b=this.mObj.getAttribute("arsort");var h=b.split(",");if(this.mGroup){this.mSortOrder=[this.mGroupOrder[0],this.mGroupOrder[1]];if(f!=-2){this.mSortOrder.push(f);this.mSortOrder.push(d)}for(var g=0;g<h.length;g+=2){var o=parseInt(h[g]);if(o!=this.mGroupOrder[0]&&(!(f!=-2)||o!=f)){var k=parseInt(h[g+1]);this.mSortOrder.push(o);this.mSortOrder.push(k)}}return}if(f==-2){this.mSortOrder=[]}else{this.mSortOrder=[f,d]}if(b!=""){for(var g=0;g<h.length;g+=2){var o=parseInt(h[g]);if(o!=f){var k=parseInt(h[g+1]);this.mSortOrder.push(o);this.mSortOrder.push(k)}}}};DTable.prototype.GetSelectedRowsByEntryId=function(){var b=[];for(var d in this.mRowSelections){b.push(d)}return b};DTable.prototype.DeleteSelected=function(){var d=this.GetSelectedRowsByEntryId();if(d.length==0){return}var f;if(d.length==1){f=getLocalizedMessage("{0} entry selected for deletion",[d.length])}else{f=getLocalizedMessage("{0} entries selected for deletion",[d.length])}var b={};return{c:{f:ConfirmPopup,a:[this.windowID,f,b,2|1]},n:{t:this,f:function(){if(("v" in b.result)&&b.result.v==1){var w=this.mObj.getAttribute("arserver");w=ExpandServerName(this.windowID,w);var u=this.mObj.getAttribute("arschema");u=ExpandSchemaName(this.windowID,u);var v=null;var g=null;for(var o=0;o<this.mResult.r.length;o++){v=this.mResult.r[o].i;var k=false;for(var h=0;h<d.length;h++){if(d[h]==v){k=true;break}}if(!k){g=v;break}}var s=new NDXDeleteEntry(this.windowID,w,u,d);this.mPrimaryRowSelection=g;this.mARRowSelection=this.mPrimaryRowSelection==null?0:this.RowNoFromTag(this.mPrimaryRowSelection)+1;this.mLastNonShiftedRowSelection=this.mLastRowSelection=this.mARRowSelection-1;this.mRowSelections=[];if(null!=this.mPrimaryRowSelection){this.mRowSelections[this.mPrimaryRowSelection]=true}return this.Refresh(0,0,false)}}}}};DTable.prototype.Resort=function(d,b){this.RebuildSortOrder(d,b);this.mChunkPage=0;return this.Refresh(-1,0,false)};DTable.prototype.ApplyData=function(){DTable.superclass.ApplyData.call(this);var g=(this.GetData().length>0);if(this.mBtnReport){this.mBtnReport.SetVisibility(g)}if(this.mBtnSelectAll){this.mBtnSelectAll.SetVisibility(g)}if(this.mBtnDeselectAll){this.mBtnDeselectAll.SetVisibility(g)}if(this.mBtnDelete){this.mBtnDelete.SetVisibility(g)}if(this.mBtnRead){this.mBtnRead.SetVisibility(g)}if(this.mBtnUnread){this.mBtnUnread.SetVisibility(g)}if(this.mChunkOuter){this.mChunkOuter.style.visibility=(g?"inherit":"hidden")}var f=this.windowID;if(FocusMgr.mCurFocusID==this.mID&&FocusMgr.mCurFocusElement!=null){setTimeout(function(){FocusMgr.TryFocus(f,FocusMgr.mCurFocusElement)},0)}if(this.mGroup&&!this.mNotRefreshed){var k="collapsed";if(this.expandPending!=null){k=this.expandPending;this.expandPending=null;this.mFolderStatus=null}if(this.GAccess()==3){$("#T"+this.mID).treetable({clickableNodeNames:true,initialState:k,expandable:false,indent:15})}else{$("#T"+this.mID).treetable({clickableNodeNames:true,initialState:k,indent:15,expandable:true});if(this.mFolderStatus!=null&&this.mFolderStatus.length>0){this.restoreAllFolderStatus(this.mFolderStatus);var b=$("#T"+this.mID).find(".SelPrimary");if(b.length>0){b[0].focus()}}else{if(this.mPrimaryRowSelection!=null){primrowno=this.RowNoFromTag(this.mPrimaryRowSelection);var h=this.FishOutTR(primrowno);while(h&&h.previousSibling){h=h.previousSibling;if(h&&(h.className.indexOf("branch")>=0||h.className.indexOf("parent")>=0||h.className.indexOf("emptyGroup")>=0)){var d=h.getAttribute("id");$("#T"+this.mID).treetable("expandNode",d);h=null}}}}}}};DTable.prototype.ARRowSelected=function(g,f,d,s){this.SetRow(this.mARRowSelection-1);if(this.mGroup&&!this.mNotRefreshed){if(this.mPrimaryRowSelection!=null){primrowno=this.RowNoFromTag(this.mPrimaryRowSelection);var o=this.FishOutTR(primrowno);while(o&&o.previousSibling){o=o.previousSibling;if(o&&(o.className.indexOf("branch")>=0||o.className.indexOf("parent")>=0||o.className.indexOf("emptyGroup")>=0)){var h=o.getAttribute("id");var k=$("#T"+this.mID);if(k!=null&&k.data("treetable")){k.treetable("expandNode",h)}o=null}}}}var b=[];if(g&&!s){b.push({f:ExecuteWorkflow,a:[this.windowID,128,this.mID]})}if(this.mID==1020&&f){this.mPrevARSelection=d;b.push({t:getStateMgr_NS(this.windowID),f:getStateMgr_NS(this.windowID).ARStateChange,a:[this.windowID,this.mResultsListState]})}return{n:b}};DTable.prototype.getPrevARSelection=function(){if(this.mID==1020){return this.mPrevARSelection}return null};DTable.prototype.RestoreResultsListToPrevSelection=function(){if(this.mPrevARSelection==null||this.mPrevARSelection==0){return{n:{t:this,f:this.ClearSelections,a:[true]}}}else{return{n:{t:this,f:this.SetPrimarySelection,a:[this.mPrevARSelection-1,false,false,true]}}}};DTable.prototype.ARRowCleared=function(){this.SetRow(-1)};DTable.prototype.GetColumnInfo=function(){return this.mColInfo};DTable.prototype.GetInitialColumnWidths=function(){if(this.mObj.getAttribute("arcolws")==""){return[]}var d=this.mObj.getAttribute("arcolws").split(",");for(var b=0;b<d.length;++b){d[b]=parseInt(d[b])}return d};DTable.prototype.GetData=function(){if(this.mResult){return this.mResult.r}else{return[]}};DTable.prototype.TagFromRowNo=function(b){return this.mResult.r[b].i};DTable.prototype.RowNoFromTag=function(b){return this.mResult.idmap[b]};DTable.prototype.SetRowSortOrder=function(d,b){};DTable.prototype.GetInitialRowSortOrder=function(){var b=this.mObj.getAttribute("arsort");if(b!=""){var d=b.split(",");return{col:parseInt(d[0]),dir:parseInt(d[1])}}return null};DTable.prototype.GetRowColours=function(){if(this.mObj.getAttribute("arcolours")){return this.mObj.getAttribute("arcolours").split("|")}};DTable.prototype.GetBkgRowColours=function(){if(this.mObj.getAttribute("arbkgcolours")){return this.mObj.getAttribute("arbkgcolours").split("|")}};DTable.prototype.GetAtBottom=function(){return this.mObj.getAttribute("arbottom")!=null};DTable.prototype.getScrollheight=function(){var b=0;var d;if(this.mParent){if(this.mFixedHeader){d=this.mParent.firstChild.childNodes[1]}else{d=this.mParent.firstChild.firstChild}}if(d.scrollHeight>d.offsetHeight){b=d.scrollHeight-d.offsetHeight}return b};DTable.prototype.getScrollwidth=function(){var b=0;var d=this.mParent.firstChild.firstChild;if(d.scrollWidth>d.offsetWidth){b=d.scrollWidth-d.offsetWidth}return b};DTable.prototype.SetDefaultSizesAndOrder=function(){var u=this.mColDatas,g=this.GetInitialColumnWidths(),b=this.mColFields;var h=gettablePrefs_NS(this.windowID);for(var k=0;k<this.mColCnt;++k){var f=b[u[k].mDataCol].mID;if(h!=null&&f in h.colWs){u[k].mWidth=h.colWs[f]}else{u[k].mWidth=(g[k]<0?0:g[k])}if(k==this.mColCnt-1&&this.mHScroll&&u[k].mWidth>0*2){u[k].mWidth-=0}}this.GetSortPreference();var s={};for(var k=0;k<this.mColCnt;k++){s[b[u[k].mDataCol].mID]=u[k]}if(h!=null&&this.mID in h.colOrd){var v=[];var o=h.colOrd[this.mID];for(var w=0;w<o.length;w++){var d=o[w];if(d in s){v.push(s[d]);delete s[d]}}if(v.length>0){for(var d in s){s[d].mWidth=0;v.splice(s[d].mDataCol,0,s[d])}this.mColDatas=v}}};DTable.prototype.GetSortPreference=function(){var h=gettablePrefs_NS(this.windowID);if(h!=null&&this.mID in h.colSort){var b=this.mColFields,w=this.mColDatas,v={},f=[];for(var s=0;s<this.mColCnt;s++){v[b[w[s].mDataCol].mID]=w[s]}var u=h.colSort[this.mID];for(var o=0;o<u.length;o+=2){var d=v[u[o]];if(!d){if(this.mID==1020){for(var g=0;g<this.mColCnt;g++){if(b[w[g].mDataCol].mObj.fid==u[o]){d=w[g];break}}}}if(d){f[o]=d.mDataCol;f[o+1]=u[o+1];if(o==0){d.mPrimarySort=true;d.mSortDir=u[o+1]}}}this.mSortOrder=f}};DTable.prototype.ClearSelections=function(b){DTable.superclass.ClearSelections.call(this,b);if(this.mFtrRObj&&this.mID==1020){var d=getLocalizedMessage("{0} rows selected");d=d.replace(/\{0\}/,0);NodeWrite(this.mFtrRObj,d)}};DTable.prototype.getTemplateForField=function(b){return this.mColFields[b].mObj.btemplate};DTable.prototype.getTemplateHeightForField=function(b){return this.mColFields[b].mObj.ht};DTable.prototype.getFieldIDForColumn=function(d){var b=this.MapUIXToData(d);if(b==null){return}return this.mColFields[b].mID};DTable.prototype.hasImgRefs=function(){for(var b=0;b<this.mColFields.length;b++){if(this.mColFields[b].hasImgRef()){return true}}return false};DTable.prototype.hasVisImgRefs=function(){for(var d=0;d<this.mColCnt;++d){if(this.mColDatas[d].mVisible){var b=this.mColFields[d];if(b.hasImgRef()){return true}}}return false};DTable.prototype.imgHtml=function(d,b,g){var f='<img class="irTbl" src='+d.HTMLEncode()+" alt=";if(b==null){f+='""'}else{f+='"'+b.HTMLEncode()+'"'}f+=" title=";if(b==null){f+='""'}else{f+='"'+b.HTMLEncode()+'"'}if(g!=null&&g.length>0){f+=' id="'+g+'"'}f+=' style="float:left"';f+=">&nbsp;";return f};DTable.prototype.hasCellColor=function(){for(var b=0;b<this.mColFields.length;b++){if(this.mColFields[b].hasCellColor()){return true}}return false};DTable.prototype.getCellColor=function(u){var g=[];for(var f=0;f<this.mColCnt;++f){if(this.mColDatas[f].mVisible||(this.mGroup&&this.mGroupOrder[0]==this.mColDatas[f].mDataCol)){var s='style=";';var d=this.mColFields[f];if(d.hasCellColor()){if(!(u.mXXXDirty&&u.mXXXDirty==2)){var o=d.getCColorFid();var b=u.ccV[o];if(b==""){b=-1}var h=d.getCColor(b);s='style="background-color:'+h+";"}}g[f]=s}}return g};DTable.prototype.initResults=function(){DTable.superclass.initResults.call(this);this.mNotRefreshed=false};DTable.prototype.findHtmlObject=function(o,g){var b=this.FishOutTR(o);if(b==null){return null}var d=b.firstChild;if(d==null){return null}var h=g;for(var f=0;f<g;++f){if(!this.mColDatas[f].mVisible){--h}}while(d){if(d.nodeType==1){if(h<=0){break}--h}d=d.nextSibling}return d};DTable.prototype.setFieldVisibilityOnCurrentRow=function(f,u){if(!this.mResult){return}var k=this.mCurrentRow;var s=this.mResult.r.length;if(k>s){return}var b=this.mResult.f.length;var o=0;var d=u.split(/,/);for(var h=0;h<d.length;h++){o=this.getColNum(d[h]);if((o>b)||(o<0)){continue}this.mResult.r[k].d[o].h=f;var g=this.findHtmlObject(k,o);if(g){if(f=="1"){g.firstChild.style.visibility="hidden"}else{g.firstChild.style.visibility="inherit"}}}};DTable.prototype.isTableGroup=function(){return this.mGroup};DTable.prototype.hasAggregateFunction=function(){return this.mFunc};DTable.prototype.getFolderCount=function(){var b=this.getAllFolderName();return b.length};DTable.prototype.getAllFolderName=function(){var f=new Array();if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return f}if(this.mDataTableObj.lastChild==null){return f}var d=this.mDataTableObj.lastChild;for(var b=0;b<d.childNodes.length;b++){var g=d.childNodes[b];if(g&&(g.className.indexOf("branch")>=0||g.className.indexOf("parent")>=0||g.className.indexOf("emptyGroup")>=0)){f.push(g.getAttribute("name"))}}return f};DTable.prototype.isFolderExpanded=function(k){var f=false;if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return f}if(this.mDataTableObj.lastChild==null){return f}var d=this.mDataTableObj.lastChild;for(var b=0;b<d.childNodes.length;b++){var h=d.childNodes[b];if(h&&(h.className.indexOf("branch")>=0||h.className.indexOf("parent")>=0||h.className.indexOf("emptyGroup")>=0)){var g=h.getAttribute("name");if(g==k){f=h.className.indexOf("expanded")>=0;return f}}}return f};DTable.prototype.getAllFolderStatus=function(){var f=new Array();if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return f}if(this.mDataTableObj.lastChild==null){return f}var d=this.mDataTableObj.lastChild;for(var b=0;b<d.childNodes.length;b++){var g=d.childNodes[b];if(g&&(g.className.indexOf("branch")>=0||g.className.indexOf("parent")>=0||g.className.indexOf("emptyGroup")>=0)){f.push(g.getAttribute("id"));f.push(g.className.indexOf("expanded")>=0?1:0)}}return f};DTable.prototype.restoreAllFolderStatus=function(b){for(var f=0;f<b.length;f+=2){try{if(b[f+1]==1){$("#T"+this.mID).treetable("expandNode",b[f])}else{$("#T"+this.mID).treetable("collapseNode",b[f])}}catch(d){}}};DTable.prototype.expandFolder=function(g){var d=false;if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return d}if(this.mDataTableObj.lastChild==null){return d}var b=this.mDataTableObj.lastChild;try{$("#T"+this.mID).treetable("expandNode",g);d=ture}catch(f){}return d};DTable.prototype.collapseFolder=function(g){var d=false;if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return d}if(this.mDataTableObj.lastChild==null){return d}var b=this.mDataTableObj.lastChild;try{$("#T"+this.mID).treetable("collapseNode",g);d=ture}catch(f){}return d};DTable.prototype.getRowCountForFolder=function(u){var o=0;if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return o}if(this.mDataTableObj.lastChild==null){return o}var g=this.mDataTableObj.lastChild;for(var f=0;f<g.childNodes.length;f++){var s=g.childNodes[f];if(s&&(s.className.indexOf("branch")>=0||s.className.indexOf("parent")>=0||s.className.indexOf("emptyGroup")>=0)){if(s.getAttribute("name")==u){var h=s.getAttribute("id");for(var d=f+1;d<g.childNodes.length;d++){var b=g.childNodes[d];if(b&&(b.className.indexOf("branch")>=0||b.className.indexOf("parent")>=0||b.className.indexOf("emptyGroup")>=0)){return o}else{if(b&&b.className.indexOf("child-of-"+h)>=0){o++}}}return o}}}return o};DTable.prototype.ExpandAll=function(){if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return false}if(this.mDataTableObj.lastChild==null){return false}var d=this.mDataTableObj.lastChild;for(var b=0;b<d.childNodes.length;b++){var g=d.childNodes[b];if(g&&(g.className.indexOf("branch")>=0||g.className.indexOf("parent")>=0||g.className.indexOf("emptyGroup")>=0)){var f=g.getAttribute("id");if(f){$("#T"+this.mID).treetable("expandNode",f)}}}return true};DTable.prototype.CollapseAll=function(){if(this.mRowsPresent==0||this.mDataTableObj==null||!this.mGroup){return false}if(this.mDataTableObj.lastChild==null){return false}var d=this.mDataTableObj.lastChild;for(var b=0;b<d.childNodes.length;b++){var g=d.childNodes[b];if(g&&(g.className.indexOf("branch")>=0||g.className.indexOf("parent")>=0||g.className.indexOf("emptyGroup")>=0)){var f=g.getAttribute("id");if(f){$("#T"+this.mID).treetable("collapseNode",f)}}}return true};DTable.prototype.updateChunkHeader2=function(){var d=this.mHdrRow.childNodes[0];var b=this.mHdrRow.childNodes[1];this.mHdrRow.removeChild(d);this.mHdrRow.removeChild(b);if(this.getMaxChunks()==1){this.mHdrRow.appendChild(this.mHdrLObj);this.mHdrRow.appendChild(this.mHdrRObj)}else{this.mHdrRow.appendChild(this.mChunkCell);this.mHdrRow.appendChild(this.mHdrLObj);this.mHdrRow.appendChild(this.mHdrRObj)}};DTable.prototype.getStartChunkNumber=function(b){var d=this.GetData();var g=this.mResult.n;var f=this.mResult.start;return(g==0?0:f+1)};DTable.prototype.getEndChunkNumber=function(f){if(this.mChunkPage==this.mChunkMax-1){return this.mResult.n}var h=this.mResult.n;var g=this.mResult.start;var b=(this.getActualDisplayChunkSize()<h)?this.getActualDisplayChunkSize():h;var d=g+b;return(h==0?0:d)};DTable.prototype.getFirstChunkSize=function(){var b=(this.mChunkPage==0)?this.getActualDisplayChunkSize():this.getDisplayChunkSize();return b};DTable.prototype.getSecondChunkStart=function(){var b=this.getNewChunkStart();var d=(this.mChunkPage==0)?this.getActualDisplayChunkSize():this.getDisplayChunkSize();while(b>0){b=b-d}return b+d};DTable.prototype.getLastChunkSize=function(){var b=this.getNewChunkStart();var d=(this.mChunkPage==this.mChunkMax)?this.getActualDisplayChunkSize():this.getDisplayChunkSize();while(b<this.mResult.n){b=b+d}return b-d+1};DTable.prototype.getChildField=function(f){var b=this.MapUIXY(f);if(b==null){return null}if(b.x<0){return null}var d=b.x;return this.getFieldIDForColumn(d)};DTable.prototype.inDataArea=function(b){var d=b.element;while(d.nodeType!=1||(d.tagName!="DIV")){d=d.parentNode}if(d!=null){if(d.className.indexOf("TableFtr")!=-1||d.className.indexOf("TableHdr")!=-1){return false}}return true};DTable.prototype.InstantiateUI_Part1=function(b){this.mSortImgs=[];this.mSortImgs[0]=b.firstChild;this.mSortImgs[1]=this.mSortImgs[0].nextSibling;this.mSortImgs[0].setAttribute("arindom",1);this.mSortImgs[1].setAttribute("arindom",1);this.mHdrObj=this.mSortImgs[1].nextSibling};DTable.prototype.InstantiateUI_Part2=function(h){function b(k,o,s){var u=h.getAttribute("ar"+k+"str");if(u==null||u==""){return null}else{return new TableBtn(u,o,k,s)}}this.mInnerObj=this.mHdrObj.nextSibling;this.mFtrObj=this.mInnerObj.nextSibling;var g=this.mHdrObj.firstChild.firstChild.firstChild;var f=h.getAttribute("archunkbuttons")!=null;var d=h.getAttribute("arnotrefstr");if(f){this.mHdrLObj=g.childNodes[1];this.mChunkCell=g.childNodes[0];this.mChunkOuter=g.childNodes[0].firstChild;this.mHdrRObj=g.childNodes[2];this.mHdrRow=g}else{this.mHdrLObj=g.childNodes[0];this.mChunkOuter=null;this.mHdrRObj=g.childNodes[1]}if(d!=null&&d.length>0){this.mHdrLObj.innerHTML=d.HTMLEncode();if(f){g.removeChild(g.childNodes[0])}}g=this.mFtrObj.firstChild.firstChild.firstChild;this.mFtrLObj=g.firstChild;this.mFtrRObj=g.childNodes[1];this.mFlushingQueue=0;DTable.superclass.InstantiateUI.call(this,this.mInnerObj);if(this.mChunkOuter!=null){this.mChunkPrevBtn=this.mChunkOuter.firstChild;this.mChunkInput=this.mChunkOuter.childNodes[1].childNodes[0];this.mChunkMenuBtn=this.mChunkOuter.childNodes[1].childNodes[1];this.mChunkNextBtn=this.mChunkOuter.childNodes[2];this.mChunkMenuBtn.style.position="absolute";if(this.getDisplayChunkSize()>=0&&typeof this.mResult!="undefined"){this.UpdateChunkUI(this.mResult.n)}}else{this.mChunkPrevBtn=this.mChunkInput=this.mChunkMenuBtn=this.mChunkNextBtn=null}this.mBtnReport=b("Rep",this.mFtrLObj,null);if(this instanceof DPageArray||(this.colCheck!=undefined&&this.colCheck==0)){if(this.mSelRow!=1){if(this.mSelRow==0){this.mBtnSelectAll=b("SelAll",this.mFtrLObj,null)}else{this.mBtnSelectAll=null}this.mBtnDeselectAll=b("DeselAll",this.mFtrLObj,null)}}else{this.mBtnSelectAll=this.mBtnDeselectAll=null}this.mBtnDelete=b("Delete",this.mFtrLObj,null);this.mBtnRead=b("Read",this.mFtrLObj,null);this.mBtnUnread=b("Unread",this.mFtrLObj,null);this.mBtnPref=b("Prefs",this.mHdrRObj,RelContextPath+"resources/images/menu_down.gif");this.mBtnRefresh=b("Ref",this.mHdrRObj,null);if(this.mBtnPref==null&&this.mBtnRefresh==null){this.mHdrRObj.className+=" collapse"}this.mUIInstantiated=true;if(!this.mAsyncResizePending){if(this.IsInFlowLayout()){this.Resize(this.mParent.offsetWidth,parseInt(h.style.height))}else{this.Resize(parseInt(h.style.width),parseInt(h.style.height))}}this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)};DTable.prototype.DOMClickAction=function(f){if(this.colCheck==1&&this.mSelRow!=1){if(f.parentNode.className=="BaseTableHeader"&&f.nodeName=="INPUT"&&this.mRowsPresent>0){if(f.checked){return 1}return 2}}var b=this.FindContainingDiv(f);if(b==null){return 0}if(b.className=="TableHdr"||b.className=="TableFtr"){if(f.tagName=="IMG"){f=f.parentNode}if(f.tagName!="A"){return 0}if(this.mBtnRefresh&&f==this.mBtnRefresh.mObj){if(this.colCheck==1&&this.mID!=1020){this.mNotRefreshed=true;this.ClearSelections(true)}return 3}else{if(this.mBtnSelectAll&&f==this.mBtnSelectAll.mObj){return 1}else{if(this.mBtnDeselectAll&&f==this.mBtnDeselectAll.mObj){return 2}else{if(this.mBtnDelete&&f==this.mBtnDelete.mObj){return 4}else{if(this.mBtnRead&&f==this.mBtnRead.mObj){return 5}else{if(this.mBtnUnread&&f==this.mBtnUnread.mObj){return 6}else{if(this.mBtnReport&&f==this.mBtnReport.mObj){return 7}else{if(this.mBtnPref&&f==this.mBtnPref.mObj){return 8}}}}}}}}}else{if(b==this.mChunkOuter||(this.mChunkMenuBtn&&b==this.mChunkMenuBtn.parentNode)){var d=f;if(d.tagName=="IMG"){d=d.parentNode}if(d==this.mChunkPrevBtn&&!f.disabled){return 9}else{if(d==this.mChunkNextBtn&&!f.disabled){return 10}else{if(d==this.mChunkMenuBtn&&!f.disabled){return 11}else{return 0}}}}}if((f.tagName=="A"&&f.className.indexOf("TableBtn")!=-1)||(f.tagName=="IMG"&&f.className.indexOf("btnimg")!=-1)){return 12}else{if(f.tagName=="INPUT"&&f.type=="checkbox"){return 13}}return 0};DTable.prototype.DOMClick=function(b){var d=this.DOMClick_part1(b);if(typeof d=="number"){return this.DOMClick_part2(b,d)}else{return d}};DTable.prototype.DOMClick_part1=function(g){hoverState.clearTracking();if(this.GAccess()==3){return}var y=this.DOMClickAction(g.element);switch(y){case 1:return{n:{f:this.SelectAll,t:this,a:[true]}};case 2:return{n:{f:this.SelectAll,t:this,a:[false]}};case 3:return{n:{t:this,f:this.Refresh,a:[-1,0,false]}};case 4:return this.DeleteSelected();case 5:return this.MarkRead(true);case 6:return this.MarkRead(false);case 7:return this.Report();case 8:var C=this.FindContainingDiv(g.element);if(C==null){return}C=g.element;return{n:{f:this.Preferences,a:[C,this],t:this}};case 9:return{n:{t:this,f:this.NextChunk,a:[-1]}};case 10:return{n:{t:this,f:this.NextChunk,a:[1]}};case 11:if(!this.mResult){return}var d=[];var w=this.getMaxChunks();if(w<=25){var k=this.mChunkPage;var D=1,z=0;var o=0;for(var A=0;A<w;A++){if(A==0){var v=this.getFirstChunkSize();d.push({l:""+D+"-"+v,v:""+z});if(v>1){D+=this.getSecondChunkStart()}else{D++}}else{if((A==w-1)&&(w-1!=0)){d.push({l:""+D+"-"+(this.mResult.n),v:""+z})}else{if(A==this.mChunkPage){d.push({l:""+D+"-"+(D+this.getActualDisplayChunkSize()-1),v:""+z});D+=this.getActualDisplayChunkSize()}else{var f=D+this.getDisplayChunkSize()-1;d.push({l:""+D+"-"+f,v:""+z});D+=this.getDisplayChunkSize()}}}z++}}else{var u=Math.ceil(w/25);var b=0,D=1,E=1;for(var A=0;A<u;++A){var h=A*25,f=h+25;if(f>w){f=w}var s=[];E=D;for(var z=h;z<f;++z){if(A==0&&z==0){var v=this.getFirstChunkSize();s.push({l:""+D+"-"+v,v:""+z});if(v>1){D+=this.getSecondChunkStart()}else{D++}}else{if(z==w-1){s.push({l:""+D+"-"+this.mResult.n,v:""+b});D=this.mResult.n;D=D+1}else{if(z==this.mChunkPage){s.push({l:""+D+"-"+(D+this.getActualDisplayChunkSize()-1),v:""+z});D+=this.getActualDisplayChunkSize()}else{s.push({l:""+D+"-"+(D+this.getDisplayChunkSize()-1),v:""+z});D+=this.getDisplayChunkSize()}}}b++}if(s.length){d.push({l:(E)+"-"+(D-1),v:s})}}}var B=this;return{n:{f:function(){return new DTableMenu(B.windowID,d,B)},a:[d,B]}};break}return y};DTable.prototype.DOMClick_part2=function(o,g){switch(g){case 12:var u=this.MapUIXY(o.element);if(u!=null){var d=[],f=this.MapUIXToData(u.x);if(f==null){return}if(this.mResult.f[f].t=="Char"){if(this.mResult.f[f].m!=null){var k=this.mResult.f[f].m;var d=getARMenuCache_NS(this.windowID)[k];if(d){d.cfid=this.mColFields[f].mID;if(!d.FieldMap[this.mColFields[f].mID]){d.addField(this.mColFields[f].mID)}}charmenu=ARMenu_Get(this.windowID,k);if(charmenu){if(charmenu.mMenuDef.length>0){var s=this;return{n:{f:function(){return new DEditMenu(s.windowID,charmenu.mMenuDef,o.element,u,f,s)},a:[charmenu.mMenuDef,o.element,u,f,s]}}}}}}else{var b=this.mResult.f[f].e;for(var h in b){d.push({l:b[h],v:h})}d.push({l:getLocalizedMessage("(clear)"),v:""});var s=this;return{n:{f:function(){return new DEditMenu(s.windowID,d,o.element.parentNode.parentNode.parentNode,u,f,s)}},a:[d,o.element.parentNode.parentNode.parentNode,u,f,s]}}}break;case 13:this.DirtyEditableCell(o.element);break}return DTable.superclass.DOMClick.call(this,o)};DTable.prototype.DOMKeyPress=function(b){if(this.GAccess()==3){return}var f=b.element;if(f==this.mChunkInput&&b.key==13){var d=parseInt(this.mChunkInput.value);if(isNaN(d)||d<1){d=1}--d;if(d!=this.mChunkPage){this.mChunkPage=d;return{n:{t:this,f:this.Refresh,a:[-1,0,true]}}}return}this.DirtyEditableCell(f)};DTable.prototype.DOMKeyUp=function(b){this.DirtyEditableCell(b.element)};DTable.prototype.DOMContextMenu=function(b){Menu_Close();if(this.GAccess()!=3){var h=new TableContextMenu(this);var f=(b.ox>=b.element.scrollLeft)?b.ox-b.element.scrollLeft:b.ox;var d=b.oy>b.mMouseY?b.mMouseY:b.oy;var k={x:f,y:d};var g=this.GetContextMenuOffsetElement(b.element);if(g.tagName=="SPAN"&&g.parentNode.tagName=="NOBR"&&g.parentNode.style.textAlign=="center"){g=g.parentNode}return{n:{f:h.Open,t:h,a:[g,4,k]}}}};DTable.prototype.GetContextMenuOffsetElement=function(b){return b};DTable.prototype.DirtyEditableCell=function(g){if(g.tagName=="INPUT"){var f=this.MapUIXY(g);if(f!=null){var d=this.GetRow();this.SetRow(f.y);var b=this.mAsyncDirty;var h=this.MapUIXToData(f.x);if(g.className=="colcheck"){h=null}if(h!=null){if(g.type=="checkbox"){this.mColFields[h].S(g.checked?new EnumType(g.value):Null)}else{this.mColFields[h].S(new CharType(g.value),true)}}this.mAsyncDirty=b;this.SetRow(d)}}};DTable.prototype.DOMKeyDown=function(b){if(this.GAccess()==3){return}if(b.key==8||b.key==46){var d=b.element;this.DirtyEditableCell(d)}var d=this.FindContainingDiv(b.element);if(d==null){return}if(d.className=="TableHdr"||d.className=="TableFtr"||d.className=="TableHdrChunk"){return}if(b.key==37&&b.shift){return{n:{f:this.NextChunk,t:this,a:[-1]}}}else{if(b.key==39&&b.shift){return{n:{f:this.NextChunk,t:this,a:[1]}}}else{if(b.key==116){b.mStoppedDefault=true;return{n:{f:this.Refresh,t:this,a:[-1,0,false]}}}else{return DTable.superclass.DOMKeyDown.call(this,b)}}}b.StopDefault()};DTable.prototype.IsMouseSelectable=function(b){return(this.MouseSelectable||b.isTextEdit)};DTable.prototype.UpdateVis=function(d){var b=(this.mObj.style.visibility!="hidden");if(!b&&d){this.SetAsync(-1);this.mObj.style.visibility="inherit";this.mObj.style.display="block"}else{if(b&&!d){this.SetAsync(1);this.mObj.style.visibility="hidden";this.mObj.style.display="none"}}};DTable.prototype.DOMFocus=function(b){return DTable.superclass.DOMFocus.call(this,b)};DTable.prototype.getRowInScroll=function(o){if(o.element.className=="BaseTableInner"){var g=o.element;var k=g.childNodes;var g=null;for(var h=0;h<k.length;h++){if(k[h].className=="BaseTable"){g=k[h];break}}if(g!=null){var v=g.rows;var f=v.length;var u=g.offsetTop;var d;posy=o.oy;for(var b=0;b<f;b++){d=u+v[b].clientHeight-1;var s=v[b].getAttribute("arrow");if(s!=null){s=parseInt(s)}if(s!=null&&posy>=u&&posy<=d){return s}u=d}}}return null};DTable.prototype.ARDrillDown=function(f,g){if(!this.mObj.getAttribute("ardrill")){return ExecuteWorkflow(this.windowID,2,this.mID)}var b=this.mResult.r[f.y].i;var d="";if(this.mID==1020){d=ARKWGetStringByIdx(this.windowID,17)}return{n:[{f:function(h){var k=unescape(encodeURIComponent(b)).length;return OpenNonModalForm(h.windowID,1,ExpandServerName(h.windowID,h.mObj.getAttribute("arserver")),ExpandSchemaName(h.windowID,h.mObj.getAttribute("arschema")),d,{fvlist:null,wMode:99,wForceClear:0,fvSetDefaults:1,qual:{qual:"4\\1\\1\\1\\2\\4\\"+k+"\\"+b+"\\",fieldids:[],fieldvals:[],fieldtypes:[]}})},a:[this]},{f:ExecuteWorkflow,a:[this.windowID,2,this.mID]}]}};DTable.prototype.getVisImgRefs=function(v){if(!this.hasVisImgRefs()){return[]}var h=[];for(var d=0;d<this.mColCnt;++d){if(this.mColDatas[d].mVisible||(this.mGroup&&this.mGroupOrder[0]==this.mColDatas[d].mDataCol)){var u="";var g=this.mColFields[d];if(g.hasImgRef()){var s=g.getImgFid();var b="";if(v.mXXXDirty!=3&&v.mXXXDirty!=2&&v.irv!=undefined){b=v.irv[s]}if(b==""){b=-1}var o=g.getImgURL(b);if(o!=null){var f=null;f=g.getImgAltT(b);u=this.imgHtml(o,f,null)}}h[d]=u}}return h};DTreeView.prototype=new DTable();DTreeView.prototype.constructor=DTreeView;DTreeView.superclass=DTable.prototype;DOMFieldFactories.TreeView=function(b,f,d){return new DTreeView(b,f,d)};DTreeView.NULL_VALUE=getLocalizedMessage("[No Value]");function DTreeView(f,k,h){if(arguments.length){this.init(f,k,h)}if((this.mObj.parentNode.className.indexOf("flowP")&&this.mObj.parentNode.className.indexOf("pnl"))!=1){var b=this.mObj.parentNode.getAttribute("arpanelmaxwidth");this.mObj.parentNode.style.maxWidth=b}this.mTreeNode=null;this.mExpandSelectedNode=false;this.expandOrCollapse=null;this.mNullValue=this.mObj.getAttribute("arnullvalue");if(this.mNullValue==null||this.mNullValue.length==0){this.mNullValue=DTreeView.NULL_VALUE}this.mCols=[];var d=this.GetInitialRowSortOrder();if(d!=null){this.RebuildSortOrder(d.col,d.dir)}for(var g=0;g<this.mSortOrder.length;g+=2){this.mCols.push(this.mSortOrder[g])}if(this.mCols.length<=0){this.mCols=[0]}this.mRow=-1;this.mLevel=this.mCols.length-1;this.mIndex="TN"+TreeNode.NextIndex++;this.mHasChildFields=false}DTreeView.prototype.SColVis=function(b,d){};DTreeView.prototype.SColLabel=function(b,d){};DTreeView.prototype.setRowAndLevel=function(b){if(b.startRow<b.endRow){this.mRow=b.startRow}else{this.mRow=b.endRow}this.mLevel=b.column};DTreeView.prototype.getChildField=function(b){return null};DTreeView.prototype.DoSet=DTreeView.prototype.DoSLoadEntry=function(g){if(!this.mTreeNode){return DTreeView.superclass.DoSet.call(this,g)}var b=g;if(g instanceof Datatype){g=g.toInteger()}else{if(g==""){g=0}else{g=parseInt(g)}}var d=true;if(g<0){g=-g}if(g>100000000||g<-100000000){d=false}if(g==0||g>this.GetData().length&&g<100000000){this.mTreeNode.ClearSelection()}else{if(d){this.SelectNode(g-1,this.mCols.length-1,false,false,false)}}var f=DTreeView.superclass.DoSet.call(this,b);return f};DTreeView.prototype.ARRowSelected=function(f,d,b,h){var g=this.FindNode(this.mARRowSelection-1,this.mLevel);if(g){this.setRowAndLevel(g)}return DTreeView.superclass.ARRowSelected.call(this,f,d,b)};DTreeView.prototype.NextChunk=function(b){};DTreeView.prototype.Report=function(){};DTreeView.prototype.Refresh=function(d,b,h,g){this.mTreeNode=null;this.mObj.innerHTML="<html></html>";if(!this.mNotRefreshed){var f=parseInt(this.mObj.getAttribute("arselrefresh"));if(f==2||f==3){this.mLevel=this.mCols.length-1}}return DTreeView.superclass.Refresh.call(this,-1,0,false,g)};DTreeView.prototype.Clear=function(){this.mLevel=this.mCols.length-1;return DTreeView.superclass.Clear.call(this)};DTreeView.prototype.SelectAll=function(b){var d=this.GLabel();if(d==null||d==""){b=false}return DTreeView.superclass.SelectAll.call(this,b)};DTreeView.prototype.GetSelectedColumn=function(d){var b;if(this.mPrimaryRowSelection==null){b=Null}else{if(d==1){if(this.mLevel==-1){return Null}else{b=new IntegerType(this.mColFields[this.mCols[this.mLevel]].mID)}}else{b=new IntegerType(this.mLevel+1)}}return b};DTreeView.prototype.initResults=function(){DTable.superclass.initResults.call(this);this.BuildTree();this.mNotRefreshed=false};DTreeView.prototype.TabableElementSelector=function(d){if(d.tagName=="DIV"&&d.style&&d.style.display!="none"&&d.style.visiblity!="hidden"){var b=d.parentNode;if(b!=null){if(b.tagName=="DIV"&&(!b.style||b.style.display=="none"||b.style.visibility=="hidden")){return null}}return d}return null};DTreeView.prototype.ResizeTo=function(d,b){if(this.mObj.style.width!=this.perWidth+"%"){this.mObj.style.width=this.perWidth+"%"}if(this.mObj.style.height!=this.perHeight+"%"){this.mObj.style.height=this.perHeight+"%"}};DTreeView.prototype.InstantiateUI=function(b){this.mObj.innerHTML="<html></html>";this.mUIInstantiated=true};DTreeView.prototype.BuildTree=function(){var O,N,K,G,Q,R,h;var L=new Array();var E=new Array();var C=-1;L[0]=this.mTreeNode=new TreeNode(gTreeMessages,gTreeMsgArgs,this.mIndex,"RootNode",false,C,"","",null,0,0);TreeNode.registerRootNode(this.mTreeNode);var s="";s=this.GLabel();if(s!=null&&s!=""){G=this.mIndex+"_"+0+"_"+-1;var g=this.getRootImgRef("timg"+G);var D=null;var o=this.getRootImgH();var b=this.getRootImgW();D=this.getRootImgAltT();C=0;h=new TreeNode(gTreeMessages,gTreeMsgArgs,G,s,C,false,"",g,D,o,b);L[0].addChild(h);L[0]=h}Q=this.GetData();var u=false;if(this.GLabel()!=null&&this.GLabel()!=""){u=true}if(Q.length>0){var A=this.mCols;var H=A.length;var I,f;var P=this.GetRowColours();for(O=0;O<Q.length;O++){if(!Q[O].mXXXDirty||Q[O].mXXXDirty!=3){f=Q[O];for(N=0;N<H;N++){R=f.d[A[N]].v;var y=0;if(R==null||R.length==0){R=this.mNullValue;y=1;if(typeof Q[O].mXXXDirty!="undefined"&&Q[O].mXXXDirty==2){y=2}}if(R!=E[N]){I=[];I.push(this.mIndex);I.push("_");I.push(O);I.push("_");I.push(N);G=I.join("");var J=this.getImgRefCell(f,A[N],"timg"+G);var z=this.getImgRefHCell(f,A[N]);var d=this.getImgRefWCell(f,A[N]);var w=null;var C=N+1;if(!u){C=N}h=new TreeNode(gTreeMessages,gTreeMsgArgs,G,R,C,false,(f.rc==-1||P==null?"":P[f.rc]),J,w,z,d);h.setNullNodeType(y);h.startRow=O;h.endRow=O;h.column=N;if(this.mColFields[A[N]].mCFCache.v){var B=N-1;while(B>=0&&!this.mColFields[A[B]].mCFCache.v){B--}L[B+1].addChild(h)}L[N+1]=h;E[N]=R;E.length=N+1}else{if(h.column==N){h.endRow=O}}L[N].endRow=O}}}this.RemoveNulls(this.mTreeNode)}};DTreeView.prototype.RemoveNulls=function(h){if(h.hasChilds()){var f=h.getChildren();var b=true;for(var d=0;d<f.length;d++){this.RemoveNulls(f[d]);if(f[d].getName()!=this.mNullValue||f[d].hasChilds()){b=false}if(f[d].getName()==this.mNullValue&&d!=0&&f[d].getNullNodeType()!=2){f[d].makeThisFirstChild();var g=f[d].getParent();var k=g.endRow;g.endRow=g.startRow;g.startRow=k}}if(b){h.resetChilds()}}};DTreeView.prototype.ApplyData=function(){if(this.mNotRefreshed){this.mTreeNode=null;this.mObj.innerHTML="<html></html>";return}var f=this.IsInFlowLayout();if(f){var b=this.mObj.className;if(this.GetData().length>0){if(b.indexOf("treeflow")==-1){b+=" treeflow";this.mObj.className=b}}else{this.mObj.className=b.replace("treeflow","")}}this.mRowsPresent=this.GetData().length;TreeNode.showTree(this.mTreeNode,this.mObj,RelContextPath+"resources/");var d=this.GLabel();if(d!=null&&d!=""&&this.GetData().length>0){TreeNode.expandNode(this.mTreeNode.getFirstChild(),false)}this.ApplySelections()};DTreeView.prototype.ApplySelections=function(){if(!this.mTreeNode.isLoaded()||this.GetData().length<=0){return}if(this.mPrimaryRowSelection!=null){var d=0;for(var b in this.mRowSelections){d++}if(this.mRowsPresent>1&&d==this.mRowsPresent&&this.mLevel==-1){this.doSelectNode(0,-1)}else{this.doSelectNode(this.mARRowSelection-1,this.mLevel)}var f=this.mIndex+"_"+this.mRow+"_"+this.mLevel;TreeNode.selectNodeByID(f);if(this.mExpandSelectedNode){TreeNode.expandNode(TreeNode.findNodeWithID(this.mTreeNode,f),false);this.mExpandSelectedNode=false}}else{this.mRow=-1;this.mTreeNode.ClearSelection()}if(this.expandOrCollapse){this.expandOrCollapse.apply(this);this.expandOrCollapse=null}};DTreeView.prototype.GetRootNode=function(){return this.mTreeNode};DTreeView.prototype.DOMClick=function(b){var d=b.element.id;if(d.indexOf("link")==0||d.indexOf("title")==0){return this.DOMClickMouseDownHelper(b)}return};DTreeView.prototype.DOMMouseDown=function(b){return this.DOMClickMouseDownHelper(b)};DTreeView.prototype.DOMClickMouseDownHelper=function(b){if(!this.mTreeNode||this.GAccess()==3){return}var f=TreeNode.getSelectedNode(this.mTreeNode);TreeNode.ClearFocusTimer(this.mTreeNode);if(TreeNode.handleSingleClick(b.element,this)){b.StopDefault()}var g=F(this.windowID,this.mParentField);while(g){if(g instanceof DPage&&g.mFillModel&&g.mState==1&&g.mFit){g.getChildScroll(this)}g=g.GetParent()}if(this.GetData().length>0){var h=b.element.id;if(h.indexOf("title")==0){h=h.substring(5)}else{if(h.indexOf("handler")==0){h=h.substring(7)}else{if(h.indexOf("link")==0){h=h.substring(4)}else{if(h.indexOf("timg")==0){h=h.substring(4)}else{if(h.indexOf("node")==0){h=h.substring(4)}else{if(h==""){h=TreeNode.getParentNode(b.element).id.substring(4)}else{return}}}}}}var d=TreeNode.getTreeNode(h);if(f==d){return}return this.SelectNode((d.startRow<=d.endRow?d.startRow:d.endRow),d.column,false,true,true)}};DTreeView.prototype.DOMDoubleClick=function(b){if(!this.mTreeNode||this.mRowsPresent==0){return}TreeNode.handleDoubleClick(b.element);var f=b.element.id;if(f.indexOf("title")==0||f.indexOf("timg")==0){var d=TreeNode.getTreeNode(f.substring((f.indexOf("title")==0)?5:4));if(!d.hasChilds()){return DTreeView.superclass.ARDrillDown.call(this,{y:d.startRow,x:d.column},false)}}};DTreeView.prototype.doSelectNode=function(h,k){var d=this.FindNode(h,k);if(d){var b=[];var g=d.parent;while(g!=null&&!g.loaded){b.push(g);g=g.parent}while(b.length>0){var f=b.pop();TreeNode.handleNode(f.id)}this.setRowAndLevel(d)}};DTreeView.prototype.SelectNode=function(h,o,f,k,d){if(!this.mTreeNode){return}if(h<0||h>this.mResult.r.length){this.mTreeNode.ClearSelection();this.ClearSelections(true);return}var g=null;if(o>this.mCols.length){o=this.mCols.length}g=this.FindNode(h,o);if(g){var b=[];b.push({t:this,f:this.ApplySelections});this.setRowAndLevel(g);if(f){this.mExpandSelectedNode=true}if(k){if(g.endRow!=g.startRow){b.push({f:this.FillSelections,t:this,a:[g.endRow,g.startRow,g.startRow,true]})}b.push({f:this.SetPrimarySelection,t:this,a:[g.startRow,d,true,true]})}return{n:b}}};DTreeView.prototype.DOMFocus=function(b){if(this.mTreeNode!=null){var d=TreeNode.getSelectedNode(this.mTreeNode);if(d!=null){TreeNode.makeNodeVisible(d);TreeNode.SetFocusToSelectedNode(this.mTreeNode)}else{if(this.mTreeNode.getFirstChild()!=null){this.mTreeNode.getFirstChild().SetFocus()}}}return DTable.superclass.DOMFocus.call(this,b)};DTreeView.prototype.IsLeafSelected=function(){var b=null;if(this.mTreeNode!=null){var d=TreeNode.getSelectedNode(this.mTreeNode);if(d==null){d=this.FindNode(this.mRow,this.mLevel)}if(d&&d.getChildCount()==0){b=IntegerType.ONE}}if(b==null){b=IntegerType.ZERO}return b};DTreeView.prototype.ExpandAll=function(){var f=this.IsInFlowLayout();if(f){var b=this.mObj.className;if(b.indexOf("treeflow")==-1){b+=" treeflow"}this.mObj.className=b}if(this.mTreeNode&&this.mTreeNode.loaded){TreeNode.expandAll(this.mTreeNode)}else{if(!this.mNotRefreshed){this.expandOrCollapse=this.ExpandAll}}var d=F(this.windowID,this.mParentField);while(d){if(d instanceof DPage&&d.mFillModel&&d.mState==1&&d.mFit){d.getChildScroll(this)}d=d.GetParent()}};DTreeView.prototype.CollapseAll=function(){var d=this.IsInFlowLayout();if(d){var b=this.mObj.className;if(b.indexOf("treeflow")!=-1){this.mObj.className=b.replace("treeflow","")}}if(this.mTreeNode&&this.mTreeNode.loaded){TreeNode.collapseAll(this.mTreeNode)}else{if(!this.mNotRefreshed){this.expandOrCollapse=this.CollapseAll}}};DTreeView.prototype.UpdateLabel=function(b){if(!this.mTreeNode){return}node=TreeNode.findNodeWithID(this.mTreeNode,this.mIndex+"_"+0+"_"+-1);if(b==null||b==""){b=this.mNullValue}if(node!=null){node.changeLabel(b)}};DTreeView.prototype.FindNode=function(d,g){var h=d;var b=g;var k,f=null;do{if(b==-1){k=this.mIndex+"_"+0+"_"+b}else{k=this.mIndex+"_"+h+"_"+b}f=TreeNode.findNodeWithID(this.mTreeNode,k);if(f==null){h--}else{if((d>=f.startRow&&d<=f.endRow)||(d<=f.startRow&&d>=f.endRow)){break}}if(f!=null||h<0){h=d;b--}}while(b>=0);if(f&&this.mResult.r[d]!=undefined&&this.mResult.r[d].mXXXDirty==2){f.column=g}return f};DTreeView.prototype.DOMKeyPress=function(b){};DTreeView.prototype.DOMKeyUp=function(b){};DTreeView.prototype.DOMKeyDown=function(b){if(this.GAccess()==3||!this.mTreeNode){return}var h=TreeNode.getSelectedNodeID(this.mTreeNode);var f;if(b.element!=null&&b.element.id!=null){f=TreeNode.getTreeNode(b.element.id.replace("title",""));if(f==null){return}}if(b.key==37){b.StopDefault();TreeNode.collapseCurrentNode(this.mTreeNode,f)}else{if(b.key==39){b.StopDefault();TreeNode.expandCurrentNode(this.windowID,this.mTreeNode,f,this)}else{if(b.key==38){b.StopDefault();TreeNode.selectPrevNode(this.mTreeNode,f)}else{if(b.key==40){b.StopDefault();TreeNode.selectNextNode(this.mTreeNode,f)}else{if(b.key==9&&b.shift==false){b.StopDefault();TreeNode.selectNextNode(this.mTreeNode,f)}else{if(b.key==9&&b.shift==true){b.StopDefault();TreeNode.selectPrevNode(this.mTreeNode,f)}else{if(b.key==32){b.StopDefault();TreeNode.selectNodeByID(f.getID())}else{if(b.key==13){b.StopDefault();TreeNode.selectNodeByID(f.getID());if(!f.hasChilds()){return DTreeView.superclass.ARDrillDown.call(this,{y:f.startRow,x:f.column},false)}}else{return}}}}}}}}var d=TreeNode.getSelectedNodeID(this.mTreeNode);if(h!=d){var g=TreeNode.getSelectedNode(this.mTreeNode);TreeNode.SetFocusToSelectedNode(this.mTreeNode);return this.SelectNode((g.startRow<=g.endRow?g.startRow:g.endRow),g.column,false,true,true)}};DTreeView.prototype.IsMouseSelectable=function(b){return false};DTreeView.prototype.setStyle=function(b){if(this.mObj.id.indexOf("title")==0){if(b){this.mObj.className=this.mObj.className+" TreeHover"}else{this.mObj.className=this.mObj.className.replace(" TreeHover","")}}};DTreeView.prototype.DOMMouseOver=function(b){hoverState.eventMouseOver(b);if(this.GAccess()==3){return}this.setStyle(true);var d=TreeNode.getParentNode(b.element);if(d.className==""){d.className="btn treetitlerollover";d.firstChild.lastChild.className+=" treetitlerollover";if(d.firstChild.lastChild.previousSibling.tagName=="A"){d.firstChild.lastChild.previousSibling.className+=" treetitlerollover"}}else{if(d.className.indexOf("treetitleselectedfocused")!=-1){d.className+=" treetitleselectedrollover";d.firstChild.lastChild.className+=" treetitleselectedrollover";if(d.firstChild.lastChild.previousSibling.tagName=="A"){d.firstChild.lastChild.previousSibling.className+=" treetitleselectedrollover"}}}};DTreeView.prototype.DOMMouseOut=function(b){hoverState.eventMouseOut(b);if(this.GAccess()==3){return}this.setStyle(false);var d=TreeNode.getParentNode(b.element);if(d.className.indexOf("treetitlerollover")!=-1){d.className="";d.firstChild.lastChild.className=d.firstChild.lastChild.className.replace(/treetitlerollover/g,"");d.firstChild.lastChild.className=d.firstChild.lastChild.className.replace(/\s+$/g,"");if(d.firstChild.lastChild.previousSibling.tagName=="A"){d.firstChild.lastChild.previousSibling.className=d.firstChild.lastChild.previousSibling.className.replace(/treetitlerollover/g,"");d.firstChild.lastChild.previousSibling.className=d.firstChild.lastChild.previousSibling.className.replace(/\s+$/g,"")}}else{if(d.className.indexOf("treetitleselectedrollover")!=-1){d.className=d.className.replace(/treetitleselectedrollover/g,"");d.className=d.className.replace(/\s+$/g,"");d.firstChild.lastChild.className=d.firstChild.lastChild.className.replace(/treetitleselectedrollover/g,"");d.firstChild.lastChild.className=d.firstChild.lastChild.className.replace(/\s+$/g,"");if(d.firstChild.lastChild.previousSibling.tagName=="A"){d.firstChild.lastChild.previousSibling.className=d.firstChild.lastChild.previousSibling.className.replace(/treetitleselectedrollover/g,"");d.firstChild.lastChild.previousSibling.className=d.firstChild.lastChild.previousSibling.className.replace(/\s+$/g,"")}}}};DTreeView.prototype.DOMMouseUp=function(b){var g=b.element.id;var f;if(g.indexOf("title")==0){f=g.substring(5)}else{if(g.indexOf("handler")==0){f=g.substring(7)}else{if(g.indexOf("link")==0){f=g.substring(4)}else{if(g.indexOf("timg")==0){f=g.substring(4)}else{this.mMouseUpRowSelection=-1;this.mMouseUpColSelection=-1;return}}}}var d=TreeNode.getTreeNode(f);if(d==null){this.mMouseUpRowSelection=-1;this.mMouseUpColSelection=-1;return}if(d.startRow<d.endRow){this.mMouseUpRowSelection=d.startRow}else{this.mMouseUpRowSelection=d.endRow}this.mMouseUpColSelection=d.column};DTreeView.prototype.getScrollheight=function(){var b=0;var d=this.mObj;if(d.scrollHeight>d.offsetHeight){b=d.scrollHeight-d.offsetHeight}return b};DTreeView.prototype.getScrollwidth=function(){var b=0;var d=this.mObj;if(d.scrollWidth>d.offsetWidth){b=d.scrollWidth-d.offsetWidth}return b};DTreeView.prototype.hasRootImg=function(){var b=this.mObj.getAttribute("arrtimg");if(b!=null&&b.length>0){return true}return false};DTreeView.prototype.getRootImgW=function(){var b=this.mObj.getAttribute("arrtimgw");if(b!=null&&b.length>0){return parseInt(b)}return 0};DTreeView.prototype.getRootImgH=function(){var b=this.mObj.getAttribute("arrtimgh");if(b!=null&&b.length>0){return parseInt(b)}return 0};DTreeView.prototype.getRootImgURL=function(){var b=this.mObj.getAttribute("arrtimg");if(b!=null&&b.length>0){return b}return null};DTreeView.prototype.getRootImgAltT=function(){var b=this.mObj.getAttribute("arrtalt");if(b!=null&&b.length>0){return b}return null};DTreeView.prototype.getRootImgFType=function(){var b=this.mObj.getAttribute("arrtf");if(b!=null&&b.length>0){return b}return null};DTreeView.prototype.imgHtml=function(d,b,g){var f='<img class="treeimgicon" src='+d.HTMLEncode()+" alt=";if(b==null){f+='""'}else{f+='"'+b.HTMLEncode()+'"'}f+=" title=";if(b==null){f+='""'}else{f+='"'+b.HTMLEncode()+'"'}if(g!=null&&g.length>0){f+=' id="'+g+'"'}f+=' height="{0}px" width="{1}px"';f+=">&nbsp;";return f};DTreeView.prototype.getRootImgRef=function(d){if(!this.hasRootImg()){return""}var g="";var b=this.getRootImgURL();if(b!=null&&b.length>0){var f=null;f=this.getRootImgAltT();g=this.imgHtml(b,f,d)}return g};DTreeView.prototype.getImgRefAltCell=function(d,b){return null};DTreeView.prototype.getImgRefCell=function(u,o,f){if(!this.hasVisImgRefs()){return""}var s="";if(this.mColDatas[o].mVisible){var g=this.mColFields[o];if(g.hasImgRef()){var k=g.getImgFid();var b=u.irv[k];if(b==""){b=-1}var h=g.getImgURL(b);if(h!=null){var d=null;d=g.getImgAltT(b);s=this.imgHtml(h,d,f)}}}return s};DTreeView.prototype.getImgRefHCell=function(h,f){if(!this.hasVisImgRefs()){return 0}var k=0;if(this.mColDatas[f].mVisible){var d=this.mColFields[f];if(d.hasImgRef()){var g=d.getImgFid();var b=h.irv[g];if(b==""){b=-1}k=d.getImgH(b)}}return k};DTreeView.prototype.getImgRefWCell=function(k,f){if(!this.hasVisImgRefs()){return 0}var h=0;if(this.mColDatas[f].mVisible){var d=this.mColFields[f];if(d.hasImgRef()){var g=d.getImgFid();var b=k.irv[g];if(b==""){b=-1}h=d.getImgW(b)}}return h};DTreeView.prototype.IsInFlowLayout=function(){var b=false;var d=this.GetParent();if(d&&d.mObj&&d.mObj.getAttribute("arfillstyle")==2){b=true}else{if((this.mObj.getAttribute("arflowid")==0)&&this.mObj.parentNode.getAttribute("arfillstyle")==2){b=true}}return b};DPageArray.prototype=new DTable();DPageArray.prototype.constructor=DPageArray;DPageArray.superclass=DTable.prototype;DOMFieldFactories.PageArray=function(b,f,d){return new DPageArray(b,f,d)};function DPageArray(b,f,d){if(arguments.length){this.init(b,f,d)}}DPageArray.prototype.getParentContainer=function(){var b=null;if(!this.mParentField){b=getFormContainerPane_NS(this.windowID)}else{b=F(this.windowID,this.mParentField)}return b};DPageArray.prototype.getparentFillStyle=function(b){return b.mObj.getAttribute("arfillstyle")};DPageArray.prototype.parentIsFill=function(){var b=false;var d=this.getParentContainer();if(d!=null&&d!="undefined"){if(d instanceof DPage){b=(d.getFillStyle()==1)}else{b=(this.getparentFillStyle(d)==1)}}return b};DPageArray.prototype.parentIsFlow=function(){var d=false;var b=this.getParentContainer();if(b!=null&&b!="undefined"){if(b instanceof DPage){d=(b.getFillStyle()==2)}else{d=this.getparentFillStyle(b)==2}}return d};DPageArray.prototype.parentIsFitToContent=function(){var b=false;var d=this.getParentContainer();if(d!=null&&d!="undefined"&&d instanceof DPage){b=d.isFitToContent()}return b};DPageArray.prototype.contentClippedRequested=function(b){if(b.getAttribute("arcontentclipped")!=null){return(b.getAttribute("arcontentclipped")==1)}else{return false}};DPageArray.prototype.ContentClippedCBT=function(d){var b=(this.getChunkSize()>0&&this.contentClippedRequested(d)&&!this.parentIsFlow()&&!this.parentIsFitToContent())?true:false;return b};DPageArray.prototype.init=function(d,o,k){this.mPaneltemplate=k.getAttribute("arptemplate");this.mPanelBorderColor=k.getAttribute("arpanelbordercolor");this.mPanelBorderWidth=k.getAttribute("arpanelborderwidth");this.mPanelHorSpace=k.getAttribute("arpanelhorspace");this.mPanelVerSpace=k.getAttribute("arpanelverspace");this.mPanelLeftMargin=k.getAttribute("arpanellmargin");this.mPanelRightMargin=k.getAttribute("arpanelrmargin");this.mPanelTopMargin=k.getAttribute("arpaneltmargin");this.mPanelBottomMargin=k.getAttribute("arpanelbmargin");this.mPanelBKGImageDIV=k.getAttribute("arimagediv");DPageArray.superclass.init.call(this,d,o,k);this.mColours=this.GetRowColours();this.mBkgcolours=this.GetBkgRowColours();this.mResizeWidth=-1;this.mResizeHeight=-1;this.isContentClipped=this.ContentClippedCBT(k);this.mHasChildFields=true;var h=this.getHoverEvtList();var g=false;var b=null;for(var f=0;f<h.length;f++){idx=f;b=AREventFunction(d,h[f],this.mID);if(b!=null){g=true;break}}if(!g){g=this.hoverEvtonChildren()}this.mHasHoverEvt=g};DPageArray.prototype.getParentSize=function(){var d={width:0,height:0};if(this.mContainerID){var b=getFields_NS(this.windowID)[this.mContainerID];if(b instanceof DPage&&b.mFit){if(b.mParentObj&&b.mParentObj.mViewTypeObj&&b.mParentObj.mViewTypeObj.mOrientation=="horizontal"){d.width=b.mxSize}else{d.height=b.mxSize}}}return d};DPageArray.prototype.getInnerWidth=function(){var b=this.getParentSize();if(b.width>0){return b.width}else{var d=this.mInner;var f=d.style.width;f=parseInt(f);return f}};DPageArray.prototype.getInnerHeight=function(){var d=this.getParentSize();if(d.height>0){return d.height}else{var f=this.mInner;var b=f.style.height;b=parseInt(b);return b}};DPageArray.prototype.computeNumClippedCells=function(d,w){var o={cRows:0,cPanelsAcross:0,newWidth:d,newHeight:w};var k=d-(parseInt(this.mPanelLeftMargin)+parseInt(this.mPanelRightMargin));var v=w-(parseInt(this.mPanelTopMargin)+parseInt(this.mPanelBottomMargin));var g=parseInt(this.mPanelWidth)+parseInt(this.mPanelHorSpace);var u=parseInt(this.mPanelHeight)+parseInt(this.mPanelVerSpace);var b=k/g;var f=v/u;var h=Math.floor(b);var s=Math.floor(f);if(h<=0){o.newWidth=(parseInt(this.mPanelLeftMargin)+parseInt(this.mPanelRightMargin))+g}if(s<=0){o.newHeight=(parseInt(this.mPanelTopMargin)+parseInt(this.mPanelBottomMargin))+u}o.cRows=(s>0)?s:1;o.cPanelsAcross=(h>0)?h:1;return o};DPageArray.prototype.ApplyData=function(){if(!this.mFirstLayout&&this.mRowsPresent==0&&this.GetData().length==0&&!this.mDirtyColumns){return}this.setDisplayChunkSize(null);this.setActualDisplayChunkSize(null);var d={cRows:0,cPanelsAcross:0,newWidth:0,newHeight:0};var D={w:0,h:0};if(this.isContentClipped){d=this.computeNumClippedCells(this.getInnerWidth(),this.getInnerHeight());D.w=d.newWidth;D.h=d.newHeight;var f=Math.min(this.getChunkSize(),d.cRows*d.cPanelsAcross);this.setDisplayChunkSize(f)}var z=this.IsInFlowLayout();if(z){var g=this.mObj.className;if(this.GetData().length>0){if(g.indexOf("cbtflow")==-1){g+=" cbtflow";this.mObj.className=g}}else{this.mObj.className=g.replace("cbtflow","")}}var G;if(this.mColDatas.length==0){G=[]}else{G=this.GetData()}var v=(G.length>0);var u=this.getPageArray(G,d,D);if(FocusMgr.mCurFocusID==this.mID&&FocusMgr.mCurFocusElement!=null){this.mResetFocusToRowAfterRefresh=this.mCurrentRow;this.mResetFocusToColumnAfterRefresh=this.mCurrentCol}this.mInner.innerHTML=u.join("");this.mRowsPresent=G.length;this.mDataTableObj=this.mInner.firstChild;if(this.isContentClipped&&G.length>0){var H=this.ComputeChunkNumber(this.mResult.start);this.mChunkPage=H;this.mChunkMax=this.ComputeMaxChunks(this.mResult.start,this.mResult.n,G.length);var A=this.createHeaderString(G.length,this.mResult.n,this.mResult.start);this.UpdateHeaderUI(A,H+1);this.UpdateChunkUI(this.mResult.n)}if(G.length>0){this.mInner.style.overflow="auto"}if(this.mBtnReport){this.mBtnReport.SetVisibility(v)}if(this.mBtnSelectAll){this.mBtnSelectAll.SetVisibility(v)}if(this.mBtnDeselectAll){this.mBtnDeselectAll.SetVisibility(v)}if(this.mBtnDelete){this.mBtnDelete.SetVisibility(v)}if(this.mBtnRead){this.mBtnRead.SetVisibility(v)}if(this.mBtnUnread){this.mBtnUnread.SetVisibility(v)}if(this.mChunkOuter){this.mChunkOuter.style.visibility=(v?"inherit":"hidden")}if(FocusMgr.mCurFocusID==this.mID&&FocusMgr.mCurFocusElement!=null){var w=this.getFocusElementForReset(this.mResetFocusToRowAfterRefresh,this.mResetFocusToColumnAfterRefresh,FocusMgr.mCurFocusElement);var o=this.windowID;setTimeout(function(){FocusMgr.TryFocus(o,w)},50)}this.ApplySizes();if(this.mContainerID&&v){var E=getFields_NS(this.windowID)[this.mContainerID];if(E instanceof DPage&&E.mFit){if(E.mParentObj&&E.mParentObj.mViewTypeObj&&E.mParentObj.mViewTypeObj.mOrientation=="horizontal"){this.mResizeWidth=E.mxSize}else{this.mResizeHeight=E.mxSize}}}var y=false;var k=this.getParentContainer();if(k!=null&&k!="undefined"){y=k.mObj.getAttribute("arfillstyle")!=0?true:false;if(k&&k.mObj.getAttribute("arfillstyle")==2){this.mResizeWidth=k.mObj.offsetWidth}}var b;if(y&&!this.isContentClipped){if(!(k&&k.mObj.getAttribute("arfillstyle")==2&&k.mFit)){var h=parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace);var C=Math.floor((this.mResizeWidth-parseFloat(this.mPanelHorSpace)+parseFloat(this.mPanelRightMargin))/h);if(C==0){C=1}if(this.mPanelNumber!=C){b=true;this.mPanelNumber=C}}}if(!(k&&k.mObj.getAttribute("arfillstyle")==2&&k.mFit)){if(this.mResizeWidth!=-1&&typeof this.mResizeWidth!="undefined"&&this.mResizeHeight!=-1&&typeof this.mResizeHeight!="undefined"){this.ResizeTo(this.mResizeWidth,this.mResizeHeight,b)}}this.mLastRowSelections={};this.ApplySelections();this.mFirstLayout=false;if(typeof AnimMgr!="undefined"&&typeof this.mHighlight!="undefined"&&this.mHighlight.length>0&&this.mID!=91530){highlight=true;for(var B=0;B<this.mHighlight.length;++B){var s=this.findHtmlObject(this.mHighlight[B].r,this.mHighlight[B].c);if(s!=null){AnimMgr.Highlight(this.mColFields[this.mHighlight[B].c],s)}}this.mHighlight=[];highlight=false}};DPageArray.prototype.mapScrolltoOverflow=function(d){var b="default";if(d){if("st" in d){switch(d.st){case"yes":b="scroll";break;case"no":b="hidden";break;case"auto":b="auto";break}}}return b};DPageArray.prototype.getPageArray=function(V,b,y){var S=b.cRows;var Y=b.cPanelsAcross;var X=(S>0&&Y>0)?true:false;var U=V.length;var R=U;var A=[];var o=0;var u=0;var B=0;var v=0;var s=0;for(var L=0;L<R;++L){if(V[L].mXXXDirty==3){R=R-1}}if(R>0){if(!X){B=Math.ceil(R/this.mPanelNumber);v=this.mPanelNumber;s=B*v;o=B*(parseFloat(this.mPanelHeight)+parseFloat(this.mPanelVerSpace))-parseFloat(this.mPanelVerSpace)+parseFloat(this.mPanelBottomMargin);u=parseFloat(this.mPanelNumber)*(parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace))-parseFloat(this.mPanelHorSpace)+parseFloat(this.mPanelRightMargin)}else{B=S;v=Y;s=B*v;o=y.h;u=y.w}}divwidth=u-this.mPanelLeftMargin-this.mPanelRightMargin;divheight=o-this.mPanelTopMargin-this.mPanelBottomMargin;A.push('<div class="pagetable" style="height:'+divheight+"px;width:"+divwidth);A.push("px;margin-left:");A.push(this.mPanelLeftMargin);A.push("px;margin-right:");A.push(this.mPanelRightMargin);A.push("px;margin-top:");A.push(this.mPanelTopMargin);A.push("px;margin-bottom:");A.push(this.mPanelBottomMargin);A.push('px">');if(U>0){var J=new Array(this.mColCnt);var G=new Array(this.mColCnt);if(U>0){for(var K=0;K<this.mColCnt;K++){J[K]=this.mColFields[K].mID}}var g=new RegExp("<iframe(.*)</iframe>","i");var C=this.mColDatas;var Q=0;var f=0;for(var L=0;L<U;++L){if(!V[L].mXXXDirty||V[L].mXXXDirty!=3){var N=this.mPaneltemplate.replace(/ROW_NUMBER/,L);if(v>0){if(Q<v){var w=0;var W=Q*(parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace))}else{var I=Math.floor(Q/v);w=I*(parseFloat(this.mPanelHeight)+parseFloat(this.mPanelVerSpace));W=(Q%v)*(parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace))}N=N.replace(/LEFT_VALUE/,W+"px").replace(/TOP_VALUE/,w+"px")}if(this.mBkgcolours!=null&&V[L].rc<this.mBkgcolours.length){N=N.replace(/BKG_COLOR/,this.mBkgcolours[V[L].rc])}A.push(N);A.push(this.mPanelBKGImageDIV);for(var O=0;O<this.mColCnt;O++){if(V[L].d[O].v.indexOf("&lt;")==-1&&V[L].d[O].v.indexOf("&amp;")==-1){G[O]=V[L].d[O].v}else{G[O]=V[L].d[O].p}}var H=this.mObj.getAttribute("arserver");H=ExpandServerName(this.windowID,H);var E=this.mObj.getAttribute("arschema");E=ExpandSchemaName(this.windowID,E);for(var K=0;K<this.mColCnt;K++){if(("template" in this.mColFields[K].mObj)&&(this.mColFields[K].mObj.template!=null)){var h=this.mColFields[K].mObj.template;var z="default";var k=V[L].d[K].v;var P=this.mColFields[K].GetDataField();if(P&&P.isRTF&&P.isRTF()){k=updateRtfHtml(this.windowID,V[L].d[K].p,V[L].i,H,E);h=h.replace(/STRING_VALUE/,this.CreateDIVRTFForCBT(this.mColFields[K].mID,null,K,L))}if(V[L].d[K].h=="1"){h=h.replace(/STRING_VALUE/,k).replace(/VISIBILITY_VALUE/,"hidden")}else{if(V[L].d[K].h=="0"){h=h.replace(/STRING_VALUE/,k)}else{if(!C[K].mVisible||C[K].mWidth<=0){h=h.replace(/STRING_VALUE/,k).replace(/VISIBILITY_VALUE/,"hidden")}else{h=h.replace(/STRING_VALUE/,k)}}}if(("et" in this.mColFields[K].mObj)&&(this.mColFields[K].mObj.et!=0)){h=h.replace("CHECKED"+V[L].d[K].p,"CHECKED").replace(/RCGroup/g,"RCGroup"+L).replace(/rccc/g,"rc"+L)}if(this.mColours!=null&&V[L].rc<this.mColours.length){h=h.replace(/ROW_COLOR/g,this.mColours[V[L].rc])}if(("mCFCache" in this.mColFields[K])){h=h.replace(/NEW_LABEL/g,this.mColFields[K].mCFCache.l)}if(this.mResult.f[K].t=="View"){if(("vt" in this.mColFields[K].mObj)||("vt" in this.mResult.r[L].d[K])){if(!("vt" in this.mResult.r[L].d[K])){this.mResult.r[L].d[K].vt=this.mColFields[K].mObj.vt}var d=DView.TEMPLATENAMERE.exec(this.mResult.r[L].d[K].vt);var D=null;if(d!=null){D=T(this.windowID,d[1])}if(D!=null){D.setDefaultParamValues();this.mResult.r[L].d[K].gt=D.process(this.windowID,J,G);h=h.replace(/DCF_SRC/g,"").replace(/DVFol&#40;&#41;/g,"F("+this.windowID+","+this.mID+").ol("+L+","+K+",true)")}else{var d=DocView.URLPAT.exec(this.mResult.r[L].d[K].vt);if(d!=null){h=h.replace(/DCF_SRC/g,this.mResult.r[L].d[K].vt).replace(/DVFol&#40;&#41;/g,"F("+this.windowID+","+this.mID+").ol("+L+","+K+",false)")}else{h=h.replace(/DCF_SRC/g,"").replace(g,this.mResult.r[L].d[K].vt);z=this.mapScrolltoOverflow(this.mColFields[K].mObj)}}}}h=h.replace(/OVERFLOW_VALUE/,z);A.push(h)}}A.push("</div></fieldset>");Q++;f++;if(f>=s){break}}}}this.setActualDisplayChunkSize(f);A.push("</div>");return A};DPageArray.prototype.ol=function(g,f,d){var b=this;setTimeout(function(){if(d){var h=b.findHtmlObject(g,f);var o=new DocView(h,b.mID+"R"+g+"C"+f);var k=false;o.S(b.mResult.r[g].d[f].gt,k)}if(g==b.GetData().length-1){inner=b.mInner;setTimeout(function(){inner.scrollTop=0},0)}},5)};DPageArray.prototype.getReizedInner=function(d,h){var b;if(this.mHdrObj!=null||this.mFtrObj!=null){var k=(this.mHdrObj!=null)?this.mHdrObj.offsetHeight:0;var g=(this.mFtrObj!=null)?this.mFtrObj.offsetHeight:0;b=h-k-g;if(this.mHdrObj!=null&&!this.mHdrLObj.firstChild&&!this.mHdrRObj.firstChild&&this.mChunkOuter==null&&!this.mObj.getAttribute("arentretstr")&&!this.mObj.getAttribute("arnotrefstr")){b+=k}if(this.mFtrObj!=null&&!this.mFtrLObj.firstChild&&!this.mFtrRObj.firstChild){b+=g}if(b<0){b=0}}if(this.mFixedHeader){b-=16}var f=d;if(f<0){f=0}return{w:f,h:b}};DPageArray.prototype.ResizeContentClipped=function(b){this.setDisplayChunkSize(null);this.setActualDisplayChunkSize(null);var k={cRows:0,cPanelsAcross:0,newWidth:0,newHeight:0};var f={w:0,h:0};k=this.computeNumClippedCells(b.w,b.h);f.w=k.newWidth;f.h=k.newHeight;var s=Math.min(this.getChunkSize(),k.cRows*k.cPanelsAcross);this.setDisplayChunkSize(s);var g;if(this.mColDatas.length==0){g=[]}else{g=this.GetData()}var h=this.getPageArray(g,k,f);this.mInner.innerHTML=h.join("");this.mRowsPresent=g.length;this.mDataTableObj=this.mInner.firstChild;this.mLastRowSelections={};this.ApplySelections();if(g.length>0){var d=this.ComputeChunkNumber(this.mResult.start);this.mChunkPage=d;this.mChunkMax=this.ComputeMaxChunks(this.mResult.start,this.mResult.n,g.length);var o=this.createHeaderString(g.length,this.mResult.n,this.mResult.start);this.UpdateHeaderUI(o,d+1);this.UpdateChunkUI(this.mResult.n)}};DPageArray.prototype.ResizeTo=function(f,C,z){if(this.mResizeWidth==f&&this.mResizeHeight==C&&(typeof z=="undefined")){return}this.mResizeWidth=f;this.mResizeHeight=C;DPageArray.superclass.ResizeTo.call(this,f,C);var v;if(this.mColDatas.length==0){v=[]}else{v=this.GetData()}var A=v.length;var B=this.mDataTableObj;if(A>0&&B&&B.children&&B.children.length>0){if(!this.isContentClipped){var w=parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace);var o=Math.floor((f-parseFloat(this.mPanelHorSpace)+parseFloat(this.mPanelRightMargin))/w);if(o==0){o=1}var g=Math.ceil(A/o);var k=g*(parseFloat(this.mPanelHeight)+parseFloat(this.mPanelVerSpace))-parseFloat(this.mPanelVerSpace)+parseFloat(this.mPanelBottomMargin);var d=parseFloat(o)*(parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace))-parseFloat(this.mPanelHorSpace)+parseFloat(this.mPanelRightMargin);B.style.width=d+"px";B.style.height=k+"px";B=B.firstChild;for(var u=0;u<A;++u){if(u<o){var s=0;var b=u*(parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace))}else{var h=Math.floor(u/o);s=h*(parseFloat(this.mPanelHeight)+parseFloat(this.mPanelVerSpace));b=(u%o)*(parseFloat(this.mPanelWidth)+parseFloat(this.mPanelHorSpace))}B.style.left=b+"px";B.style.top=s+"px";B=B.nextSibling}}else{var y={w:0,h:0};if(this.mAsyncMode){y=this.getReizedInner(this.mAsyncResizePending.w,this.mAsyncResizePending.h)}else{y={w:this.getInnerWidth(),h:this.getInnerHeight()}}this.ResizeContentClipped(y)}}};DPageArray.prototype.InstantiateUI_Part1=function(b){this.mPanelNumber=b.getAttribute("arpanelnumber");if(this.mPanelNumber>0){this.mPanelWidth=b.getAttribute("arpanelwidth");this.mPanelHeight=b.getAttribute("arpanelheight")}this.mHdrObj=b.firstChild};DPageArray.prototype.FindContainingSpan=function(b){while(b.nodeType!=1||(b.tagName!="SPAN")){b=b.parentNode}return b};DPageArray.prototype.DOMClick=function(g){var b=this.DOMClick_part1(g);if(typeof b!="undefined"&&typeof b!="number"){return b}var o=[];h=g.element;while((h!=null)&&(h.nodeType!=1||h.getAttribute("id")!="pagerow")){h=h.parentNode}if(h==null){return}var s=this.MapUIXY(g.element);if(s==null){return}var u=s.y;this.mCurrentCol=s.x;var h=g.element;if(this.IsLabelPart(h)||h.tagName=="LABEL"){g.StopBubbling();g.StopDefault();var k=this.FindContainingDiv(h);if(k&&k.className.indexOf("radio")!=-1){var f=true}}var d=FakeButton_Find(g.element);if(d){if((d.className.indexOf("spinnerup")!=-1)||(d.className.indexOf("spinnerdown")!=-1)){return}if(d.getAttribute("artype")=="Control"){var f=true}}if(this.mSelRow!=1){if(!g.ctrl&&!g.shift&&!g.meta){if((this.mColFields[s.x]&&this.mColFields[s.x].isRTF()&&$(g.element).parents(".rtf").length>0)||(g.element.tagName=="IMG")||(g.element.tagName=="A")||((g.element.tagName=="INPUT")&&((g.element.type=="radio")||(g.element.type=="checkbox")||(g.element.type=="text")))||((g.element.tagName=="DIV")&&($(g.element).is("rtf")||g.element.className.indexOf("rtf_")!=-1))||(typeof f!="undefined")){o.push({t:this.mColFields[s.x],f:this.mColFields[s.x].DOMClick,a:[g]})}if(this.mPrimaryRowSelection==null||u!=this.RowNoFromTag(this.mPrimaryRowSelection)||u!=this.mLastRowSelection){o.push({t:this,f:this.ApplySelections});o.push({f:this.SetPrimarySelection,t:this,a:[u,true,true,true]})}}else{if(this.mSelRow==0){if(!g.shift&&(g.ctrl||g.meta)){o.push({t:this,f:this.ApplySelections});o.push({f:function(){this.mLastRowSelection=u},t:this});o.push({f:this.EORSelections,t:this,a:[u,false,false]})}}}}else{if(!g.ctrl&&!g.shift&&!g.meta){if((g.element.tagName=="IMG")||(g.element.tagName=="A")||((g.element.tagName=="INPUT")&&((g.element.type=="radio")||(g.element.type=="checkbox")||(g.element.type=="text")))||((g.element.tagName=="DIV")&&(g.element.className&&g.element.className.indexOf(" rtf")!=-1))||(typeof f!="undefined")){o.push({t:this.mColFields[s.x],f:this.mColFields[s.x].DOMClick,a:[g]})}}}return{n:o}};DPageArray.prototype.DOMMouseDown=function(f){var g=this.MapUIXY(f.element);if(g){this.mMouseDownRowSelection=g.y}else{this.mMouseDownRowSelection=-1}if(this.GAccess()==3){if(f.element.type=="radio"&&f.element.name!=null&&f.element.name!="undefined"){dradiobutt=document.getElementsByName(f.element.name);for(i=0;i<dradiobutt.length;i++){if(dradiobutt[i].checked==true){f.element.disabledindex=i}}}return}var o=this.FindContainingDiv(f.element);if(o==null){return}if(o.className!="TableHdr"&&o.className!="TableFtr"&&o!=this.mChunkOuter){o=f.element;while((o!=null)&&(o.nodeType!=1||o.getAttribute("id")!="pagerow")){o=o.parentNode}if(o==null){return}var d=this.MapUIXY(f.element);if(d==null){return}var b=FakeButton_Find(f.element);if(b&&((b.className.indexOf("spinnerup")!=-1)||(b.className.indexOf("spinnerdown")!=-1))){var k=this;var h={};h.c={f:function(){var s=[];var u=d.y;k.mCurrentCol=d.x;if(k.mPrimaryRowSelection==null||u!=k.RowNoFromTag(k.mPrimaryRowSelection)||u!=k.mLastRowSelection){s.push({t:k,f:k.ApplySelections});s.push({f:k.SetPrimarySelection,t:k,a:[u,true,true,true]})}return{n:s}}};h.n={f:function(){var s=[];s.push({t:k.mColFields[d.x],f:k.mColFields[d.x].DOMMouseDown,a:[f]});return{n:s}}};return h}else{var k=this;var h={};h.c={f:function(){var s=[];var u=d.y;k.mCurrentCol=d.x;if(k.mSelRow==1){return{n:s}}if(f.shift){s.push({t:k,f:k.ApplySelections});s.push({f:function(){k.mLastRowSelection=u},t:k});if(k.mSelRow==0){if(f.ctrl||f.meta){s.push({f:k.FillSelections,t:k,a:[k.mLastRowSelection,u,u,false]})}else{if(k.mLastRowSelection==-1){s.push({f:k.SetPrimarySelection,t:k,a:[u,true,true,true]})}else{s.push({t:k,f:k.ApplySelections});s.push({f:k.FillSelections,t:k,a:[u,k.mLastNonShiftedRowSelection,k.mLastNonShiftedRowSelection<0?u:k.mLastNonShiftedRowSelection,true]})}}}}else{if(k.mSelRow!=1&&!f.ctrl&&!f.shift&&!f.meta){if((k.mRowSelections[k.mResult.r[k.mMouseDownRowSelection].i]!=true)&&(k.mPrimaryRowSelection==null||u!=k.RowNoFromTag(k.mPrimaryRowSelection)||u!=k.mLastRowSelection)){s.push({t:k,f:k.ApplySelections});s.push({f:k.SetPrimarySelection,t:k,a:[u,true,true,true]})}}}return{n:s}}};return h}}};DPageArray.prototype.DOMDragStart=function(f){if(f.ctrl){var d=this.MapUIXY(f.element);if(d==null){return}var g=d.y;if(this.mSelRow==0){var b=[];b.push({t:this,f:this.ApplySelections});b.push({f:function(){this.mLastRowSelection=g},t:this});b.push({f:this.EORSelections,t:this,a:[g,true,false]});return{n:b}}return{}}};DPageArray.prototype.DOMMouseUp=function(f){DPageArray.superclass.DOMMouseUp.call(this,f);if(this.GAccess()==3){return}var g=this.FindContainingDiv(f.element);if(g==null){return}if(g.className!="TableHdr"&&g.className!="TableFtr"&&g!=this.mChunkOuter){g=f.element;while((g!=null)&&(g.nodeType!=1||g.getAttribute("id")!="pagerow")){g=g.parentNode}if(g==null){return}var d=this.MapUIXY(f.element);if(d==null){return}var b=FakeButton_Find(f.element);if(b){if((b.className.indexOf("spinnerup")!=-1)||(b.className.indexOf("spinnerdown")!=-1)){this.mColFields[d.x].DOMMouseUp(f)}}}};DPageArray.prototype.DOMMouseOver=function(b){if(this.GAccess()==3){return}var d=this.FindContainingDiv(b.element);if(d==null){return}if(d.className!="TableHdr"&&d.className!="TableFtr"&&d!=this.mChunkOuter){d=b.element;while((d!=null)&&(d.nodeType!=1||d.getAttribute("id")!="pagerow")){d=d.parentNode}if(d==null){return}if(d.style.borderWidth=="2px"&&d.style.borderColor=="transparent"){d.className+=" RolloverRound"}else{d.style.borderColor="#339cde"}}};DPageArray.prototype.DOMMouseOut=function(f){if(this.GAccess()==3){return}var g=this.FindContainingDiv(f.element);if(g==null){return}if(g.className!="TableHdr"&&g.className!="TableFtr"&&g!=this.mChunkOuter){g=f.element;while((g!=null)&&(g.nodeType!=1||g.getAttribute("id")!="pagerow")){g=g.parentNode}if(g==null){return}if(g.className.indexOf("Round")!=-1){g.className=g.className.replace(/RolloverRound/g,"")}else{if(g.style.borderColor!="transparent"){g.style.borderColor=this.mPanelBorderColor}}g.className=g.className.replace(/\s+$/g,"");var d=this.MapUIXY(f.element);if(d==null){return}var b=FakeButton_Find(f.element);if(b){if((b.className.indexOf("spinnerup")!=-1)||(b.className.indexOf("spinnerdown")!=-1)){this.mColFields[d.x].DOMMouseOut(f)}}}};DPageArray.prototype.DOMKeyPress=function(d){if(this.GAccess()==3){return}var f=this.FindContainingDiv(d.element);if(f==null){return}if(f.className!="TableHdr"&&f.className!="TableFtr"&&f!=this.mChunkOuter){f=d.element;while((f!=null)&&(f.nodeType!=1||f.getAttribute("id")!="pagerow")){f=f.parentNode}if(f==null){return}var b=this.MapUIXY(d.element);if(b==null){return}f=d.element;if((f.className.indexOf("text")!=-1)&&(f.getAttribute("arautoc")!=null)){this.mColFields[b.x].DOMKeyPress(d)}}};DPageArray.prototype.MapUIXToData=function(b){return b};DPageArray.prototype.SyncCaret=function(f,h){var k=this.FishOutTR(h);if(k==null){return}var g=this.TabableElementSelector(k);if(g==null){var b=this.MapUIXY(f);var s=0;if(b!=null){s=0}var s=b.x;k=this.findHtmlObject(h,s);if(k==null){return}g=k;while(true){var o;if(g.firstChild&&(!g.style||(g.style.visibility!="hidden"&&g.style.display!="none"))){g=g.firstChild}else{if(g==k){g=null;return}while(!g.nextSibling){g=g.parentNode;if(g==k){g=null;return}}g=g.nextSibling}if(g.nodeType==1){var d;if((d=this.TabableElementSelector(g))!=null){if(d.className==f.className){g=d;break}}}}}if(g!=null){g.focus()}};DPageArray.prototype.DOMKeyDown=function(d){if(this.GAccess()==3){return}var f=this.FindContainingDiv(d.element);if(f==null){return}if(f.className!="TableHdr"&&f.className!="TableFtr"&&f!=this.mChunkOuter){f=d.element;while((f!=null)&&(f.nodeType!=1||f.getAttribute("id")!="pagerow")){f=f.parentNode}if(f==null){return}var b=this.MapUIXY(d.element);if(b==null){return}f=d.element;if((f.className.indexOf("text")!=-1)&&(f.getAttribute("arautoc")!=null)){this.mColFields[b.x].DOMKeyDown(d)}else{if(d.key==13){return}else{return DPageArray.superclass.DOMKeyDown.call(this,d)}}}else{return DPageArray.superclass.DOMKeyDown.call(this,d)}};DPageArray.prototype.DOMFocus=function(d){if(this.GAccess()==3){return}var f=this.FindContainingDiv(d.element);if(f==null){return null}if(f.className!="TableHdr"&&f.className!="TableFtr"&&f!=this.mChunkOuter){f=d.element;while((f!=null)&&(f.nodeType!=1||f.getAttribute("id")!="pagerow")){f=f.parentNode}if(f==null){return DPageArray.superclass.DOMFocus.call(this,d)}var b=this.MapUIXY(d.element);if(b==null){return DPageArray.superclass.DOMFocus.call(this,d)}f=d.element;if((f.className.indexOf("text")!=-1)&&(f.getAttribute("arautoc")!=null)){this.mColFields[b.x].DOMFocus(d)}}return DPageArray.superclass.DOMFocus.call(this,d)};DPageArray.prototype.FieldValChanged=function(d,g){if(this.GAccess()==3){return}var f=this.FindContainingDiv(d.element);if((f==null)||(f.className.indexOf("radio")!=-1&&d.key==9)){return}if(f.className!="TableHdr"&&f.className!="TableFtr"&&f!=this.mChunkOuter){f=d.element;while((f!=null)&&(f.nodeType!=1||f.getAttribute("id")!="pagerow")){f=f.parentNode}if(f==null){return}var b=this.MapUIXY(d.element);if(b==null){return}f=d.element;if(b.x>=0){this.mColFields[b.x].FieldValChanged(d,g)}}};DPageArray.prototype.ChangeDataColorForEnum=function(g,f){for(var b in g.childNodes){var h=g.childNodes[b];if(h.nodeType!=1||(h.tagName!="DIV")){continue}h.style.color=f;var d;if(h.getAttribute("artype")=="EnumSel"){d=h.childNodes[2].childNodes[1];d.style.color=f}else{if(h.getAttribute("artype")=="Enum"){d=h.childNodes[3].childNodes[3];d.style.color=f}else{d=h.childNodes[2];d.style.color=f}}}};DPageArray.prototype.HandleEnumSelValChanged=function(h,d){if(this.GAccess()==3){return}this.FieldValChanged(h,d);return;var k=this.FindContainingDiv(h.element);if(k==null){return}var g=k;if(k.className!="TableHdr"&&k.className!="TableFtr"&&k!=this.mChunkOuter){k=h.element;while((k!=null)&&(k.nodeType!=1||k.getAttribute("id")!="pagerow")){k=k.parentNode}if(k==null){return}var s=this.MapUIXY(h.element);if(s==null){return}if(d==""||d==null){var f=0}else{for(var u in this.mColFields[s.x].mObj.e){var b=this.mColFields[s.x].mObj.e[u];if(b==d){var f=parseInt(u)+1;break}}}if(typeof f=="undefined"){return}if(this.mColours!=null&&f<this.mColours.length){var o="";if(this.mColours[f].indexOf("inherit")==-1){o=this.mColours[f].replace(/ color:/,"").replace(/;/,"")}this.ChangeDataColorForEnum(k,o)}else{this.ChangeDataColorForEnum(k,"")}if(this.mBkgcolours!=null&&f<this.mBkgcolours.length){if(this.mBkgcolours[f].indexOf("inherit")!=-1){k.style.backgroundColor=""}else{k.style.backgroundColor=this.mBkgcolours[f].replace(/ background-color:/,"").replace(/;/,"")}}else{k.style.backgroundColor=""}}};DPageArray.prototype.HandleEnumValChanged=function(d,o){if(this.GAccess()==3){return}this.FieldValChanged(d,o);return;var h=this.FindContainingDiv(d.element);if(h==null){return}var f=h;if(h.className!="TableHdr"&&h.className!="TableFtr"&&h!=this.mChunkOuter){h=d.element;while((h!=null)&&(h.nodeType!=1||h.getAttribute("id")!="pagerow")){h=h.parentNode}if(h==null){return}var b=this.MapUIXY(d.element);if(b==null){return}if(o==""||o==null){var k=0}else{k=parseInt(o)+1}if(this.mColours!=null&&k<this.mColours.length){var g="";if(this.mColours[k].indexOf("inherit")==-1){g=this.mColours[k].replace(/ color:/,"").replace(/;/,"")}this.ChangeDataColorForEnum(h,g)}if(this.mBkgcolours!=null&&k<this.mBkgcolours.length){if(this.mBkgcolours[k].indexOf("inherit")!=-1){h.style.backgroundColor=""}else{h.style.backgroundColor=this.mBkgcolours[k].replace(/ background-color:/,"").replace(/;/,"")}}else{h.style.backgroundColor=""}}};DPageArray.prototype.DOMDoubleClick=function(d){var b=FakeButton_Find(d.element);if(b){if((b.className.indexOf("spinnerup")!=-1)||(b.className.indexOf("spinnerdown")!=-1)){return}}var f=this.MapUIXY(d.element);if(f==null){return}return this.ARDrillDown(f,false)};DPageArray.prototype.GetFocusElementForEvent=function(d){var f=d.element;if(this.GetNestedFocusability()){var g=this.FindContainingDiv(d.element);if(g==null){return null}if(g.className!="TableHdr"&&g.className!="TableFtr"&&g.className!="TableHdrChunk"&&g.className!="TableChunkDiv"){if((f.tagName=="A")||(f.tagName=="INPUT")||(f.tagName=="IMG")||(f.tagName=="TEXTAREA")){var b=this.ColField_FromElement(d);if((b!=null)&&this.GetNestedFocusabilityForColumn(b)){return f}else{return null}}else{while(f&&(f.nodeType!=1||(f.tagName!="DIV"&&f.tagName!="TR"&&f.tagName!="FIELDSET"))){f=f.parentNode}if(f&&((f.className=="BaseTableColHeaders"||f.className=="BaseTableBar"||f.className=="BaseTableHeader")||(g.getAttribute("id")=="pagerow"))){return d.element}}}else{if((f.tagName=="A")||(f.tagName=="INPUT")||(f.tagName=="IMG")){return f}}f=d.element;while((f!=null)&&(f.nodeType!=1||f.getAttribute("id")!="pagerow")){f=f.parentNode}if(f==null){if(this.mOuter!=null){return this.mOuter}return this.mObj}return f}};DPageArray.prototype.TabableElementSelector=function(o){if(o.tagName=="A"){var k=FakeButton_Find(o);if(k!=null){var h=o.parentNode;while(h&&h.getAttribute("id")!="pagerow"&&h.tagName!="TD"){h=h.parentNode}if(h&&h.tagName=="TD"){return FakeButton_TabableElementSelector(k)}else{if(h&&h==this.GetFocusElement()){return o}}}else{if(o.getAttribute("onclick")!=null){return o}else{return null}}}else{if(o.tagName=="TEXTAREA"){var h=o.parentNode;while(h&&h.getAttribute("id")!="pagerow"){h=h.parentNode}if(h&&h==this.GetFocusElement()){return o}}else{if(o.tagName=="INPUT"){var h=o.parentNode;while(h&&h.getAttribute("id")!="pagerow"&&h.tagName!="TD"){h=h.parentNode}if(h&&h==this.GetFocusElement()){if(o.getAttribute("type")=="radio"){if(o.checked){return o}else{var b=this.MapUIXY(o);if(b==null){return null}var g=this.mColFields[b.x].mField;if(g==null){return null}if(typeof g.mSelected=="undefined"){g.initVariable(o);if(g.mSelected!=null){return null}}if(g.mSelected==null){var f=g.getFirst(o);if(f!=null&&f.id==o.id){return o}else{return null}}}}else{return o}}}else{if(o.tagName=="IFRAME"){try{var d=("contentDocument" in o)?o.contentDocument:window.frames[o.name].document;if(d!=null){return(d.body==null)?d:((d.body.firstChild==null)?d.body:d.body.firstChild)}return o}catch(s){}}else{if(o.tagName=="DIV"&&(o.firstChild&&o.firstChild.tagName=="IFRAME"||o.className!="PageBody"&&o.getAttribute("onclick")!=null)){return o}}}}}return null};DPageArray.prototype.ColField_FromElement=function(d){var b=this.MapUIXY(d.element);if(b==null){return}return this.mColFields[b.x]};DPageArray.prototype.GetNestedFocusabilityForColumn=function(b){var d=b.GetParent();return((b.GAccess()!=3)&&b.GVis()&&(d==null||d.GetNestedFocusability()))};DPageArray.prototype.MapUIX=function(d){var f,g=null;var b=document.body;while(d&&(d.getAttribute("id")!="pagerow")&&(d!=b)){if((d.tagName=="DIV"||d.tagName=="INPUT")&&(d.className.indexOf("PageBody")==-1)){g=d}if((d.tagName=="A")&&(d.getAttribute("artype")=="Control")){g=d}d=d.parentNode}if(d==b){return null}if(d&&d.getAttribute("arrow")!=null){f=parseInt(d.getAttribute("arrow"))}else{return null}if(f>=this.mRowsPresent){return null}return f};DPageArray.prototype.MapUIXY=function(f){var g,b=0,h=null;var d=document.body;while(f&&(f.getAttribute("id")!="pagerow")&&(f!=d)){if((f.tagName=="DIV"||f.tagName=="INPUT")&&(f.className.indexOf("PageBody")==-1)){h=f}if((f.tagName=="A")&&(f.getAttribute("artype")=="Control")){h=f}f=f.parentNode}if(f==d){return null}if(f&&f.getAttribute("arrow")!=null){g=parseInt(f.getAttribute("arrow"))}else{return null}if(g>=this.mRowsPresent){return null}if(h==null){b=-1}else{while(h.previousSibling){h=h.previousSibling;if((h.nodeType==1)&&(h.className.indexOf("FormContainerImage")==-1)){++b}}}if(b>=this.mColCnt){return null}return{y:g,x:b}};DPageArray.prototype.FishOutTR=function(b){if(b<0||b>=this.mRowsPresent||this.mDataTableObj==null||this.mDataTableObj.childNodes.length<=0){return null}return this.mDataTableObj.childNodes[b]};DPageArray.prototype.DirtyEditableCell=function(b){return};DPageArray.prototype.DataChanged=function(){if(this.mAsyncMode){this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)}};DPageArray.prototype.findHtmlObject=function(h,f){var b=this.FishOutTR(h);if(b==null){return null}var d=b.firstChild;if(d==null){return null}while(d.nextSibling){d=d.nextSibling;if(d.nodeType==1){break}}if(d==null){return null}d=d.firstChild;var g=f;while(d){if((d.nodeType==1)&&(d.className.indexOf("FormContainerImage")==-1)){if(g<=0){break}--g}d=d.nextSibling}return d};DPageArray.prototype.findHtmlInputObject=function(h,f){var g=this.findHtmlObject(h,f);if(g==null){return null}var d=this.TabableElementSelector(g);if(d==null){d=g;while(true){var k;if(d.firstChild&&(!d.style||(d.style.visibility!="hidden"&&d.style.display!="none"))){d=d.firstChild}else{if(d==g){d=null;return}while(!d.nextSibling){d=d.parentNode;if(d==g){d=null;return}}d=d.nextSibling}if(d.nodeType==1){if(d.tagName!="IFRAME"){var b;if((b=this.TabableElementSelector(d))!=null){d=b;break}}else{d=window.frames[d.name];break}}}}return d};DPageArray.prototype.SColLabel=function(b,d){if(this.mFlushingQueue>0){this.SColFieldLabel(b,d)}else{this.mColInfo[b].heading=d;this.mAsyncQueue.push({action:0,col:b,val:d});this.mAsyncDirty=(3>this.mAsyncDirty?3:this.mAsyncDirty)}};DPageArray.prototype.SColFieldLabel=function(b,d){if(this.mAsyncDirty<3){this.ApplyData()}};DPageArray.prototype.getPageBox=function(k,d,h){var u=k.height;var f=k.width;var o=k.top;var g=k.left;u=parseInt(u.substr(0,u.length-2));f=parseInt(f.substr(0,f.length-2));o=parseInt(o.substr(0,o.length-2));g=parseInt(g.substr(0,g.length-2));o+=d;g+=h;var b=o+u-1;var s=g+f-1;return{top:o,left:g,bottom:b,right:s}};DPageArray.prototype.getRowInScroll=function(u){if(u.element.className=="BaseTableInner"){var g=this.mInner;var w=g.firstChild;var k=w.style.marginTop;var f=w.style.marginLeft;k=parseInt(k.substr(0,k.length-2));f=parseInt(f.substr(0,f.length-2));var A=w.childNodes;var d=A.length;var z=u.ox;var v=u.oy;for(var b=0;b<d;b++){var o=A[b].style;var h=new Object();var y=A[b].getAttribute("arrow");y=parseInt(y);h.height=o.height;h.width=o.width;h.top=o.top;h.left=o.left;var s=this.getPageBox(h,k,f);if((z>=s.left&&z<=s.right)&&(v>=s.top&&v<=s.bottom)){return y}}}return null};DPageArray.prototype.Clearoutfields=function(){for(var b=0;b<this.mColFields.length;++b){if(this.mColFields[b].mField){this.mColFields[b].mField=null}}};DPageArray.prototype.setFieldVisibilityOnRow=function(g,o,f){if(!this.mResult){return}var s=0;var d=0;if(o&&o>0){s=o-1}if(f&&f>0){d=f-1}var b=this.mResult.f.length;var h=this.mResult.r.length;if((s>h)||(d>b)){return}this.mResult.r[s].d[d].h=g;var k=this.findHtmlObject(s,d);if(k){if(g=="1"){k.style.visibility="hidden"}else{k.style.visibility="inherit"}}};DPageArray.prototype.setFieldVisibilityOnCurrentRow=function(f,u){if(!this.mResult){return}var k=this.mCurrentRow;var s=this.mResult.r.length;if(k>s){return}var b=this.mResult.f.length;var o=0;var d=u.split(/,/);for(var h=0;h<d.length;h++){o=this.getColNum(d[h]);if((o>b)||(o<0)){continue}this.mResult.r[k].d[o].h=f;var g=this.findHtmlObject(k,o);if(g){if(f=="1"){g.style.visibility="hidden"}else{g.style.visibility="inherit"}}}};DPageArray.prototype.mResetFocusToRowAfterRefresh=0;DPageArray.prototype.mResetFocusToColumnAfterRefresh=0;DPageArray.prototype.getFocusElementForReset=function(o,d,f){if(!this.mResult){return}var g=this.mResult.r.length;if((o>g)||(o<0)){return}var b=this.mResult.f.length;if((d>b)||(d<0)){return}var h=this.findHtmlInputObject(o,d);var k=h;if(k){while(k!=null&&f!=null&&k.tagName!=f.tagName){k=k.nextSibling}if(k==null){k=h}}else{k=f}return k};DPageArray.prototype.IsInFlowLayout=function(){var b=false;var d=this.GetParent();if(d&&d.mObj&&d.mObj.getAttribute("arfillstyle")==2){b=true}else{if((this.mObj.getAttribute("arflowid")==0)&&this.mObj.parentNode.getAttribute("arfillstyle")==2){b=true}}return b};DPageArray.prototype.ScaleSizes=function(){var b=0,h=false,g=1;for(var d in this.mColDatas){if(this.mColDatas[d].mVisible){b+=this.mColDatas[d].mWidth}}g=this.mWidth/b;if(g==1){return}if(this.mWidth<(this.mColDatas.length*5)){return}for(var d in this.mColDatas){if(this.mColDatas[d].mVisible){var f=this.mColDatas[d];f.mWidth=Math.floor(f.mWidth*g)}}};DPageArray.prototype.ApplySelections=function(){var z=this.FishOutTR(0),v={};var s=0;if(z!=null){var h=-1;for(var k in this.mRowSelections){if(!this.mResult.r[this.RowNoFromTag(k)].mXXXDirty||this.mResult.r[this.RowNoFromTag(k)].mXXXDirty!=3){v[this.RowNoFromTag(k)]="SelSecondary";if(z.style.borderWidth=="2px"&&z.style.borderColor=="transparent"){v[this.RowNoFromTag(k)]+="Round"}s++}}if(this.mPrimaryRowSelection!=null){h=this.RowNoFromTag(this.mPrimaryRowSelection);if(!this.mResult.r[h].mXXXDirty||this.mResult.r[h].mXXXDirty!=3){v[h]="SelPrimary";if(z.style.borderWidth=="2px"&&z.style.borderColor=="transparent"){v[h]+="Round"}}}var w={},y=0;for(var k in this.mLastRowSelections){if(!(k in v)){w[k]="";++y}}for(var k in v){if(this.mLastRowSelections!=null&&v[k]!=this.mLastRowSelections[k]){w[k]=v[k];++y}}var d;if(y>1750){for(var o=0;z;z=z.nextSibling,++o){if(o in w){z.className=w[o]}else{z.className=""}}}else{var u=z.parentNode,g=0;outer:for(var k in w){for(var f=0;f<u.childNodes.length;f++){if(u.childNodes[parseInt(f)+g].getAttribute("arrow")==k){u.childNodes[parseInt(f)+g].className=w[k];continue outer}}}}}this.mLastRowSelections=v;if(this.mID==1020&&this.mFtrRObj){var b=getLocalizedMessage("{0} rows selected");b=b.replace(/\{0\}/,s);NodeWrite(this.mFtrRObj,b)}};DPageArray.prototype.CreateDIVRTFForCBT=function(u,h,b,v){var f=YAHOO.util.Dom,s=YAHOO.util.Event,g=YAHOO.lang;var o="ltr";var d="div_"+this.windowID+"_"+u;var k=d+"_"+v;return'<div id="'+d+'" name="'+d+'" scrolling="'+(h?"no":"auto")+'" dir="'+o+'" allowTransparency="true" frameBorder="0" border="0" marginWidth="0" marginHeight="0" rightMargin="3px" leftMargin="2px" topMargin="3px" bottomMargin="0px"style="width:100%;height:100%;cursor:default;backgroundColor:transparent;direction:'+o+';"><div id="'+k+'" class="rtf_text">STRING_VALUE</div></div>'};var gTreeMessages=new Object();gTreeMessages[0]=getLocalizedMessage("{0}, Level {1} {2} Closed");gTreeMessages[1]=getLocalizedMessage("Level {0} {1} Closed");gTreeMessages[2]=getLocalizedMessage("{0}, Level {1} {2} Closed Disabled");gTreeMessages[3]=getLocalizedMessage("Level {0} {1} Closed Disabled");gTreeMessages[4]=getLocalizedMessage("{0}, Level {1} {2} Closed {3} of {4} {5} Items");gTreeMessages[5]=getLocalizedMessage("Level {0} {1} Closed {2} of {3} {4} Items");gTreeMessages[6]=getLocalizedMessage("{0}, Level {1} {2} Closed Disabled {3} of {4} {5} Items");gTreeMessages[7]=getLocalizedMessage("Level {0} {1} Closed Disabled {2} of {3} {4} Items");gTreeMessages[8]=getLocalizedMessage("{0}, Level {1} {2} {3} of {4}");gTreeMessages[9]=getLocalizedMessage("Level {0} {1} {2} of {3}");gTreeMessages[10]=getLocalizedMessage("{0}, Level {1} {2} {3} of {4} Disabled");gTreeMessages[11]=getLocalizedMessage("Level {0} {1} {2} of {3} Disabled");gTreeMessages[12]=getLocalizedMessage("{0} Selected");gTreeMessages[13]=getLocalizedMessage("{0} Selected Disabled");gTreeMessages[14]=getLocalizedMessage(" Selected");gTreeMessages[15]=getLocalizedMessage("Closed");gTreeMessages[16]=getLocalizedMessage("Opened");var gTreeMsgArgs=new Object();gTreeMsgArgs[0]="[treeNode.imgalt, treeNode.nodeLevel, treeNode.name]";gTreeMsgArgs[1]="[treeNode.nodeLevel, treeNode.name]";gTreeMsgArgs[2]="[treeNode.imgalt, treeNode.nodeLevel, treeNode.name]";gTreeMsgArgs[3]="[treeNode.nodeLevel, treeNode.name]";gTreeMsgArgs[4]="[treeNode.imgalt, treeNode.nodeLevel, treeNode.name, childNum, numSiblings, treeNode.childs.length]";gTreeMsgArgs[5]="[treeNode.nodeLevel, treeNode.name, childNum, numSiblings, treeNode.childs.length]";gTreeMsgArgs[6]="[treeNode.imgalt, treeNode.nodeLevel, treeNode.name, childNum, numSiblings, treeNode.childs.length]";gTreeMsgArgs[7]="[treeNode.nodeLevel, treeNode.name, childNum, numSiblings, treeNode.childs.length]";gTreeMsgArgs[8]="[treeNode.imgalt, treeNode.nodeLevel, treeNode.name, childNum, numSiblings]";gTreeMsgArgs[9]="[treeNode.nodeLevel, treeNode.name, childNum, numSiblings]";gTreeMsgArgs[10]="[treeNode.imgalt, treeNode.nodeLevel, treeNode.name, childNum, numSiblings]";gTreeMsgArgs[11]="[treeNode.nodeLevel, treeNode.name, childNum, numSiblings]";gTreeMsgArgs[12]="[nodetitle.title]";gTreeMsgArgs[13]="[nodetitle.title]";gTreeMsgArgs[14]="[]";gTreeMsgArgs[16]="[]";gTreeMsgArgs[15]="[]";TreeNode.showRootNode=false;TreeNode.showLines=true;TreeNode.sortNodes=false;TreeNode.documentID=window.location.href;TreeNode.showAllNodesOnStartup=false;var TreeNodes={};TreeNode.NextIndex=0;TreeNode.href="";TreeNode.prototype.constructor=TreeNode;function TreeNode(o,g,f,d,v,u,s,b,k,w,h){if(arguments.length){this.init(o,g,f,d,v,u,s,b,k,w,h)}}TreeNode.prototype.init=function(s,g,f,d,w,v,u,b,o,y,k){var h=arguments.length;this.addMessageStrings(s,g);this.id=arguments[2];this.name=(arguments[3]==null?"unset name":arguments[3]);this.nodeLevel=arguments[4];this.disabled=arguments[5];this.childs=new Array();this.color=(h>=7)?arguments[6]:"";this.imgref=(h>=8)?arguments[7]:"";this.imgalt=(h>=9)?arguments[8]:null;this.imgh=(h>=10)?arguments[9]:0;this.imgw=(h>=11)?arguments[10]:0;this.nullnodetype=0};TreeNode.prototype.addMessageStrings=function(b,d){this.treeMessages=b;this.treeMsgArgs=d};TreeNode.prototype.parent=null;TreeNode.prototype.linestring="";TreeNode.prototype.nextSibling=null;TreeNode.prototype.prevSibling=null;TreeNode.prototype.startRow=0;TreeNode.prototype.endRow=0;TreeNode.prototype.column=-1;TreeNode.registerRootNode=function(b){b.selectedNode=null;b.statearray=new Array();b.loaded=false;TreeNodes[b.id]=b};TreeNode.prototype.getMsg=function(d,b){var f=this.treeMessages[d];return subArgsMessages(f,b)};TreeNode.prototype.getMsgArgS=function(b){return(this.treeMsgArgs[b])};TreeNode.prototype.getID=function(){return this.id};TreeNode.prototype.setName=function(b){this.name=b};TreeNode.prototype.getName=function(){return this.name};TreeNode.prototype.setNullNodeType=function(b){this.nullnodetype=b};TreeNode.prototype.getNullNodeType=function(){return this.nullnodetype};TreeNode.prototype.addChild=function(d){var b=this.childs[this.childs.length-1];if(b){b.nextSibling=d;d.prevSibling=b}this.childs[this.childs.length]=d;d.setParent(this)};TreeNode.prototype.removeChild=function(d){var f=false;for(var b=0;b<this.childs.length;b++){if(f){this.childs[b]=this.childs[b+1]}if(this.childs[b]==d){if(b==(this.childs.length-1)){this.childs[b]=null}else{this.childs[b]=this.childs[b+1]}f=true}}if(f){this.childs.length=this.childs.length-1}};TreeNode.prototype.makeThisFirstChild=function(){var g=this.getParent();var h,b,f;if(g.hasChilds()&&g.childs[0]==this){return}else{h=this;h.prevSibling=null;f=this.nextSibling}for(var d=0;d<g.childs.length;d++){if(g.childs[d]==this){h.nextSibling=f;g.childs[d]=h;break}else{b=g.childs[d];g.childs[d]=h;h.nextSibling=b;b.prevSibling=h;h=b}}};TreeNode.prototype.getNodeElement=function(){return document.getElementById("title"+this.id)};TreeNode.prototype.resetChilds=function(){this.childs=new Array()};TreeNode.prototype.hasChilds=function(){return(this.childs.length>0)};TreeNode.prototype.getChildCount=function(){return this.childs.length};TreeNode.prototype.getFirstChild=function(){if(this.hasChilds()){return this.childs[0]}return null};TreeNode.prototype.getChildren=function(){return this.childs};TreeNode.prototype.setParent=function(b){this.parent=b};TreeNode.prototype.getParent=function(){return this.parent};TreeNode.prototype.getLineString=function(){return this.linestring};TreeNode.prototype.setLineString=function(b){this.linestring=b};TreeNode.getRootNode=function(d){var b=d.split("_");if(b.length>0){return TreeNodes[b[0]]}else{return null}};TreeNode.getTreeNode=function(d){var b=TreeNode.getRootNode(d);if(b==null){return null}return TreeNode.findNodeWithID(b,d)};TreeNode.findNodeWithID=function(d,g){if(g==null){return null}if(d.getID()==g){return d}else{if(d.hasChilds()){for(var b=0;b<d.getChildCount();b++){var f=TreeNode.findNodeWithID(d.childs[b],g);if(f!=null){return f}}}return null}};TreeNode.prototype.getState=function(){return TreeNode.getState(this.getID())};TreeNode.getState=function(f){var b=TreeNode.getRootNode(f);for(var d=0;d<b.statearray.length;d++){if(b.statearray[d]["key"]==f){state=b.statearray[d]["state"];if(state==null||state==""){state="closed"}return state}}return"closed"};TreeNode.writeStates=function(h,d){var b=TreeNode.getRootNode(h);var k="";var g=false;for(var f=0;f<b.statearray.length;f++){if(b.statearray[f]["key"]==h){b.statearray[f]["state"]=d;g=true}if(b.statearray[f]["state"]!=null){k+=b.statearray[f]["key"]+"|"+b.statearray[f]["state"]+";"}}if(g==false){b.statearray[b.statearray.length]=new Array();b.statearray[b.statearray.length-1]["key"]=h;b.statearray[b.statearray.length-1]["state"]=d;if(d!=null){k+=h+"|"+d+";"}}};var markup,imgOpenNoRootTags,imgOpenNoRootLastTags,imgOpenTags,imgOpenLastTags,imgLineTagsF,imgLineTagsE,imgWhiteTags,imgTTagsF,imgTTagsE,imgTNoRootTags,imgLastnodeTagsF,imgLastnodeTagsE;var imgTags;var TREEIMG_H=16;var TREEIMG_W=16;var IMGREF_ICO_REP="_imgref_ico_";TreeNode.showTree=function(f,d,h){TreeNode.href=h;var g='<img class="treeimgicon treeimgsize" alt="" src="'+TreeNode.href;var b='<img class="treeimgicon treeimgsize" alt="_imgref_ico_" src="'+TreeNode.href;imgTags=b+'images/twisty-right-blue.gif"';imgWhiteTags=g+'images/white.gif">';markup=[];if(f.hasChilds()){for(i=0;i<f.childs.length;i++){TreeNode.showNode(f,f.childs[i],(i==(f.childs.length-1)),i+1,f.childs.length,true)}}else{markup.push("<html></html>")}var k=markup.join("");d.innerHTML=k;f.loaded=true};TreeNode.prototype.isLoaded=function(){return this.loaded};TreeNode.prototype.scaleImgHW=function(d,o){var b={h:d,w:o};if(d<=TREEIMG_H&&o<=TREEIMG_W){return b}var g=d+0;var u=o+0;var h=TREEIMG_H/g;var s=TREEIMG_W/u;g=g*h;u=u*s;var f=Math.round(g);var k=Math.round(u);b.h=f;b.w=k;return b};TreeNode.prototype.whichAccMsgIcon=function(){var b=0;if(this.imgref!=null&&this.imgref.length>0){if(!this.disabled){b=0}else{b=2}}else{if(!this.disabled){b=1}else{b=3}}return b};TreeNode.showNode=function(rootNode,treeNode,lastNode,childNum,numSiblings,expandChildren){var tag="div";linestring=treeNode.linestring;markup.push("<");markup.push(tag);markup.push(' id="node');markup.push(treeNode.id);markup.push('"><nobr>');for(var y=0;y<linestring.length;y++){if(linestring.charAt(y)=="I"){markup.push(imgWhiteTags)}else{if(linestring.charAt(y)=="B"){markup.push(imgWhiteTags)}}}var imageTags=null;var imageAsLink=true;if(treeNode.hasChilds()){imageTags=imgTags;var imgalt="";imageTags=imageTags.replace(IMGREF_ICO_REP,imgalt)}else{imageTags=imgWhiteTags;imageAsLink=false}if(imageAsLink){markup.push('<a href="javascript:" class="btn treeimg" title="');var msgIdIcon=treeNode.whichAccMsgIcon();markup.push(treeNode.getMsg(msgIdIcon,eval(treeNode.getMsgArgS(msgIdIcon))));markup.push('" id="link');markup.push(treeNode.id);markup.push('">');markup.push(imageTags);markup.push(' id="handler');markup.push(treeNode.id);markup.push('">');markup.push("</a>")}else{markup.push(imageTags)}markup.push('<a href="javascript:"');if(!treeNode.hasChilds()){markup.push(treeNode.color)}if(treeNode.disabled){markup.push(' class="btn treetitledisabled')}else{markup.push(' class="btn treetitle')}if(treeNode.id.indexOf("0_-1")>0){markup.push(" treeroot")}markup.push('"');markup.push(' ID="title');markup.push(treeNode.id);markup.push('">');var imgref=treeNode.imgref;if(imgref!=null&&imgref.length>0){var hw=treeNode.scaleImgHW(treeNode.imgh,treeNode.imgw);imgref=imgref.replace("{0}",hw.h+"");imgref=imgref.replace("{1}",hw.w+"");markup.push(imgref)}markup.push(treeNode.name);markup.push("</a></nobr>");markup.push("</");markup.push(tag);markup.push(">");if(treeNode.hasChilds()){markup.push("<");markup.push(tag);markup.push(' id="node');markup.push(treeNode.id);markup.push('sub" style="display:');markup.push((TreeNode.showAllNodesOnStartup==true?"block;":"none;"));markup.push("visibility:");markup.push((TreeNode.showAllNodesOnStartup==true?'inherit;"':'hidden;"'));markup.push(">");var newChar="";if(!lastNode){newChar="I"}else{newChar="B"}var n=treeNode.childs.length;for(var z=0;z<n;z++){treeNode.childs[z].linestring=linestring+newChar}if(expandChildren){for(var z=0;z<n;z++){TreeNode.showNode(rootNode,treeNode.childs[z],(z==(n-1)),z+1,n,false)}treeNode.loaded=true}markup.push("</");markup.push(tag);markup.push(">")}else{markup.push("<");markup.push(tag);markup.push(' id="node');markup.push(treeNode.id);markup.push('sub" style="display:none;visibility:hidden;"></');markup.push(tag);markup.push(">")}};TreeNode.selectNodeByID=function(k){var h=TreeNode.getTreeNode(k);var d=TreeNode.getRootNode(k);if(h==null||d==null||!d.loaded){return}if(d.selectedNode!=null){if(d.selectedNode==k){return}var b=document.getElementById("title"+d.selectedNode);var s=TreeNode.getSelectedNode(d);var g="btn treetitle";if(s&&s.disabled){g="btn treetitledisabled"}if(b.id.indexOf("0_-1")>0){g+=" treeroot"}b.className=g;b.parentNode.parentNode.className="";if(b.previousSibling.tagName=="A"){b.previousSibling.className="btn treeimg"}}d.selectedNode=k;var o=document.getElementById("title"+d.selectedNode);var f="btn treetitleselectedfocused";if(h.disabled){f="btn treetitleselectedfocuseddisabled"}if(o.id.indexOf("0_-1")>0){f+=" treeroot"}o.className=f;o.parentNode.parentNode.className=f;if(o.previousSibling.tagName=="A"){o.previousSibling.className+=f}this.makeNodeVisible(h)};TreeNode.makeNodeVisible=function(d){var b=TreeNode.getRootNode(d.id);for(d=d.getParent();d!=b&&d!=null;d=d.getParent()){if(TreeNode.getState(d.id)=="closed"){TreeNode.handleNode(d.id)}}};TreeNode.handleNode=function(g,u){var k=TreeNode.getTreeNode(g);if(!k.hasChilds()){return}var b=document.getElementById("node"+g+"sub");if(!k.loaded){markup=[];var d=TreeNode.getRootNode(g);for(i=0;i<k.childs.length;i++){TreeNode.showNode(d,k.childs[i],(i==(k.childs.length-1)),i+1,k.childs.length,false)}b.innerHTML=markup.join("");k.loaded=true}var o=document.getElementById("handler"+g);var f=false;if(o.src.indexOf("_no_root")!=-1){f=true}if(b.style.display=="none"){TreeNode.writeStates(g,"open");if(typeof u!="undefined"){var h=u.IsInFlowLayout();if(h){var s=u.mObj.className;if(s.indexOf("treeflow")==-1){s+=" treeflow"}u.mObj.className=s}}b.style.display="block";b.style.visibility="inherit";o.src=TreeNode.href+"images/twisty-down-blue.gif"}else{TreeNode.writeStates(g,"closed");b.style.display="none";b.style.visibility="hidden";o.src=TreeNode.href+"images/twisty-right-blue.gif"}};TreeNode.expandNode=function(f,d){if(TreeNode.getState(f.id)=="closed"){TreeNode.handleNode(f.id)}if(d){for(var b=0;b<f.childs.length;b++){TreeNode.expandNode(f.childs[b],true)}}};TreeNode.expandAll=function(b){if(b!=null&&b.loaded){for(var d=0;d<b.childs.length;d++){TreeNode.expandNode(b.childs[d],true)}}};TreeNode.collapseNode=function(f,d){if(TreeNode.getState(f.id)=="open"){TreeNode.handleNode(f.id)}if(d){for(var b=0;b<f.childs.length;b++){TreeNode.collapseNode(f.childs[b],true)}}};TreeNode.collapseAll=function(b){if(b!=null&&b.loaded){for(var d=0;d<b.childs.length;d++){TreeNode.collapseNode(b.childs[d],true)}}};TreeNode.getSelectedNode=function(b){return TreeNode.findNodeWithID(b,b.selectedNode)};TreeNode.getSelectedNodeID=function(b){return b.selectedNode};TreeNode.getParentNode=function(d){var b=d;if(d.id.indexOf("title")==0){b=d.parentNode.parentNode}else{if(d.id.indexOf("handler")==0){b=d.parentNode.parentNode.parentNode}else{if(d.id.indexOf("timg")==0){b=d.parentNode.parentNode.parentNode}else{if(d.id.indexOf("link")==0){b=d.parentNode.parentNode.parentNode}else{if(d.id==""){b=d.parentNode.parentNode}}}}}return b};TreeNode.prototype.getNextSibling=function(){var d=this.getParent();if(d!=null){for(var b=0;b<d.childs.length;b++){if(d.childs[b]==this&&b+1<d.childs.length){return d.childs[b+1]}}}return null};TreeNode.prototype.changeLabel=function(b){var d=document.getElementById("title"+this.id);if(d){d.innerHTML=b}this.name=b};TreeNode.handleSingleClick=function(d,b){var f=d.id;if(f.indexOf("title")==0){TreeNode.selectNodeByID(f.substring(5))}else{if(f.indexOf("handler")==0){TreeNode.selectNodeByID(f.substring(7));TreeNode.handleNode(f.substring(7),b)}else{if(f.indexOf("link")==0){TreeNode.selectNodeByID(f.substring(4));TreeNode.handleNode(f.substring(4))}else{if(f.indexOf("timg")==0){TreeNode.selectNodeByID(f.substring(4));TreeNode.handleNode(f.substring(4))}else{if(f.indexOf("node")==0){TreeNode.selectNodeByID(f.substring(4))}else{if(f==""){TreeNode.selectNodeByID(TreeNode.getParentNode(d).id.substring(4))}else{return false}}}}}}return true};TreeNode.handleDoubleClick=function(b){var d=b.id;if(d.indexOf("title")==0){TreeNode.handleNode(d.substring(5))}else{if(d.indexOf("timg")==0){TreeNode.handleNode(d.substring(4))}}};TreeNode.prototype.ClearSelection=function(){if(this.selectedNode!=null){var b=document.getElementById("title"+this.selectedNode);var f=TreeNode.getTreeNode(this.selectedNode);var d="btn treetitle";if(f&&f.disabled){d="btn treetitledisabled"}if(b.id.indexOf("0_-1")>0){d+=" treeroot"}b.className=d;b.parentNode.parentNode.className="";if(b.previousSibling.tagName=="A"){b.previousSibling.className="btn treeimg"}}this.selectedNode=null};TreeNode.handleMouseOver=function(d){var b=TreeNode.getParentNode(d);if(b.id.indexOf("node")==-1){return false}if(b.className==""){b.className="btn treetitlerollover";b.firstChild.lastChild.className+=" treetitlerollover";if(b.firstChild.lastChild.previousSibling.tagName=="A"){b.firstChild.lastChild.previousSibling.className+=" treetitlerollover"}}else{if(b.className.indexOf("treetitleselectedfocused")!=-1){b.className+=" treetitleselectedrollover";b.firstChild.lastChild.className+=" treetitleselectedrollover";if(b.firstChild.lastChild.previousSibling.tagName=="A"){b.firstChild.lastChild.previousSibling.className+=" treetitleselectedrollover"}}}};TreeNode.handleMouseOut=function(d){var b=TreeNode.getParentNode(d);if(b.id.indexOf("node")==-1){return false}if(b.className.indexOf("treetitlerollover")!=-1){b.className="";b.firstChild.lastChild.className=b.firstChild.lastChild.className.replace(/treetitlerollover/g,"");b.firstChild.lastChild.className=b.firstChild.lastChild.className.replace(/\s+$/g,"");if(b.firstChild.lastChild.previousSibling.tagName=="A"){b.firstChild.lastChild.previousSibling.className=b.firstChild.lastChild.previousSibling.className.replace(/treetitlerollover/g,"");b.firstChild.lastChild.previousSibling.className=b.firstChild.lastChild.previousSibling.className.replace(/\s+$/g,"")}}else{if(b.className.indexOf("treetitleselectedrollover")!=-1){b.className=b.className.replace(/treetitleselectedrollover/g,"");b.className=b.className.replace(/\s+$/g,"");b.firstChild.lastChild.className=b.firstChild.lastChild.className.replace(/treetitleselectedrollover/g,"");b.firstChild.lastChild.className=b.firstChild.lastChild.className.replace(/\s+$/g,"");if(b.firstChild.lastChild.previousSibling.tagName=="A"){b.firstChild.lastChild.previousSibling.className=b.firstChild.lastChild.previousSibling.className.replace(/treetitleselectedrollover/g,"");b.firstChild.lastChild.previousSibling.className=b.firstChild.lastChild.previousSibling.className.replace(/\s+$/g,"")}}}};TreeNode.expandCurrentNode=function(d,f,g,b){var h=g.getState();if(h=="open"){if(g.hasChilds()){TreeNode.selectNodeByID(g.childs[0].getID())}}else{TreeNode.handleNode(g.id);TreeNode.selectNodeByID(g.id)}if(!b){return}try{var o=F(d,b.mParentField);while(o){if(o instanceof DPage&&o.mFillModel&&o.mState==1&&o.mFit){o.getChildScroll(b)}o=o.GetParent()}}catch(k){}};TreeNode.collapseCurrentNode=function(b,d){var g=d.getState();if(g=="closed"){var f=d.getParent();if(f!=null&&f!=b){TreeNode.selectNodeByID(f.getID())}}else{TreeNode.handleNode(d.id);TreeNode.selectNodeByID(d.id)}};TreeNode.selectPrevNode=function(b,d){if(d.prevSibling!=null){var f=TreeNode.getState(d.prevSibling.getID());if(f=="open"&&d.prevSibling.hasChilds()){var g=d.prevSibling.childs[d.prevSibling.childs.length-1];var h="open";while(g.hasChilds()&&(TreeNode.getState(g.getID())=="open")){g=g.childs[g.childs.length-1]}TreeNode.selectNodeByID(g.getID())}else{TreeNode.selectNodeByID(d.prevSibling.getID())}}else{if(d.getParent()!=null&&d.getParent()!=b){TreeNode.selectNodeByID(d.getParent().getID())}}};TreeNode.selectNextNode=function(b,d){var g=d.getState();if(g=="open"&&d.hasChilds()){TreeNode.selectNodeByID(d.childs[0].getID())}else{if(d.nextSibling!=null){TreeNode.selectNodeByID(d.nextSibling.getID())}else{var f=d;while((f=f.getParent())!=b){if(f.nextSibling!=null){TreeNode.selectNodeByID(f.nextSibling.getID());break}}}}};TreeNode.SetFocusToSelectedNode=function(d){var b=document.getElementById("title"+d.selectedNode);if(b!=null){d.focusTimer=setTimeout(function(){try{b.focus()}catch(f){}},10)}};TreeNode.ClearFocusTimer=function(b){if(b.focusTimer!=null){clearTimeout(b.focusTimer);b.focusTimer=null}};TreeNode.prototype.SetFocus=function(){var b=document.getElementById("title"+this.id);if(b!=null){setTimeout(function(){b.focus()},10)}};var gMenuMessages=new Object();gMenuMessages[0]=getLocalizedMessage("Sub Menu {0} Closed");gMenuMessages[2]=getLocalizedMessage("Sub Menu {0} Closed Disabled");gMenuMessages[1]=getLocalizedMessage("Sub Menu {0} Closed");gMenuMessages[3]=getLocalizedMessage("Sub Menu {0} Closed Disabled");gMenuMessages[4]=getLocalizedMessage("Sub Menu {0} Closed");gMenuMessages[6]=getLocalizedMessage("Sub Menu {0} Closed Disabled");gMenuMessages[5]=getLocalizedMessage("Sub Menu {0} Closed");gMenuMessages[7]=getLocalizedMessage("Sub Menu {0} Closed Disabled");gMenuMessages[8]=getLocalizedMessage("{0}");gMenuMessages[10]=getLocalizedMessage("{0} Disabled");gMenuMessages[9]=getLocalizedMessage("{0}");gMenuMessages[11]=getLocalizedMessage("{0} Disabled");gMenuMessages[12]=getLocalizedMessage("{0}");gMenuMessages[13]=getLocalizedMessage("{0} Disabled");gMenuMessages[14]=getLocalizedMessage("");gMenuMessages[15]=getLocalizedMessage("Closed");gMenuMessages[16]=getLocalizedMessage("Opened");var gMenuMsgArgs=new Object();gMenuMsgArgs[0]="[treeNode.name]";gMenuMsgArgs[1]="[treeNode.name]";gMenuMsgArgs[2]="[treeNode.name]";gMenuMsgArgs[3]="[treeNode.name]";gMenuMsgArgs[4]="[treeNode.name]";gMenuMsgArgs[5]="[treeNode.name]";gMenuMsgArgs[6]="[treeNode.name]";gMenuMsgArgs[7]="[treeNode.name]";gMenuMsgArgs[8]="[treeNode.name]";gMenuMsgArgs[9]="[treeNode.name]";gMenuMsgArgs[10]="[treeNode.name]";gMenuMsgArgs[11]="[treeNode.name]";gMenuMsgArgs[12]="[nodetitle.title]";gMenuMsgArgs[13]="[nodetitle.title]";gMenuMsgArgs[14]="[]";gMenuMsgArgs[15]="[]";gMenuMsgArgs[16]="[]";MenuNode.prototype=new TreeNode();MenuNode.prototype.constructor=MenuNode;MenuNode.superclass=TreeNode.prototype;function MenuNode(o,d,k,b,g,f,h){if(arguments.length){this.init(o,d,k,b,g,f,h)}}MenuNode.prototype.init=function(o,d,k,b,g,f,h){MenuNode.superclass.init.call(this,o,d,k,b,g,f);this.mtReturnValue=h};MenuNode.HandleBoxPopupKeyEvents=function(g,b,o){var h,d;if(b){h=b.target||b.srcElement;d=b.keyCode}else{return false}var s=TreeNode.getSelectedNodeID(g);var f;if(h!=null&&h.id!=null){f=TreeNode.getTreeNode(h.id.replace("title",""));if(f==null){return}}if(d==37){TreeNode.collapseCurrentNode(g,f)}else{if(d==38){TreeNode.selectPrevNode(g,f)}else{if(d==39){TreeNode.expandCurrentNode(getCurrentWindowID_NS(),g,f,this)}else{if(d==40){TreeNode.selectNextNode(g,f)}else{if(d==32){TreeNode.selectNodeByID(f.getID())}else{if(d==13){TreeNode.selectNodeByID(f.getID());if(!f.hasChilds()){o.close=true}}else{if(d==9){return true}else{return}}}}}}}var k=TreeNode.getSelectedNodeID(g);if(s!=k){var u=TreeNode.getSelectedNode(g);TreeNode.SetFocusToSelectedNode(g)}};JAttachment.prototype=new Field();JAttachment.prototype.constructor=JAttachment;JAttachment.superclass=Field.prototype;function JAttachment(g,f,d){if(arguments.length){this.init(g,f,d)}}JAttachment.prototype.init=function(g,f,d){JAttachment.superclass.init.call(this,g,f,d)};JAttachment.prototype.G=function(){return this.mObj.v};JAttachment.prototype.DoSet=JAttachment.prototype.DoSLoadEntry=function(d){if(d instanceof AttachmentType){if(this.mObj.msz&&(d.mOrigSize>this.mObj.msz)){var b=getLocalizedMessage(9210,[this.mObj.msz]);throw new WorkflowException(this.windowID,0,[{t:2,n:9210,m:b,a:null}])}this.mObj.v=d}else{if(d instanceof CharType){}else{this.mObj.v=Null}}this.updateDisplay();this.SetDirty()};JAttachment.prototype.mHaveStoredData=true;JAttachment.fileDOSPathParser=/[A-Za-z]:(\\([^\\]+))+$/;JAttachment.fileUnixPathParser=/(\/([^\/]+))+$/;JAttachment.fileNetworkPathParser=/\\(\\([^\\]+))+$/;JAttachment.prototype.updateDisplay=function(){if(!this.mObj.hdn){var d=getFields_NS(this.windowID)[this.mObj.pnt];var h;var b;if(this.mObj.v.isNull){h=b=""}else{h=this.mObj.v.mFileName;var f=h.match(JAttachment.fileDOSPathParser);if(f){h=f[2]}f=h.match(JAttachment.fileUnixPathParser);if(f){h=f[2]}f=h.match(JAttachment.fileNetworkPathParser);if(f){h=f[2]}b=parseInt(this.mObj.v.mOrigSize);if(b>0){var g=b>>10;if(b&1023){g++}b=g}b+=" KB"}d.LoadRowContents(this.mID,h,b)}};JAttachment.prototype.Clear=function(b){var d=this.mID;if((d>=1000000&&d<=1999999)||(d>=3000000&&d<=3999999)||d==1576||d==1575){return}this.mObj.v=Null;this.updateDisplay();this.SetDirty()};JAttachment.prototype.setFromAddPopup=function(d,b){this.mFromAddValue=b};JAttachment.SUCCESS=new IntegerType(0);JAttachment.CANCELLED=new IntegerType(1);JAttachment.FAILED=new IntegerType(2);JAttachment.prototype.Add=function(b){if(typeof b=="undefined"){b={}}if(this.mObj.v.isNull){return this.AddP1(b)}else{var d={};var f=getLocalizedMessage("Would you like to replace {0} with new file?",null,"Attachment").replaceArgs(this.mObj.v.mFileName);return{c:{f:ConfirmPopup,a:[this.windowID,f,d,4|8]},n:{t:this,f:function(){if(("v" in d.result)&&d.result.v==1){return this.AddP1(b)}}}}}};JAttachment.prototype.AddP1=function(b){var h=new Array();var g=AttachmentType.getKeyForCurrentField(this.mID,this.windowID);var k=0;if(this.mObj&&this.mObj.msz){k=this.mObj.msz}var f=this.GLabel();h.push({akey:g,max:k,alabel:f,afid:this.mID});var d=AttachmentPopup(this.windowID,b,"PopupSF",getLocalizedMessage("File Name",null,"Attachment"),h);this.mFromAddValue=null;return{i:1,n:{t:this,f:this.AddP2,a:[b]}}};JAttachment.prototype.AddP2=function(b){var d=b.result;var g=0;if(d.v!=-1&&d instanceof Object){for(var f in d){this.setFromAddPopup(d[f].id,new AttachmentType(d[f].v+""));if(this.mFromAddValue!=null){this.AddP3(b);g++}}if(g==0){b.result=JAttachment.CANCELLED}}else{b.result=JAttachment.FAILED}};JAttachment.prototype.AddP3=function(b){this.mObj.v=this.mFromAddValue;this.updateDisplay();if(!("mDCF" in this)){this.mDCF=(this.mObj&&"dcf" in this.mObj)?(this.mObj.dcf==1):false}this.SetDirty();this.mFromAddValue=null;if(b){b.result=JAttachment.SUCCESS}};JAttachment.prototype.Delete=function(b){if(!this.mObj.v.isNull){this.mObj.v=Null;this.updateDisplay();this.SetDirty();if(b){b.result=JAttachment.SUCCESS}}else{if(b){b.result=JAttachment.FAILED}}};JAttachment.displayHTML='<html><head><title>{0}</title></head><body onload=document.forms["ARDF12"].submit()><FORM name=ARDF12 id=ARDF12 method="GET" enctype="application/x-www-form-urlencoded" accept-charset="UTF-8" action="{1}"><input type=hidden name="{2}" value="{3}"/></FORM></body></html>';JAttachment.prototype.Display=function(b){var g=true;if(!this.mObj.v.isNull){switch(parseInt(AttachmentDisplayFilter)){case 0:break;case 1:if(!isextensionmatch(this.mObj.v.mFileName,AttachmentDisplayList)){g=false}break;case 2:if(isextensionmatch(this.mObj.v.mFileName,AttachmentDisplayList)){g=false}break;case 3:g=false;break}if(g==true){var k=getLocalizedMessage("Display Attachment",null,"Attachment");var f=window.open((AbsContextPath+"resources/html/Blank.html"),"_blank","toolbar=no,location=no,resizable=yes,scrollbars=yes,title="+k);WorkflowContext.WindowOpened(this.windowID);f.document.open("text/html");var d=JAttachment.getAttachServletURL()+"/"+new Date().getTime();var h=JAttachment.getURLParams("1",this.mObj.v.mDataKey);f.document.write(JAttachment.displayHTML.replaceArgs(k,d,"ATTKey",h));f.document.close();if(b){b.result=JAttachment.SUCCESS}}else{throw new WorkflowException(this.windowID,0,[{t:3,n:9513,m:null,a:null}])}}else{if(b){b.result=JAttachment.FAILED}}};JAttachment.getURL=function(b){return"{0}?{1}={2}".replaceArgs(JAttachment.getAttachServletURL(),"ATTKey",JAttachment.getURLParams("1",b))};JAttachment.getURLParams=function(h,f,d){if(d){}if(d){var g=d;var b=d.length;g=g.HTMLEncode();return"{0}/{1}{2}/{3}{4}/{5}".replaceArgs(h.length,h,f.length,f,b,g)}else{return"{0}/{1}{2}/{3}".replaceArgs(h.length,h,f.length,f)}};JAttachment.saveHTML='<FORM method="POST" action="{0}" enctype="application/x-www-form-urlencoded" accept-charset="UTF-8" target="{1}"><input type=hidden name="{2}" value="{3}"/></FORM>';JAttachment.prototype.SaveToDisk=function(b,d){if(!this.mObj.v.isNull){var o=window.document.createElement("DIV");o.style.top="0px";o.style.left="0px";o.style.zIndex=100001;o.style.position="absolute";o.style.display="none";window.document.body.appendChild(o);var f=JAttachment.getAttachServletURL();var k=JAttachment.getSaveFrameTarget(this.mID);var g=JAttachment.getURLParams("2",this.mObj.v.mDataKey,d);var s=JAttachment.saveHTML.replaceArgs(f,k,"ATTKey",g);o.innerHTML=s;var h=o.firstChild;h.submit();window.document.body.removeChild(o);if(b){b.result=JAttachment.SUCCESS}}else{if(b){b.result=JAttachment.FAILED}}};JAttachment.ATTACH_SERVLET=null;JAttachment.getAttachServletURL=function(){if(JAttachment.ATTACH_SERVLET==null){JAttachment.ATTACH_SERVLET=(AbsContextPath+"servlet/AttachServlet")}return JAttachment.ATTACH_SERVLET};JAttachment.getSaveFrameTarget=function(d){var b="SaveToDiskIFrame"+d;if(window.frames[b]==null){JAttachment.saveFrame=window.document.createElement("div");JAttachment.saveFrame.innerHTML='<IFRAME name="{0}" onload=JAttachment.saveFrameLoaded(fid) src="javascript:&quot;&lt;HTML&gt;&lt;/HTML&gt;&quot;"></IFRAME>'.replaceArgs(b);JAttachment.saveFrame.style.display="none";JAttachment.saveFrame.style.top=JAttachment.saveFrame.style.left="0px";JAttachment.saveFrame.style.bottom=JAttachment.saveFrame.style.right="1px";window.document.body.appendChild(JAttachment.saveFrame)}return b};JAttachment.saveFrameLoaded=function(h){var g=window.frames[JAttachment.getSaveFrameTarget(h)];try{if(g.document&&g.document.body){if(g.document.location.href!="about:blank"){var d=g.window.Msg;if(!d){d=getLocalizedMessage("Failed to perform action")}ShowAlertPopup(d,getLocalizedMessage("Save Error"))}}}catch(b){var f=WorkflowContext_StatusToString(b);ShowAlertPopup(f,getLocalizedMessage("Save Error"))}};DAttachmentPool.prototype=new SimpleTable();DAttachmentPool.prototype.constructor=DAttachmentPool;DAttachmentPool.superclass=SimpleTable.prototype;DAttachmentPool.prototype.mHaveStoredData=false;DAttachmentPool.prototype.MouseSelectable=false;DAttachmentPool.prototype.mSortImgs=null;DOMFieldFactories.AttachmentPool=function(b,f,d){return new DAttachmentPool(b,f,d)};function DAttachmentPool(g,f,d){if(arguments.length){this.init(g,f,d)}}DAttachmentPool.prototype.init=function(d,o,k){DAttachmentPool.superclass.init.call(this,d,o,k,2,false,this.InitData(k),this.InitButton(k));this.mAsyncResizePending=null;this.mHasChildFields=true;var h=this.getHoverEvtList();var g=false;var b=null;for(var f=0;f<h.length;f++){idx=f;b=AREventFunction(this.windowID,h[f],this.mID);if(b!=null){g=true;break}}if(!g){g=this.hoverEvtonChildren()}this.mHasHoverEvt=g;getAttachPoolFields_NS(this.windowID).push(this)};DAttachmentPool.prototype.InitData=function(n){var args={};var arColWidth=parseInt(n.getAttribute("arcolw"));args.h=[n.getAttribute("arcol0"),n.getAttribute("arcol1"),n.getAttribute("arcol2")];args.w=[arColWidth,arColWidth,arColWidth];args.colgradcol=n.getAttribute("arcolgradcol");args.colgradbkgcol=n.getAttribute("arcolgradbkgcol");args.colgradtype=n.getAttribute("arcolgradtype");args.colhdrtxtcol=n.getAttribute("arcolhdrtxtcol");if(args.colgradcol==null&&args.colgradbkgcol!=null){args.colgradcol=args.colgradbkgcol}this.mIdRowMap={};this.mRowIdMap={};args.r=[];var arRows=eval(n.getAttribute("arrows"));for(var i=0;i<arRows.length;++i){var row=[];var attLabel=(arRows[i].l==null||arRows[i].l=="")?"&nbsp;":arRows[i].l;row.d=[{v:"&nbsp;"},{v:"&nbsp;"},{v:attLabel}];args.r.push(row);this.mIdRowMap[arRows[i].f]=row;this.mRowIdMap[i]=arRows[i].f}return args};DAttachmentPool.prototype.getHoverEvtList=function(){return[16777216]};DAttachmentPool.prototype.hoverEvtonChildren=function(){var f=false;for(var d=0;d<this.mRowsPresent;d++){var b=AREventFunction(this.windowID,16777216,this.mRowIdMap[d]);if(b!=null){f=true;break}}return f};DAttachmentPool.prototype.GetValidRow=function(){if(this.mRowsPresent>0){for(var b=0;b<this.mRowsPresent;++b){var d=this.mResult.r[b];if(d&&d.d[0].v!=""){return b}}}return -1};DAttachmentPool.prototype.GetEmptyRow=function(){if(this.mRowsPresent>0){for(var b=0;b<this.mRowsPresent;++b){var d=this.mResult.r[b];if(d&&d.d[0].v==""){return b}}}return -1};DAttachmentPool.prototype.GetEmptyRowIds=function(){var b=[];if(this.mRowsPresent>0){var g;for(var d=0;d<this.mRowsPresent;++d){var f=this.mResult.r[d];if(f&&f.d[0].v==""){g=this.mRowIdMap[d];b.push(g)}}}return b};DAttachmentPool.prototype.getChildField=function(f){var d=f;while(f.nodeType!=1||(f.tagName!="DIV"&&f.tagName!="TR")){f=f.parentNode}if(f.tagName=="TR"){var b=this.MapUIXY(d);if(b==null){return null}var g=b.y;var h=this.mRowIdMap[this.RowNoFromTag(g)];return h}return null};DAttachmentPool.prototype.isChild=function(f){var d=false;for(var b=0;b<this.mRowsPresent;b++){if(this.mRowIdMap[b]==f){d=true;break}}return d};DAttachmentPool.prototype.getIdInScroll=function(k){if(k.element.className=="BaseTableInner"){var h=k.element;var o=h.firstChild;var v=o.rows;var f=v.length;posy=k.oy;var s=0;var b=0;for(var d=0;d<f;d++){b=s+v[d].clientHeight;if(posy>=s&&posy<=b){var u=v[d].getAttribute("arrow");u=parseInt(u);var g=this.mRowIdMap[this.RowNoFromTag(u)];return g}s=b}}return null};DAttachmentPool.prototype.GetHoverValue=function(d){var b=null;if(d.element.className=="BaseTableInner"){b=this.getIdInScroll(d)}else{b=this.getChildField(d.element)}if(b==null){return""}var f=this.mIdRowMap[b];return f.d[0].v};DAttachmentPool.prototype.setFromAddPopup=function(d,b){this.mFromAddID=d;this.mFromAddValue=b};DAttachmentPool.prototype.Delete=function(b){var f=this.GetValidRow();if(f>-1){var d=this.mRowIdMap[f];F(this.windowID,d).Delete(b)}else{if(b){b.result=JAttachment.FAILED}}};DAttachmentPool.prototype.UIDelete=function(){if(this.mPrimaryRowSelection!=null){var b=this.mRowIdMap[this.RowNoFromTag(this.mPrimaryRowSelection)];F(this.windowID,b).Delete()}else{}};DAttachmentPool.prototype.Display=function(b){var f=this.GetValidRow();if(f>-1){var d=this.mRowIdMap[f];F(this.windowID,d).Display(b)}else{if(b){b.result=JAttachment.FAILED}}};DAttachmentPool.prototype.UIDisplay=function(){if(this.mPrimaryRowSelection!=null){var b=this.mRowIdMap[this.RowNoFromTag(this.mPrimaryRowSelection)];F(this.windowID,b).Display()}else{}};DAttachmentPool.prototype.SaveToDisk=function(b){var f=this.GetValidRow();if(f>-1){var d=this.mRowIdMap[f];F(this.windowID,d).SaveToDisk(b)}else{if(b){b.result=JAttachment.FAILED}}};DAttachmentPool.prototype.UISaveToDisk=function(){if(this.mPrimaryRowSelection!=null){var b=this.mRowIdMap[this.RowNoFromTag(this.mPrimaryRowSelection)];F(this.windowID,b).SaveToDisk()}else{}};DAttachmentPool.prototype.UIDeselect=function(){this.ClearSelections(true);this.ApplyData()};DAttachmentPool.prototype.ApplyData=function(){DAttachmentPool.superclass.ApplyData.call(this);this.UpdateBtnVis()};DAttachmentPool.prototype.ResizeTo=function(f,b){var d=Math.round(b*(this.perHeight/100));var g=f;if(g<this.mMinWidth){g=this.mMinWidth}else{if(g>this.mMaxWidth){g=this.mMaxWidth}}if(d<this.mMinHeight){d=this.mMinHeight}else{if(d>this.mMaxHeight){d=this.mMaxHeight}}if(this.mAsyncMode){this.mAsyncResizePending={w:g,h:d};this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty)}else{this.Resize(g,d)}};DAttachmentPool.prototype.LoadRowContents=function(f,g,b){var d=this.mIdRowMap[f];d.d[0]={v:g.HTMLEncode()};d.d[1]={v:b};this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty);if(getCurWFC_NS(this.windowID)==null){new WorkflowContext(this.windowID,[])}};DAttachmentPool.prototype.FlushAsyncQueue=function(){var b=0;if(!this.mAsyncDirty){return}if(this.mAsyncResizePending){this.Resize(this.mAsyncResizePending.w,this.mAsyncResizePending.h)}this.mAsyncResizePending=null;this.ApplyData();b=this.getScrollheight();if(b>0){var d=F(this.windowID,this.mContainerID);while(d){if(d instanceof DPage&&d.mFillModel&&d.mState==1){d.setDirty(b)}d=d.GetParent()}}};DAttachmentPool.prototype.ARDrillDown=function(b,d){if(this.mBtnDisplay&&this.mBtnDisplay.node.GetAccess()==false){this.UIDisplay()}};DAttachmentPool.prototype.SetRowSortOrder=function(f,d,g,b){};DAttachmentPool.prototype.Clear=function(){this.ClearSelections(true);for(var b=0;b<this.mRowsPresent;++b){var d=this.mResult.r[b];if(d){d.d[0].v="";d.d[1].v=""}}this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty)};DAttachmentPool.prototype.SetAsyncDirty=function(){this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty)};function DAttachmentPool_DoEntryChange(d,b){var g=getAttachPoolFields_NS(d);for(var f=0;f<g.length;++f){if(b){g[f].ClearSelections(true)}g[f].SetAsyncDirty()}}DAttachmentPool.prototype.hasContextMenu=true;DAttachmentPool.prototype.DOMContextMenu=function(b){if((getARStateCurrent_NS(this.windowID)==4)){return}Menu_Close();var d=new AttachmentContextMenu(this);var f={x:b.ox,y:b.oy};return{n:{f:d.Open,t:d,a:[b.element,4,f]}}};DAttachmentPool.prototype.getScrollheight=function(){var b=0;var d=this.mParent.firstChild.childNodes[1];if(d.scrollHeight>d.offsetHeight){b=d.scrollHeight-d.offsetHeight}return b};DAttachmentPool.prototype.GetUsedRowIds=function(){var b=[];if(this.mRowsPresent>0){var g;for(var d=0;d<this.mRowsPresent;++d){var f=this.mResult.r[d];if(f&&f.d[0].v!=""){g=this.mRowIdMap[d];b.push(g)}}}return b};DAttachmentPool.prototype.UpdateVis=function(d){var b=(this.mObj.style.visibility!="hidden");if(!b&&d){this.mObj.style.visibility="inherit";this.SetAsync(-1)}else{if(b&&!d){this.mObj.style.visibility="hidden";this.SetAsync(1)}}};DAttachmentPool.prototype.SetBtnAccess=function(b){if(this.mBtnAdd){this.mBtnAdd.node.SetAccess(b)}if(this.mBtnDelete){this.mBtnDelete.node.SetVisibility(b)}if(this.mBtnDisplay){this.mBtnDisplay.node.SetVisibility(b)}if(this.mBtnSave){this.mBtnSave.node.SetVisibility(b)}if(this.mBtnDeselect){this.mBtnDeselect.node.SetVisibility(b)}};DAttachmentPool.prototype.ARRowSelected=DAttachmentPool.prototype.ARRowCleared=DAttachmentPool.prototype.UpdateBtnVis=function(){if((getARStateCurrent_NS(this.windowID)==4)){this.SetBtnAccess(false)}else{var d=(this.mPrimaryRowSelection==null?-1:this.RowNoFromTag(this.mPrimaryRowSelection));if(d!=-1){var b=this.mResult.r[d];if(b&&b.d[0].v!=""){this.SetBtnAccess(true);switch(parseInt(AttachmentDisplayFilter)){case 0:break;case 1:if(!isextensionmatch(b.d[0].v,AttachmentDisplayList)){if(this.mBtnDisplay){this.mBtnDisplay.node.SetAccess(false);this.mBtnDisplay.node.mObj.title="You cannot display an attachment with this extension"}}else{if(this.mBtnDisplay){this.mBtnDisplay.node.SetAccess(true)}this.mBtnDisplay.node.mObj.title=""}break;case 2:if(isextensionmatch(b.d[0].v,AttachmentDisplayList)){if(this.mBtnDisplay){this.mBtnDisplay.node.SetAccess(false);this.mBtnDisplay.node.mObj.title="You cannot display an attachment with this extension"}}else{if(this.mBtnDisplay){this.mBtnDisplay.node.SetAccess(true)}this.mBtnDisplay.node.mObj.title=""}break;case 3:if(this.mBtnDisplay){this.mBtnDisplay.node.SetAccess(false);this.mBtnDisplay.node.mObj.title="You cannot display an attachment with this extension"}break}if((getARStateCurrent_NS(this.windowID)==1)){if(this.mBtnSave){this.mBtnSave.node.SetVisibility(false)}}if((getARStateCurrent_NS(this.windowID)==3)){if(this.mBtnAdd){this.mBtnAdd.node.SetAccess(false)}if(this.mBtnDelete){this.mBtnDelete.node.SetVisibility(false)}}return}}if(d!=-1||this.GetEmptyRow()!=-1){this.SetBtnAccess(false);if(!(getARStateCurrent_NS(this.windowID)==3)){if(this.mBtnAdd){this.mBtnAdd.node.SetAccess(true)}}if(d!=-1){if(this.mBtnDeselect){this.mBtnDeselect.node.SetVisibility(true)}}return}this.SetBtnAccess(false);if(this.mARRowSelection!=0){if(this.mBtnDeselect){this.mBtnDeselect.node.SetVisibility(true)}}}};DAttachmentPool.prototype.InitButton=function(f){var d=[];var b;b=f.getAttribute("aradd");if(b!=null){this.mBtnAdd={name:b,loc:0,bar:1,func:this.Add};d.push(this.mBtnAdd)}b=f.getAttribute("ardelete");if(b!=null){this.mBtnDelete={name:b,loc:0,bar:1,func:this.UIDelete};d.push(this.mBtnDelete)}b=f.getAttribute("ardisplay");if(b!=null){this.mBtnDisplay={name:b,loc:0,bar:1,func:this.UIDisplay};d.push(this.mBtnDisplay)}b=f.getAttribute("arsave");if(b!=null){this.mBtnSave={name:b,loc:0,bar:1,func:this.UISaveToDisk};d.push(this.mBtnSave)}b=f.getAttribute("ardeselect");if(b!=null){this.mBtnDeselect={name:b,loc:0,bar:1,func:this.UIDeselect};d.push(this.mBtnDeselect)}return d};DAttachmentPool.prototype.DOMFocus=function(d){var b=[];if(d.element!=null){var f=-1;if(this.mPrimaryRowSelection!=null){f=this.mPrimaryRowSelection}f=(f<0&&d.element.className.indexOf("Add")<0?0:f);f=(f>=this.mRowsPresent?this.mRowsPresent-1:f);b.push({t:this,f:DAttachmentPool.superclass.DOMFocus,a:[d]});if(f>-1){b.push({t:this,f:this.ApplySelections,a:[true,false]});b.push({t:this,f:this.SetPrimarySelection,a:[f,true,true,true]})}return{n:b}}return DAttachmentPool.superclass.DOMFocus.call(this,d)};DAttachmentPool.prototype.DOMMouseDown=function(f){if(this.GAccess()==3){return}var g=f.element;while(g.nodeType!=1||(g.tagName!="DIV"&&g.tagName!="TR")){g=g.parentNode}if(g.tagName=="TR"){var d=[];var b=this.MapUIXY(f.element);if(b==null){return}var h=b.y;this.mCurrentCol=b.x;if(this.mPrimaryRowSelection==null||h!=this.RowNoFromTag(this.mPrimaryRowSelection)){d.push({t:this,f:this.ApplySelections,a:[true,false]});d.push({f:this.SetPrimarySelection,t:this,a:[h,true,true,true]})}new WorkflowContext(this.windowID,d)}};DAttachmentPool.prototype.Add=function(v){if(this.mPrimaryRowSelection!=null){var d=this.mRowIdMap[this.RowNoFromTag(this.mPrimaryRowSelection)];if(typeof v=="undefined"){v={}}return F(this.windowID,d).Add(v)}else{var b=[];b=this.GetEmptyRowIds();if(b.length>0){if(typeof v=="undefined"){v={}}var o=new Array();for(var u=0;u<b.length;u++){var s=AttachmentType.getKeyForCurrentField(b[u],this.windowID);var f=F(this.windowID,b[u]);var k=(f.mObj.msz)?f.mObj.msz:0;var h=f.GLabel();o.push({akey:s,msz:k,alabel:h,afid:b[u]})}var g=AttachmentPopup(this.windowID,v,"PopupSF",getLocalizedMessage("File Name",null,"Attachment"),o);this.mFromAddID=null;this.mFromAddValue=null;return{i:1,n:{t:this,f:this.AddP2,a:[v]}}}else{if(v){v.result=JAttachment.FAILED}}}};DAttachmentPool.prototype.AddP2=function(b){var d=b.result;if(d.v!=-1&&d instanceof Object){var h=0;for(var g in d){this.setFromAddPopup(d[g].id,new AttachmentType(d[g].v+""));if(this.mFromAddID!=null&&this.mFromAddValue!=null){var f=F(this.windowID,this.mFromAddID);f.S(this.mFromAddValue);this.mFromAddID=this.mFromAddValue=null;h++}}b.result=(h>0)?JAttachment.SUCCESS:JAttachment.FAILED}else{b.result=JAttachment.FAILED}};Template.prototype.constructor=Template;function Template(f,d,g,b){if(arguments.length){this.init(f,d,g,b)}}Template.prototype.init=function(g,d,h,b){this.mName=g;this.mMarkUp=d;if(this.mName==null){this.mName=""}if(this.mMarkUp==null){this.mMarkUp=""}this.mProcessedMarkup=this.mMarkUp;this.mParameters=h;this.mFields=b;this.mParams={};this.finalScript=[];this.mParamsRE={};this.mFieldsRE={};for(i in h){this.mParams[h[i]]="";this.mParamsRE[h[i]]=new RegExp("\\$\\{"+h[i]+"\\}","g")}for(var f in this.mFields){this.mFieldsRE[b[f]]=new RegExp("\\$"+b[f]+"\\$","g");this.finalScript.push('this.replaceField("'+b[f]+'", (F(getCurrentWindowID_NS(),'+b[f]+") != null)?F(getCurrentWindowID_NS(),"+b[f]+').G():"");')}getTemplates_NS()[g]=this;this.compileTemplate()};Template.prototype.setDefaultParamValues=function(){for(var b in this.mParameters){this.mParams[this.mParameters[b]]=""}};Template.prototype.replaceParams=function(){for(var b in this.mParams){if(b==null){continue}this.mProcessedMarkup=this.mProcessedMarkup.replace(this.mParamsRE[b],this.mParams[b])}};Template.prototype.replaceField=function(d,b){if(b instanceof Datatype){b=b.toString()}if(b==null){b=""}else{b=b.replace(/\$/g,"$$$$")}this.mProcessedMarkup=this.mProcessedMarkup.replace(this.mFieldsRE[d],b)};Template.prototype.S=function(d,b){this.mParams[d]=b};Template.prototype.SF=function(b,d){this.mFields[b]=d};Template.prototype.getValue=function(){return this.mProcessedMarkup};Template.prototype.compileTemplate=function(){var funcStr=this.finalScript.join("");eval("this.processFieldData=function(){"+funcStr+"}")};Template.prototype.process=function(windowID){this.mProcessedMarkup=this.mMarkUp;this.replaceParams();if(arguments.length==3){var fields=arguments[1];var values=arguments[2];for(var i in fields){this.replaceField(fields[i],values[i])}var statements=[];var found=false;for(var fld in this.mFieldsRE){for(var num in fields){if(fields[num]==fld){found=true;break}}if(found==false){statements.push('this.replaceField("'+fld+'", (F('+windowID+","+fld+") != null)?F("+windowID+","+fld+').G():"");')}found=false}if(statements.length>0){eval(statements.join(""))}}else{if(this.processFieldData){this.processFieldData()}}return this.getValue()};var DummyTemplate=new Template("","",[],[]);function T(b,d){if(d==null){d=""}var g=(d in getTemplates_NS())?getTemplates_NS()[d]:null;if(g==null){var h=getFormDataHolderById(b).cacheid;var f=new NDXGetARTemplate(b,ARKWGetStringByIdx(b,7),d,RelContextPath,h,ARKWGetStringByIdx(b,6),ARKWGetStringByIdx(b,17));if(f&&("result" in f)){g=f.result}if(!g){g=DummyTemplate}}return g}function AttachmentPopup(f,A,k,u,v){var o=1|2;var s=getLocalizedMessage("Add Attachment");var g=getLocalizedMessage("Status");var y="../../servlet/AttachServlet";var z=175;if(v.length>1){z+=(v.length-1)*20}var d=400;var b=v[0].alabel.length;for(var h=1;h<v.length;h++){if(v[h].alabel.length>b){b=v[h].alabel.length}}if(b>20){d+=(b-20)*10}var w="resources/html/AttachmentPopup.html";return weOpenModalPopup(f,(AbsContextPath+w),"Attachment",{title:s,target:k,servlet:y,aInfo:v,btn:o,appss:GetAppStyleSheet("../../"),input:u,statusLabel:g,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(f,7),schema:ARKWGetStringByIdx(f,6),view:ARKWGetStringByIdx(f,17),cacheid:getFormDataHolderById(f).cacheid},A,[d,z])}DTime.prototype=new DataField();DTime.prototype.constructor=DTime;DTime.superclass=DataField.prototype;JTime.prototype=new Field();JTime.prototype.constructor=JTime;JTime.superclass=Field.prototype;TPATime.prototype=new Field();TPATime.prototype.constructor=TPATime;TPATime.superclass=Field.prototype;DOMFieldFactories.Time=function(b,f,d){return new DTime(b,f,d)};function DTime(g,f,d){if(arguments.length){this.init(g,f,d)}}DTime.prototype.init=function(b,f,d){if(d.className.indexOf("queryFieldInner")!=-1){this.mInputNode=d.firstElementChild;this.windowID=b}else{this.mInputNode=d.childNodes[2]}DTime.superclass.init.call(this,b,f,d)};TPATime.prototype.ConvertPrimitiveToDataType=DTime.prototype.ConvertPrimitiveToDataType=function(d){var b=this.FromUIInput(d,false,false);return b};DTime.prototype.GetQBEValue=function(){if(this.IsNullKeyword()){return NullType.KEYWORD_NULL}var g=this.mInputNode.value;g=ExpandString(this.windowID,g,2|4,this.mID,7);g=g.trim(1|2);if(g==""){return Null}var d=Field.GetQBEOperator(g);if(d==null){var b=this.Validate();if(b){throw (b)}return this.G()}else{var f=this.FromUIInput(g.substring(d.length).trim(1),true,false);return new CharType(d+f.toPrimitive())}};TPATime.prototype.FromUIInput=DTime.prototype.FromUIInput=function(k,h,g){if(g){k=ExpandString(this.windowID,k,2|4,this.mID,7)}k=k.trim(1|2);if(k==""){return Null}var b=ARDate.parseDateTime(k);var f;if(b!=null){f=b.GTimestamp()}if(b==null||f<0||f>2147483647){if(h&&!k.isNumeric()){throw ({t:2,n:9376,m:null,a:this.GLabelOrName()})}f=parseInt(k,10);if(isNaN(f)){f=0}else{if(f<0){f=0}else{if(f>2147483647){f=2147483647}}}}var d=new TimeType(f);d.setDisplayFormat(this.mInputNode.getAttribute("ds"));return d};TPATime.prototype.ConvertDTForS=JTime.prototype.ConvertDTForS=DTime.prototype.ConvertDTForS=DTime.prototype.ConvertDTForSLE=function(d){var b=this.mInputNode.getAttribute("ds");if(d.isNull||(d.type==7&&!(d instanceof DateKWType)&&d.getDisplayFormat()==b)){return d}else{if(ARKWIsKeywordString(this.windowID,d)){return new CharType(d.toString())}else{d=new TimeType(d.toTime().toString(b));d.setDisplayFormat(this.mInputNode.getAttribute("ds"));return d}}};DTime.prototype.Validate=function(){try{return Time_Validate(this,this.FromUIInput(this.mInputNode.value,true,true))}catch(b){b.a=this.GLabel();return b}};DTime.prototype.mHaveStoredData=true;DTime.prototype.mDataType=7;JFieldFactories.Time=function(b,f,d){return new JTime(b,f,d)};function JTime(g,f,d){if(arguments.length){this.init(g,f,d)}}TPAFieldFactories.Time=function(b,f,d){return new TPATime(b,f,d)};function TPATime(g,f,d){if(arguments.length){this.init(g,f,d)}}TPATime.prototype.G=JTime.prototype.G=function(){var b=this.mObj.v;if(b.isNull||b.type==7){return b}else{if(b.type==4){b=ExpandString(this.windowID,b.toString(),2|4,this.mID,this.mDataType)}this.mObj.v=new TimeType(b);return this.mObj.v}};TPATime.prototype.DoSet=JTime.prototype.DoSet=function(d){if(d.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,d)){this.mObj.v=new CharType(d.toString())}else{d=d.toTime();this.mObj.v=d}}if(this.mInputNode!=null){var b;if(this.mObj.v.isNull){b=""}else{b=this.ConvertDTForS(this.mObj.v).toString()}this.mInputNode.value=b;this.mPrimVal=b;return}this.SetDirty()};JTime.prototype.Validate=function(){return Time_Validate(this,this.G())};TPATime.prototype.Validate=function(){try{return Time_Validate(this,this.FromUIInput(this.mInputNode.value,true,true))}catch(b){b.a=this.GLabel();return b}};TPATime.prototype.ValidatePopupValue=JTime.prototype.ValidatePopupValue=DTime.prototype.ValidatePopupValue=function(d){d=new TimeType(d.GTimestamp());var b=Time_Validate(this,d);if(b!=null){return{t:2,n:9307,m:null,a:"01/01/1970 - 01/19/2038 (GMT) : "+this.GLabelOrName()}}return null};TPATime.prototype.SetFromPopup=DTime.prototype.SetFromPopup=JTime.prototype.SetFromPopup=function(d){if(this instanceof TPATime){var b=new FormEvent(this.windowID,this.mParentid);b.element=this.mInputNode;getFields_NS(this.windowID)[this.mParentid].FieldValChanged(b,new TimeType(d.GTimestamp()));this.DoSet(new TimeType(d.GTimestamp()))}else{this.S(new TimeType(d.GTimestamp()))}};function Time_Validate(d,f){var b=false;if(typeof d.mLastChanged=="undefined"){b=true}else{b=d.mLastChanged&&getField_LastCleared_NS(d.windowID)<=d.mLastChanged}if(!b){return null}if(!f.isNull){if(f.valueAdjusted){return{t:2,n:9376,m:null,a:d.GLabelOrName()}}}return null}TPATime.prototype.mHaveStoredData=JTime.prototype.mHaveStoredData=true;TPATime.prototype.GetSorter=JTime.prototype.GetSorter=function(){return"(ls=parseInt(lhs),rs=parseInt(rhs),(isNaN(ls)?0:ls)-(isNaN(rs)?0:rs))"};TPATime.prototype.FieldValChanged=function(b,f){var d;if(f){d=this.ConvertDTForS(f).toString()}else{d=this.GetScreenValAsPrimitive(b)}if(this.mPrimVal==d){return}this.mPrimVal=d;if(d==""){this.mDataVal=(this.mDataType==7)?TimeNull:Null}else{var g={hasKeyword:false,hasTemporalKeyword:false};d=ExpandString(this.windowID,d,2|4,this.mID,this.mDataType,g);if(d==""){if(g.hasKeyword){this.mDataVal=(this.mDataType==7)?TimeNullType.KEYWORD_TIME_NULL:NullType.KEYWORD_NULL}else{this.mDataVal=(this.mDataType==7)?TimerNull:Null}}else{this.mDataVal=this.ConvertPrimitiveToDataType(d)}}f=this.mDataVal;if(f.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,f)){this.mObj.v=new CharType(f.toString())}else{f=f.toTime();this.mObj.v=f}}this.SetDirty();this.SaveGlobalData()};TPATime.prototype.GetScreenValAsPrimitive=function(d){if(this.mInputNode==null){if(d==null){return""}else{var b=d.element.parentNode;this.mInputNode=b.childNodes[2];if(this.mInputNode==null){return""}this.mMaxLen=this.mInputNode.getAttribute("maxlen")}}return this.mInputNode.value};TPATime.prototype.DOMClick=DTime.prototype.DOMClick=function(f){DTime.superclass.DOMClick.call(this,f);if(this.GAccess()==3){return}var k=FakeButton_Find(f.element);if(k){if(k.className.indexOf("expand")!=-1){var d=null;if(this instanceof TPATime){d=k.parentNode;this.mInputNode=d.childNodes[2]}var h=this.mInputNode.getAttribute("ds");var g=this.GAccess()==1;if(getOpenDIVPopup_NS(this.windowID)&&getOpenDIVPopup_NS(this.windowID).mModal){return}var b=new TimePopup(this,h!=2,h!=1,false,g,d);b.SetOrigin(f);if(this instanceof TPATime){return b.ShowPopup(k,3,k.offsetHeight+3)}else{return b.ShowPopup(k,0,k.offsetHeight)}}else{this.mInputNode.focus()}}};TimePopup.prototype=new DIVPopup();TimePopup.prototype.constructor=TimePopup;TimePopup.superclass=DIVPopup.prototype;function TimePopup(h,d,g,f,k,b){if(arguments.length){this.init(h,d,g,f,k,b)}}TimePopup.prototype.init=function(k,d,h,g,o,b){this.mField=k;if(b!=null){var f=b.childNodes[3]}else{var f=k.mObj.childNodes[3]}TimePopup.superclass.init.call(this,k.windowID,true,true,false,false,false);this.mShowTime=d;this.mShowDate=h;this.mShowBC=g;this.mReadOnly=o;if(this.mReadOnly){this.Buttons=[{t:getLocalizedMessage("Cancel"),id:"ardivpcancel",f:"OnCancel"}]}};TimePopup.prototype.GetTitleBarHTML=function(b){return""};TimePopup.UpdateCalendar=function(){TimePopup.prototype.UpdateCalendar.call(getOpenDIVPopup_NS(getCurrentWindowID_NS()))};TimePopup.prototype.SetMonth=function(b){this.mDateVal.SMonth(b);this.UpdateCalendar();this.focus()};TimePopup.prototype.SetYear=function(d){var f=this.mDateVal.GYear();var b=d*((f<0)?-1:1);if(f<0){b++}this.mDateVal.SYear(b);this.UpdateCalendar()};TimePopup.UpdateDay=FormEvent.Trampoline(function(d){var f=Window_FromElement(d.element);var b=d.element.getAttribute("day");if(b>=0){TimePopup.prototype.SetDay.call(getOpenDIVPopup_NS(f),b)}});TimePopup.Hover=FormEvent.Trampoline(function(d){var b=d.element.style.backgroundColor="#c1e1f5";d.element.onmouseout=function(){d.element.style.backgroundColor=""}});TimePopup.prototype.PopupStyle="DIVPopupNoHdr";TimePopup.prototype.PopupBodyStyle="DIVPopupBodyNoHdr";TimePopup.prototype.SetDay=function(b){this.mDateVal.SDate(parseInt(b));this.UpdateCalendar();var d=this.windowID;setTimeout(function(){DIVPopup.InitFocus(d)},1)};TimePopup.prototype.UpdateCalendar=function(){var b=this.mDiv.getElementsByTagName("SPAN");for(var d=0;d<b.length;d++){if(b[d].id=="calendar"){b[d].innerHTML=this.GetMonthHTML();this.mTabStops.splice(0,this.mTabStops.length);this.ComputeTabStops(this.mDiv);return}}};TimePopup.prototype.GetLastDayInMonth=function(){var b=new Date(this.mDateVal.GYear(),this.mDateVal.GMonth(),1);b.setDate(32);return 32-b.getDate()};TimePopup.prototype.GetMonthHTML=function(){var s=[];s.push('<table align="center" cellspacing=3 cellpadding=2><tr class="daysofweek">');for(var g=0;g<7;g++){s.push('<th scope="col" class="day" align=center');s.push(">&nbsp;"+ARDate.DayShort(g).HTMLEncode()+"</th>")}s.push("</tr>");var o=1-new ARDate(this.mDateVal.GYear(),this.mDateVal.GMonth(),1).GDay();var b=this.GetLastDayInMonth();for(var g=0;g<6;g++){s.push('<tr arwindowid="'+this.windowID+'">');for(var f=0;f<7;f++){var h=(o<=0||o>b)?-1:o;if(h>0){s.push('<td day="'+h+'" tabindex="0" onKeyDown="javascript:TimePopup.prototype.KeyDown();" onmouseover="javascript:TimePopup.Hover(arguments[0]);" onclick="javascript:TimePopup.UpdateDay(arguments[0]);" class="');var k=new Date();if(h==k.getDate()&&this.mDateVal.year==k.getFullYear()&&this.mDateVal.month==k.getMonth()){s.push('calendaron" id="calenderon" artb=1>')}else{if(h==this.mDateVal.GDate()){s.push('selected" id="selected" artb=1>')}else{if(f==0||f==6){s.push('weekend">')}else{s.push('weekday">')}}}s.push(h+"</td>")}else{s.push("<td>&nbsp;</td>")}o++}s.push("</tr>")}s.push("</table>");return s.join("")};TimePopup.prototype.BuildCalendar=function(){var o=localeInfo.dateFormatPattern.charAt(0);var f=(o=="Y"||o=="y");var b="100%";var k='<table style="margin:-2px 0 0 -1px"  cellspacing=0><tr class="header"><td><table style="width:'+b+'">';if(this.mShowDate){var h=ARDate.MonthLabel(this.mDateVal.GMonth());var d=this.mDateVal.GYear();if(d<=0){d=Math.abs(d)+1}else{d=Math.abs(d)}k+='<tr><td nowrap><table class="calendarTable"><tr><td><table class="fullwidth" cellpadding=0 cellspacing=0>';k+=(f?this.GetYearInput(d):this.GetMonthDropDown(h));k+="<td width='5px'>&nbsp;</td>";k+=(f?this.GetMonthDropDown(h):this.GetYearInput(d));if(this.mShowBC){k+="<td>";k+="<input type=checkbox artb=1 ";if(this.mDateVal.GYear()<=0){k+="checked "}k+='id="bc" name="bc" value="BC"></td><td nowrap>'+getLocalizedMessage("BC")+"</td>"}k+="</table></td></tr></table></td></tr></td></tr></table>";k+='<tr><td><span id="calendar">'+this.GetMonthHTML();+"</span></td></tr>"}if(this.mShowTime){if(!this.mShowDate){var k='<table style="width:'+b+'">'}k+='<tr height=50><td align="center"><div class="showTime">';this.militaryTime=localeInfo.timeFormatPattern.match(/[iI]/);var g=new TODType(this.mDateVal.GTimeOfDay());k+=this.GetTimePopupHTML(g);k+="</div></td></tr>"}k+="</table>";this.SetContents(null,k)};TimePopup.prototype.GetYearInput=function(b){return'<td height=24 cellpadding=0><input artb=1 id="popupyear" type="text" class="text" style="position:static;height:21px;width:45px" size=4 maxlength=4 value=\''+b+"'></td>"};TimePopup.prototype.GetMonthDropDown=function(b){var d=[];d.push('<td width=\'100%\' height=24><div style=\'position:relative;top:0;height:21px;width:100%;\'><input artb=1 id="popupmonth" readonly class="text" style="height:21px;width:100%"');d.push(' value="');d.push(b);d.push('"></INPUT><a class="btn btn3d selectionbtn" style="');d.push("right:0px");d.push(';height:21px;width:20px;"><img id="monthmenu"class="btnimg" alt="" src="');d.push(RelContextPath);d.push('resources/images/mt_sprites.gif"/>');d.push("</a>");d.push("</div></td>");return d.join("")};TimePopup.prototype.GetTimePopupHTML=function(f){var d=f.getTimeObj();d.h=this.AdjustHour(d.h);var v=localeInfo.AMPM[0];if(!f.isNull&&f.toInteger()>=(12*3600)){v=localeInfo.AMPM[1]}var s=[];s.A='<td><input artb=1 id="meridiem" class="text" style="position:relative; height:20px; ; width:25px; max-width: 25px" type="text" value="'+v+'" size=3 maxlength=2 > </td>';s.H='<td><input artb=1 id="hr" class="text" style="position:relative; height:20px; width:20px; max-width: 20px" type="text" value="'+d.h+'" size=2 maxlength=2 > </td>';s.I=s.H;s.U='<td><input artb=1 id="min" class="text" style="position:relative; height:20px; width:20px; max-width: 20px" type="text" value="'+ARDate.zeroPad(d.m)+'" size=2 maxlength=2 > </td>';s.S='<td><input artb=1 id="sec" class="text" style="position:relative; height:20px; width:20px; max-width: 20px" type="text" value="'+ARDate.zeroPad(d.s)+'" size=2 maxlength=2 > </td>';var w='<td><div class="label f9" style="position:relative">'+localeInfo.timeSeparator+"</div> </td>";var k=[];var g=localeInfo.timeFormatPattern.split(/[^asSuUiIhH]+/);for(var h=0;h<g.length;h++){var b=g[h].toUpperCase();if(b.length>0){if(b.match(/[U|S]/)){k.push(w)}k.push(s[b])}}var u=[];u.push('<td><table><tr><td><a href="javascript:" id="up" class="btn btn3d spinnerup">');u.push('<img id="up" alt="" class="btnimg" src="'+RelContextPath+'resources/images/mt_sprites.gif"></a></td></tr>');u.push('<tr><td><a href="javascript:" id="down" class="btn btn3d spinnerdown">');u.push('<img id="down" alt="" class="btnimg" src="'+RelContextPath+'resources/images/mt_sprites.gif"></a></td></tr></table></td>');k.push(u.join(""));return'<table align="center"><tr>'+k.join("")+"</tr></table>"};TimePopup.prototype.ShowPopup=function(h,d,b){var k=Null;var g=new Object();if(this.mField.Validate()!=null){var f;if(!this.mShowDate){f=9379}else{f=9380}g.c={f:MessagePopup,a:[this.windowID,new Array({n:f,t:1,m:null,a:null})]}}else{k=this.mField.G()}g.n={f:function(w,s){var u=new ARDate();if(s.isNull){u.STimestamp(new Date().UnixTimestamp());u.SHour(0);u.SMinute(0);u.SSecond(0)}else{if(s instanceof TODType){var y=s.getTimeObj();u.STimestamp((new ARDate(1970,1,1,y.h,y.m,y.s)).GTimestamp())}else{if(s instanceof DateType){u.SDays(s.toInteger())}else{u.STimestamp(new TimeType(s).toInteger())}}}w.mDateVal=u;w.BuildCalendar();TimePopup.superclass.ShowPopup.call(w,h,d,b,true)},a:[this,k]};return g};TimePopup.prototype.InitFocus=function(){var b=this.mDiv.getElementsByTagName("INPUT");if(b==null){return false}for(var f=0;f<b.length;f++){if(b[f].id=="popupmonth"){b[f].focus()}}for(var g=0;g<b.length;g++){if(b[g].prototype!=null){b[g].prototype.isSelected=false}}if(this.mShowDate){var d=this.mDiv.getElementsByTagName("SPAN");if(!d){return}for(var g=0;g<d.length;g++){if(d[g].id=="calendar"){var h=d[g].getElementsByTagName("TD");for(var f=0;f<h.length;f++){if(h[f].id=="calenderon"||h[f].id=="selected"){if("focus" in h[f]){h[f].focus()}}}}}}else{if(this.mShowTime){if(b&&b.length>0){if("focus" in b[0]){b[0].focus()}}}}};TimePopup.prototype.KeyPress=function(b){return false};TimePopup.prototype.KeyUp=function(f){if(f.key==8){var d=f.element,g=d.id;var b=d.value;if(g=="popupyear"){this.SetYear(b)}}};TimePopup.prototype.KeyDown=function(k){if(k==null){return false}if(k.key==9){return TimePopup.superclass.KeyDown.call(this,k)}var h=k.element,d=h.id;var w=k.key;var z=h.value;if(k.key==13){if(!(OpenedMenu!=null&&(OpenedMenu instanceof MonthDropDownMenu)&&d=="popupmonth")){h.click();return false}}if(d=="hr"||d=="min"||d=="sec"){if(z.indexOf("0")==0){z=z.substring(1)}var f=parseInt(z);var A=String.fromCharCodeWithNumPad(w);var o=parseInt(A);if(isNaN(o)){o=0}h.value=(d=="hr")?this.Validate_Hour(f,o,w):(d=="min")?ARDate.zeroPad(this.Validate_Min(f,o,w)):(d=="sec")?ARDate.zeroPad(this.Validate_Sec(f,o,w)):z}else{if(d=="popupyear"){if(w==46){h.value="";return false}var f=(z==""?z:parseInt(z));if(w==38||w==40){var u=((w==38)?1:-1);if(f!=""){u=f+u}u=Math.max(1,u);h.value=u;this.SetYear(u)}else{var o=parseInt(String.fromCharCodeWithNumPad(w));if(!isNaN(o)){var b=h.selectionStart,g=h.selectionEnd;h.value=h.value.substr(0,b)+o+h.value.substr(g);h.setSelectionRange(b+1,b+1);this.SetYear(h.value)}else{if(w==8||w==229){return true}}}}else{if(d=="meridiem"){h.value=this.Validate_Meridiem(z)}else{if((d=="calenderon"||d=="selected")&&(w==38||w==40||w==37||w==39)){var g=this.GetLastDayInMonth();var s=this.mDateVal.GDate();if(w==38||w==40){s+=(w==38)?-7:7;if(s<=0){s=35+s;if(s>g){s-=7}}if(s>g){s=s-35;if(s<=0){s+=7}}}else{if(w==37||w==39){s+=(w==37)?-1:1;if(s>g){s=1}else{if(s<=0){s=g}}}}this.SetDay(s)}else{if(d=="popupmonth"){Menu_DispatchEvent(4,k)}else{return TimePopup.superclass.KeyDown.call(this,k)}}}}}return false};TimePopup.prototype.OnOK=function(){var b=this.mDiv.getElementsByTagName("INPUT");for(var d=0;d<b.length;d++){if(b[d].id=="popupyear"){var g=0;for(var f=0;f<b[d].value.length;f++){if(isNaN(b[d].value.charAt(f))){g=1;break}else{g=2}}if(g==2){this.SetYear(b[d].value)}}}var h=this.mField.ValidatePopupValue(this.mDateVal);if(h==null){this.mField.SetFromPopup(this.mDateVal);this.HidePopup(true)}else{new WorkflowContext(this.windowID,{f:MessagePopup,a:[this.windowID,new Array(h)]})}};TimePopup.prototype.Validate_Hour=function(h,k,f){var g=this.mDateVal.GHour();if(f==38){g=(g+1)%24}else{if(f==40){g=(--g)<0?g+24:g}else{if((f>=48&&f<=57)||(f>=96&&f<=105)){if(this.militaryTime){var o=(!isNaN(h)&&(h==1||(h==2&&k<=3)))?((10*h)+k):k;g=parseInt(o)}else{var d=(this.mDateVal.GHour()>=12)?12:0;var o=(!isNaN(h)&&(h==1&&k<=2))?((10*h)+k):((isNaN(h)||k>0)?k:h);var g=parseInt(o);if(g<12){g+=d}}}}}this.mDateVal.SHour(g);if(!this.militaryTime&&(g==12||g==0||g==11||g==23)){var b=document.getElementById("meridiem");if(b){b.value=((g==0||g==11)?localeInfo.AMPM[0]:localeInfo.AMPM[1])}}return this.AdjustHour(this.mDateVal.GHour())};TimePopup.prototype.AdjustHour=function(b){if(!this.militaryTime){if(b==0){b=12}else{if(b>=13){b-=12}}}return b};TimePopup.Validate_Min_Sec=function(d,f,b){if(b==38){return(d==59)?0:++d}else{if(b==40){return(d==0)?59:--d}}return((b>=48&&b<=57)||(b>=96&&b<=105))?((d<=5)?((10*d)+f):f):d};TimePopup.prototype.Validate_Min=function(d,f,b){this.mDateVal.SMinute(TimePopup.Validate_Min_Sec(d,f,b));return this.mDateVal.GMinute()};TimePopup.prototype.Validate_Sec=function(d,f,b){this.mDateVal.SSecond(TimePopup.Validate_Min_Sec(d,f,b));return this.mDateVal.GSecond()};TimePopup.prototype.Validate_Meridiem=function(b){if(b==localeInfo.AMPM[0]){b=localeInfo.AMPM[1];this.mDateVal.SHour(this.mDateVal.GHour()+12)}else{b=localeInfo.AMPM[0];this.mDateVal.SHour(this.mDateVal.GHour()-12)}return b};TimePopup.prototype.old_id=null;TimePopup.prototype.Click=function(u){var k=u.element,f=k.id;if(f&&f!="up"&&f!="down"&&this.mShowTime){var s=this.mDiv.getElementsByTagName("INPUT");for(var o=0;o<s.length;o++){s[o].isSelected=false}}if(f&&(f=="up"||f=="down")){var A=(f=="up")?38:40;var k;var s=this.mDiv.getElementsByTagName("INPUT");for(var o=0;o<s.length;o++){if(s[o].isSelected){k=s[o];break}}if(k){if(!(k.id=="hr"||k.id=="min"||k.id=="sec"||k.id=="meridiem")){var y=this.mDiv.getElementsByTagName("INPUT");for(var h=0;h<y.length;h++){if(y[h].id=="hr"){k=y[h];k.select();k.isSelected=true;break}}}}if(k){f=k.id;var z=k.value;var d=parseFloat(z);var g=z;if(f=="meridiem"){k.value=this.Validate_Meridiem(z)}else{k.value=(f=="hr")?this.Validate_Hour(d,0,A):(f=="min")?ARDate.zeroPad(this.Validate_Min(d,0,A)):(f=="sec")?ARDate.zeroPad(this.Validate_Sec(d,0,A)):z}}}else{if(f&&(f=="hr"||f=="min"||f=="sec"||f=="meridiem"||f=="popupyear")){if(f=="popupyear"){k.focus()}else{k.select();k.isSelected=true}this.old_id=f}else{if(f&&f=="bc"){var w=this.mDateVal.GYear();if(w<0){w=Math.abs(w)+1}else{w=-w}this.mDateVal.SYear(w);this.SetYear(Math.abs(this.mDateVal.GYear()));return true}else{if(f&&(f=="popupmonth")||(f=="monthmenu")){var b=document.getElementById("popupmonth");if(!this.mMenu){this.mMenu=new MonthDropDownMenu(this.windowID,b)}return new WorkflowContext(this.windowID,{f:this.mMenu.Open,t:this.mMenu,a:[b,3]})}}}}return false};MonthDropDownMenu.prototype=new Menu();MonthDropDownMenu.prototype.constructor=MonthDropDownMenu;MonthDropDownMenu.superclass=Menu.prototype;function MonthDropDownMenu(b,d){if(arguments.length){this.init(b,d)}}MonthDropDownMenu.prototype.init=function(b,f){var g=[];for(var d=0;d<12;d++){g.push({l:ARDate.MonthLabel(d),v:ARDate.MonthLabel(d)})}MonthDropDownMenu.superclass.init.call(this,b,g);this.mField=f};MonthDropDownMenu.prototype.Open=function(b){return{n:{f:MonthDropDownMenu.superclass.Open,t:this,a:[b,3,nextZIndex++,false]}}};MonthDropDownMenu.prototype.HandleSelection=function(b){this.mField.value=b;TimePopup.prototype.SetMonth.call(getOpenDIVPopup_NS(this.windowID),parseInt(localeInfo.monthsLongMap[b.toLowerCase()]))};DTrim.prototype=new Field();DTrim.prototype.constructor=DTrim;DTrim.superclass=Field.prototype;TPATrim.prototype=new Field();TPATrim.prototype.constructor=TPATrim;TPATrim.superclass=Field.prototype;DOMFieldFactories.Trim=function(b,f,d){return new DTrim(b,f,d)};function DTrim(g,f,d){if(arguments.length){this.init(g,f,d)}}DTrim.prototype.mDOMField=DTrim.prototype.mHaveVisualCharacteristics=true;DTrim.prototype.init=function(g,f,d){DTrim.superclass.init.call(this,g,f,d);var h=this.mObj.getElementsByTagName("TD");if(h!=null){this.mTextElement=h[0]}};DTrim.prototype.Clear=function(){};DTrim.prototype.mHaveStoredData=false;TPAFieldFactories.Trim=function(b,f,d){return new TPATrim(b,f,d)};function TPATrim(g,f,d){if(arguments.length){this.init(g,f,d)}}DTrim.prototype.UpdateLabel=function(b){if(!this.mTextElement){return}this.mTextElement.innerHTML=this.ReplaceText(b)};DTrim.prototype.UpdateAccess=function(h){var f=(h==3);var k,b;if(this.mObj.getAttribute("arsubtype")==3){k=this.mTextElement;b="disabled"}else{k=this.mObj;if(k.firstChild&&k.firstChild.tagName=="B"){b="roundedtrimBorderDisabled"}else{b="trimBorderDisabled"}}if(f){var g=k.className.split(" ");g.push(b);k.className=g.join(" ")}else{var d=new RegExp(b);k.className=k.className.replace(d,"")}};DTrim.prototype.UpdateFont=function(b){var d=this.mTextElement;if(!d){return}DTrim.superclass.UpdateFont.call(this,b)};DTrim.prototype.GetFocusElement=function(){if(!("mFocusElement" in this)){var b=this.mObj.getElementsByTagName("TABLE");if(b!=null){this.mFocusElement=b[0]}else{this.mFocusElement=null}}return this.mFocusElement};DTrim.prototype.ReplaceText=function(u){var v=new Array();var h=new RegExp("<\\s*[aA][^>]*>.*?</[aA]\\s*>","mig");var f=u.match(h);var k=u;if(f!=null){for(var g=0;g<f.length;g++){var o=f[g];var d=k.indexOf(o);if(d>0){v.push(MassageText(k.substring(0,d)))}var s=o.indexOf(">");if(s!=-1){var b=o.substring(s+1);o=o.substring(0,s)+" class=TrimLink>"+b}v.push(o);k=k.substring(d+f[g].length)}}if(k.length>0){v.push(MassageText(k))}return v.join("")};function MassageText(d){var b=0;d=d.replace(/\n/gim,"<br>");d=d.replace(/(<BR>)|(&nbsp)|(<)|(>)|(\")|(\s)/gim,function(g,u,s,o,k,h,f){if(u){return u}if(s){return s}if(o){return"&lt;"}if(k){return"&gt;"}if(h){return"&quot;"}if(f){return"&nbsp;"}});return d}DTrim.prototype.ResizeTo=function(f,b){var d=this.mObj.getAttribute("arsubtype");if(d==1){if(this.mObj.style.width=="2px"){this.mObj.style.height=this.perHeight+"%"}else{if(this.mObj.style.height=="2px"){this.mObj.style.width=this.perWidth+"%"}}}else{if(d==2||d==3){DTrim.superclass.ResizeTo.call(this,f,b)}}};TPATrim.prototype.DOMClick=TPATrim.prototype.DOMKeyPress=function(b){};QueryWidget.QW_ADDDEL1="<div class='queryAddDel'><a class='btnflt toolbarBtn' href='javascript:' tabIndex=";QueryWidget.QW_ADDDEL2="><div class='queryAddBtn'><img alt='add' src='";QueryWidget.QW_ADDDEL3="resources/images/add.png'></div></a><a class='btnflt toolbarBtn queryDelBtn' href='javascript:' tabIndex=";QueryWidget.QW_ADDDEL4="><div class='queryDelBtn'><img alt='remove' src='";QueryWidget.QW_ADDDEL5="resources/images/delete.png'></div></a></div>";QueryWidget.QW_FIELD="<div class='queryField'>";QueryWidget.QW_OPERATOR="<div class='queryOperator'>";QueryWidget.QW_VALUE="<div class='queryValue'>";QueryWidget.QW_INPUT_DIV_BEGIN="<div class='queryFieldInner'>";QueryWidget.QW_INPUT_DROPDOWN_START="<a class='btn btn3d' tabIndex=";QueryWidget.QW_INPUT_DROPDOWN_END1="><img class='btnimg dropdown' alt='menu' src='";QueryWidget.QW_INPUT_DROPDOWN_END2="resources/images/field_menu.gif'></a>";QueryWidget.QW_INPUT_POPUP_BEGIN="<a class='btn btn3d' style='visibility:hidden' tabIndex=";QueryWidget.QW_INPUT_POPUP1="><img class='btnimg calendar' src='";QueryWidget.QW_INPUT_POPUP2="resources/images/field_calendar.gif' alt='date picker'></a>";QueryWidget.QW_INPUT_POPUP3="resources/images/field_time.gif' alt='time picker'></a>";QueryWidget.QW_INPUT="<input class='text queryFieldName' type='text' tabIndex=";QueryWidget.QW_INPUT_DROPDOWN="<input class='text queryFieldName dropdown' type='text' tabIndex=";QueryWidget.QW_END_TAG=" >";QueryWidget.QW_DIV_END="</div>";QueryWidget.ALL=getLocalizedMessage("All");QueryWidget.ANY=getLocalizedMessage("Any");QueryWidget.OPERATORS=null;QueryWidget.STRING_OPERATORS=[6602,6603,6604,6605,6606,6600,6601];QueryWidget.DIARY_OPERATORS=[6604,6600,6601];QueryWidget.NUM_OPERATORS=[6602,6603,6607,6608,6609,6610,6600,6601];QueryWidget.TIME_OPERATORS=[6611,6612,6613,6614,6615,6616,6600,6601];function QueryWidget(windowID,guid,result){this.mGuid=guid;this.mObj=null;this.mFieldsMenu=[];this.mDef=result.d;this.mTabIndex=result.i;eval(result.m);this.mWindowID=windowID;for(var i in this.mDef){this.mFieldsMenu.push({l:i,v:i});if(this.mDef[i].t==6){var flddef=this.mDef[i];var selections=eval(flddef.e);var menudef=[];var enumIdx={};for(var i=0;i<selections.length;++i){menudef[i]={};var sel=selections[i];if(!("l" in sel)){menudef[i].l=sel.v.ValidatorUnEscape()}else{menudef[i].l=sel.l.ValidatorUnEscape()}menudef[i].v=menudef[i].l;if("ci" in sel){enumIdx[menudef[i].v]=sel.ci}else{enumIdx[menudef[i].v]=i}}flddef.selmenu=menudef;flddef.selindex=enumIdx}}if(QueryWidget.OPERATORS==null){var i;QueryWidget.STRING_OPERATORS_MENU=[];for(i=0;i<QueryWidget.STRING_OPERATORS.length;i++){QueryWidget.STRING_OPERATORS_MENU.push({l:getLocalizedMessage(QueryWidget.STRING_OPERATORS[i],null),v:getLocalizedMessage(QueryWidget.STRING_OPERATORS[i],null)})}QueryWidget.DIARY_OPERATORS_MENU=[];for(i=0;i<QueryWidget.DIARY_OPERATORS.length;i++){QueryWidget.DIARY_OPERATORS_MENU.push({l:getLocalizedMessage(QueryWidget.DIARY_OPERATORS[i],null),v:getLocalizedMessage(QueryWidget.DIARY_OPERATORS[i],null)})}QueryWidget.NUM_OPERATORS_MENU=[];for(i=0;i<QueryWidget.NUM_OPERATORS.length;i++){QueryWidget.NUM_OPERATORS_MENU.push({l:getLocalizedMessage(QueryWidget.NUM_OPERATORS[i],null),v:getLocalizedMessage(QueryWidget.NUM_OPERATORS[i],null)})}QueryWidget.TIME_OPERATORS_MENU=[];for(i=0;i<QueryWidget.TIME_OPERATORS.length;i++){QueryWidget.TIME_OPERATORS_MENU.push({l:getLocalizedMessage(QueryWidget.TIME_OPERATORS[i],null),v:getLocalizedMessage(QueryWidget.TIME_OPERATORS[i],null)})}}}QueryWidget.prototype.setDOMRef=function(b){this.mObj=b;var d=this.mObj.className;this.mObj.className=d+" QB"};QueryWidget.prototype.DOMClick=function(o){var d=null;var k,h;var u=o.element;if(u.tagName=="INPUT"){u=u.nextElementSibling.firstElementChild}else{if(u.tagName=="A"){if(u.className.indexOf("btnflt")!=-1){u=u.firstElementChild.firstElementChild}else{u=u.firstElementChild}}}if(u.tagName=="IMG"){if(u.className.indexOf("calendar")!=-1){d="calendar";k=u.parentNode.parentNode.parentNode;if(k.className.indexOf("dfro")!=-1){return}}else{k=u.parentNode;if(k.tagName=="A"){h=k.previousElementSibling;k=k.parentNode.parentNode}d=k.className}}if(d!=null&&d.indexOf("dfro")==-1){if(d.indexOf("queryAddBtn")!=-1){this.addRow(u)}else{if(d.indexOf("queryDelBtn")!=-1){var s=u.parentNode.parentNode.parentNode.parentNode;this.deleteRow(s)}else{if(d.indexOf("queryAndOr")!=-1){return this.displayMatchDropdown(this.mWindowID,h)}else{if(d.indexOf("queryField")!=-1){return this.showFieldList(this.mWindowID,u)}else{if(d.indexOf("calendar")!=-1){var f=k.parentNode.getAttribute("fld");if(f!=null){return this.showCalendarPopup(this.mWindowID,u,f)}}else{if(d.indexOf("queryOperator")!=-1){var f=k.parentNode.getAttribute("fld");if(f!=null){return this.displayOperatorDropdown(this.mWindowID,h,f)}}else{if(d.indexOf("queryValue")!=-1){var f=k.parentNode.getAttribute("fld");if(f!=null){var g=this.mDef[f];var b=g.t;if(b==6){return this.displayValueDropdown(this.mWindowID,h,f)}else{if(b==4&&g.m!=null&&u.className.indexOf("dropdown")!=-1){return this.displayMenu(this.mWindowID,h,g.m)}else{return}}}}}}}}}}}};QueryWidget.prototype.deleteRow=function(k){var f=k.previousElementSibling;if(k.className.indexOf("queryRowLast")!=-1){if(f!=null&&f.tagName=="DIV"&&f.className!="queryAndOr"){f.className+=" queryRowLast";f.firstElementChild.firstElementChild.style.visibility="visible";this.mObj.removeChild(k)}else{var b=k.getElementsByTagName("input");for(var g=0;g<b.length;g++){b[g].value=""}var o=k.getElementsByTagName("a");for(var d=4;d<o.length;d++){o[d].style.visibility="hidden"}var h=k.lastElementChild;h.className=h.className.replace(SACCESSRE,"")}}else{this.mObj.removeChild(k)}};QueryWidget.prototype.addRow=function(g){var h=g.parentNode.parentNode.parentNode.parentNode;h.className="queryRow";g.parentNode.parentNode.style.visibility="hidden";var f=document.createElement("div");f.className="queryRow queryRowLast";var d=[];d.push(QueryWidget.QW_ADDDEL1);d.push(this.mTabIndex+8);d.push(QueryWidget.QW_ADDDEL2);d.push(RelContextPath);d.push(QueryWidget.QW_ADDDEL3);d.push(this.mTabIndex+9);d.push(QueryWidget.QW_ADDDEL4);d.push(RelContextPath);d.push(QueryWidget.QW_ADDDEL5);d.push(QueryWidget.QW_FIELD);d.push(this.createInput(false,"Field Name"));d.push(QueryWidget.QW_DIV_END);d.push(QueryWidget.QW_OPERATOR);d.push(this.createInput(false,"Operator"));d.push(QueryWidget.QW_DIV_END);d.push(QueryWidget.QW_VALUE);d.push(this.createInput(true,"Field Value"));d.push(QueryWidget.QW_DIV_END);this.mTabIndex+=2;f.innerHTML=d.join("");this.mObj.appendChild(f);var b=this.mObj;setTimeout(function(){var k=b.lastElementChild;k.getElementsByTagName("input")[0].focus()},100)};QueryWidget.prototype.createInput=function(f,b){var d=[];d.push(QueryWidget.QW_INPUT_DIV_BEGIN);if(f){d.push(QueryWidget.QW_INPUT);d.push(this.mTabIndex++);d.push(QueryWidget.QW_END_TAG)}else{d.push(QueryWidget.QW_INPUT_DROPDOWN);d.push(this.mTabIndex++);d.push(QueryWidget.QW_END_TAG)}if(!f){d.push(QueryWidget.QW_INPUT_DROPDOWN_START);d.push(this.mTabIndex++);d.push(QueryWidget.QW_INPUT_DROPDOWN_END1);d.push(RelContextPath);d.push(QueryWidget.QW_INPUT_DROPDOWN_END2)}else{d.push(QueryWidget.QW_INPUT_DROPDOWN_START);d.push(this.mTabIndex++);d.push(" style='visibility:hidden'");d.push(QueryWidget.QW_INPUT_DROPDOWN_END1);d.push(RelContextPath);d.push(QueryWidget.QW_INPUT_DROPDOWN_END2);d.push(QueryWidget.QW_INPUT_POPUP_BEGIN);d.push(this.mTabIndex++);d.push(QueryWidget.QW_INPUT_POPUP1);d.push(RelContextPath);d.push(QueryWidget.QW_INPUT_POPUP2);d.push(QueryWidget.QW_INPUT_POPUP_BEGIN);d.push(this.mTabIndex++);d.push(QueryWidget.QW_INPUT_POPUP1);d.push(RelContextPath);d.push(QueryWidget.QW_INPUT_POPUP3)}d.push(QueryWidget.QW_DIV_END);return d.join("")};QueryWidget.prototype.displayMatchDropdown=function(b,f){var d=[{l:QueryWidget.ALL,v:QueryWidget.ALL},{l:QueryWidget.ANY,v:QueryWidget.ANY}];var g=new SimpleMenu(b,f,d);if(getCurWFC_NS(b)!=null){return{n:{f:g.Open,t:g,a:[f]}}}else{new WorkflowContext(b,{f:g.Open,t:g,a:[f]})}};QueryWidget.prototype.displayOperatorDropdown=function(b,h,g){var d;var f=this.mDef[g].t;switch(parseInt(f)){case 7:case 13:case 14:d=QueryWidget.TIME_OPERATORS_MENU;break;case 2:case 3:case 6:case 10:case 12:d=QueryWidget.NUM_OPERATORS_MENU;break;case 5:d=QueryWidget.DIARY_OPERATORS_MENU;break;default:d=QueryWidget.STRING_OPERATORS_MENU;break}var k=new QueryOperatorsMenu(b,h,d);if(getCurWFC_NS(b)!=null){return{n:{f:k.Open,t:k,a:[h]}}}else{new WorkflowContext(b,{f:k.Open,t:k,a:[h]})}};QueryWidget.prototype.displayValueDropdown=function(b,g,f){var d=this.mDef[f];var h=new SimpleMenu(b,g,d.selmenu);if(getCurWFC_NS(b)!=null){return{n:{f:h.Open,t:h,a:[g]}}}else{new WorkflowContext(b,{f:h.Open,t:h,a:[g]})}};QueryWidget.prototype.displayMenu=function(b,g,f){var d=ARMenu_Get(b,f);var h=new SimpleMenu(b,g,d.mMenuDef);if(getCurWFC_NS(b)!=null){return{n:{f:h.Open,t:h,a:[g]}}}else{new WorkflowContext(b,{f:h.Open,t:h,a:[g]})}};QueryWidget.prototype.showFieldList=function(b,d){var f=d.parentNode.previousElementSibling;var g=new QueryFieldsMenu(b,f,this);if(getCurWFC_NS(b)!=null){return{n:{f:g.Open,t:g,a:[f]}}}else{new WorkflowContext(b,{f:g.Open,t:g,a:[f]})}};QueryWidget.prototype.showCalendarPopup=function(f,k,o){var h=this.mDef[o].t;var u=true,s=true;if(h==14){s=false;var g=new DTOD(f,0,k.parentNode.parentNode);var d=g.mInputNode.value;if(d!=""){g.mDataVal=new TODType(d)}}else{if(h==13){u=false;var g=new DDate(f,0,k.parentNode.parentNode);var d=g.mInputNode.value;if(d!=""){g.mDataVal=new DateType(d)}}else{var g=new DTime(f,0,k.parentNode.parentNode);var d=g.mInputNode.value;if(d!=""){g.mDataVal=new TimeType(d)}}}var b=new TimePopup(g,u,s,false,false,null);return b.ShowPopup(k,-3,k.offsetHeight)};QueryWidget.prototype.G=function(){var d=this.mObj.children;var y=d[0].getElementsByTagName("input")[0].value;var b=(y==QueryWidget.ALL)?1:2;var C=[];for(var o=1;o<d.length;o++){if(C.length>0){C.unshift(b+"\\")}var B=d[o];var u=B.getElementsByTagName("input");var k=u[1].value;var f=u[2].value;var g=this.mDef[u[0].value];if(typeof g=="undefined"){continue}var h="1\\"+g.id+"\\2\\";var w=parseInt(g.t);var s="4\\";if(k==getLocalizedMessage(6602)||k==getLocalizedMessage(6611)){s+=1+"\\"}else{if(k==getLocalizedMessage(6603)||k==getLocalizedMessage(6612)){s+=6+"\\"}else{if(k==getLocalizedMessage(6613)||k==getLocalizedMessage(6609)){s+=4+"\\"}else{if(k==getLocalizedMessage(6615)||k==getLocalizedMessage(6610)){s+=5+"\\"}else{if(k==getLocalizedMessage(6614)||k==getLocalizedMessage(6607)){s+=2+"\\"}else{if(k==getLocalizedMessage(6616)||k==getLocalizedMessage(6608)){s+=3+"\\"}else{if(k==getLocalizedMessage(6604)){s+=7+"\\";f="%"+f+"%"}else{if(k==getLocalizedMessage(6606)){s+=7+"\\";f="%"+f}else{if(k==getLocalizedMessage(6605)){s+=7+"\\";f=f+"%"}else{if(k==getLocalizedMessage(6600)){s+=1+"\\";f=null}else{if(k==getLocalizedMessage(6601)){s+=6+"\\";f=null}}}}}}}}}}}s+=h;if(f==null){s+="0"}else{switch(w){case 7:s+="7\\";s+=TimeType.getTimestamp(f);break;case 13:s+="13\\";s+=DateType.getDays(f);break;case 14:s+="14\\";s+=TODType.convertStringToTime(f);break;case 2:s+="2\\";s+=f;break;case 3:s+="3\\";s+=LCRealToEn_US(f,false);break;case 10:var z=LCDecimalToEn_US(f,false);s+="10\\";s+=z.length;s+="\\";s+=z;break;case 12:s+="12\\";s+=f;break;case 6:s+="6\\";var A=this.mDef[B.getAttribute("fld")];f=A.selindex[f];s+=f;break;case 5:s+="5\\";s+=f.toByteArray().length;s+="\\";s+=f;break;default:s+="4\\";s+=f.toByteArray().length;s+="\\";s+=f}}s+="\\";C.push(s)}return new CharType(C.join(""))};QueryWidget.prototype.Clear=function(){var b=this.mObj.children.length;for(var d=b-1;d>0;d--){this.deleteRow(this.mObj.children[d])}};QueryWidget.prototype.GLabel=function(){var d=this.mObj.children.length;var h=this.mObj.children[0].getElementsByTagName("input")[0].value;h=(h==QueryWidget.ALL?getLocalizedMessage("AND")+" ":getLocalizedMessage("OR")+" ");var b=[];for(var k=1;k<d;k++){var o=this.mObj.children[k];var f=o.getElementsByTagName("input");for(var g=0;g<=2;g++){b.push(f[g].value+" ")}if(k!=d-1){b.push(h)}}return b.join("")};QueryWidget.prototype.GetFirstTabableElement=function(d){var f=d.firstElementChild;if(f&&f.className&&f.className.indexOf("queryBuilder")!=-1){var b=this.mObj.getElementsByTagName("input");return b[0]}return null};QueryOperatorsMenu.prototype=new SimpleMenu();QueryOperatorsMenu.prototype.constructor=QueryOperatorsMenu;QueryOperatorsMenu.superclass=SimpleMenu.prototype;function QueryOperatorsMenu(b,f,d){if(arguments.length){this.init(b,f,d)}}QueryOperatorsMenu.prototype.HandleSelection=function(g){this.mField.value=g;this.mField.focus();var d=this.mField.parentNode.parentNode;var f=d.nextElementSibling;var b=f.firstElementChild.firstElementChild;if(g==getLocalizedMessage(6600,null)||g==getLocalizedMessage(6601,null)){if(f.className.indexOf("dfro")==-1){f.className+=" dfro"}b.value="";b.disabled=true}else{f.className=f.className.replace(SACCESSRE,"");b.disabled=false}};QueryFieldsMenu.prototype=new Menu();QueryFieldsMenu.prototype.constructor=QueryFieldsMenu;QueryFieldsMenu.superclass=Menu.prototype;function QueryFieldsMenu(b,f,d){if(arguments.length){this.init(b,f,d)}}QueryFieldsMenu.prototype.init=function(b,f,d){QueryFieldsMenu.superclass.init.call(this,b,d.mFieldsMenu);this.mField=f;this.mName="Popup Menu";this.mWidget=d};QueryFieldsMenu.prototype.Open=function(b){if(getCurWFC_NS(this.windowID)==null){QueryFieldsMenu.superclass.Open.call(this,b,3,nextZIndex++,false)}else{return{n:{f:QueryFieldsMenu.superclass.Open,t:this,a:[b,3,nextZIndex++,false]}}}};QueryFieldsMenu.prototype.HandleSelection=function(o){this.mField.value=o;this.mField.focus();var h=this.mWidget.mDef[o];var f=h.t;var b=this.mField.parentNode.parentNode;var k=b.nextElementSibling;b.parentNode.setAttribute("fld",o);k.getElementsByTagName("input")[0].value="";var g=k.nextElementSibling;var d=g.getElementsByTagName("input")[0];d.value="";g.className=g.className.replace(SACCESSRE,"");var s=g.getElementsByTagName("a");if(f==7||f==13){s[0].style.visibility="hidden";s[1].style.visibility="visible";s[2].style.visibility="hidden"}else{if(f==6||(f==4&&h.m!=null)){s[0].style.visibility="visible";s[1].style.visibility="hidden";s[2].style.visibility="hidden"}else{if(f==14){s[0].style.visibility="hidden";s[1].style.visibility="hidden";s[2].style.visibility="visible"}else{s[0].style.visibility="hidden";s[1].style.visibility="hidden";s[2].style.visibility="hidden"}}}if(f==6){d.className+=" dropdown"}else{d.className=d.className.replace(/[ ]*dropdown/g,"")}};DocView.prototype.constructor=DocView;DocView.URLPAT=new RegExp("^((https?)|(ftps?)|(file)):[\\\\/][\\\\/].*","i");DocView.HTMLDOCPAT=new RegExp("((<html)|(<body))","i");DocView.FRAMEBORDERRE=new RegExp("frameborder=([^\\s]+)","i");DocView.FRAMEBORDERCOLORRE=new RegExp("arviewbordercolor=([^\\s]+)","i");DocView.SCROLLRE=new RegExp("scrolling=([^\\s]+)","i");DocView.mFrameID=0;DocView.parseFrameBorder=/[0-9]/g;function DocView(d,b,k,g,h,f){if(arguments.length){this.init(d,b,k,g,h,f)}}DocView.prototype.hasHTMLDOCPAT=function(){if(this.mObj&&this.mObj.innerHTML){return this.mObj.innerHTML.match(DocView.HTMLDOCPAT)}else{return false}};DocView.prototype.G=function(){return this.mValue};DocView.prototype.init=function(d,k,h,w,g,f){this.mUpdateTimeout=null;this.mObj=d;this.mFrameHTML=h;this.mFrameName=k;this.mAutosize=w;this.mHandler=null;this.mHandlerObj=null;this.mFrameborder=0;this.mScroll="auto";this.mValue="";if(this.mAutosize==null||typeof this.mAutosize=="undefined"){this.mAutosize=false}if(g!=null&&typeof g!="undefined"){this.mHandler=g;this.mHandlerObj=(f!=null)?f:this}if(h==null||h.length===0){if(!this.mFrameName){DocView.mFrameID++;this.mFrameName="DOCFRM"+DocView.mFrameID}var b="background-color:transparent;position:static;";if(this.mAutosize==false){b+="width:100%;height:100%;"}var v="auto";if(d&&d.innerHTML){var u=DocView.SCROLLRE.exec(d.innerHTML);if(u!=null){v=u[1].match("[A-Za-z]+")}}this.mFrameHTML=" <iframe name="+this.mFrameName+' style="'+b+'" frameborder=0 scrolling="'+v+'" allowtransparency="true" src="javascript:\'<HTML></HTML>\'"></iframe>'}var s=DocView.FRAMEBORDERRE.exec(this.mFrameHTML);if(s!=null){this.mFrameborder=parseInt(s[1].replace(/\"/g,""))}var u=DocView.SCROLLRE.exec(this.mFrameHTML);if(u!=null){this.mScroll=u[1].match("[A-Za-z]+")}var o=DocView.FRAMEBORDERCOLORRE.exec(this.mFrameHTML);if(o!=null){this.mViewBorderColor=o[1].match("(#)[0-9A-Za-z]+")}};DocView.GetIFrameDoc=function(b,d){try{return("contentDocument" in b)?b.contentDocument:window.frames[d].document}catch(f){return null}};DocView.prototype.GetInnerDocument=function(){var d=this.mObj.childNodes[1];try{return("contentDocument" in d)?d.contentDocument:window.frames[this.mFrameName].document}catch(b){return null}};DocView.prototype.S=function(val,addRTLifHTML){this.mValue=val;if(this.mUpdateTimeout!=null){window.clearTimeout(this.mUpdateTimeout);this.mUpdateTimeout=null}var child;if(this.vfchild){child=this.vfchild}else{if(this.mObj&&this.mObj.childNodes&&this.mObj.childNodes.length>0){child=this.mObj.childNodes[1]}}if(val.match(DocView.URLPAT)){if(child==null||child.tagName!="IFRAME"){this.mObj.style.border="";this.mObj.style.overflow="hidden";this.mObj.innerHTML=this.mFrameHTML}else{}try{this.mObj.childNodes[1].contentWindow.location.replace(val);if(this.mHandler){this.mHandler.call(this.mHandlerObj)}}catch(err){}}else{if(val.match(DocView.HTMLDOCPAT)){if(child==null||child.tagName!="IFRAME"){this.mObj.style.border="";this.mObj.style.overflow="hidden"}this.mObj.innerHTML=this.mFrameHTML;var timeoutobj=this;this.mUpdateTimeout=window.setTimeout(function(){timeoutobj.mUpdateTimeout=null;var ifrframe=timeoutobj.GetInnerDocument();if(ifrframe!=null){ifrframe.open();ifrframe.write(val);ifrframe.close();if(timeoutobj.mAutosize){timeoutobj.mObj.childNodes[1].style.width=ifrframe.body.scrollWidth+"px";timeoutobj.mObj.childNodes[1].style.height=ifrframe.body.scrollHeight+"px"}if(addRTLifHTML){ifrframe.documentElement.dir="rtl"}if(timeoutobj.mHandler){timeoutobj.mHandler.call(timeoutobj.mHandlerObj)}}},50)}else{if(this.mViewBorderColor){this.mObj.style.border=(this.mFrameborder==0)?"":"solid 1px "+this.mViewBorderColor[0]+""}else{this.mObj.style.border=(this.mFrameborder==0)?"":"solid 1px black"}this.mObj.style.overflow=(this.mScroll=="auto")?"auto":((this.mScroll=="yes")?"scroll":"hidden");if(this.mObj.id=="artooltip"){val="<div class='toolTip' style='padding:5px;'>"+val+"</div>"}val=parseScript(val);val=parseStyleLink(val);val=parseStyle(val);this.mObj.innerHTML=val;var felechld=this.mObj.firstElementChild;if(felechld&&"getAttribute" in felechld){var hFunc=felechld.getAttribute("arhandle");if(hFunc!=null){eval(hFunc)}}var fchld=this.mObj.firstChild;if(fchld&&fchld.nodeType==3&&fchld.length<=1){fchld.nodeValue=""}if(this.mHandler){this.mHandler.call(this.mHandlerObj)}}}};DView.prototype=new AsyncField();DView.prototype.constructor=DView;DView.superclass=AsyncField.prototype;JView.prototype=new Field();JView.prototype.constructor=JView;JView.superclass=Field.prototype;TPAView.prototype=new Field();TPAView.prototype.constructor=TPAView;TPAView.superclass=Field.prototype;DOMFieldFactories.View=function(b,f,d){return new DView(b,f,d)};function DView(b,f,d){if(arguments.length){this.init(b,f,d)}}DView.prototype.val=Null;DView.prototype.mDOMField=DView.prototype.mHaveVisualCharacteristics=true;DView.GlobalFuncRE=/DVFol/g;DView.prototype.setClearInlineFormFlag=function(b){this.clearInlineFormFlag=b};DView.prototype.getClearInlineFormFlag=function(){return(this.clearInlineFormFlag)};DView.prototype.GetInnerDocument=function(){return this.mViewObj.GetInnerDocument()};DView.prototype.mHaveStoredData=false;DView.TEMPLATEPAT=new RegExp("^template:","i");DView.TEMPLATENAMERE=new RegExp("^template:(.*)","i");DView.prototype.Clear=function(){var b=this.mID;this.ClearInlineFormSettings();if((b>=1000000&&b<=1999999)||(b>=3000000&&b<=3999999)||b==1576||b==1575){return}if(this.mTemplateName!=null){return this.S(new CharType("template:"+this.mTemplateName))}return this.S(Null)};DView.prototype.GDefault=function(){if(this.mID!=1575){this.val=Null}var b=getDefaults_NS(this.windowID);if("d" in b[this.mID]){return(new CharType(ExpandString(this.windowID,""+b[this.mID].d,2)))}return Null};DView.prototype.DoSet=DView.prototype.DoSLoadEntry=function(f){if(f.isNull){this.val=Null}else{if(f instanceof CharType){this.val=f}else{if(f instanceof AttachmentType){this.val=new CharType(encodeURI(f.toURL()))}else{this.val=new CharType(f)}}}if(this.mTemplateName!=null){getTemplateFields_NS(this.windowID)[this.mID]=null}this.mTemplateName=null;this.mQWidget=null;if(this.val.toString().match(DView.TEMPLATEPAT)){var b=this.val.toString();var d=DView.TEMPLATENAMERE.exec(b);if(d!=null){this.mTemplateName=d[1];getTemplateFields_NS(this.windowID)[this.mID]=this}}if(!this.mModified){this.mModified=true}};DView.Refresh=function(d,b){var f=F(d,b);if(f==null){return}f.disableSetFieldsEvent();if(f.mModified==false){f.setContents()}};DView.prototype.FlushAsyncQueue=function(){if(this.mModified==true){this.setContents()}};DView.prototype.setContents=function(){if(this.mode==0){if(this.mTemplateName!=null){var d=T(this.windowID,this.mTemplateName);if(d!=null){d.setDefaultParamValues();this.val=new CharType(d.process(this.windowID))}}var f=this.val.toString();if(f==null||f==""||this.inlineFormDisplayed==false){this.ClearInlineFormSettings()}this.mModified=false;if(this.isSetFieldsEventEnabled()){this.setFieldsAsEvent(f)}else{var b=false;this.mViewObj.S(f,b)}this.mObj.setAttribute("arstop","0");if(this.isInlineForm()){this.inlineFormDisplayed=false;this.ClearInlineForm();this.mObj.setAttribute("arstop","1");var g=this;TIMELINE.queue("FORM_LOAD_INLINE",g.mFormName);setTimeout(function(){buildNewInlineForm(g.mChildWindowID,g.windowID,g.mFormServer,g.mFormName,g.mViewName,g.mObj,g.mFormOpeningArgs,"VF"+g.mID+"_"+new Date().getTime()+"IN");g.mFormLoaded=true},10)}if(this.mQWidget!=null){this.mQWidget.setDOMRef(this.mObj.firstChild)}}else{if(this.mode==1){this.getList();this.mModified=false}}};DView.prototype.isSetFieldsEventEnabled=function(){return false};DView.prototype.setFieldsAsEvent=function(b){};DView.prototype.disableSetFieldsEvent=function(){};DView.prototype.TabableElementSelector=function(d){if(d.tagName=="IFRAME"){try{var b=this.GetInnerDocument();if(b!=null){return(b.body==null)?b:((b.body.childNodes[1]==null)?b.body:b.body.childNodes[1])}return d}catch(f){}}else{if(this.mQWidget!=null){return this.mQWidget.GetFirstTabableElement(d)}else{if(d.tagName=="DIV"){return d}}}return null};DView.prototype.DOMKeyPress=function(d){if(d.key==13){var b=this.GetInnerDocument();if(b!=null&&"focus" in b){setTimeout(function(){b.focus()},0)}return}};DView.prototype.ol=function(){var b=this;setTimeout(function(){var f=b.GetInnerDocument();try{if(f&&f.body&&!(f.body.style.backgroundColor)){var h=(document.defaultView.getComputedStyle(f.body,null).getPropertyValue("background-color"));if(h=="#ffffff"||h=="transparent"){f.body.style.backgroundColor="transparent"}f.body.style.margin=0}if(f){var g=b.GetParent();if(g&&(g.mParentObj.mViewTypeObj.mStackViewType=="fixed")&&("getPaneAttributes" in g)){g.getPaneAttributes();if(g.mFit){this.applyLayout();setTimeout(function(){var k=traverseFields(b,g.mParentObj.mViewTypeObj.mOrientation);if(k>0){g.setDirty(k)}},0)}}}}catch(d){}},0)};DView.prototype.applyLayout=function(){var b=window.frames[this.mFrameName];if(b!=null){if(typeof b.FormPane.Layout=="function"){b.FormPane.Layout(b.getTopWinWindowID_NS())}}};DView.prototype.G=function(){if(this.mQWidget!=null){return this.mQWidget.G()}return this.val};DView.prototype.GetFocusElement=function(){var b=this.mObj.childNodes[1];return(b!=null)?b:this.mObj};function ARMT_SendSignalToParent(d,f,b){if(typeof b=="undefined"){DView.SendSignalToParent(null,d,f)}else{ARProcessEvent.Add(Window_FromElement(b),d+"",f+"",b.tagName,true)}}DView.SendSignalToParent=function(b,g,d,f){if(arguments.length==3){f=d;d=g;g=b;b=getCurrentWindowID_NS();ARProcessEvent.DeliverEvent(b,"#",d+"",f+"")}ARProcessEvent.Add(b,d+"",f+"",g+"",true)};DView.prototype.HandleEvent=function(d,g){try{if(this.mForm&&this.mChildWindowID!=null){ARProcessEvent.Add(this.mChildWindowID,d+"",g+"","@")}else{var b=window.frames[this.mFrameName];if(b!=null){if("EventDispatcher" in b&&typeof b.EventDispatcher.dispatch=="function"){b.EventDispatcher.dispatch(d,g)}else{if("ARProcessEvent" in b&&typeof b.ARProcessEvent.Add=="function"){b.ARProcessEvent.Add(b.getTopWinWindowID_NS(),d+"",g+"","@")}}}}}catch(f){}};DView.prototype.callInternalFunction=function(g,k,f){try{var b=window.frames[this.mFrameName];if(b!=null){if("EventDispatcher" in b&&typeof b.EventDispatcher.callInternalFunction=="function"){var d=b.EventDispatcher.callInternalFunction(g,k,f);if(typeof d!="undefined"){return d}}}}catch(h){}};DView.tabForward=function(){setTimeout(function(){arJumpOutForward()},100)};DView.tabBackward=function(){setTimeout(function(){arJumpOutBackward()},100)};function addAsScript(g){try{var f=document.getElementsByTagName("head")[0];var b=document.createElement("SCRIPT");b.type="text/javascript";b.appendChild(document.createTextNode(g));f.appendChild(b)}catch(d){}}function InjectFormJS(g,b,s,k,o){myCacheID=k;myFlagForInline=true;var h=g+"_"+b+"_"+s;var u=("uddjs_"+h+"_loaded").ARToJSIdentifier();var d=("formjs_"+h+"_loaded").ARToJSIdentifier();var f;createScriptTag(RelContextPath+"forms/"+g+"/"+b+"/"+s+"/form.js/"+k+".js?format=html",f,d);createScriptTag(RelContextPath+"forms/"+g+"/"+b+"/"+s+"/udd.js?ui="+getCookie("MJUID")+"&format=html&w="+encodeURIComponent(o),f,u)}function InjectFormUDD(k,h,b,s,d){var o=k+"_"+h+"_"+b;var f=("uddjs_"+o+"_loaded").ARToJSIdentifier();var g;createScriptTag(RelContextPath+"forms/"+k+"/"+h+"/"+b+"/udd.js?ui="+getCookie("MJUID")+"&format=html&w="+encodeURIComponent(d),g,f)}function replaceDOMID(d,b){return d.replace(/((\<div.*\sid=)([0-9]+))|((\<a.*\sid=)(([0-9]+)))/gm,function(g,u,s,o,k,h,f){if(u){return s+'"'+b+o+'"'}if(k){return h+'"'+b+f+'"'}})}DView.prototype.ClearFloatingPanels=function(){while(this.mFloatingDialogPanels.length>0){var b=this.mFloatingDialogPanels.pop();b.innerHTML="";ardialogfp.removeChild(b)}this.mFloatingDialogPanels=[];while(this.mFloatingPanels.length>0){var d=this.mFloatingPanels.pop();d.innerHTML="";document.body.removeChild(d)}this.mFloatingPanels=[]};DView.prototype.ClearInlineFormSettings=function(){if(this.isInlineForm()){if(this.clearInlineFormFlag){this.mObj.innerHTML="";this.clearInlineFormFlag=false}this.ClearInlineForm();this.mForm=false;this.mFormServer=null;this.mFormName=null;this.mViewName=null;this.mFormOpeningArgs=null;this.mFormLoaded=false;this.inlineFormDisplayed=false}};DView.prototype.ClearInlineForm=function(){if(isLogicalWindow(this.mChildWindowID)){LogicalWindowOnUnload(this.mChildWindowID);wm.unregisterWindow(this.mChildWindowID);if(FocusMgr.mCurFocusWindowID==this.mChildWindowID){FocusMgr.mFocusStk=[];FocusMgr.mCurFocusID=0;FocusMgr.mCurFocusWindowID=this.windowID}this.ClearFloatingPanels()}};DView.prototype.isInlineForm=function(){return(this.mForm&&this.mChildWindowID!=null)};DView.prototype.GetDOMName=function(){return this.mFrameName};JFieldFactories.View=function(b,f,d){return new JView(b,f,d)};function JView(b,f,d){if(arguments.length){this.init(b,f,d)}}JView.prototype.G=function(){return this.mObj.v};JView.prototype.DoSet=function(b){this.mObj.v=b};TPAFieldFactories.View=function(b,f,d){return new TPAView(b,f,d)};function TPAView(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAView.prototype.DoSet=TPAView.prototype.DoSLoadEntry=function(b){if(b.isNull){this.val=Null}else{if(b instanceof CharType){this.val=b}else{if(b instanceof AttachmentType){this.val=new CharType(encodeURI(b.toURL()))}else{this.val=new CharType(b)}}}this.mTemplateName=null;if(!this.mModified){this.mModified=true}};DView.prototype.init=function(b,f,d){DView.superclass.init.call(this,b,f,d);this.mode=this.mObj.getAttribute("mode");this.mForm=false;this.mChildWindowID=null;this.mFormServer=null;this.mFormName=null;this.mViewName=null;this.mFormOpeningArgs=null;this.mFormLoaded=false;this.inlineFormDisplayed=false;this.clearInlineFormFlag=false;this.mFloatingPanels=[];this.mFloatingDialogPanels=[];this.mViewBorderColor=this.mObj.getAttribute("arviewbordercolor");this.mFrameName="VF"+this.mID+"_"+new Date().getTime()+"IF_"+b;if(!this.mode){this.mode=0}if(this.mode==0){this.mFrameHTML=" "+this.mObj.getAttribute("arvfframe");this.mFrameHTML=this.mFrameHTML.replace(DView.GlobalFuncRE,"F("+b+","+f+").ol");if(this.mContainerID!=null){this.mFrameHTML=this.mFrameHTML.replace(/(WIDTH:[^;]*;)|(width:[^;]*;)/g,"width:100%;");this.mFrameHTML=this.mFrameHTML.replace(/(HEIGHT:[^;]*;)|(height:[^;]*;)/g,"height:100%;")}this.mFrameHTML=this.mFrameHTML.replace(/(name=[^\s\>]+)|((name=\"[^\"]+\"))/g,'name="'+this.mFrameName+'"id="'+this.mFrameName+'"');this.mTemplateName=null;this.DataDefault();this.mViewObj=new DocView(this.mObj,this.mFrameName,this.mFrameHTML);getViewFields_NS(b)[this.mID]=this}this.ft=true};DView.prototype.UpdateVis=function(d){var b=false;if(this.mObj.style.display!=""){b=(this.mObj.style.display!="none")}else{b=(this.mObj.style.visibility!="hidden")}if(!b&&d){this.SetAsync(-1);if(this.IsInFlowLayout()||this.IsInFillLayout()){this.mObj.style.display="block"}this.mObj.style.visibility="inherit"}else{if(b&&!d){this.SetAsync(1);if(this.IsInFlowLayout()||this.IsInFillLayout()){this.mObj.style.display="none"}this.mObj.style.visibility="hidden"}}};DView.prototype.ResizeTo=function(f,b){var d=Math.round(b*(this.perHeight/100));var g=f;if(g<this.mMinWidth){g=this.mMinWidth}else{if(g>this.mMaxWidth){g=this.mMaxWidth}}if(d<this.mMinHeight){d=this.mMinHeight}else{if(d>this.mMaxHeight){d=this.mMaxHeight}}this.mObj.style.width=g+"px";this.mObj.style.height=d+"px";var k=this.GetFocusElement();if(k&&k.tagName=="IFRAME"){k.style.width=g+"px";k.style.height=d+"px"}if(this.mFormLoaded&&this.mForm&&this.mChildWindowID!=null){var h=wm.windowHandles[""+this.mChildWindowID];if(typeof h!="undefined"&&h!=null){FormPane.Layout(this.mChildWindowID)}}};DView.prototype.IsInFlowLayout=function(){var b=false;if(("GetParent" in this)){var d=this.GetParent();if(d&&d.mObj&&d.mObj.getAttribute("arfillstyle")==2){b=true}else{if((this.mObj.getAttribute("arflowid")==0)&&this.mObj.parentNode.getAttribute("arfillstyle")==2){b=true}}}return b};DView.prototype.IsInFillLayout=function(){var d=false;if(("GetParent" in this)){var b=this.GetParent();if(b&&b.mObj&&b.mObj.getAttribute("arfillstyle")==1){d=true}}return d};DView.prototype.OpenInlineForm=function(k,f,y,A,u,d,b,w){if(!w){this.mForm=true;if(this.mChildWindowID==null){this.mChildWindowID=allocWindowID_NS()}this.mFormServer=k;this.mFormName=f;this.mViewName=y;this.mFormOpeningArgs=u;this.inlineFormDisplayed=true;var s=k+"_"+f+"_"+y;var z=("uddjs_"+s+"_loaded").ARToJSIdentifier();var g=("formjs_"+s+"_loaded").ARToJSIdentifier();if(d&&(typeof window[z]=="undefined"||typeof window[g]=="undefined")){if(A.js){addAsScript(A.js);InjectFormUDD(k,f,y,A.cacheid,u.wname)}else{InjectFormJS(k,f,y,A.cacheid,u.wname)}}this.S(new CharType(A.body.replace(/WIN_0_/gm,"WIN_"+this.mChildWindowID+"_")))}var v=this.windowID;if(b==true){if(w){var o=[];var h=this.mChildWindowID;setWindowArgs_NS(h,u);buildStackForArgs(h,o,u);o.push({f:setARStateCurrent_NS,a:[h,0]});o.push({f:Field_ClearChanged,a:[h]});o.push({f:Field_Clear,a:[h,true]});if(getARStateCurrent_NS(h)!=0){o.push({t:getStateMgr_NS(h),f:getStateMgr_NS(h).ARStateChange,a:[h,0]})}setTimeout(function(){new WorkflowContext(h,o)},0)}else{setTimeout(function(){new WorkflowContext(v,[])},0)}}};DView.prototype.DOMClick=function(b){if(this.mQWidget==null){return}return this.mQWidget.DOMClick(b)};SelectionMenu.prototype=new Menu();SelectionMenu.prototype.constructor=SelectionMenu;SelectionMenu.superclass=Menu.prototype;function SelectionMenu(d,b){if(arguments.length){this.init(d,b)}}SelectionMenu.prototype.init=function(d,b){SelectionMenu.superclass.init.call(this,d.windowID,b);this.mField=d};SelectionMenu.prototype.Open=function(b){return{n:{f:SelectionMenu.superclass.Open,t:this,a:[b,3,30100,false]}}};SelectionMenu.prototype.HandleSelection=function(b){this.mField.HandleMenuSelection(b);promptBar.setToClear();if(getCurWFC_NS(this.windowID)!=null){return{n:{f:ExecuteWorkflow,a:[this.windowID,2,this.mField.mID]}}}else{new WorkflowContext(this.windowID,{f:ExecuteWorkflow,a:[this.windowID,2,this.mField.mID]})}};DEnumSel.prototype=new DataField();DEnumSel.prototype.constructor=DEnumSel;DEnumSel.superclass=DataField.prototype;TPAEnumSel.prototype=new Field();TPAEnumSel.prototype.constructor=TPAEnumSel;TPAEnumSel.superclass=Field.prototype;DOMFieldFactories.EnumSel=function(b,f,d){return new DEnumSel(b,f,d)};function DEnumSel(b,f,d){if(arguments.length){this.init(b,f,d)}}DEnumSel.prototype.init=function(windowID,id,n){var np=n.childNodes[2];this.mInputNode=np.childNodes[1];var menuStruct=np.getAttribute("arselmenu");var inMenudef=eval(menuStruct);var menudef=[];var iOrder=[];var mIndex=0;for(var i=0;i<inMenudef.length;++i){if(!("ci" in inMenudef[i])){mIndex=i}else{mIndex=inMenudef[i].ci}menudef[mIndex]={};menudef[mIndex].ord=i;menudef[mIndex].v=inMenudef[i].v.ValidatorUnEscape();if(!("l" in inMenudef[i])){menudef[mIndex].l=inMenudef[i].v.ValidatorUnEscape()}else{menudef[mIndex].l=inMenudef[i].l.ValidatorUnEscape()}iOrder[i]=mIndex}this.mMenuDef=menudef;this.mOrder=iOrder;DEnumSel.superclass.init.call(this,windowID,id,n)};TPAFieldFactories.EnumSel=function(b,f,d){return new TPAEnumSel(b,f,d)};function TPAEnumSel(b,f,d){if(arguments.length){this.init(b,f,d)}}DEnumSel.getClearValue=function(){var b=getLocalizedMessage("(clear)");return{l:b,v:""}};DEnumSel.prototype.GetFocusElement=function(){return this.mInputNode};TPAEnumSel.prototype.ConvertPrimitiveToDataType=DEnumSel.prototype.ConvertPrimitiveToDataType=function(g){var f=this.mMenuDef;if(g!=""){g=g.HTMLEncode();for(var b in f){if(f[b].l==g){return new EnumType(b,ExpandString(this.windowID,f[b].l,2|4))}}if(!isNaN(g)){var d=f[g];if(d!=null){return new EnumType(g,ExpandString(this.windowID,d.l,2|4))}}}return Null};TPAEnumSel.prototype.ConvertDTForSLE=DEnumSel.prototype.ConvertDTForSLE=function(g){var f=this.mMenuDef;if(g.type==6){var d=g.toInteger();var b=f[d];if(b!=null){return new EnumType(d,ExpandString(this.windowID,b.l.HTMLDecode(),2|4))}}return Null};TPAEnumSel.prototype.ConvertDTForS=DEnumSel.prototype.ConvertDTForS=function(k){if(!this.mMenuDef&&this instanceof TPAEnumSel){this.buildEnumSelMenu()}var h=this.mMenuDef;var b=k.toString().HTMLEncode();switch(k.type){case 6:var g=k.toInteger();var f=h[g];if(f!=null){return new EnumType(g,ExpandString(this.windowID,f.l.HTMLDecode(),2|4))}else{return Null}break;default:if(k.type==4||k.type==5){if(b==""){return Null}for(var d in h){if(h[d].l==b){return new EnumType(d,ExpandString(this.windowID,h[d].l,2|4))}}}var g=k.toInteger();var f=h[g];if(f!=null){return new EnumType(g,ExpandString(this.windowID,f.l.HTMLDecode(),2|4))}else{return Null}}};TPAEnumSel.prototype.buildEnumSelMenu=function(){var g=F(this.windowID,this.cmid);if("e" in g.mObj){var k=g.mObj.e;var h=[];var d=[];var b=0;for(var f in k){h[f]={};h[f].ord=b;h[f].v=k[f].v.ValidatorUnEscape();h[f].l=k[f].l.ValidatorUnEscape();d[b++]=f}this.mMenuDef=h;this.mOrder=d}};TPAEnumSel.prototype.GP=DEnumSel.prototype.GP=function(){var b=this.G();if(b.isNull){return Null}var d=b.mValue;return this.GetValueForPush(d)};DEnumSel.prototype.GetValueForPush=function(d){var f=this.mMenuDef;var b=f[d];if(b!=null){return new EnumType(d,ExpandString(this.windowID,b.v.HTMLDecode(),2|4))}else{return Null}};TPAEnumSel.prototype.GetValueForPush=function(b){if((typeof this.mObj!="undefined")&&(typeof this.mObj.e!="undefined")&&this.mObj.e[b]!=null){return new EnumType(b,ExpandString(this.windowID,this.mObj.e[b].HTMLDecode(),2|4))}else{return Null}};TPAEnumSel.prototype.FieldValChanged=function(b,d){if(d){this.mDataVal=this.ConvertPrimitiveToDataType(d)}else{this.mDataVal=Null}this.DoSet(this.mDataVal)};TPAEnumSel.prototype.FindContainingDiv=function(b){while(b.nodeType!=1||(b.tagName!="DIV")){b=b.parentNode}return b};DEnumSel.prototype.GetFirst=function(){var b=this.mOrder;return b[0]};DEnumSel.prototype.GetLast=function(){var b=this.mOrder;return b[b.length-1]};DEnumSel.prototype.GetNext=function(g){var b=this.mOrder;var f=this.mMenuDef;var d=f[g].ord;if(d!=null){d++;if(d>=b.length){return -1}else{return b[d]}}return -1};DEnumSel.prototype.GetPrev=function(g){var b=this.mOrder;var f=this.mMenuDef;var d=f[g].ord;if(d!=null){d--;if(d<0){return -1}else{return b[d]}}return -1};TPAEnumSel.prototype.DoSet=TPAEnumSel.prototype.DoSLoadEntry=function(b){if(b.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,b)){this.mObj.v=new CharType(b.toString())}else{this.mObj.v=this.ConvertDTForS(b)}}};DEnumSel.prototype.UpdateAccess=function(b){DEnumSel.superclass.UpdateAccess.call(this,b);this.mInputNode.readOnly=1};DEnumSel.prototype.mHaveStoredData=true;DEnumSel.prototype.mDataType=6;TPAEnumSel.prototype.G=function(){var g=this.mObj.v;if(g.isNull){return g}else{var b=g.toString();var f=F(this.windowID,this.cmid);for(var d in f.mObj.e){if(f.mObj.e[d].l==b){this.mObj.v=new EnumType(d,b);return this.mObj.v}}if(g.type==6||b.isDigits()){if(g.type==4||g.type==5){if(!b.isNumeric()){return Null}}b=g.toInteger();for(var d in f.mObj.e){if(d==b){this.mObj.v=new EnumType(b,f.mObj.e[b].l);return this.mObj.v}}}this.mObj.v=Null;return Null}};DEnum.prototype=new DataField();DEnum.prototype.constructor=DEnum;DEnum.superclass=DataField.prototype;JEnum.prototype=new Field();JEnum.prototype.constructor=JEnum;JEnum.superclass=Field.prototype;TPAEnum.prototype=new Field();TPAEnum.prototype.constructor=TPAEnum;TPAEnum.superclass=Field.prototype;DOMFieldFactories.Enum=function(b,f,d){return new DEnum(b,f,d)};function DEnum(b,f,d){if(arguments.length){this.init(b,f,d)}}DEnum.prototype.clear=function(){if(this.mSelected!=null){this.mSelected.checked=false;this.mSelected=null;this.mSelectedIdx=null}};DEnum.prototype.GetScreenValAsPrimitive=function(){if(this.mSelectedIdx!=null){return this.mSelectedIdx}return""};DEnum.prototype.GetScreenValue=function(){if(this.mSelectedIdx==null){return""}return this.mNumToAlias[this.mSelectedIdx]};DEnum.prototype.ConvertPrimitiveToDataType=function(b){if(this.mSelectedIdx!=null){return new EnumType(this.mSelectedIdx,ExpandString(this.windowID,this.mNumToAlias[this.mSelectedIdx],2|4))}return Null};DEnum.prototype.ConvertDTForSLE=function(d){var b=d.toInteger();if(b in this.mNumToAlias){return new EnumType(b,ExpandString(this.windowID,this.mNumToAlias[b],2|4))}else{return Null}};DEnum.prototype.ConvertDTForS=function(f){var d=f.toString();switch(f.type){case 6:d=f.toInteger();if(d in this.mNumToAlias){return new EnumType(d,ExpandString(this.windowID,this.mNumToAlias[d],2|4))}break;default:if(f.type==4||f.type==5){var g=this.mAliasToNode[d];if(g){var b=g.value;return new EnumType(b,ExpandString(this.windowID,this.mNumToAlias[b],2|4))}}d=f.toInteger();if(d in this.mNumToAlias){return new EnumType(d,ExpandString(this.windowID,this.mNumToAlias[d],2|4))}}return Null};DEnum.prototype.GP=TPAEnum.prototype.GP=JEnum.prototype.GP=function(){var b=this.G();if(b.isNull){return Null}var d=b.mValue;return this.GetValueForPush(d)};DEnum.prototype.GetValueForPush=function(d){var b=this.mNumToAlias[d];if(!b){return Null}var f=this.mAliasToNode[b];if(!f){return Null}var g=f.getAttribute("arvalue");if(!g){g=b}return new EnumType(d,ExpandString(this.windowID,g.HTMLDecode(),2|4))};TPAEnum.prototype.GetValueForPush=JEnum.prototype.GetValueForPush=function(d){if("vl" in this.mObj){var b=this.mObj.vl[d];return new EnumType(d,ExpandString(this.windowID,b,2|4))}return Null};TPAEnum.prototype.FieldValChanged=function(b,d){if(d){this.mDataVal=new EnumType(d,ExpandString(this.windowID,this.mNumToAlias[d],2|4))}else{this.mDataVal=Null}this.DoSet(this.mDataVal)};DEnum.prototype.SToScreen=function(g,f){var b=this.mSelected;this.clear();if(g.isNull){this.SetDirty(b)}else{var d=this.mNumToAlias[g.mValue];var h=this.mAliasToNode[d];h.checked=true;this.mSelected=h;this.mSelectedIdx=h.value;this.SetDirty(h)}if(typeof AnimMgr!="undefined"){AnimMgr.Highlight(this,this.mObj)}};TPAEnum.prototype.GetElementForARType=function(f){var d=document.body;while(f&&f!=d){var b=f.getAttribute("artype");if(b){return f}f=f.parentNode}return null};TPAEnum.prototype.DOMClick=function(b,d){if(this.GAccess()!=2){return}var h=b.element;var g=this.mSelected;this.initVariable(h);this.mSelected=null;this.mSelectedIdx=null;if(h.tagName=="LABEL"){h=h.previousSibling}var k;if((h.tagName=="INPUT")&&(g==h)){g.checked=false;k=Null}else{h.checked=true;for(var f in this.mAliasToNode){var o=this.mAliasToNode[f];if(o.checked&&this.mSelected==null){this.mSelected=o;this.mSelectedIdx=o.value;k=new EnumType(this.mSelectedIdx,ExpandString(this.windowID,this.mNumToAlias[this.mSelectedIdx],2|4))}else{o.checked=false}}}this.DoSet(k);if((d in getFields_NS(this.windowID))&&(getFields_NS(this.windowID)[d].mObj.pnt in getFields_NS(this.windowID))){getFields_NS(this.windowID)[getFields_NS(this.windowID)[d].mObj.pnt].HandleEnumValChanged(b,this.mSelectedIdx)}};DEnum.prototype.MouseSelectable=false;DEnum.prototype.mDataType=6;DEnum.prototype.mNeedSpecialSetToScreen=true;JFieldFactories.Enum=function(b,f,d){return new JEnum(b,f,d)};function JEnum(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAFieldFactories.Enum=function(b,f,d){return new TPAEnum(b,f,d)};function TPAEnum(b,f,d){if(arguments.length){this.init(b,f,d)}}TPAEnum.prototype.G=JEnum.prototype.G=function(){var f=this.mObj.v;if(f.isNull){return f}else{var b=f.toString();for(var d in this.mObj.e){if(this.mObj.e[d]==b){this.mObj.v=new EnumType(d,b);return this.mObj.v}}if(f.type==6||b.isDigits()){if(f.type==4||f.type==5){if(!b.isNumeric()){return Null}}b=f.toInteger();for(var d in this.mObj.e){if(d==b){this.mObj.v=new EnumType(b,this.mObj.e[b]);return this.mObj.v}}}this.mObj.v=Null;return Null}};TPAEnum.prototype.ConvertDTForS=JEnum.prototype.ConvertDTForS=function(f){var b=f.toString();switch(f.type){case 6:b=f.toInteger();for(var d in this.mObj.e){if(d==b){return new EnumType(b,this.mObj.e[b])}}break;default:if(f.type==4||f.type==5){for(var d in this.mObj.e){if(this.mObj.e[d]==b){return new EnumType(d,b)}}}b=f.toInteger();for(var d in this.mObj.e){if(d==b){return new EnumType(b,this.mObj.e[b])}}}return Null};TPAEnum.prototype.DoSet=TPAEnum.prototype.DoSLoadEntry=JEnum.prototype.DoSet=JEnum.prototype.DoSLoadEntry=function(b){if(b.isNull){this.mObj.v=Null}else{if(ARKWIsKeywordString(this.windowID,b)){this.mObj.v=new CharType(b.toString())}else{this.mObj.v=this.ConvertDTForS(b)}}if(this instanceof JEnum){this.SetDirty()}};DEnum.prototype.mHaveStoredData=TPAEnum.prototype.mHaveStoredData=JEnum.prototype.mHaveStoredData=true;TPAEnum.prototype.GetEnumValues=JEnum.prototype.GetEnumValues=function(){return this.mObj.e};TPAEnum.prototype.GetSorter=JEnum.prototype.GetSorter=function(){return"(ls=parseInt(lhs),rs=parseInt(rhs),(isNaN(ls)?0:ls)-(isNaN(rs)?0:rs))"};TPAEnum.prototype.getFirst=function(d){if(!("mAliasToNode" in this)){this.initVariable(d)}for(var b in this.mAliasToNode){return this.mAliasToNode[b]}return null};TPAEnum.prototype.initVariable=function(b){this.mSelected=null;this.mSelectedIdx=null;this.mNumIndexes=0;this.mNumToAlias={};this.mAliasToNode={};this.mLabelToNode={};var d=this.GetElementForARType(b);this.iterate(function(k,f){var h=k.nextSibling.firstChild.data;h=h.replaceNBSP();this.mNumToAlias[k.value]=h;this.mAliasToNode[h]=k;var g=k.getAttribute("arvalue");if(g){this.mLabelToNode[g]=k}this.mNumIndexes++;if(k.checked){this.mSelected=k;this.mSelectedIdx=k.value}},d)};DEnumSel.prototype.TabableElementSelector=function(f){var b=this.mObj.childNodes[2];var d=b.className.indexOf("dat");if(f.tagName=="A"&&d!=-1&&this.GAccess()!=2){return null}return DEnumSel.superclass.TabableElementSelector.call(this,f)};TPAEnumSel.prototype.DOMClick=DEnumSel.prototype.DOMClick=function(d,f){DEnumSel.superclass.DOMClick.call(this,d);if(this.GAccess()!=2){return}if(this instanceof TPAEnumSel){var k=this.FindContainingDiv(d.element);this.cmid=f;this.curevt=d}if(!this.mMenu||this instanceof TPAEnumSel){if(this instanceof TPAEnumSel){this.mInputNode=k.childNodes[1];this.buildEnumSelMenu()}var h=this.mMenuDef;var b=this.mOrder;var o=[];for(var g=0;g<b.length;g++){o.push({v:h[b[g]].l,l:h[b[g]].l})}o.push(DEnumSel.getClearValue());this.mMenu=new SelectionMenu(this,o)}if(this instanceof TPAEnumSel){return{n:{f:this.mMenu.Open,a:[k],t:this.mMenu}}}else{return{n:{f:this.mMenu.Open,a:[this.mObj.childNodes[2]],t:this.mMenu}}}};DEnumSel.prototype.DOMKeyDown=function(b){if(this.GAccess()!=2){return}var d=b.key;if(d==38||d==40||d==37||d==39){var f=this.G();if(f.isNull){f=(d==38||d==37)?this.GetLast():this.GetFirst()}else{f=f.toInteger();f=(d==38||d==37)?this.GetPrev(f):this.GetNext(f)}if(f==-1){this.S(Null)}else{this.S(new EnumType(f,ExpandString(this.windowID,this.mMenuDef[f].l,2|4)))}b.StopDefault();return ExecuteWorkflow(this.windowID,2,this.mID)}};TPAEnumSel.prototype.HandleMenuSelection=DEnumSel.prototype.HandleMenuSelection=function(d){var b=this.mInputNode;b.value=d;this.FieldValChanged();if(this instanceof DEnumSel){this.SetDirty(b)}if((this.cmid!=null)&&(this.curevt!=null)){if((this.cmid in getFields_NS(this.windowID))&&(getFields_NS(this.windowID)[this.cmid].mObj.pnt in getFields_NS(this.windowID))){getFields_NS(this.windowID)[getFields_NS(this.windowID)[this.cmid].mObj.pnt].HandleEnumSelValChanged(this.curevt,d)}}this.DoSet(new CharType(d))};DEnumSel.prototype.DOMFocus=function(b){var d=this.mObj.childNodes[2];var f=d.className.indexOf("dat");if(f!=-1&&this.GAccess()==2){this.mDAT=1;d.className=d.className.replace(/(\s*dat)/g,"")}return DEnumSel.superclass.DOMFocus.call(this,b)};DEnumSel.prototype.DOMBlur=function(b){if(this.mDAT){delete this.mDAT;this.mObj.childNodes[2].className+=" dat"}return DEnumSel.superclass.DOMBlur.call(this,b)};DEnumSel.prototype.DOMMouseOver=function(b){this.mInputNode.title=this.mInputNode.value;DEnumSel.superclass.DOMMouseOver.call(this,b)};TPAEnumSel.prototype.resetFocusTab=DEnumSel.prototype.resetFocusTab=function(f){if(f.tagName!="INPUT"){return}if(this.mDataVal&&this.mDataVal.isNull){return}var b=this.mObj.childNodes[2];var d=b.className.indexOf("dat");if(d!=-1&&this.GAccess()==1){return}f.select()};DEnum.prototype.init=function(b,f,d){this.mSelected=null;this.mSelectedIdx=null;this.mNumIndexes=0;this.mNumToAlias={};this.mAliasToNode={};this.mLabelToNode={};this.iterate(function(o,g){var k=o.nextSibling.firstChild.data;k=k.replaceNBSP();this.mNumToAlias[o.value]=k;this.mAliasToNode[k]=o;var h=o.getAttribute("arvalue");if(h){this.mLabelToNode[h]=o}this.mNumIndexes++;if(o.checked){this.mSelected=o;this.mSelectedIdx=o.value}},d);DEnum.superclass.init.call(this,b,f,d)};TPAEnum.prototype.iterate=JEnum.prototype.iterate=DEnum.prototype.iterate=function(k,f){var h=f?f:this.mObj.childNodes[2];var b=0;var g=h;while(1){if(h.nodeType==1&&h.tagName=="INPUT"){b=h.value;var d=k.call(this,h,b);if(typeof d!="undefined"){return d}}if(h.firstChild){h=h.firstChild}else{while(!h.nextSibling){h=h.parentNode;if(h==g){return}}h=h.nextSibling}}};DEnum.prototype.GetDataPortion=function(){return this.mObj.getElementsByTagName("fieldset")[0]};DEnum.prototype.TabableElementSelector=function(b){if(b.tagName=="INPUT"&&!b.disabled){if(this.mSelected==b){return b}var d=this.getFirst();if(d&&this.mSelected==null&&d==b){return b}if(d&&d==b&&b.type=="checkbox"&&this.mSelected!=null){return b}}return null};DEnum.prototype.GetFocusElementForEvent=function(b){if(this.GetNestedFocusability()){var d=b.element;if(d.tagName=="LABEL"){d=d.previousSibling;if(d==null){return null}}if(d.tagName=="INPUT"){return d}else{return DEnum.superclass.GetFocusElementForEvent.call(this,b)}}return null};DEnum.prototype.DOMClick=function(b){DEnum.superclass.DOMClick.call(this,b);if(this.GAccess()!=2){return}var g=b.element;var f=this.mSelected;this.mSelected=null;this.mSelectedIdx=null;if((g.tagName=="INPUT")&&(f==g)){f.checked=false}else{for(var d in this.mAliasToNode){var h=this.mAliasToNode[d];if(h.checked&&this.mSelected==null){this.mSelected=h;this.mSelectedIdx=h.value}else{h.checked=false}}}if(this.mSelected!=f){this.FieldValChanged();this.SetDirty((this.mSelected!=null)?this.mSelected:f);return ExecuteWorkflow(this.windowID,2,this.mID)}};DEnum.prototype.GetFocusElement=function(){if(this.mSelected){return this.mSelected}else{return DEnum.superclass.GetFocusElement.call(this)}};DEnum.prototype.getPrev=function(g){if(g.tagName!="INPUT"){return null}var f=g.value;var d=null;for(var b in this.mNumToAlias){if(b==f){break}else{d=this.mNumToAlias[b]}}if(d==null){return this.getLast()}else{return this.mAliasToNode[d]}};DEnum.prototype.getNext=function(h){if(h.tagName!="INPUT"){return null}var g=h.value;var b=null;var f=false;for(var d in this.mNumToAlias){if(d==g){f=true}else{if(f==true){b=this.mNumToAlias[d];break}}}if(b!=null){return this.mAliasToNode[b]}else{return this.getFirst()}};DEnum.prototype.getFirst=function(){for(var b in this.mAliasToNode){return this.mAliasToNode[b]}return null};DEnum.prototype.getLast=function(){var d=null;for(var b in this.mAliasToNode){d=this.mAliasToNode[b]}return d};DEnum.prototype.DOMKeyDown=function(b){if(this.GAccess()!=2){return}var f=b.key;if(f==37||f==39||f==38||f==40){var h=this.G();var d=null;if(h.isNull){d=this.getFirst()}else{if(f==37||f==38){d=this.getPrev(this.mAliasToNode[this.mNumToAlias[h.mValue]])}else{d=this.getNext(this.mAliasToNode[this.mNumToAlias[h.mValue]])}}d=d.value;this.S(new EnumType(d));if(f==37||f==39||f==38||f==40){for(var g in this.mAliasToNode){var k=this.mAliasToNode[g];if(k.value==d){k.focus()}}}b.StopDefault();return ExecuteWorkflow(this.windowID,2,this.mID)}};DEnumSel.prototype.HighlightBorder=function(){var b=this.mInputNode.parentNode;b.className+=" bHighlight";getStateMgr_NS(this.windowID).highlightedFlds.push(this.mID)};DEnumSel.prototype.RemoveHighlightBorder=function(){this.mInputNode.parentNode.className=this.mInputNode.parentNode.className.replace("bHighlight","")};var PageHolderFactories={};TabView.prototype.constructor=TabView;TabView.prototype.constructor=TabView;function TabView(b){this.init(b)}PageHolderFactories.TabView=function(b){return new TabView(b)};TabView.prototype.SelectTab=function(b){if(b!=this.mSelectedTab){this.mSelectedTab=b;if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}};TabView.prototype.init=function(b){this.mParentObj=b;this.mObj=this.mParentObj.mObj;this.mID=this.mParentObj.mID;this.windowID=this.mParentObj.windowID;var o=this.mObj;this.mTabs=[];this.mChildren=[];this.mMissingBorderObj=null;this.mScrollingTabs=[];this.mTabH=parseInt(o.getAttribute("armaxh"));this.mViewPort;this.mCanvas;this.mLastVisibleTab;this.mFirstVisibleTab=0;this.mOuterTab=null;this.mMissingBorder=null;this.mInitialLayout=true;var d=parseInt(o.style.height)-this.mTabH;if(d<0){d=0}for(var k=o.firstChild;k;k=k.nextSibling){if(k.nodeType==1){if(k.className=="TabChildMissingBorder"){this.mMissingBorderObj=k}else{if(k.className.indexOf("TabChild")==0){if(k.getAttribute("arradius")!=null){k.style.border="1px solid #aebac1"}this.mChildren.push(k);k.style.top=this.mTabH+"px";k.style.height=d+"px"}else{if(k.className.indexOf("OuterTabsDiv")==0){this.mOuterTab=k;for(var h=k.firstChild;h;h=h.nextSibling){if(h.nodeType==1){if(h.className.indexOf("ScrollingTab")==0){this.mScrollingTabs.push(h)}else{if(h.className.indexOf("TabsViewPort")==0){this.mViewPort=h;var f=h.getElementsByTagName("DL")[0];this.mCanvas=f.parentNode;if(f.className.indexOf("OuterOuterTab")==0){for(var g=f.firstChild;g;g=g.nextSibling){if(g.nodeType==1&&g.className=="OuterTab"){g.setAttribute("arwindowid",this.windowID);this.mTabs.push(g)}}}}}}}}else{if(k.className.indexOf("OuterOuterTab")!=0){k.style.zIndex=parseInt(k.style.zIndex)+5000;k.style.top=parseInt(k.style.top)+this.mTabH+1+"px";k.style.left=parseInt(k.style.left)+1+"px"}}}}}}this.mItems=this.mTabs.length;this.mSelectedTab=-1};TabView.prototype.ResizeChildren=function(){if(this.mParentObj.mContainerID!=null||this.mParentObj.mFloat==2||this.mParentObj.mFlowID==0){var b=this.mObj.offsetHeight-this.mTabH;if(this.mMissingBorderObj&&this.mMissingBorderObj.style.width!="100%"){this.mMissingBorderObj.style.width="100%"}if(this.mOuterTab&&this.mOuterTab.style.width!="100%"){this.mOuterTab.style.width="100%"}for(var d in this.mChildren){if(this.mChildren[d].style.width!="100%"){this.mChildren[d].style.width="100%"}this.mChildren[d].style.height=((b<0)?0:b)+"px"}if(this.mParentObj.mAsyncMode==0){this.DoLayout();return}this.ResizeChildrenInSelectedTab()}};TabView.prototype.DoLayout=function(){if(this.mItems<=0){return}if(this.mOuterTab!=null){this.mOuterTab.style.visibility="inherit"}if(this.mMissingBorder!=null){this.mMissingBorder.style.visibility="inherit"}if(this.mTabH!=0&&this.mFirstVisibleTab!=-1){this.mTabs[this.mFirstVisibleTab].firstChild.className="TabLeft";this.mFirstVisibleTab=-1;if((typeof this.mLastVisibleTab!="undefined")){var w=this.mTabs[this.mLastVisibleTab].getElementsByTagName("Span");if(w!=null&&w.length>2){w[2].className="TabRight"}}}var o=0,u=0,v=-1,k=false;for(var s=0;s<this.mItems;++s){var B=this.mTabs[s],b=this.mChildren[s];if(B.className.indexOf("OuterTabSelected")!=-1){B.style.width="";var h=b.style.zIndex;b.style.zIndex=h-1;B.className=B.className.replace(/OuterTabSelected/,"OuterTab");b.style.visibility="hidden";if(getCurWFC_NS(this.windowID)){AsyncField_IncrAsyncRef(this.windowID,b.getAttribute("arid"),1)}}if(this.mTabH==0){B.style.visibility="hidden"}else{B.style.top="1px"}B.style.zIndex=1;B.style.left=o+"px";if(b.getAttribute("arvisibility")=="hidden"){B.style.visibility="hidden";B.style.display="none";if(this.mSelectedTab==s){k=true}b.style.left=(s*-2000)+"px"}else{if(this.mFirstVisibleTab==-1){B.firstChild.className="TabLeftRounded";this.mFirstVisibleTab=s}b.style.left="0px";if(this.mTabH!=0){B.style.visibility="inherit";B.style.display="block"}if(v==-1){v=s}}var d=B.childNodes[2].offsetWidth+10;o+=d;if(this.mTabs[s].style.visibility!="hidden"){u+=d;this.mLastVisibleTab=s}}if(k||this.mSelectedTab==-1){this.mSelectedTab=v}if(this.mSelectedTab==-1){if(this.mMissingBorderObj!=null){this.mMissingBorderObj.style.visibility="hidden"}for(var A=0;A<this.mScrollingTabs.length;A++){this.mScrollingTabs[A].style.display="none"}return}else{if(this.mMissingBorderObj!=null){this.mMissingBorderObj.style.visibility="inherit"}}var B=this.mTabs[this.mSelectedTab],b=this.mChildren[this.mSelectedTab];B.style.top=(this.mTabH==0?-1000:1)+"px";B.style.zIndex=3;b.style.visibility="inherit";var h=parseInt(b.style.zIndex);if(!isNaN(h)){b.style.zIndex=h+1}B.className=B.className.replace(/OuterTab/,"OuterTabSelected");var z=parseInt(this.mObj.style.width);if(this.mTabH!=0){var y=0;if(u<=z){for(var A=0;A<this.mScrollingTabs.length;A++){this.mScrollingTabs[A].style.display="none"}}else{for(var A=0;A<this.mScrollingTabs.length;A++){this.mScrollingTabs[A].style.display="block";y+=this.mScrollingTabs[A].offsetWidth}}if(z-y<0){if(getCurWFC_NS(this.windowID)){AsyncField_IncrAsyncRef(this.windowID,b.getAttribute("arid"),-1)}return}else{this.mViewPort.style.width=(z-y-1)+"px"}this.mViewPortWidth=(z-y);this.mCanvas.style.width=(u>this.mViewPortWidth?u:this.mViewPortWidth)+"px";var g=parseInt(this.mCanvas.style.left);if(g<0&&g<z-y-u){g=(z-y)-u;this.mCanvas.style.left=(g<0?g:0)+"px"}if(g==0){this.mScrollingTabs[0].disabled=true;this.mScrollingTabs[0].childNodes[3].firstChild.style.color="gray"}if(this.mViewPortWidth-g<u){this.mScrollingTabs[1].disabled=false;this.mScrollingTabs[1].childNodes[3].firstChild.style.color=""}var f=this.mTabs[this.mLastVisibleTab];var w=f.getElementsByTagName("Span");if(w!=null){if(w!=null&&w.length>2){w[2].className="TabRightRounded"}}}if(getCurWFC_NS(this.windowID)){AsyncField_IncrAsyncRef(this.windowID,b.getAttribute("arid"),-1)}this.ResizeChildrenInSelectedTab();this.mInitialLayout=false};TabView.prototype.ResizeChildrenInSelectedTab=function(){var b=(this.mSelectedTab!=-1)?parseInt(this.mChildren[this.mSelectedTab].getAttribute("arid")):-1;if(b!=-1){getFields_NS(this.windowID)[b].ResizeChildren()}};TabView.prototype.G=function(){if(this.mSelectedTab==-1){for(var b=0;b<this.mChildren.length;b++){if(this.mChildren[b].getAttribute("arvisibility")!="hidden"){return new CharType(this.mChildren[b].getAttribute("ardbn"))}}return Null}if(typeof this.mSelectedTab!="undefined"){return new CharType(this.mChildren[this.mSelectedTab].getAttribute("ardbn"))}return Null};TabView.prototype.DoSet=TabView.prototype.DoSLoadEntry=function(f){f=f.toString();for(var b=0;b<this.mItems;++b){var d=this.mChildren[b];if(d.getAttribute("ardbn")==f&&d.getAttribute("arvisibility")!="hidden"){this.SelectTab(b);return}}};TabView.prototype.TabableElementSelector=function(d){if(d.tagName=="A"){var b=d.parentNode.parentNode;if(this.mTabs[this.mSelectedTab==-1?0:this.mSelectedTab]==b){return d}}return null};TabView.prototype.GetTabForID=function(b){var f=b+"";for(var d=0;d<this.mItems;++d){if(this.mTabs[d].getAttribute("artabid")==f){return this.mTabs[d]}}return null};TabView.prototype.GetTextElement=function(b){return this.GetTabForID(b).childNodes[2].childNodes[0]};TabView.prototype.GetTabIndexForID=function(b){var f=b+"";for(var d=0;d<this.mItems;++d){if(this.mTabs[d].getAttribute("artabid")==f){return d}}return null};TabView.prototype.GetFocusElementForEvent=function(b){if(this.mParentObj.GetNestedFocusability()){var f=b.element;for(var d=0;d<this.mItems;++d){if(this.mTabs[d]==f||this.mTabs[d].childNodes[2]==f||this.mTabs[d].childNodes[2].childNodes[0]==f){return this.mTabs[d].childNodes[2].childNodes[0]}}if(f.id=="prevTab"||f.id=="nextTab"){return f}}return null};TabView.prototype.DragHandler=function(b){};TabView.prototype.DOMClick=function(b){var d=b.element;if(d.id=="prevTab"){this.scrollTabsLeftward()}else{if(d.id=="nextTab"){this.scrollTabsRightward()}}};TabView.prototype.scrollTabsLeftward=function(o){if(this.isTablessBorderless()){return}if(!this.mScrollingTabs[0].disabled){this.mScrollingTabs[1].disabled=false;this.mScrollingTabs[1].childNodes[3].firstChild.style.color="";var d=parseInt(this.mCanvas.style.left);var f=0;var b=this.mTabs.length;var k;for(var g=0;g<b;g++){k=g;if(this.mTabs[k].style.visibility!="hidden"){var h=this.mTabs[k].childNodes[2].offsetWidth+10;if(g==0||g==b-1){h-=2}if(f+h>=-d||o==g){this.mCanvas.style.left=-f+"px";if(f==0){this.mScrollingTabs[0].disabled=true;this.mScrollingTabs[0].childNodes[3].firstChild.style.color="gray"}break}f+=h}}}};TabView.prototype.scrollTabsRightward=function(o){if(this.isTablessBorderless()){return}if(!this.mScrollingTabs[1].disabled){this.mScrollingTabs[0].disabled=false;this.mScrollingTabs[0].childNodes[3].firstChild.style.color="";var f=0,d=0;f=d=parseInt(this.mCanvas.style.left);var b=this.mTabs.length;var k;for(var g=0;g<b;g++){k=g;if(this.mTabs[k].style.visibility!="hidden"){var h=this.mTabs[k].childNodes[2].offsetWidth+10;if(g==0||g==b-1){h-=2}f+=h;if(f>this.mViewPortWidth){this.mCanvas.style.left=-(f-this.mViewPortWidth-d)+"px";if(g==this.mLastVisibleTab){this.mScrollingTabs[1].disabled=true;this.mScrollingTabs[1].childNodes[3].firstChild.style.color="gray"}if(o==undefined||o==g){break}}}}}};TabView.prototype.DOMKeyDown=function(b){var d=-1;if(b.key==39){for(var f=this.mSelectedTab+1;f<this.mTabs.length;f++){if(this.mChildren[f].getAttribute("arvisibility")!="hidden"){d=this.mTabs[f].getAttribute("artabid");break}}}else{if(b.key==37){var f=(this.mSelectedTab>0)?this.mSelectedTab-1:((this.mTabs.length>0)?0:-1);for(;f>=0;f--){if(this.mChildren[f].getAttribute("arvisibility")!="hidden"){d=this.mTabs[f].getAttribute("artabid");break}}}}if(d>0){do{if(!(d.isDigits())){Assert("(PageHolder.js:538) newTabId.isDigits()")}}while(0);d=parseInt(d);b.mStoppedDefault=true;return{c:{t:FocusMgr,f:FocusMgr.SetFocusToField,a:[this.windowID,d]}}}};TabView.prototype.DOMFocus=function(b){var d=b.element;if(d.tagName=="A"){if(d.id=="nextTab"||d.id=="prevTab"){return}d=d.parentNode.parentNode}return{c:{f:ExecuteWorkflow,a:[this.windowID,8192,this.mID]},n:{t:this,f:this.domFocusP2,a:[d]}}};TabView.prototype.domFocusP2=function(d){var f=(this.mSelectedTab!=-1)?parseInt(this.mChildren[this.mSelectedTab].getAttribute("arid")):-1;var b=(d.className.indexOf("TabChild")==0)?parseInt(d.getAttribute("arid")):d.className.indexOf("Tab")==0?parseInt(d.parentNode.getAttribute("artabid")):parseInt(d.getAttribute("artabid"));if((f!=b)&&(f!=-1)&&(f==FocusMgr.mCurFocusID)){return{c:{f:ExecuteWorkflow,a:[this.windowID,256,f]},n:{t:this,f:this.domFocusP3,a:[b],e:this.focusExceptionHandler,ea:[this.mSelectedTab]}}}else{return{n:{t:this,f:this.domFocusP3,a:[b],e:this.focusExceptionHandler,ea:[this.mSelectedTab]}}}};TabView.prototype.focusExceptionHandler=function(b,d){this.SelectTab(d);throw b};TabView.prototype.domFocusP3=function(h){var u=h+"";for(var d=0;d<this.mItems;++d){if(this.mTabs[d].getAttribute("artabid")==u){var b=this.mSelectedTab;this.SelectTab(d);if(!this.isTablessBorderless()){if(!this.mViewPortWidth){var v=parseInt(this.mObj.style.width);var o=0;for(var y=0;y<this.mScrollingTabs.length;y++){o+=this.mScrollingTabs[y].offsetWidth}this.mViewPortWidth=v-o}var f=parseInt(this.mTabs[d].style.left);var s=f+this.mTabs[d].childNodes[2].offsetWidth+(this.mTabs[d].childNodes[0].offsetWidth*2);var g=this.mViewPortWidth;var k=parseInt(this.mCanvas.style.left);var w=-k+g;if(f<-k){this.scrollTabsLeftward(d)}else{if(s>w){this.scrollTabsRightward(d)}}}return{c:{f:ExecuteWorkflow,a:[this.windowID,256,this.mID]},n:{t:this,f:this.domFocusP4,a:[h],e:this.focusExceptionHandler,ea:[b]}}}}};TabView.prototype.domFocusP4=function(b){FocusMgr.mCurFocusID=b;FocusMgr.mCurFocusWindowID=this.windowID;return{c:{f:ExecuteWorkflow,a:[this.windowID,8192,b]}}};TabView.prototype.GetFocusElement=function(){return this.mSelectedTab!=-1?this.mTabs[this.mSelectedTab].childNodes[2].childNodes[0]:this.mTabs.length>0?this.mTabs[0].childNodes[2].childNodes[0]:null};TabView.prototype.getFocusElementForTab=function(b){var d=this.GetTabForID(b);if(d!=null){return d.childNodes[2].childNodes[0]}return null};TabView.prototype.IsPageVisible=function(d){var b=this.GetTabForID(d.mID);return(b&&b.className.indexOf("OuterTabSelected")!=-1)};TabView.prototype.registerPageField=function(b){};TabView.prototype.HeaderClick=function(b,d){};TabView.prototype.UpdatePageVis=function(d,b){if(!d&&this.mSelectedTab!=-1&&this.mChildren[this.mSelectedTab].getAttribute("arid")==b.mID){this.mSelectedTab=-1}if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}};TabView.prototype.HandleState=function(b,d){};TabView.prototype.isTablessBorderless=function(){return(this.mScrollingTabs.length==0)};var PageDirty=false;StackView.prototype.constructor=StackView;function StackView(b){this.init(b)}PageHolderFactories.StackView=function(b){return new StackView(b)};StackView.prototype.G=function(){if(this.mStackViewType&&this.mStackViewType=="accordion"){for(var b=0;b<this.mVisibleChildren.length;b++){if(this.mVisibleChildren[b].mPageField.getState()==1){return new CharType(this.mVisibleChildren[b].mObj.getAttribute("ardbn"))}}}return Null};StackView.prototype.DoSet=StackView.prototype.DoSLoadEntry=function(b){};StackView.prototype.HandleAccordionState=function(b,d){if(b.getState()!=d){if(d==1){return this.HandleAccordionClick(b,true)}}};StackView.prototype.IsPageVisible=function(b){return(b.mObj.getAttribute("arvisibility")=="visible")};StackView.prototype.SelectTab=function(b){};StackView.prototype.UpdatePageVis=function(h,g){for(var d=0;d<this.mChildren.length;d++){if(this.mChildren[d].mPageField==g){this.mChildren[d].mVisible=h?true:false;g.mObj.style.visibility=h?"inherit":"hidden";AsyncField_IncrAsyncRef(this.windowID,g.mID,((h)?-1:1));if(this.mStackViewType=="accordion"){if(!h&&g.mState==1){this.ExpandNextAccordionPage(d)}else{if(h&&g.mState==0){var f=true;for(var b=0;b<this.mChildren.length;b++){if(this.mChildren[b].mPageField==g){continue}if(this.mChildren[b].mPageField.mState==1&&this.mChildren[b].mVisible){f=false;break}}if(f){this.HandleAccordionClick(g,true)}}}}if(this.mStackViewType=="accordion"&&this.mOrientation=="horizontal"){g.mObj.style.width=h?"auto":"0px"}else{g.mObj.style.display=h?"block":"none"}}}if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}};StackView.prototype.GetTabIndexForID=function(b){return null};StackView.prototype.HandleState=function(b,d){if(this.mStackViewType!="resizable"){if(this.mStackViewType=="accordion"){return this.HandleAccordionState(b,d)}else{if(d==0){return b.collapse(true,false)}else{return b.expand(true,false)}}}};function ContentPane(h,g,d,b,f){this.init(h,g,d,b,f)}StackView.prototype.HandleAccordionClick=function(f,b){if(!f.IsVisible()){return}var g=f.getState();if(g==0){for(var d=0;d<this.mChildren.length;d++){if(this.mChildren[d].mPageField==f){continue}if(this.mChildren[d].mPageField.mState==0){continue}this.mChildren[d].mPageField.collapse(true,false);break}if(b==true){this.calcAccordionPaneSize()}f.changeSize(f.mHeader==null?this.mAccordionSize:this.mAccordionSize+20);return f.expand(true,false)}};StackSplitterPane.prototype.constructor=StackSplitterPane;function StackSplitterPane(d,b){if(arguments.length){this.init(d,b)}}StackSplitterPane.prototype.init=function(d,b){this.mObj=d;this.position=0;this.mOrientation=b;this.mSize=parseInt((b=="horizontal")?d.style.width:d.style.height);if(isNaN(this.mSize)){this.mSize=5}};StackSplitterPane.prototype.setPosition=function(b){this.position=b;if(this.mOrientation=="horizontal"){this.mObj.style.left=b+"px"}else{this.mObj.style.top=b+"px"}};ContentPane.prototype.constructor=ContentPane;ContentPane.prototype.resize=function(d,b){this.position=d;this.sizeActual=this.sizeShare=b;this.redraw()};ContentPane.prototype.resizeByPosition=function(b){this.position=b;this.redraw()};ContentPane.prototype.resizePane=function(b){if(this.mPageField){this.mPageField.changeSize(b)}};ContentPane.prototype.redraw=function(){this.sizeActual=((this.sizeActual<0)?0:parseInt(this.sizeActual));this.position=parseInt(this.position);if(this.mOrientation=="horizontal"){this.mObj.style.left=this.position+"px";this.mObj.style.width=this.sizeActual+"px"}else{this.mObj.style.top=this.position+"px";this.mObj.style.height=this.sizeActual+"px"}if(this.mPageField){this.mPageField.changeSize(this.sizeActual)}};ContentPane.prototype.init=function(h,g,d,b,f){this.mObj=h;this.mParent=g;this.mOrientation=d;this.mViewType=b;this.mHeader=false;this.position=0;this.mIndex=f;this.mMinSize=parseInt(this.mObj.getAttribute("arminsize"));if(this.mMinSize==0){this.mMinSize=25}this.mMaxSize=parseInt(this.mObj.getAttribute("armaxsize"));this.mInitSize=parseInt(this.mObj.getAttribute("arinitsize"));this.mSlackOrder=parseInt(this.mObj.getAttribute("arslackorder"));this.mWhitespace=this.mObj.getAttribute("arwhitespace")==1;this.sizeActual=parseInt((d=="horizontal")?this.mObj.style.width:this.mObj.style.height);this.mFitSize=this.mInitSize;if(this.mMaxSize==0){this.mMaxSize=this.mInitSize+10}if(this.sizeActual==0){this.sizeActual=10}this.sizeShare=this.sizeActual;this.mID=this.mObj.getAttribute("arid");this.mPageField=null;this.mVisible=(this.mObj.getAttribute("arvisibility")=="visible")};StackView.prototype.init=function(b){this.mParentObj=b;this.mObj=this.mParentObj.mObj;this.mID=this.mParentObj.mID;this.windowID=this.mParentObj.windowID;this.mRelPosContainer=null;var h=this.mObj;this.mOrientation=h.getAttribute("arorientation");this.mStackViewType=h.getAttribute("arstackviewtype");this.mChildren=[];this.mVisibleChildren=[];this.mSplitters=[];this.mSplitterSize=0;this.mPostCreate=false;this.mLength=0;this.mAccordionSize=0;this.mInitializeLayout=0;this.mFixedContainer=null;this.mDefaults=false;this.mInitPageID=this.mObj.getAttribute("arinitpage");this.mDraw=false;this.mShrink=false;this.vSize=0;this.mMargin=h.getAttribute("armargin");this.mBorderless=h.getAttribute("arborder");this.mFlow=h.getAttribute("arflowid");for(var g=this.mObj.firstChild;g;g=g.nextSibling){if(g.className=="PageHolderStackViewResizable"){h=this.mRelPosContainer=g;break}}if(this.mStackViewType=="fixed"){for(var g=h.firstChild;g;g=g.nextSibling){if(g.className!=null&&g.className.indexOf("PageHolderStackViewFixedC")!=-1){h=this.mFixedContainer=g;break}}}var d=0;for(var g=h.firstChild;g;g=g.nextSibling){if(g.nodeType==1){var f=g.getAttribute("artype");if(f!=null&&f=="Page"){this.mChildren.push(new ContentPane(g,this,this.mOrientation,this.mStackViewType,d++))}}}};StackView.prototype.DoLayout=function(){if(this.mInitializeLayout==0||!this.mPostCreate||this.mParentObj.mAsyncDirty){this.mVisibleChildren=[];for(var v=0;v<this.mChildren.length;v++){if(this.mChildren[v].mVisible){this.mVisibleChildren.push(this.mChildren[v])}}this.mDefaults=this.comparetodefaults();if(this.mFlow!=null){for(var u=0;u<this.mVisibleChildren.length;u++){var g=this.mVisibleChildren[u].mPageField.mFieldSetNode;var z=g.className;z+=" flchild ";g.className=z}}if(this.mStackViewType&&this.mStackViewType=="resizable"){this.removeSplitters();for(var u=0;u<this.mVisibleChildren.length;u++){var f=this.mVisibleChildren[u];f.mObj.style.position="absolute";if(u==this.mVisibleChildren.length-1){break}var b=this.mObj.getAttribute("splitter");if(b!=0){var d=true;var w=this.mVisibleChildren[u+1];if(((f.mInitSize==f.mMinSize)&&(f.mInitSize==f.mMaxSize))||((w.mInitSize==w.mMinSize)&&(w.mInitSize==w.mMaxSize))){d=false}var s="#717375";if(f.mPageField){var o=f.mPageField.mFieldSetNode;if(o&&o.getAttribute("arbcolor")!=null){s=o.getAttribute("arbcolor")}}this.addSplitter(d,b,s)}}var A=this.mObj.getAttribute("dragHandler");if(A==null){this.mObj.setAttribute("dragHandler","PageHolder_DragHandler");this.mObj.setAttribute("arwindowid",this.windowID)}}}this.mInitializeLayout=0;this.mDraw=true;if(this.mStackViewType&&this.mStackViewType=="resizable"){this.initLayout()}else{if(this.mStackViewType&&this.mStackViewType=="accordion"){this.calcAccordionPaneSize();if(this.mPostCreate){for(var h=0;h<this.mVisibleChildren.length;h++){var y=this.mVisibleChildren[h].mPageField;if(y.mState==1){y.changeSize((y.mHeader==null)?this.mAccordionSize:this.mAccordionSize+20);break}}}}else{this.applyFixedLayout()}}this.mDraw=false;if(!this.mPostCreate){this.postCreate()}};StackView.prototype.postCreate=function(){if(this.mStackViewType=="accordion"){var d=null;if(this.mInitPageID!=null){d=getFields_NS(this.windowID)[this.mInitPageID]}if(d==null||!d.IsVisible()){if(this.mVisibleChildren.length>0){d=this.mVisibleChildren[0].mPageField}}for(var b=0;b<this.mChildren.length;b++){var f=this.mChildren[b].mPageField;f.changeSize((f==d&&f.mHeader!=null)?this.mAccordionSize+20:this.mAccordionSize);if(this.mChildren[b].mVisible){if(f==d){f.expand(false,true);continue}}this.mChildren[b].mPageField.collapse(false,true)}}else{if(this.mStackViewType=="fixed"){for(var b=0;b<this.mChildren.length;b++){if(this.mChildren[b].mPageField.mState==0){this.mChildren[b].mPageField.collapse(false,true)}}}}this.mPostCreate=true};StackView.prototype.registerPageField=function(b){if(this.mPostCreate){return}var d=this.mChildren[this.mLength++];d.mPageField=b;d.mHeader=(b.mHeader!=null);if(this.mOrientation=="horizontal"&&b.mSpan!=null){b.SetExpand("&#9658");b.SetCollapse("&#9660")}};StackView.prototype.HeaderClick=function(b,d){var f=b.element;if(this.mStackViewType=="accordion"){return this.HandleAccordionClick(d,true)}else{if(this.mStackViewType=="fixed"){if((f.tagName=="SPAN"&&f.className.indexOf("Twisty")!=-1)||f.tagName=="A"){return d.toggleState()}}}};StackView.prototype.GetPagePos=function(d){for(var b=0;b<this.mChildren.length;b++){if(this.mChildren[b].mPageField==d){return b}}return -1};StackView.prototype.addSplitter=function(g,h,d){var f=this.mSplitters.length;var k=document.createElement("div");if(g){k.setAttribute("dragHandler","PageHolder_DragHandler");k.setAttribute("draggable","1")}else{k.style.cursor="auto"}k.className=(this.mOrientation=="horizontal")?"PageHolderSplitterH":"PageHolderSplitterV";if(h==2){k.setAttribute("arbcolor",d);if(this.mOrientation=="horizontal"){k.className+=" InvisibleSplitterH";k.style.width="0px"}else{k.className+=" InvisibleSplitterV";k.style.height="0px"}}k.setAttribute("dragoriginal","");k.setAttribute("arpageholderid",this.mParentObj.mID);k.setAttribute("arsplitposition",f);k.setAttribute("arwindowid",this.windowID);this.mSplitters[f]=new StackSplitterPane(k,this.mOrientation);if(this.mSplitterSize==0){this.mSplitterSize=this.mSplitters[0].mSize}var b=(this.mRelPosContainer!=null)?this.mRelPosContainer:this.mObj;b.appendChild(k)};StackView.prototype.calcAccordionPaneSize=function(){var f=(this.mRelPosContainer!=null)?this.mRelPosContainer:this.mObj;var d=(this.mOrientation=="horizontal")?f.offsetWidth:f.offsetHeight;if(d==0){d=(this.mOrientation=="horizontal")?parseInt(f.parentNode.style.width):parseInt(f.parentNode.style.height)}var g=0;for(var b=0;b<this.mChildren.length;b++){if(this.mChildren[b].mVisible&&this.mChildren[b].mHeader){g++}}var h=g*20;this.mAccordionSize=d-h;this.mAccordionSize-=this.mVisibleChildren.length;if(this.mAccordionSize<30){this.mAccordionSize=30}};StackView.prototype.applyFixedLayout=function(){if(this.mVisibleChildren.length==0){return}var u=(this.mRelPosContainer!=null)?this.mRelPosContainer:this.mObj;var d=(this.mOrientation=="horizontal")?u.offsetWidth:u.offsetHeight;var o=this.compareforShrink();var C=0;var v=0;var y=false;var z=0;var w;var B;var k=0;var g=false;if(g&&(this.mOrientation=="horizontal")){var h=this.mVisibleChildren.length-1;var A=0;var b=this.mVisibleChildren[A];while(b.mPageField.mState!=1&&A<h){b=this.mVisibleChildren[++A]}}else{var A=this.mVisibleChildren.length-1;var b=this.mVisibleChildren[A];while(b.mPageField.mState!=1&&A>0){b=this.mVisibleChildren[--A]}}if(o){this.vSize=d;this.mShrink=true}for(var s=0;s<this.mVisibleChildren.length;s++){if(this.mVisibleChildren[s].mPageField.mState==0){if(this.mVisibleChildren[s].mHeader){v+=20;if(o){C+=20}}}else{var f=this.mVisibleChildren[s];if(f.mPageField.getFillStyle()==2&&f.mPageField.mFit){v+=f.mObj.offsetHeight}else{v+=f.mInitSize}if(o){C+=f.mInitSize}if(this.mDefaults&&f!=b){f.resizePane(f.mInitSize)}else{if(!this.mDefaults&&f.mWhitespace){f.resizePane(f.mFitSize)}}}}if(this.mShrink){d=this.vSize}if(o){k=this.applyMargins();if(k>0){C+=k}w=C;B=0}else{w=d;B=d-v}if(this.mDefaults){z=this.slacktolastPanel(B,b,y)}else{z=this.allocateSlackToPanes(B)}if(z<0){w-=z}this.setFinalSize(w,o,k)};StackView.prototype.applyMargins=function(){var d=0;if(this.mMargin){var b=this.mMargin.split(",");if(this.mOrientation=="vertical"){d=parseInt(b[0])+parseInt(b[2])}else{d=parseInt(b[1])+parseInt(b[3])}}return d};StackView.prototype.setFinalSize=function(f,b,d){if(this.mOrientation=="horizontal"){this.mFixedContainer.style.width=((d>0)?f-d:f)+"px"}else{if(this.mFixedContainer.style.height!="auto"){this.mFixedContainer.style.height=((d>0)?f-d:f)+"px"}}if(b||this.mShrink){if(this.mOrientation=="horizontal"){this.mObj.style.width=((this.mBorderless=="1")?f+2:f)+"px"}else{this.mObj.style.height=((this.mBorderless=="1")?f+2:f)+"px"}}};StackView.prototype.slacktolastPanel=function(b,g,d){if(g.mPageField.mState==1){var f=g.mInitSize;if(b>=0){f+=b}g.resizePane(((this.mOrientation=="horizontal")&&(d==true))?(f-3):f)}return b};StackView.prototype.getSlackPriority=function(){var b=[];for(var d=0;d<this.mVisibleChildren.length;d++){if(this.mVisibleChildren[d].mPageField.mState==1){var f=this.mVisibleChildren[d];var g=f.mSlackOrder;if(typeof b[g]=="undefined"){b[g]=[]}b[g].push(d)}else{if(this.mOrientation=="vertical"){this.mVisibleChildren[d].mPageField.mFieldSetNode.style.height=this.mVisibleChildren[d].mInitSize+"px"}else{this.mVisibleChildren[d].mPageField.mFieldSetNode.style.width=this.mVisibleChildren[d].mInitSize+"px"}}}return b};StackView.prototype.allocateSlackToPanes=function(f){var b=this.getSlackPriority();var s=[];var d,g;for(var h in b){s.push(h)}while(f!=0&&s.length!=0){((f>0)?s.sort(function(u,k){return u-k}):s.sort(function(u,k){return k-u}));f=this.distributeSlack(f,b[s[0]],s);s.shift()}while(f==0&&s.length!=0){var o=b[s[0]];for(h=0;h<o.length;h++){d=this.mVisibleChildren[o[h]];d.resizePane(d.mInitSize)}s.shift()}return f};StackView.prototype.distributeSlack=function(z,w,o){var b,h,f,E,g,d,k=w.length;var y=0;if(k==1){f=this.mVisibleChildren[w[0]];var D=f.mPageField.mObj.getAttribute("arfillstyle");b=(z>0?f.mMaxSize-f.mInitSize:f.mMinSize-f.mInitSize);if((z>0&&b>z)||(z<0&&b<z)){b=z}if(f.mWhitespace){if(b>0){b=this.fitToContent(f,b);b=this.fitPane(b,f,z)}else{f.resizePane(f.mInitSize+b);f.mFitSize=f.mInitSize+b}}if(!f.mWhitespace){f.resizePane(b+f.mInitSize)}return z-b}else{var C=new Array(k);var u=new Array(k);for(h=0;h<k;h++){f=this.mVisibleChildren[w[h]];var D=f.mPageField.mObj.getAttribute("arfillstyle");C[h]=(z>0?f.mMaxSize-f.mInitSize:f.mMinSize-f.mInitSize);u[h]=0}var g=k;while(g>0&&((z>g-1)||(z<-(g-1)))){var B=(z>0?Math.floor(z/g):Math.ceil(z/g));for(h=0;h<k;h++){if(C[h]!=0){E=B;if((B>0&&C[h]<B)||(B<0&&C[h]>B)||C[h]==B){E=C[h];g-=1}z-=E;u[h]+=E;C[h]-=E}else{g-=1}}}for(h=0;h<k;h++){f=this.mVisibleChildren[w[h]];var D=f.mPageField.mObj.getAttribute("arfillstyle");if(f.mWhitespace){if(z>0){u[h]+=z;z=0}var A=u[h];if(u[h]>0){u[h]=this.fitToContent(f,u[h]);if(u[h]>A){u[h]=A}u[h]=this.fitPane(u[h],f,A)}else{f.resizePane(f.mInitSize+u[h]);f.mFitSize=f.mInitSize+u[h]}var d=f.mFitSize-f.mInitSize;y=A-d;z+=y;C[h]-=u[h]}}h=0;if(g>0){E=(z>0?1:-1);while(h<k&&z!=0){if(C[h]!=0){C[h]-=E;u[h]+=E;z-=E}h++}}for(h=0;h<k;h++){f=this.mVisibleChildren[w[h]];if(!f.mWhitespace){f.resizePane(u[h]+f.mInitSize)}}return z}};StackView.prototype.fitPane=function(h,k,d){var f=0,g=0,b=0;if(h>=0){if(k.mFitSize>k.mInitSize){g=k.mFitSize-k.mInitSize;b=d-g;if(h>b){h=b}f=h+k.mFitSize;k.mFitSize+=h;h=k.mFitSize-k.mInitSize}else{if(k.mFitSize<=k.mInitSize){f=h+k.mInitSize;k.mFitSize=f}else{if(d<(k.mFitSize-k.mInitSize)){h=d;f=h+k.mInitSize;k.mFitSize=f}}}}k.resizePane(f);return h};StackView.prototype.getSlackOrder=function(){var b=new Array();for(var d=0;d<this.mVisibleChildren.length;d++){if(this.mVisibleChildren[d].mPageField.mState==1){var f=this.mVisibleChildren[d];b[d]=f.mSlackOrder}}return b};StackView.prototype.getVisibleChildren=function(d){var b=new Array();for(var f=0;f<this.mVisibleChildren.length;f++){if(d==this.mVisibleChildren[f].mSlackOrder&&(this.mVisibleChildren[f].mPageField.mState==1)){b.push(this.mVisibleChildren[f])}}return b};StackView.prototype.avoidWhitespace=function(f,b){var g=0;var d=f.mPageField.mFieldSetNode.childNodes[3];if(f.mOrientation=="vertical"){if(d.className.indexOf("pageBody")!=-1){d.className="pageBody ft"}if(d.scrollHeight>d.offsetHeight){g=d.scrollHeight-d.offsetHeight;if(g>0&&g<3){g=0}else{if(g>3){g+=3}}}}else{if(d.scrollWidth>d.offsetWidth){g=d.scrollWidth-d.offsetWidth}}if(g<b){b=g}if((b+f.mFitSize)>=f.mMaxSize){b=f.mMaxSize-f.mFitSize}else{if((b+f.mFitSize)<=f.mMinSize){b=f.mMinSize-f.mFitSize}}return b};StackView.prototype.fitToContent=function(g,d){var f=g.mPageField.mObj.getAttribute("arfillstyle");var b=0;if(g.mWhitespace){if(f=="1"){if(PageDirty){b=g.mPageField.mScrollHeight;g.mPageField.mScrollHeight=0;if(b>d){b=d}if((b+g.mFitSize)>=g.mMaxSize){b=g.mMaxSize-g.mFitSize}else{if((b+g.mInitSize)<=g.mMinSize){b=g.mMinSize-g.mInitSize}}}return b}else{d=this.avoidWhitespace(g,d);return d}}};StackView.prototype.comparetodefaults=function(){for(var b=0;b<this.mVisibleChildren.length;b++){var d=this.mVisibleChildren[b];if(d.mSlackOrder!=0){return false}}return true};StackView.prototype.compareforShrink=function(){for(var b=0;b<this.mChildren.length;b++){var d=this.mChildren[b];if(d.mMinSize!=d.mMaxSize){return false}}return true};StackView.prototype.initLayout=function(){if(this.mVisibleChildren.length==0){return}var s=(this.mRelPosContainer!=null)?this.mRelPosContainer:this.mObj;var f=s.offsetWidth;var B=s.offsetHeight;var d=(this.mOrientation=="horizontal")?f:B;if(this.mVisibleChildren.length>1){d-=(this.mSplitterSize*(this.mVisibleChildren.length-1))}var g=0;var h=0;for(var u=0;u<this.mVisibleChildren.length;u++){g+=this.mVisibleChildren[u].sizeShare}var y=this.mVisibleChildren.length;var w=new Array();var v=new Array();var b,z=0;var k=new Array();var A=d-g;if(this.mDefaults){this.splitterdefaults(d,g,y)}else{w=this.getSlackOrder();((A>0)?w.sort(function(D,C){return D-C}):w.sort(function(D,C){return C-D}));for(var u=0;u=w.length;u++){var o=0;if(w[o]==w[o+1]){k.push(w[o]);w.shift()}else{k.push(w[o]);w.shift();break}}h=this.resizeSplitter(d,g,w,z);this.slacktoPriorityOrder(k,d,h)}this.layoutPanels()};StackView.prototype.slacktoPriorityOrder=function(g,h,b){if(g.length>1){this.allocateSlacktoSplitter(h,b,g)}else{for(var f=0;f<this.mVisibleChildren.length;f++){if(g==this.mVisibleChildren[f].mSlackOrder){var o=h-b;var d=this.mVisibleChildren[f].sizeActual;var k=this.mVisibleChildren[f].mMaxSize;this.mVisibleChildren[f].sizeActual=o;o=0}}}};StackView.prototype.allocateSlacktoSplitter=function(o,d,g){var k=0;var s=o-d;var h=s/g.length;var b=new Array();b=this.getVisibleChildren(g[0]);for(var f=0;f<b.length;f++){paneReq=b[f].mMaxSize;if(g[0]==b[f].mSlackOrder){si=b[f].sizeActual;if(h<=paneReq){if(f==b.length-1){b[f].sizeActual=s;s=0}else{b[f].sizeActual=h;s-=h}}else{if(h>paneReq){if(f==b.length-1){b[f].sizeActual=h;s=0}else{k=h-paneReq;h+=k;b[f].sizeActual=paneReq}}}}}};StackView.prototype.splitterdefaults=function(o,f,d){var k=o/f;var b=0;for(var h=0;h<d-2;h++){b=this.getActualSize(k,b,h)}var g=Math.round(k*this.mVisibleChildren[d-1].sizeShare);if(g<this.mVisibleChildren[d-1].mMinSize){g=this.mVisibleChildren[d-1].mMinSize}else{if(g>this.mVisibleChildren[d-1].mMaxSize){g=this.mVisibleChildren[d-1].mMaxSize}}this.mVisibleChildren[d-1].sizeActual=g;b+=g;if(this.mVisibleChildren[d-2]!=null){var s=o-b;if(s<this.mVisibleChildren[d-2].mMinSize){s=this.mVisibleChildren[d-2].mMinSize}this.mVisibleChildren[d-2].sizeActual=s}};StackView.prototype.resizeSplitter=function(s,g,b,o){var k=s/(g-o);var d=0;for(var f=0;f<this.mVisibleChildren.length;f++){for(var h=0;h<b.length;h++){if(this.mVisibleChildren[f].mSlackOrder==b[h]){d=this.getActualSize(k,d,f);break}}}return d};StackView.prototype.getActualSize=function(g,b,d){var f=Math.round(g*this.mVisibleChildren[d].sizeShare);if(f<this.mVisibleChildren[d].mMinSize){f=this.mVisibleChildren[d].mMinSize}else{if(f>this.mVisibleChildren[d].mMaxSize){f=this.mVisibleChildren[d].mMaxSize}}this.mVisibleChildren[d].sizeActual=f;b+=f;return b};StackView.prototype.layoutPanels=function(){var f=0;var d=this.mVisibleChildren[0].sizeActual;this.mVisibleChildren[0].resizeByPosition(f);f+=d;for(var b=1;b<this.mVisibleChildren.length;b++){if(this.mSplitters[b-1]){this.mSplitters[b-1].setPosition(f)}f+=this.mSplitterSize;this.mVisibleChildren[b].resizeByPosition(f);f+=this.mVisibleChildren[b].sizeActual}};StackView.prototype.removeSplitters=function(){if(this.mSplitters.length==0){return}var b=(this.mRelPosContainer!=null)?this.mRelPosContainer:this.mObj;for(var d=(this.mSplitters.length-1);d>=0;d--){b.removeChild(this.mSplitters[d].mObj);this.mSplitters.pop()}this.mSplitters=[]};StackView.prototype.ResizeChildren=function(b){if(this.mParentObj.mFloat==2||this.mParentObj.mContainerID!=null||this.mParentObj.mFlowID==0){this.mInitializeLayout=1;if(this.mParentObj.mAsyncMode&&(typeof b=="undefined"||b==false)){if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}else{this.DoLayout()}}};StackView.prototype.DragHandler=function(v){var s=v.srcElement;var z=parseInt(s.getAttribute("arsplitposition"));if(v.state==0){var f=this.mSplitters[z];var b=this.mVisibleChildren[z];var u=this.mVisibleChildren[z+1];var o=(this.mRelPosContainer!=null)?this.mRelPosContainer:this.mObj;var h=o.offsetWidth;var B=o.offsetHeight;var g=0;var A=0;var d=0;var y=0;var k=Math.max((b.position+b.mMinSize),(u.position+(u.sizeActual-u.mMaxSize)));var w=Math.min((b.position+b.mMaxSize),(u.position+(u.sizeActual-u.mMinSize)))+this.mSplitterSize;if(this.mOrientation=="horizontal"){g=k;d=w;y=B;if(!((v.mx>=k)&&(v.mx<=w))){WDEDragContext_Stop()}}else{A=k;d=h;y=w;if(!((v.my>=k)&&(v.my<=w))){WDEDragContext_Stop()}}v.dragContext.SetDragBounds(g,A,d,y)}else{if(v.state==2){var f=this.mSplitters[z];if(f.mObj.className.indexOf("InvisibleSplitter")!=-1){if(this.mOrientation=="horizontal"){f.mObj.style.borderLeft=""}else{f.mObj.style.borderTop=""}}f.setPosition((this.mOrientation=="horizontal")?v.x:v.y);this.resizePanesAtPos(z)}}};StackView.prototype.resizePanesAtPos=function(k){var b=this.mVisibleChildren[k];var g=this.mVisibleChildren[k+1];var o=this.mSplitters[k];var s=o.position;var f=b.position;var h=g.position+g.sizeActual;b.sizeActual=s-f;g.position=s+this.mSplitterSize;g.sizeActual=h-g.position;for(var d=0;d<this.mVisibleChildren.length;d++){this.mVisibleChildren[d].sizeShare=this.mVisibleChildren[d].sizeActual}b.redraw();g.redraw()};StackView.prototype.TabableElementSelector=function(b){return null};StackView.prototype.GetTabForID=function(d){var h=d+"";var b=new Array();for(var g=0;g<this.mChildren.length;++g){if(this.mChildren[g].mID==h){var k=this.mChildren[g].mPageField.mHeader;if(k!=null){var f=k.getElementsByTagName("SPAN");if(f.length>0){if(this.mStackViewType&&this.mStackViewType=="fixed"){for(g=0;g<f.length;g++){b.push(f[g])}return b}else{for(g=0;g<f.length;g++){if(f[g].className.indexOf("label")!=-1){return f[g]}}}}}}}return null};StackView.prototype.GetTextElement=function(b){return this.GetTabForID(b)};StackView.prototype.GetFocusElementForEvent=function(b){return null};StackView.prototype.DOMClick=function(b){};StackView.prototype.DOMKeyDown=function(b){return};StackView.prototype.DOMFocus=function(b){};StackView.prototype.GetFocusElement=function(){return null};StackView.prototype.getFocusElementForTab=function(b){return null};StackView.prototype.GetNextVisiblePageField=function(g){var b=null;for(var f=(g+1);f<this.mChildren.length;f++){if(this.mChildren[f]&&this.mChildren[f].mVisible==true){b=this.mChildren[f].mPageField;break}}if(!b){for(var d=0;d<g;d++){if(this.mChildren[d]&&this.mChildren[d].mVisible==true){b=this.mChildren[d].mPageField;break}}}return b};StackView.prototype.ExpandNextAccordionPage=function(g){var f=null;for(var d=(g+1);d<this.mChildren.length;d++){if(this.mChildren[d]&&this.mChildren[d].mVisible==true){f=this.mChildren[d].mPageField;break}}if(!f){for(var b=0;b<g;b++){if(this.mChildren[b]&&this.mChildren[b].mVisible==true){f=this.mChildren[b].mPageField;break}}}if(f){if(this.mStackViewType&&this.mStackViewType=="accordion"){this.calcAccordionPaneSize();f.size=this.mAccordionSize}this.HandleAccordionClick(f,false)}};DPageHolder.prototype=new AsyncField();DPageHolder.prototype.constructor=DPageHolder;DPageHolder.superclass=AsyncField.prototype;DOMFieldFactories.PageHolder=function(b,f,d){return new DPageHolder(b,f,d)};function DPageHolder(b,f,d){if(arguments.length){this.init(b,f,d)}}DPageHolder.prototype.mDOMField=DPageHolder.prototype.mHaveVisualCharacteristics=true;DPageHolder.prototype.Clear=function(){};DPageHolder.prototype.mHaveStoredData=false;DPageHolder.prototype.MouseSelectable=false;DPageHolder.prototype.mContainFields=true;DPageHolder.prototype.registerPageField=function(b){this.mViewTypeObj.registerPageField(b)};DPageHolder.prototype.IsPageVisible=function(b){return this.mViewTypeObj.IsPageVisible(b)};DPageHolder.prototype.HandleState=function(b,d){return this.mViewTypeObj.HandleState(b,d)};DPageHolder.prototype.SelectTab=function(b){this.mViewTypeObj.SelectTab(b)};DPageHolder.prototype.DoLayout=function(){this.mViewTypeObj.DoLayout();if(this.mFloat==1){this.mObj.style.zIndex=nextZIndex++}this.mUIInstantiated=true};DPageHolder.prototype.UpdatePageVis=function(d,b){this.mViewTypeObj.UpdatePageVis(d,b)};DPageHolder.prototype.G=function(){return this.mViewTypeObj.G()};DPageHolder.prototype.DoSet=DPageHolder.prototype.DoSLoadEntry=function(b){this.mViewTypeObj.DoSet(b)};DPageHolder.prototype.GetTabIndexForID=function(b){return this.mViewTypeObj.GetTabIndexForID(b)};DPageHolder.prototype.init=function(f,k,h){this.mFloat=h.getAttribute("arfloattype");this.mDropShadow=((h.getAttribute("arshadow")==1)?true:false);DPageHolder.superclass.init.call(this,f,k,h);this.mAsyncResizePending=null;var g=this.mObj;var b=g.getAttribute("arphviewtype");if(b==null){b="TabView"}this.mViewTypeObj=PageHolderFactories[b](this);if(this.mDropShadow){var d=this.mObj.className;if(d.indexOf("shadow")==-1){d+=" shadow";this.mObj.className=d}}};DPageHolder.prototype.reset=function(){DPageHolder.superclass.reset.call(this);this.mTT.style.display="none"};DPageHolder.prototype.showTT=function(){DPageHolder.superclass.showTT.call(this);this.mTT.style.display="block"};function PageHolder_DragHandler(f){var b=f.srcElement.getAttribute("arpageholderid");var d=f.srcElement.getAttribute("arwindowid");getFields_NS(d)[b].DragHandler(f)}DPageHolder.prototype.DragHandler=function(b){this.mViewTypeObj.DragHandler(b)};DPageHolder.prototype.DOMMouseOver=function(b){hoverState.eventMouseOver(b)};DPageHolder.prototype.DOMMouseMove=function(b){hoverState.eventMouseMove(b)};DPageHolder.prototype.DOMMouseOut=function(b){hoverState.eventMouseOut(b)};DPageHolder.prototype.FlushAsyncQueue=function(){if(!this.mAsyncDirty){return}if(this.mAsyncResizePending){this.Resize(this.mAsyncResizePending.w,this.mAsyncResizePending.h)}this.mAsyncResizePending=null;this.DoLayout()};DPageHolder.prototype.UpdateVis=function(d){var b=(this.mObj.style.visibility!="hidden");if(!b&&d){if(this.mFloat!=2){this.SetAsync(-1)}this.mObj.style.visibility="inherit";this.mObj.style.display="block"}else{if(b&&!d){if(this.mFloat!=2){this.SetAsync(1)}if(this.mFloat!=2){this.mObj.style.visibility="hidden";this.mObj.style.display="none"}else{if(typeof AnimMgr!="undefined"){this.mHg=parseInt(this.mObj.style.height);this.mWd=parseInt(this.mObj.style.width);AnimMgr.shrinkFloatingPanel(this.windowID,this.mID,this.mObj,this.mHg,this.mWd,false,this)}else{this.mObj.style.visibility="hidden";this.mObj.style.display="none"}}}}};DPageHolder.prototype.TabableElementSelector=function(b){return this.mViewTypeObj.TabableElementSelector(b)};DPageHolder.prototype.GetTabForID=function(b){return this.mViewTypeObj.GetTabForID(b)};DPageHolder.prototype.GetTextElement=function(b){return this.mViewTypeObj.GetTextElement(b)};DPageHolder.prototype.GetFocusElementForEvent=function(b){return this.mViewTypeObj.GetFocusElementForEvent(b)};DPageHolder.prototype.DOMClick=function(b){this.mViewTypeObj.DOMClick(b)};DPageHolder.prototype.DOMKeyDown=function(b){return this.mViewTypeObj.DOMKeyDown(b)};DPageHolder.prototype.DOMFocus=function(b){return this.mViewTypeObj.DOMFocus(b)};DPageHolder.prototype.DOMBlur=function(b){};DPageHolder.prototype.GetFocusElement=function(){return this.mViewTypeObj.GetFocusElement()};DPageHolder.prototype.getFocusElementForTab=function(b){return this.mViewTypeObj.getFocusElementForTab(b)};DPageHolder.prototype.HeaderClick=function(b,d){return this.mViewTypeObj.HeaderClick(b,d)};DPageHolder.prototype.Resize=function(d,b){this.mObj.style.width=d+"px";if(this.mContainerID==0||this.mObj.style.height!="auto"){this.mObj.style.height=b+"px"}this.mViewTypeObj.ResizeChildren(true)};DPageHolder.prototype.getPanelWidth=function(){return this.mObj.offsetWidth};DPageHolder.prototype.getPanelHeight=function(){return this.mObj.offsetHeight};DPageHolder.prototype.ResizeTo=function(f,b){if(this.mFloat==2){this.Resize(f,b)}else{var d=Math.round(b*(this.perHeight/100));var g=f;if(g<this.mMinWidth){g=this.mMinWidth}else{if(g>this.mMaxWidth){g=this.mMaxWidth}}if(d<this.mMinHeight){d=this.mMinHeight;if(this.mObj.className.indexOf("nohrzscroll")!=-1){g=g-18}else{if(this.mContainerID==0){if(g-18>this.mMinWidth){g=g-18;getFormElements_NS(this.windowID)["FormContainer"].style.overflowX="hidden"}else{getFormElements_NS(this.windowID)["FormContainer"].style.overflowX="auto"}}}}else{if(d>this.mMaxHeight){d=this.mMaxHeight}}if(this.mAsyncMode){this.mAsyncResizePending={w:g,h:d};this.mAsyncDirty=(1>this.mAsyncDirty?1:this.mAsyncDirty)}else{this.Resize(g,d)}}};DPageHolder.prototype.getNoDragDropStyleClasses=function(){return["PageHolderSplitterH","PageHolderSplitterV"]};DPage.prototype=new Field();DPage.prototype.constructor=DPage;DPage.superclass=Field.prototype;DOMFieldFactories.Page=function(b,f,d){return new DPage(b,f,d)};function DPage(b,f,d){if(arguments.length){this.init(b,f,d)}}DPage.prototype.mDOMField=DPage.prototype.mHaveVisualCharacteristics=true;DPage.prototype.G=function(){return new IntegerType(this.getState())};DPage.prototype.Clear=function(){};DPage.prototype.getState=function(){return this.mState};DPage.prototype.toggleState=function(){if(this.mState==1){return this.collapse(true,false)}else{return this.expand(true,false)}};DPage.prototype.SetExpand=function(b){this.mExpand=b};DPage.prototype.SetCollapse=function(b){this.mCollapse=b};DPage.prototype.mHaveStoredData=false;DPage.prototype.mContainFields=true;DPage.prototype.init=function(d,w,y){this.mFloat=y.getAttribute("arfloattype");DPage.superclass.init.call(this,d,w,y);var b=0;this.mFieldSetNode=this.mPageBody=y;this.mHeader=null;this.mBackgroundIMG=null;this.mResizeOnExpand=false;this.mSpan=null;this.mExpand=null;this.mAnchor=null;this.mCollapse=null;this.mScrollHeight=0;resizeWindow=false;this.mPageScroll=null;this.mDisabled=false;this.mDisabledObj=null;this.mAltText=y.getAttribute("aralttext");this.mFit=((y.getAttribute("arwhitespace")==1)?true:false);this.mxSize=y.getAttribute("arinitsize");this.mDropShadow=((y.getAttribute("arshadow")==1)?true:false);if(y.tagName=="DIV"||y.tagName=="FIELDSET"){this.getPaneAttributes();if((y.className.indexOf("Panel")!=-1)&&(y.className.substr(0,5)=="Panel")){this.mPageScroll=y;this.getRoundedBorders(y,y);for(var H=y.firstChild;H;H=H.nextSibling){if(H.tagName=="FIELDSET"){this.mPageBody=H;break}}if(this.mDropShadow){var o=y.className;if(o.indexOf("shadow")==-1){o+=" shadow";y.className=o}}if(this.mFit){var b=this.getScrollheight();if(b>0){var G=F(d,this.mID);var v=G.GetParent();while(v){if(v instanceof DPage&&v.mFillModel&&v.mState==1){v.setDirty(b)}v=v.GetParent()}}}}else{for(var s=y.firstChild;s;s=s.nextSibling){if(s.nodeType==1){if(((s.tagName=="DIV")&&s.className.indexOf("PageBody")!=-1)||s.tagName=="FIELDSET"){this.mFieldSetNode=s;for(var H=s.firstChild;H;H=H.nextSibling){if(H.tagName=="DIV"&&H.className.indexOf("PageBody")!=-1){this.mPageBody=H;break}}this.getRoundedBorders(this.mFieldSetNode,this.mPageBody);var z=s.getElementsByTagName("div");if(z.length>0){var k=z[0];if((typeof k.className=="string")&&k.className.indexOf("FormContainerBackground")!=-1){var u=k.getElementsByTagName("IMG");for(var D=0;D<u.length;D++){if(u[D].className=="FormContainerImage"){this.mBackgroundIMG=u[D];break}}}}}else{if(s.className.indexOf("PageHeader")!=-1){if(s.className.indexOf("PageHeaderHorizontal")!=-1){if(!getPlatform()){var B=s.getElementsByTagName("SPAN");for(D=0;D<B.length;D++){if(B[D].className.indexOf("label")!=-1){if(B[D].getAttribute("vtext")!=null){B[D].innerHTML=B[D].getAttribute("vtext")}var E=B[D].getAttribute("tcolor");if(E!=null){B[D].style.color=((E.charAt(0)=="#")?E:("#"+E))}}}}else{getPlatformColor(s,s);var B=s.getElementsByTagName("SPAN");for(D=0;D<B.length;D++){if(B[D].className.indexOf("label")!=-1){if(B[D].getAttribute("vtext")!=null){B[D].innerHTML=B[D].getAttribute("vtext")}var E=B[D].getAttribute("tcolor");if(E!=null){B[D].style.color=((E.charAt(0)=="#")?E:("#"+E))}}}}}else{if(s.getAttribute("argcolor")!=null){if(!getPlatform()){if(s.getAttribute("argcolor")!=null){var A=s.getAttribute("argcolor");s.style.backgroundColor="#"+A.substr(2,6)}}else{if(s.getAttribute("argcolor")!=null){var A=s.getAttribute("argcolor");s.style.backgroundColor="#"+A.substr(2,6)}}}}this.mHeader=s;this.mSpan=s.getElementsByTagName("SPAN")[0];this.mAnchor=s.getElementsByTagName("A")[0];if(this.mSpan){this.mExpand="&#9660";this.mCollapse="&#9658"}}}}}}}var C=null;var g=y.parentNode;while(g&&(g!=getFormElements_NS(d)["FormContainer"]&&g!=document.body)){C=g.getAttribute("arid");if(C!=null){break}g=g.parentNode}if(C&&(F(d,C) instanceof DPageHolder)){this.mParentObj=F(d,parseInt(C));this.mParentObj.registerPageField(this);if(this.mParentObj.GetTabForID(this.mID)!=null){this.mTextElement=this.mParentObj.GetTextElement(this.mID)}}else{this.mTextElement=this.mObj.getElementsByTagName("legend")[0]}if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="accordion"){this.mState=0}else{this.mState=1;if(this.mObj.getAttribute("arstate")=="0"){this.mState=0}}var h=this.mObj.getAttribute("arfillstyle");if(h!=null&&(h==1||h==2)){this.mFillModel=new FillLayoutPolicy();getLayoutParentFields_NS(d).push(this)}else{if(this.mPageBody.className.indexOf("PageBody")!=-1){this.mPageBody.style.height="100%"}}if(this.mPageScroll==null){this.mPageScroll=this.mPageBody}if(this.mPageScroll!=null){this.mPageScroll.onscroll=FormEvent.Trampoline(function(f){if(rtfEditor!=null&&rtfEditor.mEditing!=null){rtfEditor.UpdatePos()}})}};DPage.prototype.getRoundedBorders=function(h,d){if(h.getAttribute("arradius")!=null){if((h.getAttribute("arbcolor")!=null)&&(h.getAttribute("arbwidth")!=null)){var b=h.getAttribute("arbcolor");var f=h.getAttribute("arbwidth");var g=f.split(",");d.style.borderTop=g[0]+"px solid "+b;d.style.borderRight=g[1]+"px solid "+b;d.style.borderBottom=g[2]+"px solid "+b;d.style.borderLeft=g[3]+"px solid "+b}}};DPage.prototype.DOMMouseOver=function(b){return hoverState.eventMouseOver(b)};DPage.prototype.DOMMouseMove=function(b){return hoverState.eventMouseMove(b)};DPage.prototype.DOMMouseOut=function(b){return hoverState.eventMouseOut(b)};DPage.prototype.isPartOfHeader=function(d){var b=this.mObj;var f=d;while(f&&f!=this.mObj){if(f.className.indexOf("PageHeader")!=-1){return true}f=f.parentNode}return false};DPage.prototype.DOMClick=function(b){hoverState.clearTracking();var d=b.element;if(this.mHeader){if(this.mParentObj&&this.isPartOfHeader(d)){return this.mParentObj.HeaderClick(b,this)}}};DPage.prototype.SelectPageDueToFocusInChildField=function(){if(this.mParentObj){var b=this.mParentObj.GetTabIndexForID(this.mID);this.mParentObj.SelectTab(b)}};DPage.prototype.UpdateFont=function(g){if(this.mTextElement!=null){var o=false;if(this.mParentObj&&this.mParentObj.mViewTypeObj.mOrientation=="horizontal"&&o){var k,f,b;if(this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){k=this.mTextElement[1];f=k.parentNode;var h=k.getAttribute("tcolor");if(h!=null){this.mTextElement[0].style.color=(h.charAt(0)=="#"?h:("#"+h))}}else{k=this.mTextElement;f=k.parentNode.parentNode}if(f.getAttribute("argcolor")!=null){b=getGradientforHeader(f,"argcolor")}else{b=getGradientforHeader(f,"arcolor")}k.setAttribute("tfont",g);b+=getVerticalText(k);UpdateFlashAttributes(f,b,this.windowID,this.mID)}else{if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){var d=this.mTextElement;this.mTextElement=this.mTextElement[1]}DPage.superclass.UpdateFont.call(this,g);if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){this.mTextElement=d}}if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}};DPage.prototype.UpdateColour=function(f){if(f==null){if("c" in getDefaults_NS(this.windowID)[this.mID]){f=getDefaults_NS(this.windowID)[this.mID].c}else{f=""}}if(this.mTextElement!=null){var h=false;if(this.mParentObj&&this.mParentObj.mViewTypeObj.mOrientation=="horizontal"&&h){if(this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){var g=this.mTextElement[1];var d=g.parentNode;this.mTextElement[0].style.color=f}else{var g=this.mTextElement;var d=g.parentNode.parentNode}if(d.getAttribute("argcolor")!=null){var b=getGradientforHeader(d,"argcolor")}else{var b=getGradientforHeader(d,"arcolor")}g.setAttribute("tcolor",f);b+=getVerticalText(g);UpdateFlashAttributes(d,b,this.windowID,this.mID)}else{if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){for(i=0;i<this.mTextElement.length;i++){this.mTextElement[i].style.color=f}}else{DPage.superclass.UpdateColour.call(this,f)}}if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}};DPage.prototype.UpdateLabel=function(h){if(this.mTextElement!=null){var o=false;if(this.mParentObj&&this.mParentObj.mViewTypeObj.mOrientation=="horizontal"&&o){if(this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){var k=this.mTextElement[1];var g=k.parentNode;var f=k.getAttribute("tcolor");if(f!=null){this.mTextElement[0].style.color=((f.charAt(0)=="#")?f:("#"+f))}}else{var k=this.mTextElement;var g=k.parentNode.parentNode}if(g.getAttribute("argcolor")!=null){var b=getGradientforHeader(g,"argcolor")}else{var b=getGradientforHeader(g,"arcolor")}k.setAttribute("vtext",h);b+=getVerticalText(k);UpdateFlashAttributes(g,b,this.windowID,this.mID)}else{if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){var d=this.mTextElement;this.mTextElement=this.mTextElement[1]}DPage.superclass.UpdateLabel.call(this,h);if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"){this.mTextElement=d}}if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}};DPage.prototype.UpdateVis=function(f){var b=this.mParentObj;if(typeof b=="undefined"){var d=(this.mObj.style.visibility!="hidden");if(this.mFloat!=2){this.mObj.style.visibility=(f?"inherit":"hidden")}else{if(f){this.mObj.style.visibility="inherit";this.mObj.style.display="block"}else{if(typeof AnimMgr!="undefined"){this.mHg=parseInt(this.mObj.style.height);this.mWd=parseInt(this.mObj.style.width);AnimMgr.shrinkFloatingPanel(this.windowID,this.mID,this.mObj,this.mHg,this.mWd,true)}else{this.mObj.style.visibility="hidden";this.mObj.style.display="none";if(d&&!f){AsyncField_IncrAsyncRef(this.windowID,this.mID,1)}}}}if(!d&&f){AsyncField_IncrAsyncRef(this.windowID,this.mID,-1);if(this.mFloat==1){this.mObj.style.zIndex=nextZIndex++}}else{if(d&&!f&&(this.mFloat!=2)){AsyncField_IncrAsyncRef(this.windowID,this.mID,1)}}}else{this.mObj.setAttribute("arvisibility",f?"visible":"hidden");b.UpdatePageVis(f,this)}};DPage.prototype.ResizeTo=function(g,b){var d=this.perWidth+"%";var f=this.perHeight+"%";if(this.mFloat==2){this.mObj.style.width=g+"px";this.mObj.style.height=b+"px"}else{if(this.mObj.style.width!=d){this.mObj.style.width=d}if(this.mObj.style.height!=f){this.mObj.style.height=f}if(this.mObj.getAttribute("arminwidth")!=null){this.mObj.style.minWidth=this.mMinWidth+"px"}if(this.mObj.getAttribute("armaxwidth")!=null){this.mObj.style.maxWidth=this.mMaxWidth+"px"}if(this.mObj.getAttribute("arminheight")!=null){this.mObj.style.minHeight=this.mMinHeight+"px"}if(this.mObj.getAttribute("armaxheight")!=null){this.mObj.style.maxHeight=this.mMaxHeight+"px"}}this.ResizeChildren()};DPage.prototype.afterExpand=function(b){if(b){if(this.mParentObj&&this.mParentObj.mViewTypeObj){this.mParentObj.mViewTypeObj.DoLayout()}}if(this.mResizeOnExpand==true){this.ResizeChildren()}this.mResizeOnExpand=false};DPage.prototype.ResizeChildren=function(){if(this.mParentObj&&(this.mParentObj.mAsyncMode>1||this.mParentObj.mAsyncResizePending!=null)){return}var u=this.mObj.scrollWidth;var h=this.mObj.offsetWidth;var o=this.mObj.scrollHeight;var f=this.mObj.offsetHeight;var b=0;var k=0;var g=0;var d=0;try{b=parseInt(this.mParentObj.mObj.style.paddingLeft.replace("px",""));k=parseInt(this.mParentObj.mObj.style.paddingRight.replace("px",""));g=parseInt(this.mParentObj.mObj.style.paddingTop.replace("px",""));d=parseInt(this.mParentObj.mObj.style.paddingBottom.replace("px",""))}catch(s){}this.ReallyResizeChildren();try{if(Math.abs(u-h)>2||Math.abs(o-f)>2||(u!=0&&this.mParentObj.mViewTypeObj.mOrientation=="vertical"&&Math.abs(this.mParentObj.mObj.scrollWidth-u)>(b+k))||(o!=0&&this.mParentObj.mViewTypeObj.mOrientation=="horizontal"&&Math.abs(this.mParentObj.mObj.scrollHeight-o)>(g+d))){var v=this;setTimeout(function(){v.ReallyResizeChildren()},0)}}catch(s){}};DPage.prototype.ReallyResizeChildren=function(){if(this.mParentObj&&this.mParentObj.mObj.className.indexOf("tb")!=-1){this.mFieldSetNode.style.width=this.mParentObj.mObj.offsetWidth+"px"}if(this.mFillModel){if(this.mState==1){if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"&&this.mParentObj&&this.mParentObj.mViewTypeObj.mOrientation=="vertical"){var s=this.mObj;var y=0;var A=document.defaultView.getComputedStyle(s,"");if(A!=null){var k=(isNaN(parseInt(A.getPropertyValue("padding-left"))))?0:parseInt(A.getPropertyValue("padding-left"));var b=(isNaN(parseInt(A.getPropertyValue("padding-right"))))?0:parseInt(A.getPropertyValue("padding-right"));y=k+b}var E=this.mObj.offsetWidth-y;this.mFieldSetNode.style.width=E+"px"}}}var v=this.mPageBody;if(v){var f=document.defaultView.getComputedStyle(v,"");if(f!=null){v.style.setProperty("padding-right","")}}var B=this.mFieldSetNode.offsetWidth;var u=this.mFieldSetNode.offsetHeight;var D;if(u==0){u=parseInt(this.mObj.style.height)}if(B==1){B=this.size}if(u==1){u=this.size}this.AdjustBackgroundImage(B,u);if(this.mFillModel){if(this.mState==1){var z=0,o=0;D=this.mFieldSetNode.getAttribute("arbwidth");if(D==0){D=this.mFieldSetNode.getAttribute("arbw")}if(D){var d=D.split(",");if(d.length==1){z=o=parseInt(d[0])*2}else{o=parseInt(d[0])+parseInt(d[2]);z=parseInt(d[1])+parseInt(d[3])}}var g=this.mFieldSetNode.getAttribute("armargin");var C=(g?parseInt(g):0);if((this.getFillStyle()==2)||(this.getFillStyle()==1)){C+=z}this.mFillModel.ReCalculateNewLayout(((B-C)<0)?0:B-C,((u-o)<0)?0:u-o)}else{this.mResizeOnExpand=true}}};DPage.prototype.GetFocusElementForEvent=function(b){var f=b.element;if(this.mHeader){if(this.isPartOfHeader(f)){for(var d=f;d!=this.mObj;d=d.parentNode){if(d.tagName=="A"&&d.parentNode.className.indexOf("PageHeader")!=-1){return f}}return null}}if(this.mParentObj){return this.mParentObj.GetFocusElementForEvent(b)}};DPage.prototype.TabableElementSelector=function(b){if(this.mHeader){if(this.mParentObj&&this.isPartOfHeader(b)&&b.tagName=="A"){return b}}return null};DPage.prototype.DOMFocus=function(b){var d=b.element;if(this.mHeader&&d!=null){if(this.mParentObj&&this.isPartOfHeader(d)){if(FocusMgr.mCurFocusElement!=this.mHeader&&FocusMgr.mCurFocusElement!=this.mSpan&&FocusMgr.mCurFocusElement!=this.mAnchor){FocusMgr.mCurFocusElement=null}return DPage.superclass.DOMFocus.call(this,b)}}if(this.mParentObj){return{c:{t:this.mParentObj,f:this.mParentObj.DOMFocus,a:[b]}}}};DPage.prototype.GetFocusElement=function(){if(this.mParentObj){if(this.mAnchor){return this.mAnchor}return this.mParentObj.getFocusElementForTab(this.mID)}else{return this.mObj}};DPage.prototype.changeSize=function(d){var b=this.mParentObj.mViewTypeObj;this.size=(this.mHeader)?(d-20):d;if(this.size<0){return}if(b&&b.mOrientation=="vertical"){if(this.mFieldSetNode.style.height=="auto"){return}if(this.mFit&&this.mObj.getAttribute("arfillstyle")==2){this.mFieldSetNode.style.height="auto"}else{this.mFieldSetNode.style.height=this.size+"px"}}else{this.mFieldSetNode.style.width=this.size+"px"}this.processChildren()};DPage.prototype.processChildren=function(){if(resizeWindow){var b=this;setTimeout(function(){b.ResizeChildren()},0)}else{this.ResizeChildren()}};DPage.prototype.SState=function(b){if(this.mParentObj){return this.mParentObj.HandleState(this,b)}return null};DPage.prototype.expand=function(d,k){if(this.mState==1&&(k==false)){return}var h=this.mState;this.mState=1;this.mFieldSetNode.style.display="";var b=this.mParentObj.mViewTypeObj;if(typeof AnimMgr!="undefined"){if(b.mOrientation=="vertical"){AnimMgr.WipeInPanel(this.mFieldSetNode,1,this.size,this)}else{AnimMgr.WipeInPanel(this.mFieldSetNode,0,this.size,this)}}else{this.afterExpand(false)}if(this.mSpan&&this.mSpan.className.indexOf("Twisty")!=-1){this.mSpan.innerHTML="";var f;if(this.mParentObj&&this.mParentObj.mViewTypeObj.mOrientation=="horizontal"){f="\u25BA"}else{f="\u25BC"}var g=document.createTextNode(f);this.mSpan.appendChild(g)}if(h==0){AsyncField_IncrAsyncRef(this.windowID,this.mID,-1)}if(b!=null&&b.mStackViewType=="fixed"){if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}if(d&&d==true){if(!getCurWFC_NS(this.windowID)){promptBar.setToClear()}return ExecuteWorkflow(this.windowID,33554432,this.mID)}};DPage.prototype.collapse=function(d,h){if(this.mState==0&&h==false){return}var k=this.mState;this.mState=0;var b=this.mParentObj.mViewTypeObj;if(typeof AnimMgr!="undefined"&&this.GVis()){if(b.mOrientation=="vertical"){this.size=(this.mFieldSetNode.offsetHeight==0)?parseInt(this.mFieldSetNode.style.height):this.mFieldSetNode.offsetHeight;AnimMgr.WipeOutPanel(this.mFieldSetNode,1,this)}else{this.size=(this.mFieldSetNode.offsetWidth==0)?parseInt(this.mFieldSetNode.style.width):this.mFieldSetNode.offsetWidth;AnimMgr.WipeOutPanel(this.mFieldSetNode,0,this)}}else{this.size=(this.mParentObj.mViewTypeObj.mOrientation=="vertical")?this.mFieldSetNode.offsetHeight:this.mFieldSetNode.offsetWidth;if(this.size==0){this.size=(this.mParentObj.mViewTypeObj.mOrientation=="vertical")?parseInt(this.mFieldSetNode.style.height):parseInt(this.mFieldSetNode.style.width)}this.mFieldSetNode.style.display="none"}if(this.mSpan&&this.mSpan.className.indexOf("Twisty")!=-1){this.mSpan.innerHTML="";var f;if(this.mParentObj&&this.mParentObj.mViewTypeObj.mOrientation=="horizontal"){f="\u25BC"}else{f="\u25BA"}var g=document.createTextNode(f);this.mSpan.appendChild(g)}if(k==1){AsyncField_IncrAsyncRef(this.windowID,this.mID,1)}if(b!=null&&b.mStackViewType=="fixed"){if(this.mParentObj){this.mParentObj.mAsyncDirty=(1>this.mParentObj.mAsyncDirty?1:this.mParentObj.mAsyncDirty)}}if(d&&d==true){if(!getCurWFC_NS(this.windowID)){promptBar.setToClear()}return ExecuteWorkflow(this.windowID,67108864,this.mID)}};DPage.prototype.IsVisible=function(){if(this.mParentObj){return this.mParentObj.IsPageVisible(this)}else{return this.mObj.style.visibility!="hidden"}};DPage.prototype.AdjustBackgroundImage=function(d,z){var f=this.mBackgroundIMG;if(f!=null){var b=f.parentNode;var v=b.getAttribute("a");var k=b.getAttribute("j");if(typeof v!="undefined"){if(v==2){f.style.top=((z-f.height)/2)+"px"}else{if(v==5){var s=b.getElementsByTagName("IMG");var u=f.offsetHeight;var A=u*s.length;while(z>A){var o=this.createIMG(f);o.style.left="0px";o.style.top=A+"px";b.appendChild(o);A+=u}}}}if(typeof k!="undefined"){if(k==2){f.style.left=((d-f.width)/2)+"px"}else{if(k==5){var s=b.getElementsByTagName("IMG");var y=f.offsetWidth;var g=y*s.length;while(d>g){var o=this.createIMG(f);o.style.left=g+"px";o.style.top="0px";b.appendChild(o);g+=y}}}}}};DPage.prototype.createIMG=function(b){var d=document.createElement("IMG");d.style.width=b.style.width;d.style.height=b.style.height;d.src=b.src;d.galleryimg="no";d.className="FormContainerImage";d.alt="";return d};DPage.prototype.getChildScroll=function(f){var d=0;if(this.getFillStyle()==2){this.setDirty(0)}else{if(this.mParentObj!=null){var b=this.mParentObj.mViewTypeObj;if(b!=null&&b.mOrientation=="vertical"){d=f.getScrollheight()}else{if(b!=null&&b.mOrientation=="horizontal"){d=f.getScrollwidth()}}if(d>0){this.setDirty(d)}}}};DPage.prototype.setDirty=function(d){if(this.mParentObj){var b=this.mParentObj.mViewTypeObj;if(b!=null&&(b.mStackViewType=="fixed"||b.mStackViewType=="resizable")){if((this.mFillModel)&&(this.mState==1)){for(var f=0;f<b.mChildren.length;f++){if(b.mChildren[f].mPageField!=null&&(this.mID==b.mChildren[f].mPageField.mID)){if(b.mChildren[f].mWhitespace==true&&b.mChildren[f].mVisible==true){d+=3;if(b.mStackViewType=="fixed"){this.mScrollHeight=d}PageDirty=true}}}}}if(PageDirty&&!b.mDraw){if(getCurWFC_NS(this.windowID)!=null){getCurWFC_NS(this.windowID).AddCallback(b,b.DoLayout,[])}else{new WorkflowContext(this.windowID,{t:b,f:b.DoLayout,a:[]})}}}};DPage.prototype.getScrollheight=function(){var b=0;var d=this.mFieldSetNode.firstChild;if(d.scrollHeight>d.offsetHeight){b=d.scrollHeight-d.offsetHeight}return b};DPage.prototype.getFillStyle=function(){return this.mObj.getAttribute("arfillstyle")};DPage.prototype.isFitToContent=function(){var b=false;if(this.mObj.getAttribute("arfillstyle")==1){if(this.mParentObj&&this.mParentObj.mViewTypeObj.mStackViewType&&this.mParentObj.mViewTypeObj.mStackViewType=="fixed"&&this.mFit){b=true}}return b};DPage.prototype.getPaneAttributes=function(){if(this.mParentObj){var b=this.mParentObj.mViewTypeObj;if(b!=null&&(b.mStackViewType=="fixed")){if((this.mFillModel)&&(this.mState==1)){for(var d=0;d<b.mChildren.length;d++){if(b.mChildren[d].mPageField!=null&&(this.mID==b.mChildren[d].mPageField.mID)){this.mxSize=b.mChildren[d].mMaxSize;this.mFit=b.mChildren[d].mWhitespace}}}}}};function getFlashURL(f,d){if(!getPlatform()){var g=f.getAttribute("aropacity");if((g==null||g=="1.0"||g=="0.0")&&(f.getAttribute("arradius")==null)&&f.getAttribute("argcolor")==null){return}else{var b=RelContextPath+"resources/swf/background.swf?";if(f.getAttribute("aropacity")!=null){b+="a="+f.getAttribute("aropacity")}if(f.getAttribute("argcolor")!=null){b+="&c="+f.getAttribute("argcolor")}else{if(f.getAttribute("arcolor")!=null){b+="&c="+f.getAttribute("arcolor")}}if(f.getAttribute("arbcolor")!=null){b+="&b="+f.getAttribute("arbcolor").substring(1)}if(f.getAttribute("arbwidth")!=null){b+="&t="+f.getAttribute("arbwidth")}if(f.getAttribute("vtext")!=null){b+="&v="+f.getAttribute("vtext")}if(f.getAttribute("otop")!=null){b+="&y="+f.getAttribute("otop")}if(f.getAttribute("rotate")!=null){b+="&d="+f.getAttribute("rotate")}if(f.getAttribute("tfont")!=null){b+="&f="+f.getAttribute("tfont")}if(f.getAttribute("arradius")!=null){b+="&r="+f.getAttribute("arradius")}getFlashObject(f,b,d,this.windowID+"",this.mID+"")}}else{getPlatformColor(f,f)}}function getFlashObject(b,d,o,y,u,f,w){var g="";var k=d.indexOf("?");if(k>-1){g=d.substring(k+1);if(g.charAt(0)=="&"){g=g.substring(1)}d=d.substring(0,k)}g+=(g.length>0)?"&wi=":"wi=";g+=y+"&fi="+u;var v=b.childNodes[1];var h=document.createElement("embed");if(v.className&&v.className.indexOf("flchild")!=-1){h.style.position="relative";var s=v.offsetHeight;h.style.top="-"+s+"px";h.style.zIndex="0"}h.setAttribute("src",d);h.setAttribute("quality","high");h.className="bkgImg";h.setAttribute("name","bkgFlashImg"+o);h.setAttribute("type","application/x-shockwave-flash");h.setAttribute("wmode","transparent");h.setAttribute("FlashVars",g);b.appendChild(h)}function UpdateFlashAttributes(f,d,b,g){var h=f.getElementsByTagName("EMBED");if(h!=null){for(i=0;i<h.length;i++){f.removeChild(h[i])}}getFlashObject(f,d,b+"",g+"")}function getLabelforHeaders(d){var b=d.getElementsByTagName("SPAN");for(i=0;i<b.length;i++){if(b[i].className.indexOf("label")!=-1){return getVerticalText(b[i])}}}function getGradientforHeader(f,b){var d=RelContextPath+"resources/swf/background.swf?a=1&c="+f.getAttribute(b)+"&t=0";return d}function getPlatform(){var b=navigator.platform;enableFlashUIRendering=false;if((b.indexOf("Linux")!=-1)||(b.indexOf("SunOS")!=-1)||!enableFlashUIRendering){return true}else{return false}}function getPlatformColor(k,f){if(k.getAttribute("argcolor")!=null){var b=k.getAttribute("argcolor");f.style.backgroundColor="#"+b.substr(2,6)}else{if(k.getAttribute("arcolor")!=null){var b=k.getAttribute("arcolor");if(b==""){b="ffffff"}f.style.backgroundColor=((b.charAt(0)=="#")?b:("#"+b))}}if(k.getAttribute("arradius")!=null){if((k.getAttribute("arbcolor")!=null)&&(k.getAttribute("arbwidth")!=null)){var d=k.getAttribute("arbcolor");var g=k.getAttribute("arbwidth");var h=g.split(",");f.style.borderTop=h[0]+"px solid "+d;f.style.borderRight=h[1]+"px solid "+d;f.style.borderBottom=h[2]+"px solid "+d;f.style.borderLeft=h[3]+"px solid "+d}}}function getVerticalText(d){var b;if(d.getAttribute("vtext")!=null){b="&v="+d.getAttribute("vtext")}if(d.getAttribute("tcolor")!=null){b+="&l=0&k="+d.getAttribute("tcolor")}if(d.getAttribute("otop")!=null){b+="&y="+d.getAttribute("otop")}if(d.getAttribute("rotate")!=null){b+="&d="+d.getAttribute("rotate")}if(d.getAttribute("tfont")!=null){b+="&f="+d.getAttribute("tfont")}return b}function UpdateFlashObject(b,d,v,h,u){var k="";var o=d;var s=d.indexOf("?");if(s>-1){k=d.substring(s+1);if(k.charAt(0)=="&"){k=k.substring(1)}d=d.substring(0,s)}var g=false;var w=getFormContext(v).fields[h];if(w!=null&&w.isFlashInit()){g=true}var f=b.getElementsByTagName("EMBED");if(g&&f!=null&&f.length>0&&typeof f[0]=="function"){f[0].updateParams(k)}else{u++;if(u<=10){setTimeout(function(){UpdateFlashObject(b,o,v,h,u)},5)}}}DPage.prototype.getPanelWidth=function(){return this.mObj.offsetWidth};DPage.prototype.getPanelHeight=function(){return this.mObj.offsetHeight};JStatusHistory.prototype=new JChar();JStatusHistory.prototype.constructor=JStatusHistory;JStatusHistory.superclass=JChar.prototype;function JStatusHistory(b,f,d){if(arguments.length){this.init(b,f,d)}}JStatusHistory.prototype.G=function(){var b=JStatusHistory.superclass.G.call(this);if(b.isNull){return Null}return new StatusHistoryType(b)};JStatusHistory.prototype.mIsComplexField=true;function arInvokeGuide(b,d,f){if(typeof d!="string"||typeof f!="string"){return}var g=getCurWFC_NS(b);if(g){return g.execute({f:ARACTCallGuide,a:[b,d,f,true]})}else{new WorkflowContext(b,{f:ARACTCallGuide,a:[b,d,f,true]})}}function ARACTCallGuide(g,z,B,C,u,w){var d=z;z=ExpandServerName(g,z);if((z=="")||(z==null)){var f="";var y=d.split("$");var D=0;for(;D<y.length;D++){if(y[D].length>0){f=y[D];break}}var A=F(g,f).GLabelOrName();var o=getLocalizedMessage(9427,[A]);var G={n:9427,t:2,m:o,a:null};throw new WorkflowException(g,0,[{mstat:G,msgloc:null}])}B=ExpandGuideName(g,B);LogGuideMessage1(g,B,z);var h="AREVTGuide"+B.ARToJSIdentifier();var E=getFormWorkflowHolder(ExpandServerName(g,"@"),getFormContext(g).formName,getFormContext(g).view);if(h in E){var v=getCurWFC_NS(g).getGuideState();if(v&&v.g==B){LogWrite("Warning: Current guide not executed; Guide is called recursively. Guide being called recursively is:"+B);return}var k={g:B};var s={c:{},n:{f:ARACTCallGuideCont,a:[g],e:ARACTCallGuideException,ea:[g]}};if(u){var H=F(g,u);if(H instanceof DTable){k.table=H;k.row=0;k.oldrow=H.GetRow();k.selected=(w==2)?H.GetSelectedRows():null;k.looptype=w;k.func=E[h];s.c.f=ARACTRunLoopGuide;s.c.a=[g];s.c.t=E}else{return}}else{s.c.f=E[h];s.c.a=[g];s.c.t=E}getCurWFC_NS(g).enterGuide(k);return s}else{var b=new NDXGetGuideServerAndForm(g,z,B);var I=b.GetResult();if(I.server==ARKWGetStringByIdx(g,7)&&I.form==ARKWGetStringByIdx(g,6)){var o=getLocalizedMessage(9371,[B]);throw new WorkflowException(g,0,[{t:2,n:9371,m:o,a:null}])}return OpenNonModalForm(g,1,I.server,I.form,I.view,{wMode:2,runGuide:{server:z,guidename:B,hidden:C,tableid:u,looptype:w}})}}function ARACTCallGuideException(d,b){if(typeof d!="object"||!(d instanceof WorkflowException)){throw d}ARACTCallGuideCont(b);switch(d.mCode){case 3:return;case 4:if(getCurWFC_NS(b).getGuideState()==null){return}default:throw d}}function ARACTCallGuideCont(d){var g=getCurWFC_NS(d);var f=g.getGuideState();if(f.table){if(f.oldrow>=f.table.GetData().length){f.oldrow=-1}f.table.SetRow(f.oldrow);if(f.oldrow>=0){var b=f.table.TagFromRowNo(f.oldrow);f.table.mRowSelections[b]=true;f.table.mPrimaryRowSelection=b}else{f.table.mRowSelections=[];f.table.mPrimaryRowSelection=null}}if(f&&f.g){LogGuideExit(d,f.g)}g.exitGuide()}function ARACTRunLoopGuide(b){var h=getCurWFC_NS(b);var d=h.getGuideState();var g=getFormWorkflowHolder(getFormContext(b).server,getFormContext(b).formName,getFormContext(b).view);if(d.looptype==2){while(d.selected[d.row]<d.table.GetRows()){LogLoopGuide(b,"selrow "+d.selected[d.row]+"/"+d.selected.length+"/"+d.table.GetRows());d.currow=d.selected[d.row];d.table.SetRow(d.currow);++d.row;var f=h.execute({t:g,f:d.func,a:[b]});if(f){return{i:1,n:{f:ARACTRunLoopGuide,a:[b]}}}}}else{if(d.looptype==4){d.table.mActualDisplayChunkSize=d.table.GetRows();if(d.table.mDisplayChunkSize!=null){d.table.mDisplayChunkSize=null}if(!("ccvisiblecntmax" in d)){d.ccvisiblecntmax=-1;if(d.table.isContentClipped){d.ccvisiblecntmax=d.table.getActualDisplayChunkSize()}}if(!("ccvisiblecnt" in d)){d.ccvisiblecnt=0}if(!("cont" in d)){d.cont=true}while(d.cont&&d.row<d.table.GetRows()){if(d.table.mResult.r[d.row].mXXXDirty==3){LogGuideMessage(b,"LoopGuideVisible: row "+d.row+" is deleted. Skipping");++d.row}else{LogGuideMessage(b,"LoopGuideVisible: row "+d.row);d.currow=d.row;d.table.SetRow(d.currow);++d.row;++d.ccvisiblecnt;var f=h.execute({t:g,f:d.func,a:[b]});if(d.table.isContentClipped&&d.ccvisiblecnt>=d.ccvisiblecntmax){d.cont=false}if(f){return{i:1,n:{f:ARACTRunLoopGuide,a:[b]}}}}}}else{while(d.row<d.table.GetRows()){LogGuideMessage(b,"LoopGuide: row "+d.row+"/"+d.table.GetRows());d.currow=d.row;d.table.SetRow(d.currow);++d.row;var f=h.execute({t:g,f:d.func,a:[b]});if(f){return{i:1,n:{f:ARACTRunLoopGuide,a:[b]}}}}}}}function ARACTSetVisibility(g,b,d){if(b==1020&&getForm_NS(g).UseResultsListPane){return}var k="Hidden";if(d){k="Visible"}var h=F(g,b);LogWrite('<div class="aract_non_deb">Change Field "'+h.GLabelOrName()+"("+b+')" To '+k);h.SVis(d?true:false);if(h.mFloat&&h.mFloat==2){if(d){formModalList.addToStack(h)}else{formModalList.removeFromStack(h)}}else{if(h.mFloat&&h.mFloat==3){if(d){formTTList.show(h,false)}}}}function ARACTSetAccess(f,d,b){var g="Read Only";if(b==2){g="Read/Write"}else{if(b==3){g="Disabled"}}LogWrite('<div class="aract_non_deb">Change Field "'+F(f,d).GLabelOrName()+"("+d+')" Access To '+g);F(f,d).SAccess(b)}function ARACTSetEntryMode(f,b,k,o,h){var d="Required";if(k==0){d="Optional"}var g=F(f,b);LogWrite('<div class="aract_non_deb">Change Field "'+g.GLabelOrName()+"("+b+')" entry-mode to process '+d+", required Field identifier character is "+o+", required Field identifier character location is "+h);if(g instanceof DataField){if(k==1&&(!((typeof g.mCFCache.r!="undefined")&&g.mCFCache.r==1))){g.setBoldness(true);g.setDecorator(o,h);g.mCFCache.r=1}else{if(k==0&&(!((typeof g.mCFCache.r!="undefined")&&g.mCFCache.r==0))){g.UpdateLabel(g.GLabel());g.setBoldness(false);g.RemoveHighlightBorder();g.mCFCache.r=0}}}}function ARACTSetLabelColour(d,b,g){var f="Default";if(g!=null){f=g}LogWrite('<div class="aract_non_deb">Change Field "'+F(d,b).GLabelOrName()+"("+b+')" label Color to '+f);F(d,b).SColour(g)}function ARACTSetLabel(d,b,f){f=ExpandString(d,f,1);LogWrite('<div class="aract_non_deb">Change Field "'+F(d,b).GLabelOrName()+"("+b+')" label To -- '+f);F(d,b).SLabel(f)}function ARACTSetFont(d,b,f){var g="";switch(f){case"f0":g="Detail Text";break;case"f1":g="Edit Field";break;case"f2":g="Header Text(I)";break;case"f3":g="Header Text(II)";break;case"f4":g="Header Text(III)";break;case"f5":g="Note Text";break;case"f6":g="Optional Field";break;case"f7":g="Push Button";break;case"f8":g="Radio Button";break;case"f9":g="Required Field";break;case"f10":g="System Field";break;default:g="Unchanged";break}LogWrite('<div class="aract_non_deb">Change Label Font On Field "'+F(d,b).GLabelOrName()+"("+b+')" -- '+g);F(d,b).SFont(f)}function ARACTSetMenu(d,b,f){LogWrite('<div class="aract_non_deb">Set Field "'+F(d,b).GLabelOrName()+"("+b+')" Menu To '+f);F(d,b).SMenu(f)}function ARACTTableRefresh(d,b){var g=F(d,b);LogWrite('<div class="aract_non_deb">Refresh Table Action Called On Field "'+g.GLabelOrName()+"("+b+')"');if(g instanceof DTable){var f;if(isTableAutoRefreshExcludedForSessionTimeout){f="SessionExcludedTableAutoRefreshCall"}var h=getCurWFC_NS(d);if(h.enableWaitCursor==0){return g.Refresh(-1,0,false,0,f)}else{return g.Refresh(-1,0,false,undefined,f)}}}function callBulkRefresh(windowID,args,tableprops,tblAtRef){var cWFC=getCurWFC_NS(windowID);var tableAutoRefreshWithSessExcld;if(isTableAutoRefreshExcludedForSessionTimeout&&(typeof tblAtRef!="undefined")&&(tblAtRef=="tblAtRefExcld")){tableAutoRefreshWithSessExcld="SessionExcludedTableAutoRefreshCall"}else{tableAutoRefreshWithSessExcld="DisabledSessionExcludedTableAutoRefreshCall"}if(ShowWaitCursor()&&cWFC.enableWaitCursor!=0){var req=new NDXRequest();return{isFromFunctionSplit:1,c:{t:req,f:function(){req.windowID=windowID;req.AsyncBC("GetBulkTableEntryList",windowID,args,tableAutoRefreshWithSessExcld);req.showRunning();weDisableStuff(windowID);return{i:1}}},n:{t:req,f:function(){var result=eval(req.result);var part2=[];for(var i in result){var prop=tableprops[i];var rr=F(windowID,i).RefreshTable_part2(result[i],prop[0],prop[1],prop[2]);if(typeof rr!="undefined"){part2.push(rr)}}getCurWFC_NS(windowID).pushEntryForBulk(part2)}}}}else{var req=new NDXGetBulkTableEntryList(windowID,args,tableAutoRefreshWithSessExcld);var result=eval(req.result);var part2=[];for(var i in result){var prop=tableprops[i];var rr=F(windowID,i).RefreshTable_part2(result[i],prop[0],prop[1],prop[2]);if(typeof rr!="undefined"){part2.push(rr)}}getCurWFC_NS(windowID).pushEntryForBulk(part2);return null}}function ARACTBulkTableRefresh(){var windowID=arguments[0];var tblAtRef=arguments[1];var args=[];var tableprops=[];for(var i=2;i<arguments.length;i++){var table=F(windowID,arguments[i]);if(!(table instanceof DTable)){continue}var start,maxrows,oldcurrow=null;var refreshmode=parseInt(table.mObj.getAttribute("arselrefresh"));if(this.mNotRefreshed||(refreshmode!=0&&refreshmode!=1)){table.ClearSelections(true)}if(table.getDisplayChunkSize()>0){if(table.mResult){var maxpage=Math.ceil(table.mResult.n/table.getDisplayChunkSize());if(table.mChunkPage>=maxpage){table.mChunkPage=maxpage-1}}if(table.mChunkPage<0){table.mChunkPage=0}start=(startrow>=0)?startrow:table.mChunkPage*table.getDisplayChunkSize();maxrows=(numrows>0)?numrows:table.getChunkSize()}else{start=(startrow>=0)?startrow:0;maxrows=(numrows>0)?numrows:parseInt(table.mObj.getAttribute("armaxrows"))}if(table.mNotRefreshed&&table.mSortOrder.length==0){var sortorder=table.GetSortPreference();if(sortorder==null){sortorder=table.GetInitialRowSortOrder();if(sortorder!=null){table.RebuildSortOrder(sortorder.col,sortorder.dir)}}}var refreshmode=parseInt(table.mObj.getAttribute("arselrefresh"));var server=table.mObj.getAttribute("arserver");server=ExpandServerName(windowID,server);var schema=table.mObj.getAttribute("arschema");schema=ExpandSchemaName(windowID,schema);table.mSchema=schema;var qual;if(typeof this.mQual!="undefined"){qual=table.mQual}else{qual=table.mObj.getAttribute("arqual");eval("qual="+qual)}var optimizeCall=IsExternQualOptimizable(windowID,qual);qual=ExpandQualifier(windowID,qual,schema,server,optimizeCall);var startrow=-1,numrows=0;var maxrows,start;if(table.getDisplayChunkSize()>0){start=(startrow>=0)?startrow:table.mChunkPage*table.getDisplayChunkSize();maxrows=(numrows>0)?numrows:table.getChunkSize()}else{start=(startrow>=0)?startrow:0;maxrows=(numrows>0)?numrows:parseInt(table.mObj.getAttribute("armaxrows"))}var p=[start,maxrows,refreshmode];tableprops[arguments[i]]=p;var irid=table.getImgRefIds();var iccid=table.getCColorIds();args.push(MarshallArgsWrapper("GetTableEntryList",ARKWGetStringByIdx(windowID,7),ARKWGetStringByIdx(windowID,6),ARKWGetStringByIdx(windowID,17),table.mID,server,schema,((ARKWGetStringByIdx(windowID,21)!=null)?ARKWGetStringByIdx(windowID,21):""),start,maxrows,table.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,qual.fieldexterns,optimizeCall,irid,iccid))}if(args.length==0){return}return callBulkRefresh(windowID,args,tableprops,tblAtRef)}function MarshallArgsWrapper(w,y,B,d,o,f,g,h,u,A,b,s,k,v,z){return MarshallArgs(arguments)}function ARACTExpandCollapseTreeLevels(f,b,d){var g="Expand All Levels of Field";if(d==2){g="Collapse All Levels of Field"}var h=F(f,b);LogWrite('<div class="aract_non_deb">'+g+' "'+h.GLabelOrName()+"("+b+')"');if(h instanceof DTreeView){if(d==1){h.ExpandAll()}else{if(d==2){h.CollapseAll()}}}if(h instanceof DTable&&h.mGroup){if(d==1){h.expandPending="expanded"}else{if(d==2){h.expandPending="collapsed"}}}}function ARACTSetPageState(d,b,g){var f="COLLAPSE";if(g){f="EXPAND"}LogWrite('<div class="aract_non_deb">Set Page state to '+f);var h=F(d,b);if(h instanceof DPage){if(h.mParentObj&&h.mParentObj.mViewTypeObj){if(!h.mParentObj.mViewTypeObj.mPostCreate&&h.mParentObj.mViewTypeObj.postCreate){h.mParentObj.mViewTypeObj.postCreate()}}}return h.SState(g)}function ARACTSetFocus(d,b){LogWrite('<div class="aract_non_deb">Set Focus To Field "'+F(d,b).GLabelOrName()+"("+b+')"');return{n:{t:FocusMgr,f:FocusMgr.SetFocusToField,a:[d,b]}}}function ARACTIndirectChangeField(h,d,b){var k=F(d,b).G().toString();k=k.trim(1|2);if(k.isNumeric()){b=parseInt(k);var f=new Array(arguments.length-1);f[0]=d;f[1]=b;for(var g=2;g<arguments.length-1;++g){f[g]=arguments[g+1]}return h.apply(null,f)}}function ARACTSetDraggable(f,d,b){var g="Field is Set to Not-Draggable(Disable)";if(b){g="Field is Set to Draggable(Enable)"}LogWrite('<div class="aract_non_deb">Field "'+F(f,d).GLabelOrName()+"("+d+')" is set to '+g);F(f,d).SDraggable(b?true:false)}function ARACTSetDroppable(d,b,g){var f="Field is set to Not-Droppable(Disable)";if(g){f="Field is set to Droppable(Enable)"}LogWrite('<div class="aract_non_deb">Field "'+F(d,b).GLabelOrName()+"("+b+')" is set to '+f);F(d,b).SDroppable(g?true:false)}function ARACTSetExpandBoxVisibility(h,b,g,s){var d="HIDDEN";if(g){d="VISIBLE"}var o=F(h,b);LogWrite('<div class="aract_non_deb">Set Field "'+o.GLabelOrName()+"("+b+')" Expand Box to '+d);if(s==231){for(var k=o.mObj.firstChild;k;k=k.nextSibling){if(k.nodeType==1){if((k.tagName=="A")&&((k.className.indexOf("expand")!=-1)||(k.className.indexOf("edit")!=-1)||(k.className.indexOf("richtext")!=-1))){k.style.display=(g?"block":"none");k.style.visibility=(g?"inherit":"hidden")}}}}else{if(s==5224){for(var k=o.mObj.firstChild;k;k=k.nextSibling){if(k.nodeType==1){if((k.tagName=="A")&&k.className.indexOf("menu")!=-1){k.style.display=(g?"block":"none");k.style.visibility=(g?"inherit":"hidden")}}}}}}function ARACTSetBorderVisibility(h,b,g){var d="HIDDEN";if(g){d="VISIBLE"}var k=F(h,b);LogWrite('<div class="aract_non_deb">Set Field "'+k.GLabelOrName()+"("+b+')" Border Visibility to '+d);if(g==0){k.mInputNode.style.border="none"}else{k.mInputNode.style.border="1px solid #717375";k.mInputNode.style.borderColor="#6b7479 #bbc4c9 #bbc4c9 #6b7479"}}function ARACTCloseWindow(d,b){var f="Close";if(b){f="Close All"}LogWrite('<div class="aract_non_deb">'+f+" Form Window");return{c:{f:weDisplayWFNotes,a:[d,window]},n:{f:ARACTCloseWindowP2,a:[d,b]}}}function ARACTCloseWindowP2(d,b){var g={};var f=getStateMgr_NS(d);return{c:{t:f,f:f.WindowIsClosing,a:[g]},n:{f:function(o,k,h){if(!k.ab){getStateMgr_NS(h).mWindowIsClosed=true;if(o==0){if(weAmDialogue(window.name)){weCloseDialogue(h,window.weDialogueReturnValue)}else{weCloseWindow(h,window,true)}}else{var s=window;var u=s;while(u){u=s.weGetOpener();if(u){if(!u.closed){s=u}else{break}}}s.weCloseAllWindows(h,s,true,null)}throw new WorkflowException(h,0,[])}},a:[b,g,d]}}}function LogOutmapParms(b,d){switch(d.type){case 12:case 6:if(b==123||b==102||b==125){LogWrite("Committing field "+b+" back to parent with value ******")}else{LogWrite("Committing field "+b+" back to parent with value "+d.toPrimitive())}break;default:if(b==123||b==102||b==125){LogWrite("Committing field "+b+" back to parent with value ******")}else{LogWrite("Committing field "+b+" back to parent with value "+d.toString())}}}function ARACTCommit(windowID){LogWrite('<div class="aract_non_deb">Commit Changes');if((getARStateCurrent_NS(windowID)==2)){try{var testOpener=window.weGetOpener(windowID).name}catch(e){LogAndAlert("Cannot commit changes because the parent window has been closed.");return null}var weArgs=getWindowArgs_NS(windowID);if(weArgs!=null&&"fvout" in weArgs){var dlgOut=new FieldList(windowID);var fields=getFields_NS(windowID);for(var item in fields){var val={t:fields[item].G().type,v:fields[item].G().toPrimitive()};dlgOut.AddField(item,Datatype_Factory(val))}var myOpener=window.weGetOpener(windowID);if(weArgs.fvout==null){LogWrite("No output parms")}for(var item in weArgs.fvout){if(typeof(weArgs.fvout[item])!="function"){var value=eval(weArgs.fvout[item]);if(typeof fields[item]!="undefined"&&typeof fields[item].mEncryptDataAtRest!="undefined"){LogOutmapParms(item,(fields[item].mEncryptDataAtRest?value.toString().replace(/./g,"*"):value))}else{LogOutmapParms(item,value)}var tvalue=value.toPrimitive();if(tvalue!=null){tvalue=tvalue.replace(/<marquee([^<>]+)?>(.+?)<\/marquee>/gi," ");tvalue=tvalue.replace(/&lt;marquee[^"\r\n]*marquee&gt;/gi," ")}myOpener.SetFieldFromDialog(weGetDialogueParentID(),item,{t:value.type,v:tvalue})}}}}else{return FormAction_GenericApply(windowID)}}function ARACTExitGuide(f,d){var b="Current";if(d){b="All"}LogWrite('<div class="aract_non_deb">Exit Guide('+b+") Action Called:");if(ARKWGetStringByIdx(f,20)==null){LogWrite('<div class="aract_non_deb">No Guide Running');return}if(d){LogGuideExitAll(f);throw new WorkflowException(f,4)}else{throw new WorkflowException(f,3)}}function ARACTGoto(b,g){if(getCurWFC_NS(b).getGuideState()!=null){var f=getCurWFC_NS(b).getGuideState();var d=("g" in f)?f.g:" ";LogWrite('<div class="event">Goto EO -- '+g+" : inside guide "+d+", GOTO ignored");return}LogWrite('<div class="event">Goto EO -- '+g);if(g<0){g=0}else{if(g>1000){g=1000+1}}throw new WorkflowException(b,1,g)}function ARACTGotoGuideLabel(b,d){LogGuideMessage(b,"GotoGuideLabel("+b+", "+d+")");ARGotoGuideLabel(b,d)}function ARACTMessage(f,k,g,b,d){var u=d;if(k==7){u=u.HTMLEncode()}LogWrite('<div class="aract_non_deb">Message ['+g+"] "+u);d=ExpandString(f,d,1|2|4|8);u=d;if(k==7){u=u.HTMLEncode()}LogWrite("Expanded Message : "+u);var o=[{t:k,n:g,m:d,a:null}];if(k==2||k==3){var s=(b)?0:1;getCurWFC_NS(f).status(o,s)}else{if(k==7){var h={n:{f:ARACTToolTip,a:[f,o]}}}else{var h={n:{f:ARACTMessageP2,a:[f,o,b]}};if(getCurWFC_NS(f).notes.length>0){h.c={f:WC_DisplayMessage,a:[f,getCurWFC_NS(f).notes]}}}return h}}function ARACTMessageP2(b,f,h){getCurWFC_NS(b).notes=[];if(!h){window.focus()}var d=(h)?0:1;var g={mstat:f[0],msgloc:d};return WC_DisplayMessage(b,[g])}function ARACTToolTip(d,b){return toolTip.showToolTip(d,b[0].m)}function ARACTPrompt(b,f,d,g,h){h=ExpandString(b,h,1|2|4|8);window.status=getLocalizedMessage(h,null);if(f==2||f==3){getCurWFC_NS(b).status(0)}}function continueModal(d,g){var f=getCurWFC_NS(d);if(f){var b=[];b.push({f:function(){FocusMgr.SetFocusBacktoWindow()},a:[]});f.resume(b)}}function LogInmapParms(d,g){if(d==null){LogWrite("No input parms")}else{for(var k in d){switch(d[k].t){case 7:case 13:case 14:var f=DatatypeFactories[d[k].t](d[k].v);if(k==123||k==102||k==125){LogWrite("Field "+k+" input value ******")}else{LogWrite("Field "+k+" input value "+f.toString())}break;case 4:var b=getFields_NS(g);var h=false;for(var o in b){if(typeof b[o]!="undefined"&&typeof b[o].mEncryptDataAtRest!="undefined"){if(d==o&&b[o].mEncryptDataAtRest){h=true;break}}}if(h){LogWrite("Field "+k+" input value "+d[k].v.toString().replace(/./g,"*"))}else{LogWrite("Field "+k+" input value "+d[k].v.toString())}break;default:if(k==123||k==102||k==125){LogWrite("Field "+k+" input value ******")}else{LogWrite("Field "+k+" input value "+d[k].v.toString())}}}}}function ARACTOpenDialog(d,g,k,o,C,f,v,b,u,h){LogWrite('<div class="aract_non_deb">Open Dialog Window \n Server: '+g+"\n Schema: "+k+"\n View: "+o);g=ExpandServerName(d,g);k=ExpandGuideName(d,k);o=ExpandString(d,o,1|2|4);var A=false;var s=new NDXGetURLForForm(d,A,g,((ARKWGetStringByIdx(d,21)!=null)?ARKWGetStringByIdx(d,21):""),k,o,true,"","",false).GetResult();var z;if(s.dims==null){z=null}else{z=s.dims.split(",");z[0]=parseInt(z[0]);z[1]=parseInt(z[1])}LogInmapParms(f,d);var B={cb:C,fvlist:f,fvout:v,title:k};if(u){B.runGuide={server:b,guidename:u,hidden:false}}if(s.url.indexOf("?")!=-1){s.url=s.url+"&format=html"}else{s.url=s.url+"?format=html"}var y=window.weOpenDialogue(d,s.url,"FormDialog",B,continueModal,z,h);if(y){ARKWSet(d,35,y.name)}return{i:1}}function arInvokeForm(b,f,d,g){if(typeof f!="string"||typeof d!="string"||(typeof g!="number"&&typeof g!="string")){return}if(typeof g=="string"){g=g.toLowerCase().trim(1|2);if("new"==g||"submit"==g){g=2}else{if("search"==g||"query"==g){g=1}else{if("display"==g){g=11}else{g=1}}}}var h=getCurWFC_NS(b);if(h){return h.execute({f:ARACTOpenWindow,a:[b,f,d,"","Current",0,null,g,null,null,{}]})}else{new WorkflowContext(b,{f:ARACTOpenWindow,a:[b,f,d,"","Current",0,null,g,null,null,{}]})}}function ARACTOpenWindow(d,g,k,u,A,y,f,h,b,v,s){g=ExpandServerName(d,g);k=ExpandGuideName(d,k);if((typeof __tmp_app=="undefined")&&(g==""||k=="")){throw new WorkflowException(d,0,[])}u=ExpandString(d,u,1|2|4);LogWrite('<div class="aract_non_deb">Open Window \n Server: '+g+"\n Schema: "+k+"\n View: "+u);var o={wname:"",fvlist:f,wMode:h,wForceClear:1,fvSetDefaults:y};if(v){o.runGuide={server:b,guidename:v,hidden:false}}if(y){LogWrite("Input fields set to default")}else{LogInmapParms(f,d)}A=ExpandString(d,A,1|2|4);if(IsTargetLocationViewField(d,A,g,k,u,o,s)){return}var w=1;if(A.compareToIgnoreCase("current")){w=2}else{if(A.compareToIgnoreCase("newwithouttoolbar")){w=3}}if(w==2&&!weAmDialogue(window.self.name)){var z=[];z.push({f:OpenNonModalForm,a:[d,w,g,k,u,o]});this.document.body.style.visibility="hidden";setTimeout(function(){new WorkflowContext(d,z)},20);throw new WorkflowException(d,0,[]);return}return{c:{f:OpenNonModalForm,a:[d,w,g,k,u,o]},n:{f:function(D,C,B){if(D==2&&!weAmDialogue(C.self.name)){throw new WorkflowException(B,0,[])}},a:[w,window,d]}}}function ARACTOpenReportWindow(d,A,z,u,H,w,k,h,G,E,s,y,o,v,B,I){LogWrite('<div class="aract_non_deb">Open Report Window \n Server: '+A+"\n Schema: "+z+"\n View: "+u);A=ExpandServerName(d,A);z=ExpandGuideName(d,z);if(A==""||z==""){throw new WorkflowException(d,0,[])}u=ExpandString(d,u,1|2|4);H=ExpandString(d,H,1|2|4);var C="";if(s.dt){C=ExpandString(d,s.dt,1|2|4)}var g=C.indexOf(":");if(g!=-1){C=C.substr(0,g+2)}if(C!="to-file: "&&C!="to-screen: "){C="to-screen: "}var b=ExpandString(d,s.ty,1|2|4);var D=CreateReportParms(d,A,z,u,H,w,k,h,G,E,s,v,B,I);var f=(H!="Current");if(C=="to-file: "&&b=="1"){ReportToFile(d,D,A)}else{ReportToScreen(d,f,D,A,H)}return 0}function IsDestinationViewField(b,h){var d=/^VF([0-9]+)$/;if(d.test(h)){var g=F(b,h.substring(2));if(g instanceof DView){return g}}return null}var ap=null;function MakeReportKey(b){return"{0}/{1}".replaceArgs(b.length,b)}function MakeReportIntKey(b){var d=b+"";return"{0}/{1}".replaceArgs(d.length,d)}function CreateReportParms(f,y,w,o,D,v,h,g,C,B,k,s,z,H){var G=[];var u;var d;G.push((w!=null)?MakeReportKey(w):"0/");G.push((y!=null)?MakeReportKey(y):"0/");G.push((o!=null)?MakeReportKey(o):"0/");if(k.ty){d=ExpandString(f,k.ty,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(k.na){d=ExpandString(f,k.na,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(k.op){d=ExpandString(f,k.op,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(k.id){d=ExpandString(f,k.id,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(k.or){d=ExpandString(f,k.or,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(k.dt){d=ExpandString(f,k.dt,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}G.push((s!=null)?MakeReportKey(s):"0/");G.push((z!=null)?MakeReportIntKey(z):"0/");G.push((H!=null)?MakeReportKey(H):"0/");if(k.lc){d=ExpandString(f,k.lc,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(k.cs){d=ExpandString(f,k.cs,1|2|4);G.push((d!=null)?MakeReportKey(d):"0/")}else{G.push("0/")}if(h!=null){h=ExpandQualifier(f,h,w,y);if(h.qual!=""&&h.fieldids.length>0){var b=new NDXParseAndEvaluateQualifier(f,y,w,o,h.qual,h.fieldids,h.fieldvals,h.fieldtypes);h={qual:b.result,fieldids:[],fieldvals:[],fieldtypes:[]}}G.push((h.qual!=null)?MakeReportKey(h.qual):"0/")}else{G.push("0/")}if(B!=null&&B.length>0){var A=B.join(":");G.push(MakeReportKey(A))}else{G.push("0/")}if(window.opener!="undefined"&&window.opener!=null&&!window.opener.closed){var E=G.slice();E.splice(0,3);window.opener.quickReportParamURL=E.join("");window.opener.quickReportSchema=w}G.push(MakeReportKey(ARKWGetStringByIdx(f,30)));return G.join("")}function genReportHTML(d,g){var b="<div class='PageLoadProgress' style='color:#0069A5;display:inline;overflow:visible;position:absolute;left:40%;top:40%;'><div class='loadingContainer' style='padding: 5px;border:#014c8d 1px solid;background-color: #eeeeee;position:static;'><nobr><img class='loadingImage' src='"+AbsContextPath+"resources/images/Progress_NonModal-circle.gif'/><span class='loadingText' style='padding:5px;position:relative;top:-10px;'>"+getLocalizedMessage("Loading...")+"</span></nobr></div></div>";if(d.search(/to-screen/)==-1){b=""}var h='<html><head></head><body onload=document.forms["RPTDIS70"].submit()><FORM name=RPTDIS70 id=RPTDIS702 method="POST" enctype="application/x-www-form-urlencoded" accept-charset="UTF-8" action="{0}"><input type=hidden name="{1}" value="{2}"/><input type=hidden name="{3}" value="{4}"/></FORM>'+b+"</body></html>";var f=(AbsContextPath+"servlet/ReportServlet")+"/"+new Date().getTime();return h.replaceArgs(f,"REPPARM",d.HTMLEncode(),"server",g)}function ReportToScreenNew(f,b,o){var g="ReportWin"+new Date().getTime();var h=allocWindowID_NS();var d=window.weOpen(h,f,"",g,"Report",null,null,true,true);WorkflowContext.WindowOpened(f);d.arWindowType="Report";var k=d.document;k.open("text/html");k.write(genReportHTML(b,o));k.close()}function ReportToScreen(d,g,b,h,k){if(g){var f=IsDestinationViewField(d,k);if(f!=null){f.S(new CharType(genReportHTML(b,h)))}else{ReportToScreenNew(d,b,h)}}else{ReportToScreenCurrent(d,b,h)}}function ReportToScreenCurrent(f,b,k){var d=window.document.createElement("DIV");d.style.zIndex=100001;d.style.position="absolute";d.style.display="none";window.document.body.appendChild(d);var s='<FORM method="POST" action="{0}" enctype="application/x-www-form-urlencoded" accept-charset="UTF-8" target="{1}"><input type=hidden name="{2}" value="{3}"/><input type=hidden name="{4}" value="{5}"/></FORM>';var g=(AbsContextPath+"servlet/ReportServlet")+"/"+new Date().getTime();var o=s.replaceArgs(g,"_parent","REPPARM",b.HTMLEncode(),"server",k);d.innerHTML=o;var h=d.firstChild;h.submit();window.document.body.removeChild(d)}function isFedSrvURL(b){if(typeof b!="string"){return false}if(b.indexOf("RedirToFedSrvServlet")==-1){return false}else{return true}}function addFedSrvArgsToURL(d,b){if(typeof b!="object"){return d}if(!isFedSrvURL(d)){return d}if(typeof b.fvlist!="object"){return d}for(var g in b.fvlist){if((typeof b.fvlist[g].t!="undefined")&&(b.fvlist[g].t in DatatypeFactories)){var f="F"+g+"="+DatatypeFactories[b.fvlist[g].t](b.fvlist[g].v,b.fvlist[g].a).toString();d+="&"+f}}return d}function OpenNonModalForm(f,u,g,d,s,h){if(u==2&&weAmDialogue(window.self.name)){u=1}var o=u==2?window.self.name:(""+new Date().getTime());var v=(g.toLowerCase()+d)._urlencode()+o;var k=weDeepSerialiseVariable(h);var b=new NDXGetURLForForm(f,false,g,((ARKWGetStringByIdx(f,21)!=null)?ARKWGetStringByIdx(f,21):""),d,s,false,v,k,false).GetResult().url;b=addFedSrvArgsToURL(b,h);return OpenNonModalURL(f,b,u,o)}function OpenNonModalURL(d,g,b,f){ARKWSet(d,35,f);var h=allocWindowID_NS();return{c:{f:weDisplayWFNotes,a:[d,window]},n:{f:function(o){if(b==2){try{o.open(g,o.name)}catch(k){}o.arWindowType="Form";WorkflowContext.WindowOpened(d);return o.self}if(b==3){o.weOpen(h,d,g,f,"Form",null,null,false,false)}else{o.weOpen(h,d,g,f,"Form",null,null,true,false)}},a:[window]}}}function ARACTOpenQueryWindow(g,H,G,z,Q,B,s,o,d,P,N,C,v,A,I,w){H=ExpandServerName(g,H);G=ExpandGuideName(g,G);var S="";switch(B){case 10:S="Modify";break;case 12:S="Modify Direct";break;case 11:S="Display";break;case 3:S="Modify List";break;case 4:S="Modify Detail";break;case 5:S="Modify Split";break;case 13:S="Modify Directly List";break;case 14:S="Modify Direct Detail";break;case 15:S="Modify Direct Split";break;case 6:S="Display List";break;case 7:S="Display Detail";break;case 8:S="Display Split";break;case 16:S="Display Direct";break;case 17:S="Display Direct List";break;case 18:S="Display Direct Detail";break;case 19:S="Display Direct Split";break}LogWrite('<div class="aract_non_deb">Open Query Window \n Server: '+H+"\n Schema: "+G+"\n View: "+z+"\n WindowMode: "+S);if(H==""||G==""){throw new WorkflowException(g,0,[])}s=ExpandQualifier(g,s,G,H);z=ExpandString(g,z,1|2|4);var R=ExpandString(g,Q,1|2|4);var u=R.compareToIgnoreCase("Current");var y=u?window.self.name:(""+new Date().getTime());var D=(H.toLowerCase()+G)._urlencode()+y;var O=1;if(B==12||B==13||B==14||B==15){O=0}var E={wname:D,wMode:B,wForceClear:O,qual:s,sort:N,suppressNoMatch:o,noMatchMessage:d,interval:I};var k=weDeepSerialiseVariable(E);d.m=ExpandString(g,d.m,1|2|4|8);if(v){E.runGuide={server:C,guidename:v,hidden:false}}var L=IsDestinationViewField(g,R);var K=(z==null||z=="")?getSFMap(H,G):(H+"_"+G+"_"+z);var J=("uddjs_"+K+"_loaded").ARToJSIdentifier();if(L&&typeof window[J]=="undefined"){b=new NDXRequest();b.windowID=g;b.SendAsync("GetOpenWindowQueryVF",g,H,G,((ARKWGetStringByIdx(g,21)!=null)?ARKWGetStringByIdx(g,21):""),s.qual,s.fieldids,s.fieldvals,s.fieldtypes,z,D,N)}if(IsTargetLocationViewField(g,R,H,G,z,E,w)){A.v=0;return}var b=new NDXGetOpenWindowURL(g,false,H,G,((ARKWGetStringByIdx(g,21)!=null)?ARKWGetStringByIdx(g,21):""),s.qual,s.fieldids,s.fieldvals,s.fieldtypes,P,(!o&&d.t==2),z,D,k,N);var U=b.result;if(U.n==0&&P){if(A){A.v=1}return}var h=1;if(Q.compareToIgnoreCase("current")){h=2}else{if(Q.compareToIgnoreCase("newwithouttoolbar")){h=3}}return{c:{f:OpenNonModalURL,a:[g,U.url,h,y]},n:{f:function(W,X,Z,V,aa,Y,f){if(X.n==0&&!Z&&V.t==2){getCurWFC_NS(W).status(0,[])}if(aa=="Current"&&!weAmDialogue(Y.self.name)){throw new WorkflowException(W,0,[])}if(f){f.v=0}return},a:[g,U,o,d,Q,window,A]}}}function IsTargetLocationViewField(o,d,R,Q,C,b,w){var W=d;var v=o;var k=(typeof w=="object"&&typeof w.inline!="undefined"&&w.inline==true)?true:false;var H=false;var Y=false;if(W.compareToIgnoreCase("current")){var O=getParentWindowID_NS(o);if(O!=null){var L=getViewFields_NS(O);for(var S in L){if(L[S]!=null&&L[S].mChildWindowID!=null&&L[S].mChildWindowID==o){v=O;d="VF"+L[S].mID;k=true;H=true;break}}}}var U=IsDestinationViewField(v,d);if(U!=null){var I=null;var G=null;var h=null;var u=null;var K=window.frames[d];var P=U.mID;var A=true;var g=null;var z=0;if(((P=="80028")||(P=="80058")||(P=="80043")||(P=="80073"))&&(U.ft)){var Z=getUDDHolderById(v).vf;if((typeof Z!="undefined")&&(typeof Z[P]!="undefined")){I=Z[P].server;G=Z[P].form;h=Z[P].view;A=false;U.ft=false;k=true}}if(!k&&U.isInlineForm()){U.ClearInlineFormSettings()}if(K!=null&&"ARProcessEvent" in K){U.mObj.childNodes[1].src="about:blank"}if(!k&&A){var s=weDeepSerialiseVariable(b);var J=(R.toLowerCase()+Q)._urlencode()+U.mFrameName;if(typeof u=="undefined"||u==null){u=new NDXGetURLForForm(v,false,R,((ARKWGetStringByIdx(o,21)!=null)?ARKWGetStringByIdx(o,21):""),Q,C,false,J,s,false).GetResult().url}u=addFedSrvArgsToURL(u,b)}if(!k&&A){if(u.indexOf("?")!=-1){u=u+"&format=html"}else{u=u+"?format=html"}}else{if(I==null){I=R}if(G==null){G=Q}if(h==null){h=C}if(inlineCacheIDUpdate){g=new NDXGetCacheIDForViewField(v,R,((ARKWGetStringByIdx(o,21)!=null)?ARKWGetStringByIdx(o,21):""),Q,C).GetResult().cacheID}else{var y=getCookie(R);if(y!=null){try{z=parseInt(y)}catch(V){}}g=iUniqueid;if(z!=0){g=iUniqueid+z}}if(H){var D=getSFV_NS(o);if(D.s==I&&D.f==G&&D.v==h){Y=true}}var E=null;if(h==null||h==""){E=getSFVSnippetFromSF(I,G)}else{E=getSFVSnippet(I,G,h)}if(Y==false){if(E==null||(inlineCacheIDUpdate&&E.cacheid!=g)||!inlineCacheIDUpdate){E=new NDXGetHTMLScriptForViewField(v,I,((ARKWGetStringByIdx(o,21)!=null)?ARKWGetStringByIdx(o,21):""),G,h,false,g).GetResult();if(h==null||h==""){setSFMap(I,G,E.viewname)}setSFVSnippet(I,G,E.viewname,E)}else{if(ariever6&&!A){var X=new NDXGetHTMLScriptForViewField(v,I,((ARKWGetStringByIdx(o,21)!=null)?ARKWGetStringByIdx(o,21):""),G,h,true,g).GetResult();E.js=X.js;E.udd=X.udd;A=true}}}U.OpenInlineForm(I,G,E.viewname,E,b,A,(W=="Current"),Y);if(W=="Current"){throw new WorkflowException(o,0,[])}}if(!k&&A){var B=document.location;var N=B.protocol+"//"+B.hostname;if(B.port){N+=":"+B.port}N+=u;U.S(new CharType(N))}return true}return false}function GetSaveFrameTarget(b){var f=window.frames.exportSaveFrame;if(!f||(f==null)){var d=window.document.createElement("div");d.innerHTML='<IFRAME name="exportSaveFrame" onload=saveFrameLoaded('+b+') src="javascript:&quot;&lt;HTML&gt;&lt;/HTML&gt;&quot;"></IFRAME>';d.style.display="none";d.style.top=d.style.left="0px";d.style.bottom=d.style.right="1px";window.document.body.appendChild(d)}return"exportSaveFrame"}function saveFrameLoaded(d){var h=window.frames[GetSaveFrameTarget(d)];try{if(h.document&&h.document.body){if(h.document.location.href!="about:blank"){var f=h.window.Msg;if(!f){f=getLocalizedMessage("Failed to perform Action")}ShowAlertPopup(d,f,getLocalizedMessage("Report Error"))}}}catch(b){var g=WorkflowContext_StatusToString(d,[b.message]);ShowAlertPopup(d,g,getLocalizedMessage("Report Error"))}}function ReportToFile(g,h,k){var s=window.document.createElement("DIV");s.style.top="0px";s.style.left="0px";s.style.zIndex=100001;s.style.position="absolute";s.style.display="none";window.document.body.appendChild(s);var u='<FORM method="POST" action="{0}" enctype="application/x-www-form-urlencoded" accept-charset="UTF-8" target="{1}"><input type=hidden name="{2}" value="{3}"/><input type=hidden name="{4}" value="{5}"/></FORM>';var d=(AbsContextPath+"servlet/ReportServlet")+"/"+new Date().getTime();var o=GetSaveFrameTarget(g);var b=u.replaceArgs(d,o,"REPPARM",h.HTMLEncode(),"server",k);s.innerHTML=b;var f=s.firstChild;f.submit();window.document.body.removeChild(s)}var ARRPValues={"GET-CHANGE-FLAG":{t:2,f:ARProcessGetChangeFlag,tc:[]},JAVASCRIPT:{t:7,f:ARProcessJavascript,tc:[]},"PERFORM-ACTION-ACTIVE-LINK":{t:5,f:ARProcessActionActiveLink,tc:[2,4]},"PERFORM-ACTION-ADD-ATTACHMENT":{t:7,f:ARProcessAddAttach,tc:[2,4]},"PERFORM-ACTION-APPLY":{t:5,f:ARProcessApply,tc:[]},"PERFORM-ACTION-DELETE-ATTACHMENT":{t:3,f:ARProcessDeleteAttach,tc:[2]},"PERFORM-ACTION-EXIT-APP":{t:5,f:ARProcessExitApp,tc:[]},"PERFORM-ACTION-GET-FIELD-LABEL":{t:6,f:ARProcessGetFieldLabel,tc:[2]},"PERFORM-ACTION-GET-PREFERENCE":{t:2,f:ARProcessGetPreference,tc:[2,4]},"PERFORM-ACTION-GO-HOME":{t:1,f:ARProcessGoHome,tc:[]},"PERFORM-ACTION-HOME-FIELD-REFRESH":{t:1,f:ARProcessHomeFieldRefresh,tc:[]},"PERFORM-ACTION-NEXT":{t:5,f:ARProcessResultsListNext,tc:[]},"PERFORM-ACTION-OPEN-ATTACHMENT":{t:3,f:ARProcessDisplayAttach,tc:[2]},"PERFORM-ACTION-OPEN-URL":{t:1,f:ARProcessOpenURL,tc:[4,4]},"PERFORM-ACTION-PREV":{t:5,f:ARProcessResultsListPrev,tc:[]},"PERFORM-ACTION-REFRESH-PREFERENCE":{t:1,f:ARProcessRefreshPreference,tc:[2]},"PERFORM-ACTION-SAVE-ATTACHMENT":{t:3,f:ARProcessSaveAttach,tc:[2,4]},"PERFORM-ACTION-SEND-EVENT":{t:1,f:ARProcessSendEvent,tc:[4,4,4]},"PERFORM-ACTION-SET-PREFERENCE":{t:1,f:ARProcessSetPreference,tc:[2,4]},"PERFORM-ACTION-SET-SCREEN-PREFERENCE":{t:1,f:ARProcessSetScreenPreference,tc:[2,4]},"PERFORM-ACTION-TABLE-CLEAR":{t:1,f:ARProcessTableClear,tc:[2]},"PERFORM-ACTION-TABLE-CLEAR-ROWCHANGED":{t:1,f:ARProcessTableSetRowState,tc:[2]},"PERFORM-ACTION-TABLE-DESELECTALL":{t:5,f:ARProcessTableDeselectAll,tc:[2]},"PERFORM-ACTION-TABLE-NEXT-CHUNK":{t:5,f:ARProcessTableNextChunk,tc:[2]},"PERFORM-ACTION-TABLE-PREV-CHUNK":{t:5,f:ARProcessTablePrevChunk,tc:[2]},"PERFORM-ACTION-TABLE-REFRESH":{t:5,f:ARProcessTableRefresh,tc:[2,2,2]},"PERFORM-ACTION-TABLE-REPORT":{t:5,f:ARProcessTableReport,tc:[2]},"PERFORM-ACTION-TABLE-SELECTALL":{t:5,f:ARProcessTableSelectAll,tc:[2]},"PERFORM-ACTION-TABLE-GET-SELECTED-COLUMN":{t:2,f:ARProcessTableGetSelectedColumn,tc:[2,2]},"PERFORM-ACTION-TABLE-SELECT-NODE":{t:7,f:ARProcessTableSelectNode,tc:[2,2,2,2]},"PERFORM-ACTION-TABLE-IS-LEAF-SELECTED":{t:6,f:ARProcessTableIsLeafSelected,tc:[2]},"SET-CHANGE-FLAG":{t:1,f:ARProcessSetChangeFlag,tc:[2]},"SET-RO-COLOR":{t:1,f:ARProcessSetROColour,tc:[4]},"PERFORM-ACTION-NAV-FIELD-SET-SELECTED-ITEM":{t:1,f:ARProcessNavFieldSetSelectedItem,tc:[2]},"APPLICATION-COPY-FIELD-VALUE":{t:2,f:ARProcessCopyFieldValue,tc:[2,2]},"PERFORM-ACTION-MAP-GROUPIDS-TO-NAMES":{t:6,f:ARProcessGroupIdsToName,tc:[4]},"PERFORM-ACTION-TABLE-SET-ROWSTATE":{t:1,f:ARProcessTableSetRowState,tc:[2,2,2]},"PERFORM-ACTION-TABLE-ADD-ROW":{t:5,f:ARProcessTableAddRow,tc:[2,2]},"PERFORM-ACTION-TABLE-DELETE-ROW":{t:5,f:ARProcessTableDeleteRow,tc:[2,2,2]},"PERFORM-ACTION-LIST-APPEND":{t:1,f:ARProcessListAppend,tc:[2,4]},"PERFORM-ACTION-MAP-PUT":{t:1,f:ARProcessMapPut,tc:[2,4,4]},"PERFORM-ACTION-TABLE-CLEAR-DELETED":{t:5,f:ARProcessTableClearDeleted,tc:[2,2,2]},"PERFORM-ACTION-TABLE-CHANGE-ROW-COL-VISIBILITY":{t:1,f:ARProcessTableChangeVisibility,tc:[2,2,4]},"PERFORM-ACTION-TABLE-GET-CURRENT-CHUNK":{t:2,f:ARProcessTableGetCurChunk,tc:[2]},"PERFORM-ACTION-GET-ENTRY":{t:5,f:ARProcessGetEntry,tc:[4]},"PERFORM-ACTION-VALIDATE-NULL-REQUIRED-FIELDS":{t:5,f:ARProcessValidateNullRequiredFields,tc:[4,4]},"PERFORM-ACTION-CLEAR-PROMPTBAR":{t:5,f:ARProcessHidePromptBar,tc:[]},"PERFORM-ACTION-CHANGE-MODE":{t:5,f:ARProcessChangeMode,tc:[4]},"PERFORM-ACTION-SHOW-TOOLBAR":{t:5,f:ARProcessShowToolbar,tc:[4]},"PERFORM-ACTION-TABLE-GET-CHUNKSIZE":{t:6,f:ARProcessTableGetChunkSize,tc:[2]},"PERFORM-ACTION-SET-QUERY-WIDGET":{t:3,f:ARProcessSetQueryWidget,tc:[2,4,4]},"ENABLE-WAIT-CURSOR-ON-LONG-RUNNING-PROCESS":{t:1,f:ARProcessSetWaitCursorState,tc:[2]},"SECURITY-FILTER":{t:7,f:ARProcessSecurityFilter,tc:[]}};function ARACTProcess(f,d,b,v){LogWrite('<div class="aract_non_deb">Run Process: '+d);var u=d.search(/\s/);var g=(u>0)?d.substring(0,u).toUpperCase():d.toUpperCase();var k=[];var s=true;if(g in ARRPValues){k=ARRPValues[g].tc}else{s=false}d=ExpandStringProcess(f,d,1|2|4|16|8,k,s);var u=d.search(/\s/);var g=(u>0)?d.substring(0,u).toUpperCase():d.toUpperCase();g=g.trim(1|2);if((g in ARRPValues)||(((u=d.indexOf(":"))>0)&&((g=d.substring(0,u).toUpperCase())=="JAVASCRIPT"))){var o=ARRPValues[g];if((o.t&b)!=0){d=(u>0)?d.substring(u+1).trim(1):"";if((((o).t&4)!=0)){if((b&2)&&(((o).t&2)!=0)){return{c:{f:o.f,a:[f,d,v]}}}else{return{c:{f:o.f,a:[f,d]}}}}else{if((((o).t&2)!=0)){if(typeof v=="undefined"){var h={};o.f(f,d,h);return h.result}else{return{c:{f:o.f,a:[f,d,v]}}}}else{o.f(f,d);return}}}else{if((b&2)!=0){getCurWFC_NS(f).status(9281)}else{getCurWFC_NS(f).status(9300)}}}getCurWFC_NS(f).status(9366)}function ARACTServerProcess(h,y,z,v,k,d,u){var o=ARKWGetStringByIdx(h,7);var g=new Array();var b=new Array();FieldList.PopulateValueAndTypeArrays(h,u,g,b);var f=new Array();var s=new Array();FieldList.PopulateValueAndTypeArrays(h,d,f,s);var w=new NDXServerRunProcess(h,o,y,z,v,k,d,f,s,u,g,b);if(w.result==""){return Null}else{return new CharType(w.result)}}function ARProcessError(b,d){Log("Process not implemented");getCurWFC_NS(b).status(9215)}function ARProcessSetChangeFlag(d,f){var b=0;if(typeof f!="undefined"){b=parseInt(f)}if(isNaN(b)||(b==0)){Field_ClearChangedFromRunProcess(d)}else{Field_SetChanged(d)}}function ARProcessGetChangeFlag(d,f,b){b.result=Field_GetChanged(d)?IntegerType.ONE:IntegerType.ZERO}function ARByteToHex(b){return((b<16)?"0":"")+b.toString(16)}function ARProcessSetROColour(f,k){var h=k.split(",");if(h.length==3){var s=parseInt(h[0]);var o=parseInt(h[1]);var d=parseInt(h[2]);if(!isNaN(s)&&!isNaN(o)&&!isNaN(d)){var u="#"+ARByteToHex(s)+ARByteToHex(o)+ARByteToHex(d);Field_SetROBackground(f,u)}}}function ARProcessActionActiveLink(b,d){var h=d.match(/\b([0-9]+)\b/g);if(h!=null){var f=AREventFunction(b,h[0],h[1]);if(f){var g=parseInt(h[0]);if(g==4194304||g==8388608||g==16777216){return alExecuteHover(b,g,parseInt(h[1]))}else{return f.f.apply(f.h,[b])}}}}function ARProcessJavascript(windowID,args,result){try{var res=eval(args);if(res&&typeof res=="object"&&("i" in res||"n" in res||"c" in res)){return res}else{if(typeof result=="object"){result.result=new CharType(res)}}}catch(e){getCurWFC_NS(windowID).status(9369)}}function ARProcessGetFieldLabel(d,g,b){b.result=Null;var k=parseInt(g);if(!isNaN(k)){var h=F(d,k);if(h instanceof DView&&h.mQWidget!=null){b.result=new CharType(h.mQWidget.GLabel())}else{var f=h.GLabel();if(f==" "){f=""}if(f!=null){b.result=new CharType(f)}}}}function ARProcessRefreshPreference(d,f){var b=parseInt(f);if(!isNaN(b)){ARPrefsRefresh(d,b)}}var GPSP=/([0-9]+)(-((\"(([^\"]|(\"\"))*)\"?)|(\S+)))?/;var REPDBQ=/\"\"/g;function ARProcessGetPreference(d,f,b){var k=f.match(GPSP);if(!k||k[1]==""){b.result=new CharType("");return}var h=(k[5]=="")?k[8]:k[5];if(h&&k[7]&&k[7]!=""){h=h.replace(REPDBQ,'"')}var g=ARPrefsGet(d,parseInt(k[1]),h);b.result=(g==null)?new CharType(""):new CharType(""+g)}function ARProcessHomeFieldRefresh(b){DAppList.Refresh(b)}function ARProcessGoHome(b){FormAction_OpenHomePage(b)}var URLRE=/[a-zA-Z]+:[\/]*(.*)/mg;function ARProcessOpenURL(f,s){var u=true;rsso_flag=false;if(s!=""){var z=s.split(" ");if(z.length>2){if(z[2]==="rssoreauth"){rsso_flag=true;z.splice(2)}}if(z[0].compareToIgnoreCase("new")||z[0].compareToIgnoreCase("current")||z[0].compareToIgnoreCase("newwithouttoolbar")){if(z.length>2){var k=z[1];for(var A=2;A<z.length;A++){k=k+" "+z[A]}z=new Array(z[0],k)}}else{if(z.length>1){z=new Array(s)}}var d=false;if(z.length>0&&z.length<=2){var v;if(z.length==1||z[0].compareToIgnoreCase("new")){v=(""+new Date().getTime())+"_"+f}else{if(z[0].compareToIgnoreCase("current")){v=window.self.name+"_"+f;d=true}else{if(z[0].compareToIgnoreCase("newwithouttoolbar")){v=(""+new Date().getTime())+"_"+f;u=false}}}if(v){var b=(z.length==1)?z[0]:z[1];b=b.trim(1|2);var h=b.indexOf('"');var y=b.lastIndexOf('"');if(h==0&&y==b.length-1){b=b.substring(1,y)}var o=b.match(URLRE);if(!isValidPort(b)){LogAndAlert(getLocalizedMessage("Cannot decode URL. The URL supplied is invalid. Please see your administrator.")+" - "+b)}if(o||b.indexOf("www.")==0){if(!o){b="http://"+b}if(d){getCurWFC_NS(f).execute({f:OpenNonModalURL,a:[f,b,2,v]})}else{var g=allocWindowID_NS();window.weOpen(g,f,b,v,"URL",null,null,u,false);ARKWSet(f,35,v)}}else{if(b.charAt(0)=="/"&&b.indexOf("/launch")!=-1){var B=getFormContext(f);if(B!=null){var w=B.server;if(typeof w!="undefined"){if(b.indexOf("?")==-1){b=b+"?arserver="+w}else{b=b+"&arserver="+w}if(d){getCurWFC_NS(f).execute({f:OpenNonModalURL,a:[f,b,2,v]})}else{var g=allocWindowID_NS();window.weOpen(g,f,b,v,"URL",null,null,u,false);ARKWSet(f,35,v)}}}}}}}}}function isValidPort(d){var v=true;var w=d.substring(0,d.indexOf("://"));var g=/(http)/i;var k=/(ftp)/i;var s=d.substring(d.indexOf("://")+3);var o=s.substring(0,s.indexOf("/"));var u=-1;u=o.indexOf(":");if(u===-1){return v}var f=o.substring(u+1);if(isNaN(f)){if(g.test(w)&&o.indexOf("@")===-1){v=false}else{if(k.test(w)&&o.indexOf("@")!=-1){var h=o.indexOf("@");var b=s.substring(h+1,s.indexOf("/"));u=b.indexOf(":");if(u===-1){return v}f=b.substring(u+1);if(isNaN(f)){v=false}}}}return v}function GetAttachField(b,g){var d=g.split(" ");if(d.length>0){var k=parseInt(d[0]);var h=F(b,k);if(h&&(h instanceof JAttachment||h instanceof DAttachmentPool)){return h}}return null}function ARProcessAddAttach(d,g,b){var h=GetAttachField(d,g);if(h){return h.Add(b)}else{if(b){b.result=JAttachment.FAILED}}}function ARProcessDeleteAttach(d,g,b){var h=GetAttachField(d,g);if(h){return h.Delete(b)}else{if(b){b.result=JAttachment.FAILED}}}function ARProcessDisplayAttach(d,g,b){var h=GetAttachField(d,g);if(h){return h.Display(b)}else{if(b){b.result=JAttachment.FAILED}}}function ARProcessSaveAttach(d,o,b){var s=GetAttachField(d,o);if(s){var k=o.split(" ");var h=null;if(k.length>=2){h=k[1];if(h.charAt(0)=='"'&&h.charAt(h.length-1)=='"'){h=h.substr(1,h.length-2);var g=/""/g;h=h.replace(g,'"')}}return s.SaveToDisk(b,h)}else{if(b){b.result=JAttachment.FAILED}}}var SPSP=/([0-9]+)(-((\"(([^\"]|(\"\"))*)\"?)|(\S+)))?(\s+(.*))?/;function ARProcessSetPreference(b,d){var h=d.match(SPSP);if(!h||h[1]==""){return}var g=(h[5]=="")?h[8]:h[5];if(g&&h[7]&&h[7]!=""){g=g.replace(REPDBQ,'"')}var f=h[10]?h[10]:"";ARPrefsSet(b,parseInt(h[1]),g,f)}function ARProcessSetScreenPreference(b,f){if(f!=""){var d=f.match(/[^\s]+/g);var g=parseInt(d[0]);if(d.length>1&&!isNaN(g)){ARPrefsSetAsString(g,d[1])}}}function ARProcessApply(b,d){return FormAction_GenericApply(b)}function ARProcessGetTableField(b,d){var g=parseInt(d);if(!isNaN(g)){var f=F(b,g);if(f instanceof DTable){return f}}return null}function ARProcessTableClear(b,d){var f=ARProcessGetTableField(b,d);if(f){f.Clear();if(!getCurWFC_NS(b)){promptBar.setToClear()}}}function ARProcessTableRefresh(b,f){var h=ARProcessGetTableField(b,f);if(h){var k=-1;var g=0;f=f.split(/\s/);if(f.length>1){var d=parseInt(parseFloat(f[1]));if(!isNaN(d)){k=d-1;if(k<0){k=0}}if(f.length>2){var d=parseInt(parseFloat(f[2]));if(!isNaN(d)){g=d;if(g<0){g=0}}}}return h.Refresh(k,g,false,0)}}function ARProcessTableSelectAll(b,d){var f=ARProcessGetTableField(b,d);if(f&&!f.mNotRefreshed){return f.SelectAll(true)}}function ARProcessTableDeselectAll(b,d){var f=ARProcessGetTableField(b,d);if(f&&!f.mNotRefreshed){return f.SelectAll(false)}}function ARProcessTableNextChunk(b,d){var f=ARProcessGetTableField(b,d);if(f){return f.NextChunk(1)}}function ARProcessTablePrevChunk(b,d){var f=ARProcessGetTableField(b,d);if(f){return f.NextChunk(-1)}}function ARProcessTableReport(b,d){var f=ARProcessGetTableField(b,d);if(f){return f.Report()}}function ARProcessResultsListPrev(b,d){var g=F(b,1020);if(g){var f=g.G().toInteger();if(f!=-1){f-=1;if(f<1){f=g.GetRows()}return{n:{f:g.S,t:g,a:[new IntegerType(f)]}}}}}function ARProcessResultsListNext(b,d){var g=F(b,1020);if(g){var f=g.G().toInteger();if(f!=-1){f+=1;if(f>g.GetRows()){f=1}return{n:{f:g.S,t:g,a:[new IntegerType(f)]}}}}}function ARProcessTableGetSelectedColumn(f,h,b){b.result=Null;var k=ARProcessGetTableField(f,h);if(k instanceof DTreeView){var d=0;h=h.split(/\s/);if(h.length>1){var g=parseInt(parseFloat(h[1]));if(!isNaN(g)&&g==1){d=1}}b.result=k.GetSelectedColumn(d)}}function ARProcessTableSelectNode(b,f){var h=ARProcessGetTableField(b,f);if(h instanceof DTable){var k=0;var o=-1;var g=0;f=f.split(/\s/);if(f.length>1){var d=parseInt(parseFloat(f[1]));if(!isNaN(d)){k=d}if(f.length>2){var d=parseInt(parseFloat(f[2]));if(!isNaN(d)&&d>o){o=d}if(f.length>3){var d=parseInt(parseFloat(f[3]));if(!isNaN(d)&&d==1){g=1}}}}if(h instanceof DTreeView){if(k==0){return h.S("0")}else{if(o==-1||(k>100000000||k<-100000000)){return h.S(k+"")}else{if(k<0){return h.SelectNode(-k-1,o-1,g,true,false)}else{return h.SelectNode(k-1,o-1,g,true,true)}}}}else{return h.S(k+"")}}}function ARProcessTableIsLeafSelected(d,f,b){var g=ARProcessGetTableField(d,f);if(g instanceof DTreeView){b.result=g.IsLeafSelected()}else{b.result=IntegerType.ZERO}}function ARProcessTableSetRowState(b,f){var h=ARProcessGetTableField(b,f);if(h){f=f.trim(2);f=f.split(/\s/);if(f.length>1){var o=parseInt(parseFloat(f[1]));if(isNaN(o)){return}var k=0;if(f.length>2){var g=parseInt(parseFloat(f[2]));if(!isNaN(g)){k=g}}if(k>=0&&k<=3){h.SetRowState(o-1,k)}}else{var d=getCurWFC_NS(b).getGuideState();if(d!=null){if("table" in d){h.SetRowState(d.currow,0);return}}h.SetRowState(-1,0)}}}function ARProcessGroupIdsToName(f,o,w){w.result=null;var v=o;if(v.charAt(0)=='"'&&v.charAt(v.length-1)=='"'){v=v.substr(1,v.length-2)}else{var s=v.split(" ");if(s.length>1){w.result=new CharType(o);return}}v=v.trim(1|2);var k="";if(v.length>0){var g=v.split(";");var u=g.length;u--;var d;for(var h=0;h<u;h++){if(k!=""){k+=" "}var b=g[h];b=b.trim(1|2);d=getLabel(f,b);if(d){k+=d}else{k+=b}}w.result=new CharType(k)}}var ARProcessSendEvent_CmdlineParser=new RegExp('\\s*((\\"(([^"]|(""))*)\\"\\s*)|([^\\s]*))',"g");function ParseProcessArgs(g,b){var f;ARProcessSendEvent_CmdlineParser.lastIndex=0;for(var d=0;d<b.length&&(f=ARProcessSendEvent_CmdlineParser.exec(g));d++){b[d]=f[3]?f[3].replace(REPDBQ,'"'):f[6]}}function ARProcessSendEvent(b,f){f=f.trim(1|2);if(f.length==0){return}var d=["","",""];ParseProcessArgs(f,d);if(d[0]==""||d[1]==""){return}if(d[2]==""||d[2]==undefined){d[2]=null}ARProcessEvent.DeliverEvent(b,d[0],d[1],d[2])}function ARProcessNavFieldSetSelectedItem(d,g){var f=g.split(/\s/);var k=F(d,f[0]);var b="open";var h=false;if(f.length==1){if(!isNaN(f[0])&&k instanceof DNavBarItem){k.SetSelected()}}else{b=(f[1]==0||f[1]==2)?"close":"open";h=(f[1]==0||f[1]==1)?true:false;expandCollapseVertNavBarItems(k,h,b,d)}}var CPEX=/([0-9]+)(\s+)([0-9]+)/;function ARProcessCopyFieldValue(f,g,d){var k=g.match(CPEX);if(k==null){d.result=new IntegerType(1);return}var o=k[1];var h=k[3];var b=getFields_NS(f);if(h in b&&o in b){F(f,o).S((F(f,h).G()));d.result=new IntegerType(0)}else{d.result=new IntegerType(1)}}function ARProcessTableAddRow(b,f){var d=f.split(/\s/);var k=ARProcessGetTableField(b,d[0]);var g=null,h=null,o=null;if(k&&k.mID!=1020&&k.mID!=706){if(!k.mResult){k.initResults()}if(d.length==1||(d.length>1&&d[1]=="")){h=k.GetData().length+1;d.push(h);o=h}else{if(d[1]==0){return}else{h=computeRowIndex(d[1],k.GetData().length);if(d[1]>100000000){o=100000000+h}else{if(d[1]<-100000000){o=-(100000000+h)}else{o=h}}}}k.chunkDirtyTable=true;k.addRowToData(h);k.mARRowSelection=-1;g=k.S(new IntegerType(o));k.DataChanged();k.mAsyncQueue.push({action:2,val:"",cval:0})}return g}function ARProcessTableDeleteRow(b,f){var d=f.split(/\s/);var g=null;if(d.length<2){return}var h=ARProcessGetTableField(b,d[0]);if(!h||h.mID==1020||h.mID==706){return}if(d[1]>0&&d[1]<=h.GetData().length){if(h&&h.mResult){h.chunkDirtyTable=true;h.mResult.r[d[1]-1].mXXXDirty=3;if(h.colCheck==1){h.clearDeleted()}if(d.length>2){g=h.S(new IntegerType(d[2]))}h.DataChanged();h.mAsyncQueue.push({action:2,val:"",cval:0})}}return g}function computeRowIndex(d,b){if(d==null){return b+1}if(d<0){d=-d}if(d>100000000){d=d-100000000}if(d>b){return b+1}else{return d}}function ARProcessListAppend(f,k){k=k.trim(1|2);if(k.length==0){return}var g=["",""];ParseProcessArgs(k,g);var d=g[0];if(d==null||d==""){return}var b=g[1];var h=ARR(f,d);if(h==null){return}h.append(b)}function ARProcessMapPut(g,o){o=o.trim(1|2);if(o.length==0){return}var h=["","",""];ParseProcessArgs(o,h);var f=h[0];if(f==null||f==""){return}var k=h[1];var d=h[2];var b=M(g,f);if(b==null){return}b.setValue(k,d)}function ARProcessTableClearDeleted(b,f){var d=f.split(/\s/);var g=ARProcessGetTableField(b,d[0]);if(!g||g.mID==1020||g.mID==706||!g.IsRefreshed()){return}g.clearDeleted();return}function ARProcessTableChangeVisibility(d,g){var f=g.split(/\s/);if(f==null||f.length<3){return}var b=f[0];if(b==null){return}var h=ARProcessGetTableField(d,b);if(!h||(h instanceof DTreeView)||(h instanceof DAlertList)||b==1020||b==706){return}h.setFieldVisibilityOnCurrentRow(f[1],f[2]);return}function ARProcessTableGetCurChunk(d,f,b){var g=new RegExp("^[0-9]+$");if(g.test(f)){var k=parseInt(f);if(!isNaN(k)){if(k in getFields_NS(d)){var h=F(d,k);if(h instanceof DTable){if(h.IsRefreshed()){b.result=new IntegerType(h.mChunkPage+1);return}b.result=Null;return}b.result=new IntegerType(1);return}}}b.result=Null}function buildResultListEntry(g,f,d){var u=F(g,1020);u.mResult={eid:null,f:[],idmap:[],n:1,q:null,r:[],start:0};u.mResult.eid=f;u.mResult.f.push({dt:4,m:null,t:"Char"});u.mResult.idmap[f]=0;var b="4\\1\\1\\1\\2\\4\\";var o=b+""+(f.length)+"\\"+f+"\\";u.mResult.q='{qual:"'+o+'"}';if(typeof u.mQual=="undefined"||u.mQual==null){u.mQual={qual:null}}u.mQual.qual=o;var s=new Object();s.i=f;var h=new Object();h.v="";h.p="";s.d=[];for(var k=0;k<u.mColCnt;++k){if(u.mColDatas[k].mVisible){s.d.push(h)}}s.rc=-1;u.mResult.r[0]=s;u.mCurrentRow=0;u.mPrimaryRowSelection=f;u.mRowSelections=[];u.mRowSelections[f]=true;u.mNotRefreshed=false;u.mResultsListState=d;u.mAsyncDirty=3}function ARProcessGetEntry(b,d){if((getARStateCurrent_NS(b)!=3&&getARStateCurrent_NS(b)!=5)||(typeof d=="undefined"||d==null||d=="")){return}getForm_NS(b).procGetEntry=true;buildResultListEntry(b,d,getARStateCurrent_NS(b));return FormAction_SimulateGetEntry(b)}function ARProcessValidateNullRequiredFields(b,d){getStateMgr_NS(b).ClearHighlight(b);return{c:{f:function(){var s=[];var v=d.split(/\s/);var g=1;if(v.length>0){var u=v[0].replace(/\"/g,"");u=u.toLowerCase();if(u=="prompt"){g=0}}if(v.length==1){var y=getFields_NS(b);for(var h in y){var w=y[h];checkRequiredFields(w,s)}}else{if(v.length==2){var f=v[1].replace(/\"/g,"");var k=f.split(/\\/);var o=k.length;for(var h=0;h<o;h++){var w=F(b,k[h].trim(1|2));checkRequiredFields(w,s)}}}if(s.length!=0){getCurWFC_NS(b).status(s,g)}},e:getStateMgr_NS(b).HandleException,ea:[b]}}}function checkRequiredFields(f,d){if(f instanceof DataField){if((f.mCFCache.o==1||f.mCFCache.r==1)&&(f.GDefault().mValue==null||(f.GDefault().mValue!=null&&f.G().isNull&&f.IsDirty()))){var b=f.G();if(b==null||b.mValue==null||(b.mValue!=null&&b.mValue.length==0)){d.push(f.getRequiredException())}}}}function ARProcessHidePromptBar(){HidePromptBar()}function ARProcessChangeMode(b,d){if(weAmDialogue(window.name)){return}getCurWFC_NS(b).AddCallback(null,SimulateModeChange,[b,d]);throw new WorkflowException(b,0,[])}function ARProcessShowToolbar(b,d){ShowToolbar(b,(d!=null&&(d=="1"||d==1)))}function ARProcessTableGetChunkSize(d,h,b){b.result=new IntegerType(0);var k=parseInt(h);if(isNaN(k)){return}var g=F(d,k);if(g!=null&&g instanceof DTable&&g.IsRefreshed()){var f=g.getDisplayChunkSize();if(f>0){b.result=new IntegerType(f)}}}function ARProcessSetQueryWidget(b,s,y){var v=s.split(/\s/);if(v==null||v.length<2){return}var g=v[0];var w=v[1];var k="";if(g==null||w==null){return}if(v.length>2){var o=g.length+w.length+2;k=s.substring(o)}var d=ARKWGetByIdx(b,7);var h=parseInt(g);var f=F(b,h);if(f instanceof DView){if(f.mQWidget!=null&&f.mQWidget.mGuid==w){if(k==null||k.length==0){f.mQWidget.Clear();return}}var u=new NDXLoadQueryWidget(b,w,k,d.toString(),localeInfo.name);if(u.result==-1){getCurWFC_NS(b).status(9507)}else{if(u.result==0){y.result=new IntegerType(1);return}}f.DoSet(new CharType(u.result.h));f.mQWidget=new QueryWidget(b,w,u.result);y.result=new IntegerType(0)}else{y.result=new IntegerType(1)}}function ARProcessSetWaitCursorState(b,d){getCurWFC_NS(b).enableWaitCursor=d}function expandCollapseVertNavBarItems(s,k,d,b){if(s instanceof DVertNavBar){var g=s.mObj.childNodes.length;for(var h=0;h<g;h++){if(s.mObj.childNodes[h].className&&s.mObj.childNodes[h].className.indexOf("VNavParent")!=-1){var o=F(b,s.mObj.childNodes[h].getAttribute("arid"));o.SetStatus(d);if(k){recurExpandCollapse(s.mObj.childNodes[h],d,b)}}}}else{if(s instanceof DNavBarItem){if(k){recurExpandCollapse(s.mObj,d,b);s.SetStatus(d);s.MakeItemVisible()}else{s.SetStatus(d);s.MakeItemVisible()}}}}function recurExpandCollapse(k,f,d){var h=k.nextSibling;if(h.className&&h.className.indexOf("VNavSub")!=-1){var b=h.childNodes.length;for(var g=0;g<b;g++){if(h.childNodes[g].className&&h.childNodes[g].className.indexOf("VNavParent")!=-1){var o=F(d,h.childNodes[g].getAttribute("arid"));o.SetStatus(f);recurExpandCollapse(h.childNodes[g],f,d)}}}}function ARProcessSecurityFilter(d,f,b){var g=new String(f);g=g.HTMLEncode();if(g&&typeof g=="object"&&("i" in g||"n" in g||"c" in g)){return g}else{if(typeof b=="object"){b.result=new CharType(g.toString())}}}function ARProcessExitApp(o){licenseSessionExit(o);FieldList.ClearAllGlobals(o);var d=false;var k=window;var b=k;var f=weGetAllWindows(o);var h=f.length;var z=0;for(var u=0;u<h;u++){try{if("checkIfWindowDirty" in f[u]){var s=f[u].checkIfWindowDirty();if(z==0&&s.llen>0){z=1}if(s.dirty){d=true;break}}}catch(v){}}while(b){b=k.weGetOpener(o);if(b&&!b.closed){if(!b.weGetOpener){break}k=b}else{break}}var y={};var w={};if(d){if(h<=1&&z==0&&!getStateMgr_NS(o).IsSaveAllowed(o)){d=false}else{var w={};var g=getLocalizedMessage("Your changes have not been saved or sent.  Do you really want to close the window?");y.c={f:ConfirmPopup,a:[o,g,w,4|8]}}}y.n={f:ExitApp,a:[o,d,w,f,k,MarkLogoutOnWindowsRecur]};return y}function ExitApp(d,g,f,o,k,h){var b={};if(getCurWFC_NS(d).notes.length>0){b.c={f:WC_DisplayMessage,a:[d,getCurWFC_NS(d).notes]}}b.n={f:function(s){getCurWFC_NS(s).notes=[];if(!g||((typeof f.result!="undefined")&&("v" in f.result)&&f.result.v==1)){if(g){for(var u=0;u<o.length;u++){try{o[u].Field_ClearChangedFromRunProcess(s)}catch(v){}}}if(h){h.apply(k.window,[getTopWinWindowID_NS(),k])}k.window.weCloseAllWindows(getTopWinWindowID_NS(),k,true,(AbsContextPath+"servlet/LogoutServlet"));throw new WorkflowException(s,0,[])}},a:[d]};return b}function MarkLogoutOnWindowsRecur(b,k){if(!k.closed&&globalLogout){try{k.globalLogout=true;k.onbeforeunload=null;k.onunload=null}catch(h){}}var f=k.getChildWindowIDs(b);if(!k.closed&&f!=null){for(i in f){var g=f[i].windowObj;try{if(g){arguments.callee(g.getTopWinWindowID_NS(),g)}}catch(d){}}}}function ARACTSQL(f,w,o,g,d,s){LogWrite('<div class="aract_non_deb">Direct SQL: \n    SQL: '+o);var b=new Array();var h=new Array();FieldList.PopulateValueAndTypeArrays(f,d,b,h);var k=new Array();var y=new Array();FieldList.PopulateValueAndTypeArrays(f,s,k,y);var v=new NDXGetSQLEntryList(f,ARKWGetStringByIdx(f,7),w,g,3,6,d,b,h,s,k,y,true);var u=v.result}function ARACTSetAllFields(d,b){if((getARStateCurrent_NS(d)==1)||(getARStateCurrent_NS(d)==5)||(getARStateCurrent_NS(d)==6)||(getARStateCurrent_NS(d)==4)){b.RemoveField(6);b.RemoveField(5);b.RemoveField(3);b.RemoveField(1)}for(var f in b.mFields){F(d,f).S(b.mFields[f])}}SvcOutList.prototype.constructor=SvcOutList;function SvcOutList(){this.init()}SvcOutList.prototype.init=function(){this.mretVals=new Object()};SvcOutList.prototype.F=function(b){return(b in this.mretVals)?this.mretVals[b]:Null};SvcOutList.prototype.SV=function(d,b){this.mretVals[d]=Datatype_Factory(b)};function ARACTService(windowID,server,formname,requestidField,inmap,outmap,outrefs,arrname){var dynServer=server;var dynformname=formname;dynServer=ExpandString(windowID,dynServer,1|2|4);dynformname=ExpandString(windowID,dynformname,1|2|4);var dynrequestid="";if(requestidField!=0){dynrequestid=dynrequestid+F(windowID,requestidField).G()}var inIds=new Array();var inVals=new Array();var inTypes=new Array();for(var id in inmap){var value=inmap[id];if(value.t!="dt"){inIds.push(parseInt(id));inVals.push(value.v.toPrimitive());inTypes.push(value.v.type)}}var inlist=[];for(var x=0;x<inIds.length;x++){if(inIds[x]==123||inIds[x]==102||inIds[x]==125){inlist.push(inIds[x]+":******")}else{inlist.push(inIds[x]+":"+inVals[x])}}var inliststr="inmap:";if(inlist.length>0){inliststr=inliststr+"["+inlist.join(",")+"]"}var outlist=[];for(var y in outmap){outlist.push(outmap[y].f+":"+outmap[y].e)}var outliststr="outmap:";if(outlist.length>0){outliststr=outliststr+"["+outlist.join(",")+"]"}if(dynServer!=server){LogWrite('<div class="aract_non_deb">ARACTService server:'+dynServer)}if(dynformname!=formname){LogWrite('<div class="aract_non_deb">ARACTService formname:'+dynformname)}if(requestidField!=0){LogWrite('<div class="aract_non_deb">ARACTService request id:'+dynrequestid)}LogWrite('<div class="aract_non_deb">Service Action: \n');eval("var "+arrname+"= new SvcOutList()");var req=new NDXExecuteService(windowID,dynServer,dynformname,ARKWGetStringByIdx(windowID,7),ARKWGetStringByIdx(windowID,6),dynrequestid,inIds,inVals,inTypes,outrefs,arrname);var res=req.result;if((res!=null)&&(res!=0)){eval(res.oa);var newval;for(var index in outmap){eval("newval ="+outmap[index].e);var opValue='""';if(newval&&!newval.isNull){opValue=newval.mValue}LogWrite('<div class="aract_non_deb">  '+F(windowID,outmap[index].f).GLabelOrName()+"("+outmap[index].f+"):"+opValue);if(outmap[index].f in getFields_NS(windowID)){F(windowID,outmap[index].f).S(newval)}}}}function SelectionPopup(d,b,f){b.title=getLocalizedMessage("Selection list");b.appss=GetAppStyleSheet("../../");b.AbsContextPath=AbsContextPath;b.server=ARKWGetStringByIdx(d,7);b.schema=ARKWGetStringByIdx(d,6);b.view=ARKWGetStringByIdx(d,17);b.cacheid=getFormDataHolderById(d).cacheid;return weOpenModalPopup(d,(AbsContextPath+"resources/html/SelectionPopup.html"),"Selection",b,f,[640,320])}DDisplay.prototype=new DView();DDisplay.prototype.constructor=DDisplay;DDisplay.superclass=DView.prototype;JDisplay.prototype=new JView();JDisplay.prototype.constructor=JDisplay;JDisplay.superclass=JView.prototype;DOMFieldFactories.Display=function(b,f,d){return new DDisplay(b,f,d)};function DDisplay(g,f,d){if(arguments.length){this.init(g,f,d)}}DDisplay.prototype.init=function(b,f,d){DDisplay.superclass.init.call(this,b,f,d);this.DataDefault()};DDisplay.prototype.mHaveStoredData=false;DDisplay.prototype.Clear=function(){return};DDisplay.prototype.GDefault=function(){this.val=Null;if("d" in getDefaults_NS(this.windowID)[this.mID]){return(new CharType(ExpandString(this.windowID,""+getDefaults_NS(this.windowID)[this.mID].d,2)))}return null};DDisplay.URLTypeParamsRE=new RegExp("[?|&]([^=]*)=([^&]*)","g");DDisplay.RegularParamsRE=new RegExp('\\s*([^=\\s,]+)\\s*=((\\s*([^",]+\\"[^"]*\\"[^",]*)*\\s*)|(\\s*\\"(([^"]|(""))*)\\"\\s*)|([^,]*))(,|$)',"g");DDisplay.HTTPPAT=new RegExp("^https?:[\\\\/][\\\\/].*","i");DDisplay.CURRENTSERVER=new RegExp("^((%40)|@)$");DDisplay.replaceRegExpSuffix=")=[^&]*";DDisplay.PLUGIN_CONTEXT="plugins/";DDisplay.PLUGIN_CONTEXT_SUFF="/params";DDisplay.PluginNameReplaceRE=new RegExp("(.*/)"+DDisplay.PLUGIN_CONTEXT+"[^/]+"+DDisplay.PLUGIN_CONTEXT_SUFF);DDisplay.prototype.DoSet=DDisplay.prototype.DoSetLoadEntry=function(g){if(g.isNull){return}else{g=g.toString()}var v={};var k=[];if(g.match(DDisplay.HTTPPAT)){var o;while((o=DDisplay.URLTypeParamsRE.exec(g))){k.push("("+o[1]+")");v[(o[1]!="windowID")?o[1].toLowerCase():o[1]]=o[2]}}else{var o;while((o=DDisplay.RegularParamsRE.exec(g))){k.push("("+o[1]+")");var D=o[3]?o[3]:(o[4]?o[4]:(o[6]?(o[8]?o[6].replace(/\"\"/g,'"'):o[6]):o[9]));if(typeof D=="undefined"||D==null){D=""}v[o[1].toLowerCase()]=encodeURIComponent(D)}}k.push("(rtl)");var w="ltr";v.rtl=w;if(k.length>0){var h=v.server;if(h&&h.match(DDisplay.CURRENTSERVER)){v.server=encodeURIComponent(ARKWGetStringByIdx(this.windowID,7))}if(this.mContainerID!=null){var b=parseInt(this.GetFocusElement().offsetWidth);var B=parseInt(this.GetFocusElement().offsetHeight);if(v.width&&b>0){v.width=b}if(v.height&&B>0){v.height=B}}var f="[?|&]("+k.join("|");f+=DDisplay.replaceRegExpSuffix;var u;var d;if(this.val.isNull){h=v.plugin;delete v.plugin;u=(AbsContextPath+DDisplay.PLUGIN_CONTEXT+h+DDisplay.PLUGIN_CONTEXT_SUFF+"?");v.fieldid=this.mID;v.windowID=this.windowID;h=((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):"");if(h!=""){v.appname=encodeURIComponent(h)}var s=ARKWGetStringByIdx(this.windowID,6);if(typeof s=="undefined"){s=""}v.schema=encodeURIComponent(s);var y=ARKWGetStringByIdx(this.windowID,17);v.view=encodeURIComponent(y);d=true}else{d=false;h=v.plugin;u=this.val.toString();if(h){u=u.replace(DDisplay.PluginNameReplaceRE,"$1"+DDisplay.PLUGIN_CONTEXT+h+DDisplay.PLUGIN_CONTEXT_SUFF);delete v.plugin;this.disableSetFieldsEvent()}u=u.replace(new RegExp(f,"gi"),function(G,H){var E=v[H];delete v[H];return G.charAt(0)+H+"="+E})}var C=[];for(var A in v){if((typeof A=="string")&&(A.indexOf("qual")!=-1)&&(!xmlHttpGET)){var z=decodeURIComponent(v[A]);z=z.replace(/\'/g,"$quot");z=z.replace(/</g,"$lt");z=z.replace(/>/g,"$gt");C.push(A+"="+encodeURIComponent(z))}else{C.push(A+"="+v[A])}}if((u.indexOf("qual")!=-1)&&(!xmlHttpGET)){u=u.replace(/\'/g,encodeURIComponent("$quot"));u=u.replace(/</g,encodeURIComponent("$lt"));u=u.replace(/>/g,encodeURIComponent("$gt"))}if(C.length>0){if(!d){u+="&"}u+=C.join("&")}DDisplay.superclass.DoSet.call(this,new CharType(u))}};DDisplay.prototype.setContents=function(){DDisplay.superclass.setContents.call(this);initSessionTimeoutCounter()};DDisplay.fbDrillDown=function(g,f,b,d){new WorkflowContext({f:ARACTOpenQueryWindow,a:[g,f,b,"New",10,d,1,null,false,[],null,null,{}]})};DDisplay.prototype.isSetFieldsEventEnabled=function(){var f=false;try{var b=window.frames[this.mFrameName];if(b!=null&&typeof b.EventDispatcher!="undefined"&&typeof b.EventDispatcher.isSetFieldsEventEnabled=="function"){f=b.EventDispatcher.isSetFieldsEventEnabled()}}catch(d){}return f};DDisplay.prototype.setFieldsAsEvent=function(f){try{var b=window.frames[this.mFrameName];if(b!=null&&typeof b.EventDispatcher!="undefined"){b.EventDispatcher.dispatch("ACT-SET-FIELDS-EVENT",f)}}catch(d){}};DDisplay.prototype.disableSetFieldsEvent=function(){try{var b=window.frames[this.mFrameName];if(b!=null&&typeof b.EventDispatcher!="undefined"&&typeof b.EventDispatcher.disableSetFieldsEvent=="function"){b.EventDispatcher.disableSetFieldsEvent()}}catch(d){}};JFieldFactories.Display=function(b,f,d){return new JDisplay(b,f,d)};function JDisplay(g,f,d){if(arguments.length){this.init(g,f,d)}}DAppList.prototype=new DView();DAppList.prototype.constructor=DAppList;DAppList.superclass=DView.prototype;JAppList.prototype=new JView();JAppList.prototype.constructor=JAppList;JAppList.superclass=JView.prototype;DOMFieldFactories.AppList=function(b,f,d){return new DAppList(b,f,d)};function DAppList(g,f,d){if(arguments.length){this.init(g,f,d)}}DAppList.prototype.init=function(b,f,d){DAppList.superclass.init.call(this,b,f,d);this.loaded=false;if(this.mode==1){this.mTopbkcolor=this.mObj.getAttribute("topbkcolor");this.mLvlevenbkcolor=this.mObj.getAttribute("lvlevenbkcolor");this.mLvloddbkcolor=this.mObj.getAttribute("lvloddbkcolor");this.mToptxtcolor=this.mObj.getAttribute("oddlvltxtcolor");this.mSublvlcolor=this.mObj.getAttribute("evenlvltxtcolor");this.inFill=false;if(this.mObj.getAttribute("arcontainerid")){this.inFill=true}if(this.mObj.getAttribute("arparentid")){this.mContainerID=this.mObj.getAttribute("arparentid");if(this.inFill==false){this._top=this.mObj.style.top;this._left=this.mObj.style.left}}this.rootFlyout=this.mObj.childNodes[1];this.mContainFields=true;this.mModified=true}};DAppList.prototype.getList=function(){var u=document.createElement("DIV");u.style.align="center";u.style.valign="center";u.style.left="30%";u.style.top="50%";u.style.visibility="visible";u.className="loadingContainer";u.style.display="inline";u.innerHTML="<nobr><img class='loadingImage' src='"+AbsContextPath+"resources/images/Progress_NonModal-circle.gif'/><span class='loadingText'>"+getLocalizedMessage("Loading...")+"</span></nobr>";this.rootFlyout.appendChild(u);var g=null;if(""+1576 in getFields_NS(this.windowID)){g=getFields_NS(this.windowID)[1576].G().toString()}var d=encodeURIComponent(ARKWGetStringByIdx(this.windowID,7));var h=encodeURIComponent(ARKWGetStringByIdx(this.windowID,6));var s=encodeURIComponent(ARKWGetStringByIdx(this.windowID,17));var b=getFormDataHolderById(this.windowID).appcacheid;if(typeof myAppCacheID!="undefined"&&myAppCacheID!=b){b=myAppCacheID}var k=RelContextPath+"forms/"+d+"/"+h+"/"+s+"/AppList.html?cacheid="+b+"&format=html";if(g!=null&&g!=""){k+="&AppListSubset="+encodeURIComponent(g)}var f="&mode="+this.mode+"&mID="+this.mID;var v=GET_XML_HTTP();v.open("GET",k+f,true);v.setRequestHeader("Content-type","text/plain; charset=UTF-8");var w=this;v.onreadystatechange=function(){if(v.readyState==4){var y="ARERR ["+9201+"]";if(v.responseText.indexOf(y)==-1){initSessionTimeoutCounter();w.loaded=true;var z=parseScript(v.responseText);w.rootFlyout.innerHTML=z;if(v.responseText.length>0){Field_Init(w.windowID,w.rootFlyout);setHandlers(w.windowID,w.mObj)}}}};try{v.send(f)}catch(o){alert(o.message)}};function parseStyle(u){var k=u;var h=new Array();while(k.indexOf("<style")>-1||k.indexOf("</style")>-1){var g=k.indexOf("<style");var b=k.indexOf(">",g);var o=k.indexOf("</style",g);var d=k.indexOf(">",o);h.push(k.substring(b+1,o));k=k.substring(0,g)+k.substring(d+1)}for(var f=0;f<h.length;f++){embedStyle(h[f])}return k}var STYLEHREFLINK=new RegExp("^href=((\")|('))?([^'\"\\s]*)((\")|('))?","i");function parseStyleLink(b){var d=b;var y=new Array();while(d.indexOf("<link")>-1||d.indexOf("</link")>-1){var z=d.indexOf("<link");var k=d.indexOf(">",z);var o=d.indexOf("</link",z);var h=d.indexOf(">",o);var w=d.substring(z+4,k);if(w.length>0){var v=w.indexOf("href=");if(v!=-1){STYLEHREFLINK.lastIndex=0;var g=STYLEHREFLINK.exec(w.substring(v));if(g!=null&&typeof g[4]!="undefined"){y.push(g[4]);if(o!=-1){d=d.substring(0,z)+d.substring(h+1)}else{d=d.substring(0,z)+d.substring(k+1)}}}}}for(var f=0;f<y.length;f++){try{createStyleTag(y[f])}catch(u){}}return d}var SCRIPTSRCLINK=new RegExp("^src=((\")|('))?([^'\"\\s]*)((\")|('))?","i");function parseScript(b){var d=b;var f=new Array();var z=new Array();while(d.indexOf("<script")>-1||d.indexOf("<\/script")>-1){var B=d.indexOf("<script");var u=d.indexOf(">",B);var v=d.indexOf("<\/script",B);var o=d.indexOf(">",v);var A=d.substring(B+6,u);if(A.length>0){var y=A.indexOf("src=");if(y!=-1){SCRIPTSRCLINK.lastIndex=0;var k=SCRIPTSRCLINK.exec(A.substring(y));if(k!=null&&typeof k[4]!="undefined"){z.push(k[4]);if(v!=-1){d=d.substring(0,B)+d.substring(o+1)}else{d=d.substring(0,B)+d.substring(u+1)}continue}}}f.push(d.substring(u+1,v));d=d.substring(0,B)+d.substring(o+1)}for(var g=0;g<z.length;g++){try{createScriptTag(z[g])}catch(w){}}for(var h=0;h<f.length;h++){embedScript(f[h])}return d}DAppList.prototype.mContainFields=false;DAppList.Load=function(b){var d=getFields_NS(b)[1575];if(d&&d instanceof DAppList&&!d.loaded){DAppList.Refresh(b)}};function OpenWindow(f,d,g,h){var b=getCurrentWindowID_NS();f=f.replace(/\\/g,"\\\\");d=d.replace(/\\/g,"\\\\");if(getCurWFC_NS(b)){return getCurWFC_NS(b).execute({f:ARACTOpenWindow,a:[b,f,d,"","New",h,null,g,null,null]})}new WorkflowContext(b,{f:ARACTOpenWindow,a:[b,f,d,"","New",h,null,g,null,null]})}function OpenAppWindow(f,d){var b=getCurrentWindowID_NS();if(d.shiftKey==true){if(getCurWFC_NS(b)){return getCurWFC_NS(b).execute({f:OpenNonModalURL,a:[b,f,1,""+new Date().getTime()]})}new WorkflowContext(b,{f:OpenNonModalURL,a:[b,f,1,""+new Date().getTime()]})}else{if(getCurWFC_NS(b)){return getCurWFC_NS(b).execute({f:OpenNonModalURL,a:[b,f,2,""+new Date().getTime()]})}new WorkflowContext(b,{f:OpenNonModalURL,a:[b,f,2,""+new Date().getTime()]})}}DAppList.Refresh=function(f){var g=getFields_NS(f)[1575];if(g&&g instanceof DAppList){var s=null;if(""+1576 in getFields_NS(f)){s=getFields_NS(f)[1576].G().toString()}var o=encodeURIComponent(ARKWGetStringByIdx(f,7));var k=encodeURIComponent(ARKWGetStringByIdx(f,6));var d=encodeURIComponent(ARKWGetStringByIdx(f,17));var b=getFormDataHolderById(f).appcacheid;if(typeof myAppCacheID!="undefined"&&myAppCacheID!=b){b=myAppCacheID}var h=(AbsDocumentPath+"AppList.html?cacheid="+b+"&format=html");if(s!=null&&s!=""){h+="&AppListSubset="+encodeURIComponent(s)}if(typeof g.mID!="undefined"&&g.mID!=null){h+="&mID="+g.mID}g.loaded=true;DAppList.superclass.DoSet.call(g,new CharType(h))}};DAppList.prototype.DoSet=DAppList.prototype.DoSLoadEntry=JAppList.prototype.DoSet=JAppList.prototype.DoSLoadEntry=function(b){};DAppList.prototype.ol=function(){var d=window.frames[this.mFrameName];try{if(d.document&&d.document.body){if(!(d.document.body.style.backgroundColor)){d.document.body.style.backgroundColor="transparent"}var g=d.window.Msg;if(g){var f=getFields_NS(this.windowID)[1575];if(f){DAppList.superclass.DoSet.call(f,new CharType("<html><body>"+getLocalizedMessage(g)+"</body></html>"))}}}}catch(b){}};DAppList.prototype.mHaveStoredData=JAppList.prototype.mHaveStoredData=false;function arInvokeEntryPoint(d,h,g){if(typeof h!="string"||typeof g!="string"){return}var f=getFields_NS(d)[1575];if(!f.mFrameName){return}var b=window.frames[f.mFrameName];if(!b){return}h=ExpandServerName(d,h);g=ExpandGuideName(d,g);var k="CallARG"+(g+h).ARToJSIdentifier()+"EPFunc";if(k in b){return b[k](true)}else{return}}function doEval(str){return eval(str)}JFieldFactories.AppList=function(b,f,d){return new JAppList(b,f,d)};function JAppList(b,f,d){if(arguments.length){this.init(b,f,d)}}JAppList.prototype.init=function(b,f,d){JAppList.superclass.init.call(this,b,f,d);this.loaded=false};function ParseInvalidNumberInLocaleAsBestWeCan(g,f){if(g==null||g==""){return g}g=g.replace(f,"$1");var d="",b;for(b=0;b<g.length;b++){if(g.charAt(b)==localeInfo.lcDecimalSep){d+="."}else{if(g.charAt(b)!=localeInfo.lcThousandSep){d+=g.charAt(b)}}}return""+parseFloat(d)}function LCRealToEn_US(k,h){var g=localeInfo.lcDecimalSep;if(g=="."){g="\\."}var f=new RegExp("^\\s*[+-]?\\d*("+g+"\\d+)?\\s*$");if(!k.match(f)){f=new RegExp("^\\s*[+-]?\\d*("+g+"\\d+)?[Ee][+-]?\\d+\\s*$");if(!k.match(f)){if(h){throw ({t:2,n:9373,m:null,a:'"'+k+'"'})}else{var f=new RegExp("^\\s*([+-]?\\d*("+g+"\\d+)?)(.*)");return ParseInvalidNumberInLocaleAsBestWeCan(k,f)}}}var d="",b;for(b=0;b<k.length;b++){if(k.charAt(b)==localeInfo.lcDecimalSep){d+="."}else{if(k.charAt(b)==localeInfo.lcThousandSep){d+=","}else{d+=k.charAt(b)}}}return d}function En_USRealToLC(f){var d="",b;for(b=0;b<f.length;b++){if(f.charAt(b)=="."){d+=localeInfo.lcDecimalSep}else{if(f.charAt(b)==","){d+=localeInfo.lcThousandSep}else{d+=f.charAt(b)}}}return d}function En_USDecimalToLC(o){var g=o.replace(".",localeInfo.lcDecimalSep);var f="",b=g.length-1,k,d,h=g.indexOf(localeInfo.lcDecimalSep)-1;if(h<0){h=b}for(d=0;d<=b;d++){f+=k=g.charAt(d);if((d<h)&&((h-d)%3==0)&&(k!="-")){f+=localeInfo.lcThousandSep}}return f}function LCDecimalToEn_US(o,k){var h=localeInfo.lcDecimalSep;if(h=="."){h="\\."}var g=localeInfo.lcThousandSep;if(g=="."){g="\\."}var f=new RegExp("^\\s*[+-]?\\d*("+g+"\\d\\d\\d)*("+h+"\\d*)?\\s*$");if(!o.match(f)){if(k){throw ({t:2,n:9374,m:null,a:'"'+o+'"'})}else{f=new RegExp("^\\s*([+-]?[\\d*"+g+"]+("+h+"\\d*)?)(.*)");return ParseInvalidNumberInLocaleAsBestWeCan(o,f)}}var d="",b;for(b=0;b<o.length;b++){if(o.charAt(b)==localeInfo.lcDecimalSep){d+="."}else{if(o.charAt(b)==localeInfo.lcThousandSep){}else{d+=o.charAt(b)}}}return d}DIVPopup.prototype.constructor=DIVPopup;var ddGlobal=null;var gFocusItem=null;function DIVPopup(b){if(arguments.length){this.init(b)}}DIVPopup.prototype.init=function(d,k,g,b,h,f){this.windowID=d;this.mDiv=null;this.mModal=k;this.mShowBtn=g;this.mX=this.mY=0;this.mIFrame=null;this.mOrigin=null;this.mDraggable=b;this.mResizable=h;this.mTitleBar=f;this.mW=this.mH=0};DIVPopup.prototype.windowID;DIVPopup.FindPopup=function(d,g){var b=null;if(getOpenDIVPopup_NS(d)!=null){while(g&&g!=document.body){if(g.id=="ardivpcancel"){return findClickedElement(d,g)}if(g==getOpenDIVPopup_NS(d).mDiv){return getOpenDIVPopup_NS(d)}else{if(g.className.indexOf("DIVPopup")!=-1){for(var f=0;f<getCharEditPopups_NS(d).length;f++){if(getCharEditPopups_NS(d)[f].mDiv==g){b=getCharEditPopups_NS(d)[f]}}}}g=g.parentNode}if(getOpenDIVPopup_NS(d).ShowSingle()){getOpenDIVPopup_NS(d).HidePopup(true)}}return b};DIVPopup.prototype.ShowSingle=function(){return !this.mModal};DIVPopup.prototype.OnResize=function(d,f,g,b){};DIVPopup.prototype.OnStartDrag=function(){};DIVPopup.prototype.OnEndDrag=function(){};DIVPopup.prototype.KeyDown=function(b){if(getOpenDIVPopup_NS(this.windowID)&&getOpenDIVPopup_NS(this.windowID).mModal){if(b.key==27&&typeof(getOpenDIVPopup_NS(this.windowID).OnCancel)=="function"){getOpenDIVPopup_NS(this.windowID).OnCancel();return false}if((b.key==13||b.key==32)&&b.element.getAttribute("DIVBTN")){b.element.click();return false}}if(b.key==9){this.DoTab(b,!b.shift);b.SetKeyCode(505);return false}return true};DIVPopup.prototype.Click=DIVPopup.prototype.KeyPress=function(b){return false};DIVPopup.prototype.HidePopup=function(g){if(g&&(typeof AnimMgr!="undefined")){var d,o,f,k;d=parseInt(this.mDiv.style.left);o=parseInt(this.mDiv.style.top);if(this.mDiv!=null){f=k=0}AnimMgr.ZoomIn(this,d,o,f,k)}else{if(this.mIFrame!=null&&this.mIFrame.frameElement!=null){this.mIFrame.frameElement.src="javascript:false;"}document.body.removeChild(this.mDiv)}var b=getCharEditPopups_NS(this.windowID);if(b.length>0){setOpenDIVPopup_NS(this.windowID,b[b.length-1])}else{clearOpenDIVPopup_NS(this.windowID)}if(this.mModal){weEnableStuff(this.windowID)}FocusMgr.resettheFocus()};DIVPopup.setIFrameHeight=function(g,b,f){var d=g.getElementsByTagName("iframe");if(d.length!=0){if(d[0].className.indexOf("yui")==-1){if(f){d[0].style.height=(b-21)+"px"}else{d[0].style.height=b+"px"}}return true}return false};DIVPopup.prototype.ShowPopup=function(J,k,g,o){var B=this.mW,N=this.mH;var L=this.mDiv.childNodes[0];if(B==0){B=L.offsetWidth}if(N==0){N=L.offsetHeight}var I=getFormElements_NS(0)["FormContainer"];if(this.mResizable){var u=L.className;if(u.indexOf("ResizablePopup")==-1){L.className=u+" ResizablePopup"}}if(this.mModal){weDisableStuff(this.windowID)}this.mDiv.style.zIndex=nextZIndex++;setOpenDIVPopup_NS(this.windowID,this);var Q=document.body.scrollTop;var s=window.innerHeight+Q;var S=ComputeElementPosition(J,document.body,k,g);var A=S.x,z=S.y;z=(z<Q?Q:z);z=(z+N>=s?s-N:z);z=(z<0?0:z);var b=document.body.scrollLeft;var R=window.innerWidth+b;A=(A<b?b:A);A=(A+B>=R?R-B:A);A=(A<0?0:A);this.mDiv.style.left=this.mX=A+"px";this.mDiv.style.top=this.mY=z+"px";var H=Math.max(A+B-R,0);var f=Math.max(z+N-s,0);if(weGetDialogueParentID()==0&&getWindowType(this.windowID)!="FormDialog"){var E=I.offsetHeight+I.offsetTop;if(N>E){N=E}}if(o&&(typeof AnimMgr!="undefined")&&H<=0&&f<=0){AnimMgr.ZoomOut(J,this,A,z,B,N)}else{if(this instanceof RichTextEditPopupCK){this.mDiv.style.minWidth=B+"px"}this.mDiv.style.width=B+"px";this.mDiv.style.height=N+"px";var v=this.windowID;setTimeout(function(){DIVPopup.InitFocus(v)},20)}if(this.mDiv.getElementsByTagName("textarea").length==1){this.mDiv.getElementsByTagName("textarea")[0].style.height=(N-100)+"px"}else{if(this.mDiv.getElementsByTagName("textarea").length==2){this.mDiv.getElementsByTagName("textarea")[0].style.height=(N/2-65)+"px";this.mDiv.getElementsByTagName("textarea")[1].style.height=(N/2-65)+"px"}}var d=this.mDiv.getElementsByTagName("div");if(!(this instanceof RichTextEditPopup)){var S=DIVPopup.setIFrameHeight(this.mDiv,N,this.mResizable);var D=0;if(d.length!=0&&!S){for(var K=0;K<d.length;K++){if(d[K].id.indexOf("editor")!=-1||d[K].id.indexOf("Editor")!=-1){if(D){d[K].style.height=(N/2-65)+"px";d[D].style.height=(N/2-65)+"px"}else{d[K].style.height=(N-100)+"px";D=K}}}}}this.mDiv.style.visibility="inherit";this.mDiv.style.overflow="hidden";this.mTabStops=[];this.ComputeTabStops(this.mDiv);if(H>0||f>0){if(weAmPopup(window.name)){if(H>0){var G=getOpenDIVPopup_NS(this.windowID).mDiv.offsetWidth;window.weOpener.getOpenDIVPopup_NS(weGetDialogueParentID()).mDiv.style.width=G+H+"px"}if(f>0){var P=getOpenDIVPopup_NS(this.windowID).mDiv.offsetHeight;var O=P+f;var C=window.weOpener.getOpenDIVPopup_NS(weGetDialogueParentID()).mDiv;C.style.height=O+"px";if(!(this instanceof RichTextEditPopup)){var S=DIVPopup.setIFrameHeight(C,O,this.mResizable)}}}else{window.resizeBy(H,f)}}this.InstantiateDragandResize()};DIVPopup.prototype.ComputeTabStops=function(d){if("getAttribute" in d&&d.getAttribute("artb")){this.mTabStops.push(d)}if(d.childNodes&&d.childNodes.length>0){for(var b=0;b<d.childNodes.length;b++){this.ComputeTabStops(d.childNodes[b])}}};DIVPopup.prototype.SetSize=function(b,d){if(b){this.mW=b}if(d){this.mH=d}};DIVPopup.prototype.ShowCentredPopup=function(b){var d=this.GetPosition();return this.ShowPopup(document.body,d.x,d.y,b)};DIVPopup.prototype.GetPosition=function(){var o=document.body.scrollTop;var g=document.body.scrollLeft;var f=window.innerHeight+o;var s=window.innerWidth+g;var d=this.mW/2,k=this.mH/2;if(d==0){d=Math.floor(this.mDiv.firstChild.offsetWidth/2)}if(k==0){k=Math.floor(this.mDiv.firstChild.offsetHeight/2)}var b=g+(s-g)/2-d;var u=o+(f-o)/2-k;return{x:b,y:u}};DIVPopup.prototype.SetFocus=function(){};DIVPopup.prototype.Buttons=[{t:getLocalizedMessage("OK"),f:"OnOK",id:"ardivpok"},{t:getLocalizedMessage("Cancel"),f:"OnCancel",id:"ardivpcancel"}];DIVPopup.prototype.CloseButton=[{t:getLocalizedMessage("Close"),f:"OnCancel",id:"ardivpcl"}];DIVPopup.prototype.ButtonSpacing=5;DIVPopup.prototype.WriteClickHandlerButton=function(b){return" onclick=\"var target=FindClickedPopup('"+this.windowID+"', event); if(target){ target."+b+'();target.stopBubbling(event);return false;}"'};DIVPopup.prototype.WriteModalButtons=function(){var d=[];d.push("<tr><td colspan=3 align=center class='DIVPopupButtons");if(!this.mTitleBar){d.push(" bottomborder")}d.push("'><table><tr>");for(var b in this.Buttons){d.push('<td height="29px">');d.push("<button artb=1 divbtn=1 tabindex = 0 onmousedown=\"this.className=this.className.replace(/btn3d/,'btn3ddown')\" onmouseup=\"this.className=this.className.replace(/btn3ddown/,'btn3d')\" onmouseout=\"this.className=this.className.replace(/btn3ddown/,'btn3d')\"");d.push(' id="'+this.Buttons[b].id+'"');d.push(this.WriteClickHandlerButton(this.Buttons[b].f));d.push(' class="btn3d" style="position:relative; left:0; height:19; top:0; "');d.push(">");d.push('<div class="btntextdiv f1" style="position:relative; padding-top:3px; left:0px; height:19px;">&nbsp;&nbsp;');d.push(this.Buttons[b].t+"&nbsp;&nbsp;</div>");d.push('</td><td width="'+this.ButtonSpacing+'" height="19px">&nbsp;</td>')}d.push('</tr><tr><td height="10px"></td></tr></table></td></tr>');return d.join("")};DIVPopup.prototype.SetFocusToButton=function(b){var d=document.getElementById(b);if(d!=null){d.focus()}};DIVPopup.prototype.stopBubbling=function(b){LogWrite("divpopup.stopbubbling");b.stopPropagation()};DIVPopup.prototype.OnOK=function(){this.HidePopup(true)};DIVPopup.prototype.OnCancel=function(){this.HidePopup(true)};DIVPopup.prototype.PopupBodyStyle="DIVPopupBody";DIVPopup.prototype.PopupStyle="DIVPopup";DIVPopup.prototype.GetTitleBarHTML=function(d){var h="DIVPopupTitleBar";var k="title";if(this.mDraggable){h+=" DIVDraggable";if(this.mField!=null){if(this.mField.mID!=0){k+=this.mField.mID}else{k+=this.mField.mInputNode.id;if("mRowPos" in this.mField){k+=this.mField.mRowPos}}}}k=k+"_"+this.windowID;var g='<tr class="'+h+'">';g+="<td colspan=3 ";g+="class='center' id='"+k+'\' align=left nowrap><div class="title">';g+=(d.HTMLEncode()+"&nbsp;&nbsp;&nbsp;");g+="</div>";for(var f in this.CloseButton){var b="Close  right";g+='<button type="button" class="'+b+'" id="'+this.CloseButton[f].id+'" title="'+this.CloseButton[f].t+'"';g+=this.WriteClickHandlerButton(this.CloseButton[f].f);g+=">"}g+="</button></td>";g+="</tr>";return g};function FindClickedPopup(b,f){f=f||window.event;var d=f.target||f.srcElement;return findClickedElement(b,d)}function findClickedElement(f,h){var k=new Array;var d;while(h.id==""&&h!=document.body){h=h.parentNode}if((h.id=="ardivpok")||(h.id=="ardivpcancel")||(h.id=="ardivpcl")){d=FindClickedParent(h)}if(d==getOpenDIVPopup_NS(f).mDiv){return getOpenDIVPopup_NS(f)}if(d){k=getCharEditPopups_NS(f);var b=k.length;for(var g=0;g<b;g++){if((k[g].mDiv==d)){return getCharEditPopups_NS(f)[g]}}}return null}function RemoveClickedPopup(d,h){var g=getCharEditPopups_NS(d);var k;var b=g.length;for(var f=0;f<b;f++){if((g[f].mDiv==h.mDiv)){k=f;break}}getCharEditPopups_NS(d).splice(k,1);if(getCharEditPopups_NS(d).length>0){setOpenDIVPopup_NS(d,getCharEditPopups_NS(d)[getCharEditPopups_NS(d).length-1])}}function FindClickedParent(d){var b=d;while(b&&b!=document.body){if(b.id.indexOf("popup")==0){return b}b=b.parentNode}return null}DIVPopup.prototype.GetDragHandlerHTML=function(){return"<DIV class='DraggableTitleBar DIVDraggable' id='title_"+this.windowID+"'><img style='width:100%;height:100%' src='"+RelContextPath+"resources/images/transparent.gif'></DIV>"};DIVPopup.prototype.SetContents=function(f,g){this.CreateDIV();var d=this.PopupStyle;if(this.mW>0){d+=" ResizablePopup"}var h='<table id="DivTable" class=\''+d+"' cellspacing=0 cellpadding=0>";if(this.mTitleBar){h+=this.GetTitleBarHTML(f)}h+='<tr><td colspan=3 class="'+this.PopupBodyStyle;if(this.mTitleBar){h+=" DIVPopupBodyBorder"}h+='">'+g+"</td></tr>";if(this.mShowBtn){h+=this.WriteModalButtons()}h+="</table>";if(this.mTitleBar){h+="<b class='rndfooter'><b class='rnd1'></b><b class='rnd2'></b><b class='rnd3'></b></b>"}if(this.mResizable){var k="handle";if(this.mField!=null){if(this.mField.mID!=0){k+=this.mField.mID}else{k+=this.mField.mInputNode.id;if("mRowPos" in this.mField){k+=this.mField.mRowPos}}}k+="_"+this.windowID;var b="ResizeHandle  right";h+='<DIV class="'+b+"\" id='";h+=k;h+="'></DIV>"}if(!this.mTitleBar&&this.mDraggable){h+=this.GetDragHandlerHTML()}if(this.isOldChild==undefined){this.mDiv.innerHTML=h}};DIVPopup.prototype.CreateDIV=function(){if(!this.mDiv){var g=null;var d="popup";if(this.mField!=null){var h=this.mField.mID;if(h==0){h=this.mField.mInputNode.id;if("mRowPos" in this.mField){h+=this.mField.mRowPos}}h=h+"_"+this.windowID;d+=h}else{d+="_"+this.windowID}var b=this.PopupStyle;if(!this.mTitleBar){b+=" transparent"}b+=" shadow ";var f=document.getElementById(d);if(f){g=f;this.isOldChild=true}else{g=document.createElement("DIV");g.id=d;g.className=b;g.style.top=this.mY+"px";g.style.left=this.mX+"px";g.style.zIndex=nextZIndex++;document.body.appendChild(g)}this.mDiv=g;this.mDiv.setAttribute("arwindowid",this.windowID)}};DIVPopup.InitFocus=function(b){if(getOpenDIVPopup_NS(b)){getOpenDIVPopup_NS(b).InitFocus()}};DIVPopup.prototype.InitFocus=function(){return};DIVPopup.prototype.DoTab=function(d,g){var b=0;var f=d.element;if(f&&f.getAttribute("artb")){for(var h=0;h<this.mTabStops.length;h++){if(this.mTabStops[h]==d.element){b=h+(g?1:-1);if(b>=this.mTabStops.length){b=0}else{if(b<0){b=this.mTabStops.length-1}}}}if(b in this.mTabStops){gFocusItem=this.mTabStops[b];setTimeout("doFocus()",100)}}};function doFocus(){try{if(gFocusItem!=null){gFocusItem.focus();gFocusItem=null}}catch(b){alert("Error in doFocus()")}}DIVPopup.prototype.SetOrigin=function(b){this.mOrigin=b};DIVPopup.prototype.InstantiateDragandResize=function(){var g="popup";var d="handle";var h="title";if(this.mField!=null){var k=this.mField.mID;if(k==0){k=this.mField.mInputNode.id;if("mRowPos" in this.mField){k+=this.mField.mRowPos}}k=k+"_"+this.windowID;g+=k;d+=k;h+=k}else{g+="_"+this.windowID;d+="_"+this.windowID;h+="_"+this.windowID}if(this.mDiv.id!=g){this.mDiv.id=g}var b=null;if(this.mDraggable){b=new PopUpDrag(this,g,"paneldrag");b.addInvalidHandleId(d);b.setOuterHandleElId(h);b.startDrag=function(){var s=DIVPopup.FindPopup(this.mDIVPopup.windowID,this.getEl());var o=document.getElementById(this.handleElId);if(o!=null&&o.className.indexOf("DraggableTitleBar")!=-1){o.style.height="30px"}if(s){s.SetFocus()}};b.endDrag=function(){var o=document.getElementById(this.handleElId);if(o!=null&&o.className.indexOf("DraggableTitleBar")!=-1){o.style.height="10px"}}}var f=new PopupResize(this,g,d,"panelresize");if(this.mDraggable){f.popupDrag=b;ddGlobal=b}};AlertPopup.prototype=new DIVPopup();AlertPopup.prototype.constructor=AlertPopup;AlertPopup.superclass=DIVPopup.prototype;AlertPopup.prototype.Buttons=[{t:getLocalizedMessage("OK"),w:50,f:"OnOK",id:"ardivpok"},];function AlertPopup(b){AlertPopup.superclass.init.call(this,b,true,true,false,false,true)}function ShowAlertPopup(b,f,k){var h=new AlertPopup(b);var d='<P><TABLE><TR><TD><textarea id="aralertpopmsg" readonly rows=4 cols=50 class="dat" style="overflow:auto;">{0}</textarea></TD></TR></TABLE><P>'.replaceArgs(f);h.SetContents(k,d);h.ShowCentredPopup(false);h.SetFocusToButton(h.Buttons[0].id);if("external" in top){try{top.external.ShowAlertPopup()}catch(g){}}}PopupResize=function(f,h,d,b,g){PopupResize.superclass.constructor.call(this,h,b,g);this.mDIVPopup=f;if(d){this.setHandleElId(d)}};YAHOO.extend(PopupResize,YAHOO.util.DragDrop,{_newHeight:0,_newWidth:0,_minX:250,_minY:200,onMouseDown:function(g){var f=this.getEl();this.startRTF={};this.startWidth=f.offsetWidth;this.startHeight=f.offsetHeight;this._newWidth=this.startWidth;this._newHeight=this.startHeight;this.startPos=[YAHOO.util.Event.getPageX(g),YAHOO.util.Event.getPageY(g)];var h=YAHOO.util.Event.getTarget(g);this.resizeHandle=false;if(h!=null&&$(h).is(".ResizeHandle")){var d=$(f).find("div#maintextareadiv_rtf_container");if(d.length>0){this.startRTF.RTF=true;this.startRTF["div#maintextareadiv_rtf_container"]={width:d.width(),height:d.height()}}else{this.startRTF.RTF=false}var b=$(h).is(".right")?"right bottom":"left bottom";$(h).css({height:"1000px",width:"1000px","background-position":b});this.resizeHandle=true}},onDrag:function(w){var y=[YAHOO.util.Event.getPageX(w),YAHOO.util.Event.getPageY(w)];var o=y[0]-this.startPos[0];var h=y[1]-this.startPos[1];var d=this.getEl();if(this.resizeHandle){this._newWidth=Math.max(this.startWidth+o,10);this._newHeight=Math.max(this.startHeight+h,10);if(this._newWidth<this._minX){this._newWidth=this._minX}if(this._newHeight<this._minY){this._newHeight=this._minY}var k=this._newWidth;var b=this._newHeight;$(d).css({width:k+"px",height:b+"px"});var u=$(d).find("textarea");if(u.length==1){$(u[0]).css({height:(b-100)+"px"})}else{if(u.length==2){$(u[0]).css({height:(b/2-65)+"px"});$(u[1]).css({height:(b/2-65)+"px"})}}if(this.startRTF.RTF){h=b-this.startHeight;var f=Math.max(this.startRTF["div#maintextareadiv_rtf_container"].height+h,10);this.mDIVPopup.FixWidthAndHeights(f)}else{var s=$(d).find("iframe");var g=s.length;if(g>0){$(s).css("height",(b-25)+"px")}else{var z=0;$(d).find("div").each(function(A,B){if($(B).attr("id")!=undefined&&($(B).attr("id").indexOf("editor")!=-1||$(B).attr("id").indexOf("Editor")!=-1)){z+=1}});$(d).find("div").each(function(A,B){if($(B).attr("id")!=undefined&&($(B).attr("id").indexOf("editor")!=-1||$(B).attr("id").indexOf("Editor")!=-1)){if(z<=1){$(B).css("height",(b-100)+"px")}else{$(B).css("height",((b/z)-65)+"px")}}})}}}else{var v=$(d).position();$(d).css({left:(v.left+o)+"px",top:(v.top+h)+"px"});this.startPos=y}hoverState.mIgnoreEvent=true},onMouseUp:function(f){if(this.resizeHandle){$(this.getEl()).css({width:this._newWidth+"px",height:this._newHeight+"px"});this.mDIVPopup.OnResize(this.startWidth,this._newWidth,this.startHeight,this._newHeight)}this._newWidth=0;this._newHeight=0;var d=this.popupDrag;if(d!=undefined){d.resetConstraints();d.setConstraints()}var g=document.getElementById(this.handleElId);if(g!=null&&$(g).is(".ResizeHandle")){var b=$(g).is(".right")?"right bottom":"left bottom";$(g).css({height:"10px",width:"10px","background-position":b})}hoverState.mIgnoreEvent=false}});PopUpDrag=function(f,d,b){this.mDIVPopup=f;PopUpDrag.superclass.constructor.call(this,d,b)};YAHOO.extend(PopUpDrag,YAHOO.util.DD,{onMouseUp:function(b){this.mDIVPopup.OnEndDrag();PopUpDrag.superclass.onMouseUp.apply(this,arguments)},onMouseDown:function(b){if(this.maxY<0){this.maxY=0}this.mDIVPopup.OnStartDrag();PopUpDrag.superclass.onMouseDown.apply(this,arguments)},init:function(){PopUpDrag.superclass.init.apply(this,arguments);this.setConstraints()}});YAHOO.util.Event.on(window,"resize",function(b){if(ddGlobal){ddGlobal.setConstraints()}},this,false);PopUpDrag.prototype.setConstraints=function(){var d=YAHOO.util.Dom.getRegion(document.body);var g=this.getEl();var u=YAHOO.util.Dom.getXY(g);var f=parseInt(g.style.width,10);var s=parseInt(g.style.height,10);if(f==1){f=this.mDIVPopup.mW}if(s==1){s=this.mDIVPopup.mH}var h=u[0]-d.left;var o=d.right-u[0]-f;var k=u[1]-d.top;var b=YAHOO.util.Dom.getDocumentHeight()-u[1]-s;this.setXConstraint(h,o);this.setYConstraint(k,b)};DialogPopup.prototype=new DIVPopup();DialogPopup.prototype.constructor=DialogPopup;DialogPopup.superclass=DIVPopup.prototype;function DialogPopup(b,d){if(arguments.length){this.init(b,d)}}DialogPopup.prototype.init=function(b,d){DialogPopup.superclass.init.call(this,b,true,false,true,(d?true:false),d);if(!d){this.PopupStyle="DIVPopupNoBorder"}};DialogPopup.prototype.PopupBodyStyle="DIVPopupBodyNoBorder";DialogPopup.prototype.SetContents=function(d,h,b){var g=[];g.push("<iframe id=");g.push(d);g.push(" style='width:100%; height:100%' src='");g.push(b);g.push("' frameBorder=0");if(!this.mTitleBar){g.push(" allowTransparency=true")}g.push("></iframe>");var f=window.frames.length;DialogPopup.superclass.SetContents.call(this,h,g.join(""));this.mIFrame=window.frames[f];this.mIFrame.window.name=d};DialogPopup.prototype.OnCancel=function(){if("CloseFormDialog" in this.mIFrame){this.mIFrame.window.CloseFormDialog()}else{this.mIFrame.window.weCloseDialogue(this.mIFrame.window.getTopWinWindowID_NS(),{v:-1})}};function CloseFormDialog(){setTimeout(function(){var b=[];b.push({f:ARACTCloseWindow,t:this,a:[getTopWinWindowID_NS(),0]});new WorkflowContext(getTopWinWindowID_NS(),b)},0)}function ARDate(h,k,g,f,b,d){if(arguments.length){this.init(h,k,g,f,b,d)}}ARDate.prototype.year=-1;ARDate.prototype.month=-1;ARDate.prototype.date=-1;ARDate.prototype.hour=0;ARDate.prototype.minute=0;ARDate.prototype.second=0;ARDate.prototype.day=-1;ARDate.prototype.ampm=-1;ARDate.prototype.era=1;ARDate.prototype.jera=-1;ARDate.prototype.init=function(h,k,g,f,b,d){this.year=h;this.month=k;this.date=g;this.hour=f;this.minute=b;this.second=d};ARDate.prototype.GYear=function(){return this.year};ARDate.prototype.GMonth=function(){return this.month};ARDate.MonthLabel=function(b){return localeInfo.monthsLong[b]};ARDate.DayShort=function(b){return localeInfo.daysShort[b]};ARDate.prototype.DayLong=function(){return localeInfo.daysLong[this.GDay()]};ARDate.prototype.GDate=function(){return this.date};ARDate.prototype.GHour=function(){return this.hour};ARDate.prototype.GMinute=function(){return this.minute};ARDate.prototype.GSecond=function(){return this.second};ARDate.prototype.GTimeOfDay=function(){return(this.GHour()*3600)+(this.GMinute()*60)+this.GSecond()};ARDate.prototype.GDay=function(){if(this.day==-1){var d=new ARDate(1995,0,1,0,0,0,0);var b=d.GDays()-this.GDays();if(b>=0){this.day=(7-(b%7))%7}else{this.day=(-b)%7}}return this.day};ARDate.prototype.GAMPM=function(){return this.ampm};ARDate.prototype.GEra=function(){return this.era};ARDate.prototype.SYear=function(b){this.year=b};ARDate.prototype.SMonth=function(b){this.month=b};ARDate.prototype.SDate=function(b){this.date=b};ARDate.prototype.SHour=function(b){this.hour=b};ARDate.prototype.SMinute=function(b){this.minute=b};ARDate.prototype.SSecond=function(b){this.second=b};ARDate.prototype.SDay=function(b){this.day=b};ARDate.prototype.SAMPM=function(b){this.ampm=b};ARDate.prototype.SEra=function(b){this.era=b};ARDate.prototype.GDays=function(){var d=0;var f=parseInt((13-this.month)/12);var g=this.year+4800-f;var b=this.month+12*f-2;if((this.year<1582)||(this.year==1582&&this.month<9)||(this.year==1582&&this.month==9&&this.date<=4)){d=this.date+parseInt((153*b+2)/5)+g*365+parseInt(g/4)-32083}else{d=this.date+parseInt((153*b+2)/5)+g*365+parseInt(g/4)-parseInt(g/100)+parseInt(g/400)-32045}return d};ARDate.prototype.SDays=function(h){var k=0,g=0,u=0,s=0,o=0,f=0;if(h<2299161){u=h+32082}else{k=h+32044;g=parseInt((4*k+3)/146097);u=k-parseInt((g*146097)/4)}s=parseInt((4*u+3)/1461);o=u-parseInt((1461*s)/4);f=parseInt((5*o+2)/153);this.year=g*100+s-4800+parseInt(f/10);this.month=f+2-12*parseInt(f/10);this.date=o-parseInt((153*f+2)/5)+1;if(this.year<=0){this.era=0}};ARDate.prototype.GWeekNumber=function(){var f=0,d=0,h=0;var g=this.GDays();f=(g+31741-(g%7))%146097%36524%1461;d=Math.floor(f/1460);h=((f-d)%365)+d;h=Math.floor(h/7)+1;return h};ARDate.prototype.GTimestamp=function(){if(this.GEra()==0){return -1}var d=new Date(this.year,this.month,this.date,this.hour,this.minute,this.second,0);if(prefTimeZone==false){return(d.getTime()/1000)}var g=d.getTimezoneOffset()*60000;var f=timezoneInfo.offset;var h=d.valueOf();var b=h-g-f;var k=this.inDST(b/1000);if(k==-1){return -1}else{if(k==0){b-=timezoneInfo.dst}}b+=(ARDate.getTimeinMS(this.hour,this.minute,this.second)-ARDate.getTimeinMS(d.getHours(),d.getMinutes(),d.getSeconds()));return b/1000};ARDate.prototype.STimestamp=function(d){var b=new Date(d*1000);this.init(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds());if(prefTimeZone==true){this.adjustTime(b)}};ARDate.prototype.adjustTime=function(w){var b=w.getTime();var d=w.getTimezoneOffset()*60000;var g=timezoneInfo.offset;var u=d+g;if(this.inDST(b/1000)!=1){u+=timezoneInfo.dst}if(u==0){return}var v=u%60000;var f=((u-v)%3600000)/60000;if(u<0){var k=Math.ceil(u/3600000)}else{var k=Math.floor(u/3600000)}var o=ARDate.getDaysInMonth(this.month,this.year);this.second+=v;this.minute+=f;this.hour+=k;if(u>0){if(this.second>59){this.second-=60;this.minute++}if(this.minute>59){this.minute-=60;this.hour++}if(this.hour>23){this.hour-=24;this.date++;this.day++;if(this.day>6){this.day-=7}}if(this.date>o){this.date-=o;this.month++}if(this.month>11){this.month-=12;this.year++}}else{if(this.second<0){this.second+=60;this.minute--}if(this.minute<0){this.minute+=60;this.hour--}if(this.hour<0){this.hour+=24;this.date--;this.day--;if(this.day<0){this.day+=7}}if(this.date<=0){this.month--;o=ARDate.getDaysInMonth(this.month,this.year);this.date+=o}if(this.month<0){this.month+=12;this.year--}}};ARDate.prototype.inDST=function(g){if(typeof timezoneInfo.Transitions=="undefined"){return 1}var k=g;var h=timezoneInfo.Transitions;if(k<=h[h.length-1]){var f;for(f=h.length-1;f>=0;f--){if(k>=h[f]){break}}var d=new Date(h[f]*1000);var b=new Date(h[f+1]*1000);if(timezoneInfo.hemisphere==0){return(b.getMonth()>d.getMonth()?0:1)}else{return(b.getMonth()<d.getMonth()?0:1)}}else{return(timezoneInfo.hemisphere==0?1:0)}return 1};ARDate.prototype.validateDate=function(d,f){if(this.year==-1||this.month==-1||this.date==-1){return false}var b=ARDate.getDaysInMonth(this.month,this.year);if(this.date>b){return false}if(this.hour<12&&this.ampm==1){this.hour+=12}else{if(this.hour==12&&this.ampm==0){this.hour=0}}if(d!=13){this.adjustYear()}else{this.adjustYearForDateField(f)}return true};ARDate.prototype.adjustYear=function(){if(this.jera!=-1&&localeInfo.name=="ja_JP"){if(this.jera==0){this.year+=1925}else{if(this.jera==1){this.year+=1988}}}else{if(this.year>=70&&this.year<=138){this.year+=1900}else{if(this.year<=38){this.year+=2000}}}};ARDate.prototype.adjustYearForDateField=function(b){if(this.jera!=-1&&localeInfo.name=="ja_JP"){if(this.jera==0){this.year+=1925}else{if(this.jera==1){this.year+=1988}}}if(this.era==0){this.year-=((2*this.year)-1)}else{if(b<=2&&this.year>=0&&this.year<=33){this.year+=2000}else{if(b<=2&&this.year>33&&this.year<100){this.year+=1900}}}};ARDate.prototype.populate=function(k,s,o){var g=k.length;var f=0;var u=1;for(var h=0;h<g;h++){var d=k.charAt(h);if(!this.validateValue(d,s[u++])){return false}if(d=="y"){f=s[u-1].length;if(o==13||o==7){var b=this.validateValue("G",s[u]);if(!b&&o==13){return false}}u++}}return this.validateDate(o,f)};ARDate.prototype.validateValue=function(g,h){h=h.toLowerCase();switch(g){case"y":var k=parseInt(parseFloat(h));if(isNaN(k)){return false}this.SYear(k);return true;case"M":if(h in localeInfo.monthsShortMap){this.SMonth(localeInfo.monthsShortMap[h]);return true}if(h in localeInfo.monthsLongMap){this.SMonth(localeInfo.monthsLongMap[h]);return true}return false;case"m":var k=parseInt(parseFloat(h));if(isNaN(k)){return false}k-=1;if(k<0||k>11){return false}this.SMonth(k);return true;case"d":var k=parseInt(parseFloat(h));if(isNaN(k)){return false}if(k<0||k>31){return false}this.SDate(k);return true;case"E":if(h in localeInfo.daysShortMap){this.SDay(localeInfo.daysShortMap[h]);return true}if(h in localeInfo.daysLongMap){this.SDay(localeInfo.daysLongMap[h]);return true}return false;case"a":if(h in localeInfo.AMPMMap){this.SAMPM(localeInfo.AMPMMap[h]);return true}return false;case"z":if(h.length==3||h.indexOf("gmt")==0){return true}return false;case"G":var b=localeInfo.eras.length;h=h.trim(1|2);if(h.length==0){return true}for(var f=0;f<b;f++){if(h==localeInfo.eras[f].toLowerCase()){this.SEra(f);return true}else{var k=h.replace(/\./g,"");var d=localeInfo.eras[f].toLowerCase().replace(/\./g,"");if(k==d){this.SEra(f);return true}else{if(k=="bc"){this.SEra(0);return true}}}}if(localeInfo.name=="ja_JP"){b=localeInfo.jeras.length;for(var f=0;f<b;f++){if(h==localeInfo.jeras[f].toLowerCase()){this.jera=f;return true}}}return false;case"h":var k=parseInt(parseFloat(h));if(isNaN(k)){return false}if(h<0||h>23){return false}this.SHour(k);return true;case"u":var k=parseInt(parseFloat(h));if(isNaN(k)){return false}if(h<0||h>59){return false}this.SMinute(k);return true;case"s":var k=parseInt(parseFloat(h));if(isNaN(k)){return false}if(h<0||h>59){return false}this.SSecond(k);return true}return false};ARDate.prototype.format=function(v,w){var o="adDeEGhHiImMnNsSuUyYzZ";var z=false;var k=v.split("");var s=k.length;var B=new Array(s);var y=0;var d=false;while(k[y]){if(k[y]=="'"){if((y+1)<s&&k[y+1]=="'"){B.push("'");y++}else{d=!d}++y}else{if(!d&&o.indexOf(k[y])>-1){switch(k[y]){case"a":this.GHour()>=12?B.push(localeInfo.AMPM[1]):B.push(localeInfo.AMPM[0]);break;case"d":B.push(this.GDate());break;case"D":B.push(ARDate.zeroPad(this.GDate()));break;case"e":B.push(localeInfo.daysShort[this.GDay()]);break;case"E":B.push(localeInfo.daysLong[this.GDay()]);break;case"G":B.push(localeInfo.eras[this.GEra()]);if(this.jera!=-1){B.push(" "+localeInfo.jeras[this.jera])}break;case"h":var g=this.GHour();if(g==0){B.push(12)}else{g>12?B.push(g-12):B.push(g)}break;case"H":var g=this.GHour();if(g==0){g=12}else{if(g>12){g-=12}}B.push(ARDate.zeroPad(g));break;case"i":B.push(this.GHour());break;case"I":B.push(ARDate.zeroPad(this.GHour()));break;case"m":B.push(localeInfo.monthsShort[this.GMonth()]);break;case"M":B.push(localeInfo.monthsLong[this.GMonth()]);break;case"n":B.push(this.GMonth()+1);break;case"N":B.push(ARDate.zeroPad(this.GMonth()+1));break;case"s":B.push(this.GSecond());break;case"S":B.push(ARDate.zeroPad(this.GSecond()));break;case"u":B.push(this.GMinute());break;case"U":B.push(ARDate.zeroPad(this.GMinute()));break;case"y":z=true;var A=this.GYear();var f="";if(w!=13){f=(A+"").substr(2)}else{if(A<=0){f=ARDate.zeroPadYear(A*(-1)+1)}else{f=ARDate.zeroPadYear(A)}}B.push(f);break;case"Y":z=true;var A=this.GYear();var f=A+"";if(w==13){if(A<=0){f=ARDate.zeroPadYear(A*(-1)+1)}else{f=ARDate.zeroPadYear(A)}}B.push(f);break;case"z":if(this.inDST()==0){B.push(tzNames[1])}else{B.push(tzNames[0])}break;case"Z":break}y++}else{B.push(k[y++])}}}var u=new RegExp("^zh|^ja|^ko").exec(localeInfo.name);var b=B.join("");if(z&&this.GYear()<0&&v.indexOf("G")<0){b=(u)?localeInfo.eras[0]+" "+b:b+" "+localeInfo.eras[0]}return b};ARDate.daysCount=function(d,b){return(b>=d)?b-d:(7-d+b)};ARDate.isLeapYear=function(b){return(((b%4==0)&&(b%100!=0))||(b%400==0))};ARDate.getTimeinMS=function(d,f,b){return(d*3600000)+(f*60000)+(b*1000)};ARDate.zeroPad=function(b){return(b<10)?"0"+b:b};ARDate.zeroPadYear=function(d){var b="";var f=4-(d+"").length;while(f>0){b+="0";f--}return b+d};ARDate.getDaysInMonth=function(d,b){if(d<0){d=11}if(d==1&&ARDate.isLeapYear(b)){return ARDate.daysinMonth[d]+1}return ARDate.daysinMonth[d]};ARDate.daysinMonth=[31,28,31,30,31,30,31,31,30,31,30,31];ARDate.parseDateTime=function(h){for(var f in localeInfo.parsePatterns){var g=new RegExp(localeInfo.parsePatterns[f]);var b=g.exec(h);if(b!=null){var d=new ARDate();if(d.populate(localeInfo.normalizedPatterns[f],b,7)){return d}}}return ARDate.parseTime(h)};ARDate.parseDate=function(d){var k=new RegExp("\\s*"+localeInfo.eras[0]+"\\s*");var b=d.replace(k,"");var h=b!=d;d=b;for(var g in localeInfo.parseDatePatterns){var f=new RegExp(localeInfo.parseDatePatterns[g]);var u=f.exec(d);if(u!=null){var o=localeInfo.normalizedDatePatterns[g];var s=new ARDate();if(h){s.SEra(0)}if(s.populate(o,u,13)){return s}}}};ARDate.parseTime=function(d){var k=false;var g=new Date();var g=new ARDate(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0);for(var h in localeInfo.parseTimePatterns){var o=new RegExp(localeInfo.parseTimePatterns[h]);var b=o.exec(d);if(b!=null){var f=localeInfo.normalizedTimePatterns[h];if(g.populate(f,b,14)){return g}else{k=true}}}return null};ARDate.getDateObject=function(f){var d=parseInt(f);if(d<0){d=0}if(d>5373120){d=5373120}var b=new ARDate();b.SDays(d);return b};ARDate.ARCustomDateSetup=function(g,f,d,b){localeInfo.parseDatePatterns.splice(0,0,g);localeInfo.normalizedDatePatterns.splice(0,0,f);localeInfo.parsePatterns.splice(0,0,g);localeInfo.normalizedPatterns.splice(0,0,f);localeInfo.parsePatterns.splice(0,0,d);localeInfo.normalizedPatterns.splice(0,0,b)};ARDate.ARCustomTimeSetup=function(b,d){localeInfo.parseTimePatterns.splice(0,0,b);localeInfo.normalizedTimePatterns.splice(0,0,d)};ARDate.ARSetDateTimeFormat=function(d,b){localeInfo.dateFormatPattern=d;localeInfo.timeFormatPattern=b};SearchBarMenu.prototype=new Menu();SearchBarMenu.prototype.constructor=SearchBarMenu;SearchBarMenu.superclass=Menu.prototype;function SearchBarMenu(b){if(arguments.length){this.init(b)}}SearchBarMenu.prototype.init=function(f){var g=[];this.mName=getLocalizedMessage("Search Bar");if(getForm_NS(f.windowID).SearchBarMenuDef.length>0){g.push({l:getLocalizedMessage("Fields").JScriptEncode(),v:getForm_NS(f.windowID).SearchBarMenuDef})}if(getForm_NS(f.windowID).SearchBarEnumFields.length>0){g.push({l:getLocalizedMessage("Selection Values").JScriptEncode(),v:getForm_NS(f.windowID).SearchBarEnumFields})}var d=[];for(var b in getARKWValues_NS(f.windowID)){d.push({v:"$"+getARKWValues_NS(f.windowID)[b].n+"$",l:getARKWValues_NS(f.windowID)[b].n})}d.sort(function(k,h){return k.l.toLowerCase().localeCompare(h.l.toLowerCase())});g.push({l:getLocalizedMessage("Keywords").JScriptEncode(),v:d});g.push({l:getLocalizedMessage("Currency Codes").JScriptEncode(),v:currencyMenu});SearchBarMenu.superclass.init.call(this,f.windowID,g);this.mField=f};SearchBarMenu.prototype.Open=function(b){return{n:{f:SearchBarMenu.superclass.Open,a:[b,3,30100,false],t:this}}};SearchBarMenu.prototype.HandleSelection=function(b){this.mField.InsertAtCaret(b)};DSearchBar.prototype=new Field();DSearchBar.prototype.constructor=DSearchBar;DSearchBar.superclass=Field.prototype;DSearchBar.prototype.Snapshot=DSearchBar.prototype.Restore=function(){};DSearchBar.prototype.mDOMField=DSearchBar.prototype.mHaveVisualCharacteristics=true;DOMFieldFactories.SearchBar=function(b,f,d){return new DSearchBar(b,f,d)};function DSearchBar(b,f,d){if(arguments.length){this.init(b,f,d)}}DSearchBar.prototype.mID=1005;DSearchBar.prototype.height=100;DSearchBar.buttons=[["(",")",'"'],["+","-","*","/","%"],["=","!=","&lt;","&gt;","&lt=","&gt=","LIKE"],["AND","OR","NOT"]];function CreateAdvancedSearchBar(g){var v=F(g,1005);var y=v.mObj;var d=[];d.push(y.innerHTML);d.push("<table class=SearchBarOperators width=100%><tr height=20>");var w=DSearchBar.buttons;d.push("<td>&nbsp;</td>");var u="<td class=SearchBarButtonCell>";var h="<a href=javascript: style='text-align:center;position:static;width:28px;height:19px;padding-top:1px' class='btn btn3d'";var z=">";var k="</a></td>";var b="<td>&nbsp;</td>";for(var s in w){for(var o in w[s]){d.push(u);d.push(h);d.push(z);d.push(w[s][o]);d.push(k)}d.push(b)}d.push("</tr></table>");d.push("<table class=SearchBarInput width=100%><tr>");d.push("<td width><textarea style='width:99%;height:21px;' class=sr cols='' wrap=off rows=1 ");d.push("id=arid"+1005);d.push("></textarea></td>");d.push("<td width=70>");d.push("<a href=javascript: style='position:static;height:19px;width:70px;text-align:center' class='btn btn3d menu'");d.push(">");d.push(getLocalizedMessage("Fields")+"&nbsp;<img style=border:none alt='' src='"+RelContextPath+"resources/images/menu_down.gif'></a></td></tr></table>");y.innerHTML=d.join("")}DSearchBar.prototype.DOMMouseOver=function(b){return hoverState.eventMouseOver(b)};DSearchBar.prototype.DOMMouseMove=function(b){return hoverState.eventMouseMove(b)};DSearchBar.prototype.DOMMouseOut=function(b){return hoverState.eventMouseOut(b)};DSearchBar.prototype.DOMClick=function(b){hoverState.clearTracking();if(this.GAccess()==3){return}var d=FakeButton_Find(b.element);if(d){if(d.className.indexOf("menu")!=-1){if(!this.mMenu){this.mMenu=new SearchBarMenu(this)}return{n:{f:this.mMenu.Open,a:[d,3],t:this.mMenu}}}else{var f=d.firstChild.data;if(f!='"'&&f!="%"){f=" "+f+" "}this.InsertAtCaret(f)}}};DSearchBar.prototype.DOMKeyPress=function(b){if(b.key==13){b.StopDefault()}};DSearchBar.prototype.GetEditor=function(){return this.mObj.getElementsByTagName("textarea")[0]};DSearchBar.prototype.SVis=function(b){DSearchBar.superclass.SVis.call(this,b);if(getQBPane_NS(this.windowID)){if(getQBPane_NS(this.windowID).GVis()!=b){getQBPane_NS(this.windowID).SVis(b);FormPane.Layout(this.windowID);if(b==true){getForm_NS(this.windowID).LastFormFID=0}}}else{if(b==true){if(this.mObj.style.visibility=="hidden"&&ARPrefsGetAsNumber(23203)>0){this.mObj.style.visibility="inherit"}getForm_NS(this.windowID).LastFormFID=0}}};DSearchBar.prototype.VisClick=function(b){this.mKeepOpen=!this.GVis();this.SVis(!this.GVis())};DSearchBar.prototype.InsertAtCaret=function(d){var b=this.GetEditor();b.focus();DSearchBar.superclass.InsertAtCaret.call(this,b,d);new WorkflowContext(this.windowID,{t:FocusMgr,f:FocusMgr.SetFocusToField,a:[this.windowID,this.mID]})};DSearchBar.prototype.TracksCaret=true;DSearchBar.prototype.Clear=function(){this.GetEditor().value=""};DSearchBar.prototype.DoSet=DSearchBar.prototype.DoSLoadEntry=function(b){this.GetEditor().value=b.toString()};DSearchBar.prototype.G=function(){var b=this.GetEditor().value;b=b.trim(1|2);if(b==""){return Null}return new CharType(this.GetEditor().value)};DSearchBar.prototype.GetFocusElement=function(){return this.GetEditor()};DateKWType.prototype=new TimeType();DateKWType.prototype.constructor=DateKWType;DateKWType.superclass=TimeType.prototype;function DateKWType(){this.init()}DateKWType.prototype.init=function(){var b=new Date().UnixTimestamp();var d=new TimeType(b).toString(2);this.mValue=new TimeType(d).toInteger()};DateKWType.prototype.toString=function(){return TimeType.getDateTimeString(this.mValue,2)};TODKWType.prototype=new TODType();TODKWType.prototype.constructor=TODKWType;TODKWType.superclass=TODType.prototype;function TODKWType(){this.init()}TODKWType.prototype.init=function(){this.mTimestamp=new Date().UnixTimestamp();TODKWType.superclass.init.call(this,new TimeType(this.mTimestamp).toTOD())};TODKWType.prototype.toInteger=function(){return this.mTimestamp};TODKWType.prototype.toDecimal=function(){return new IntegerType(this.toInteger()).toDecimal()};TODKWType.prototype.toReal=function(){return this.mTimestamp};TODKWType.prototype.toDate=function(){return new DateType(new TimeType(this.toInteger()).toDate())};TODKWType.prototype.toTOD=function(){return new TODType(this.mValue)};WeekdayKWType.prototype=new Datatype();WeekdayKWType.prototype.constructor=WeekdayKWType;WeekdayKWType.superclass=Datatype.prototype;function WeekdayKWType(){this.init()}WeekdayKWType.prototype.init=function(){var b=new Date().UnixTimestamp();var d=new TimeType(b).toDate();this.mValue=new TimeType(d).toInteger()};WeekdayKWType.prototype.isNull=false;WeekdayKWType.prototype.toInteger=function(){var b=new ARDate();b.STimestamp(this.mValue);return b.GDay()};WeekdayKWType.prototype.toDecimal=function(){return new IntegerType(this.toInteger()).toDecimal()};WeekdayKWType.prototype.toReal=function(){return this.toInteger()};WeekdayKWType.prototype.toString=function(d){var b=new ARDate();b.STimestamp(this.mValue);return b.DayLong()};WeekdayKWType.prototype.compareValStr=function(){return this.toString()};WeekdayKWType.prototype.toPrimitive=function(){return this.mValue.toString()};WeekdayKWType.prototype.toTOD=function(){return new TimeType(this.mValue).toTOD()};WeekdayKWType.prototype.toTime=function(){return new TimeType(this.mValue)};WeekdayKWType.prototype.toDate=function(){return new DateType(new TimeType(this.mValue).toDate())};WeekdayKWType.prototype.EQ=function(b){return new CharType(this.toString()).EQ(b)};WeekdayKWType.prototype.NE=function(b){return new CharType(this.toString()).NE(b)};WeekdayKWType.prototype.LT=function(b){return new CharType(this.toString()).LT(b)};WeekdayKWType.prototype.LE=function(b){return new CharType(this.toString()).LE(b)};WeekdayKWType.prototype.GT=function(b){return new CharType(this.toString()).GT(b)};WeekdayKWType.prototype.GE=function(b){return new CharType(this.toString()).GE(b)};WeekdayKWType.prototype.LIKE=function(b){return new CharType(this.toString()).LIKE(b)};DefaultKWType.prototype=new Datatype();DefaultKWType.prototype.constructor=DefaultKWType;DefaultKWType.superclass=Datatype.prototype;DatatypeFactories[1]=function(b){return new DefaultKWType(b)};function DefaultKWType(b){if(arguments.length&&!(typeof b=="undefined")){this.init(b)}}DefaultKWType.prototype.init=function(b){if(b instanceof Datatype){this.mValue=b.toChar()}else{if(typeof b=="string"){this.mValue=b}else{this.mValue=b}}};DefaultKWType.prototype.type=1;DefaultKWType.prototype.isNull=false;DefaultKWType.prototype.toString=function(){return this.mValue};DefaultKWType.prototype.compareValStr=function(){return this.toString()};DefaultKWType.prototype.toPrimitive=function(){return this.mValue};DAlertList.prototype=new DTable();DAlertList.prototype.constructor=DAlertList;DAlertList.superclass=DTable.prototype;DOMFieldFactories.AlertList=function(b,f,d){return new DAlertList(b,f,d)};function DAlertList(b,f,d){if(arguments.length){this.init(b,f,d)}}DAlertList.prototype.init=function(d,o,k){DAlertList.superclass.init.call(this,d,o,k);if(AlertInfo.servers.length==0){AlertInfo.servers.push(ExpandServerName(d,this.mObj.getAttribute("arserver")));AlertInfo.schemas.push(ExpandSchemaName(d,this.mObj.getAttribute("arschema")))}this.mHasChildFields=true;var h=this.getHoverEvtList();var g=false;var b=null;for(var f=0;f<h.length;f++){idx=f;b=AREventFunction(d,h[f],this.mID);if(b!=null){g=true;break}}if(!g){g=this.hoverEvtonChildren()}this.mHasHoverEvt=g};DAlertList.prototype.InstantiateUI=function(){DAlertList.superclass.InstantiateUI.call(this);if(ARPrefsGetAsNumber(24001)!=0){NodeWrite(this.mFtrRObj,this.mObj.getAttribute("arautorefstr"));var b=this;getFormContext(this.windowID).inlineIntervalHandles.push(setInterval(function(){new WorkflowContext(b.windowID,[{f:b.Refresh,t:b,a:[-1,0,false]}])},ARPrefsGetAsNumber(24001)*60*1000))}};DAlertList.prototype.Refresh=function(startrow,numrows,fromchunk,swc){return this.RefreshTable(startrow,numrows,fromchunk,function(start,maxrows,dataWrapper){var qual=this.mObj.getAttribute("arqual");eval("qual="+qual);if(this.mNotRefreshed&&this.mSortOrder.length==0){var sortorder=this.GetInitialRowSortOrder();if(sortorder!=null){this.RebuildSortOrder(sortorder.col,sortorder.dir)}}var results=[];for(var i=0;i<AlertInfo.servers.length;++i){qual=ExpandQualifier(this.windowID,qual,AlertInfo.schemas[i],AlertInfo.servers[i]);if(ShowWaitCursor()&&(typeof swc=="undefined")){dataWrapper.myidx=i;return{isFromFunctionSplit:1,c:{t:this,f:function(){dataWrapper.req=new NDXRequest();dataWrapper.req.windowID=this.windowID;dataWrapper.req.AsyncBC("GetTableEntryList",this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,AlertInfo.servers[i],AlertInfo.schemas[i],((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),start,maxrows,this.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,qual.fieldexterns,false,[],[]);dataWrapper.req.showRunning();weDisableStuff(this.windowID);return{i:1}}},n:{t:this,f:function(){results[dataWrapper.myidx]=dataWrapper.req.result;result=this.CombineResult(results,dataWrapper.myidx);dataWrapper.req.result=result;return{result:result}}}}}else{res=new NDXGetTableEntryList(this.windowID,ARKWGetStringByIdx(this.windowID,7),ARKWGetStringByIdx(this.windowID,6),ARKWGetStringByIdx(this.windowID,17),this.mID,AlertInfo.servers[i],AlertInfo.schemas[i],((ARKWGetStringByIdx(this.windowID,21)!=null)?ARKWGetStringByIdx(this.windowID,21):""),start,maxrows,this.mSortOrder,qual.qual,qual.fieldids,qual.fieldvals,qual.fieldtypes,qual.fieldexterns,false,[],[],"DisabledSessionExcludedTableAutoRefreshCall");results[i]=res.result}}result=this.CombineResult(results);return{result:result}},swc)};DAlertList.prototype.CombineResult=function(g,h){var k=F(this.windowID,718).mObj.dataidx;if(typeof h!="undefined"){var s={f:g[h].f,r:[],idmap:{}};var b=0;for(var d=0;d<g[h].r.length;++d){var u=g[h].r[d].i+AlertInfo.servers[h];var o={eid:g[h].r[d].i,aid:h,i:u,d:g[h].r[d].d,rc:g[h].r[d].rc};if(o!=null&&o.d[k]!=null&&o.d[k].p=="@"){o.d[k].p=o.d[k].v=AlertInfo.servers[h]}s.r.push(o);s.idmap[u]=b;++b}s.n=b}else{var s={f:g[0].f,r:[],idmap:{}};var b=0;for(var f=0;f<g.length;++f){for(var d=0;d<g[f].r.length;++d){var u=g[f].r[d].i+AlertInfo.servers[f];var o={eid:g[f].r[d].i,aid:f,i:u,d:g[f].r[d].d,rc:g[f].r[d].rc};if(o!=null&&o.d[k]!=null&&o.d[k].p=="@"){o.d[k].p=o.d[k].v=AlertInfo.servers[f]}s.r.push(o);s.idmap[u]=b;++b}}s.n=b}return s};DAlertList.prototype.ARDrillDown=function(k,o){if(!this.mObj.getAttribute("ardrill")){return ExecuteWorkflow(this.windowID,2,this.mID)}var g=this.GetRow();this.SetRow(k.y);var h=F(this.windowID,718).G().toString();var f=F(this.windowID,717).G().toString();var d=F(this.windowID,716).G().toString();this.SetRow(g);if(f==""||d==""){f=DAlertList.findSchemaName(this.windowID,h);if(f==""&&h!=""){var b=h.indexOf(".");if(b!=-1){f=DAlertList.findSchemaName(this.windowID,h.substring(0,b))}}d=this.mResult.r[k.y].eid}return{n:[{f:function(s){return OpenNonModalForm(s.windowID,1,h,f,"",{fvlist:null,wMode:4,wForceClear:1,qual:{qual:"4\\1\\1\\1\\2\\4\\"+d.length+"\\"+d+"\\",fieldids:[],fieldvals:[],fieldtypes:[]}})},a:[this]},{f:ExecuteWorkflow,a:[this.windowID,2,this.mID]}]}};DAlertList.findSchemaName=function(b,f){for(var d=0;d<AlertInfo.servers.length;++d){if(AlertInfo.servers[d]==f){return AlertInfo.schemas[d]}}return""};DAlertList.prototype.GetSelectedAlerts=function(){var d=this.GetSelectedRows();var f=[];for(var b=0;b<AlertInfo.servers.length;++b){f[b]=[]}if(d.length>0){for(var b=0;b<d.length;++b){f[this.mResult.r[d[b]].aid].push(this.mResult.r[d[b]].eid)}}return f};DAlertList.prototype.MarkRead=function(d){var f=this.GetSelectedAlerts();for(var b=0;b<AlertInfo.servers.length;++b){if(f[b].length>0){new NDXMarkAlert(this.windowID,AlertInfo.servers[b],AlertInfo.schemas[b],f[b],d)}}return this.Refresh(-1,0,false)};DAlertList.prototype.DeleteSelected=function(){var d=this.GetSelectedAlerts();for(var b=0;b<AlertInfo.servers.length;++b){if(d[b].length>0){new NDXDeleteEntry(this.windowID,AlertInfo.servers[b],AlertInfo.schemas[b],d[b])}}return this.Refresh(-1,0,false)};DAlertList.prototype.Resort=function(d,b){DTable.superclass.Resort.call(this,d,b);return{n:{t:this,f:this.TriggerEventRefresh}}};DAlertList.prototype.GetInitialRowSortOrder=function(){var b=this.mObj.getAttribute("arsort");if(b!=""){return DAlertList.superclass.GetInitialRowSortOrder.call(this)}else{return null}};DAlertList.prototype.SetRowSortOrder=function(b,d){if(this.mSortOrder.length>=2&&b==this.mSortOrder[0]&&d==this.mSortOrder[1]){return null}if(!this.mResult){return null}if(this.mSortOrder.length==2&&b==this.mSortOrder[0]&&d!=this.mSortOrder[1]){this.RebuildSortOrder(b,d);this.mResult.r.reverse()}else{this.RebuildSortOrder(b,d);var k=["var ls,rs,"];for(var f=0;f<this.mSortOrder.length+2;f+=2){var g=this.mSortOrder[f];if(f>=this.mSortOrder.length||g==-1){k.push("v=l.i.localeCompare(r.i);")}else{var h=this.mSortOrder[f+1];var u=this.mColFields[g].GetSorter();u=u.replace(/([lr])hs/g,function(v,w){return(((w=="l")^(h==1))?"r":"l")+".d["+g+"].p"});k.push("v="+u+";")}if(f==this.mSortOrder.length-2){k.push("return v;")}else{k.push("if(v!=0) return v;")}}k=k.join("");CompileFunction(k,"l,r",{});var u=CompiledFunction;this.mResult.r.sort(u)}var o={};var s=this.mResult.r;for(var f=0;f<s.length;++f){o[s[f].i]=f}this.mResult.idmap=o};function ARProcessEvent(f,g,b,d){this.mEventType=f;this.mEventData=g;this.mSrcWinID=b;this.ignore=d;if(typeof(d)=="undefined"){keyRefCnt++}}ARProcessEvent.Add=function(b,f,h,g,d){window.self.getARProcessEventMIncomingQ_NS(b).push(new ARProcessEvent(f,h,g,d))};ARProcessEvent.InitKeywordsEtc=function(b){var d=getWindowName_NS(b);ARKWSet(b,34,d);ARKWSet(b,35,d);if(AREventFunction(b,1048576)){getFormContext(b).inlineIntervalHandles.push(setInterval(function(){var f=getARProcessEventMIncomingQ_NS(b);for(var k in f){if(getIsInInterruptMode_NS(b)){break}if(getCurWFC_NS(b)!=null){break}var g=f[k].mSrcWinID;var h=f[k].mEventType;var o=f[k].mEventData;var s=f[k].ignore;f.splice(k,1);ARKWSet(b,33,g);ARKWSet(b,32,h);ARKWSet(b,42,o);LogEventEvent(b,h,o);new WorkflowContext(b,{f:ExecuteWorkflow,a:[b,1048576]});if(typeof(s)=="undefined"){keyRefCnt--}}},200))}};ARProcessEvent.MFieldIDRE=/^F([0-9]+)$/;ARProcessEvent.DeliverEvent=function(d,D,v,h){var s=new Array();var g=new Array();var z;var o=getWindowName_NS(d);if(D=="@"){var u=getParentWindowID_NS(d);if(u!=null){ARProcessEvent.Add(u,v,h,o)}else{g.push({wobj:weGetOpener(),list:[weGetDialogueParentID()]})}}else{if(D=="#"){s=weGetChildWindows(d);g.push({wobj:window,list:getLogicalChildWindowIDs(d)})}else{if(D=="*"){s=weGetAllWindows(d);for(var B=0;B<s.length;B++){var w=s[B];if(w!=null&&!w.closed&&"genAllLogicalChildWindowIDsInList" in w){var G=[];w.genAllLogicalChildWindowIDsInList(w.getTopWinWindowID_NS(),G);g.push({wobj:w,list:G})}}}else{if((z=D.match(ARProcessEvent.MFieldIDRE))!=null){var b=z[1];var y=getFields_NS(d);if(b in y){if("HandleEvent" in y[b]){y[b].HandleEvent(v,h)}}}else{s.push(weGetWindowByName(d,D))}}}}for(var E=0;E<s.length;E++){var f=s[E];if(f!=null&&f&&!f.closed&&"ARProcessEvent" in f){f.ARProcessEvent.Add(f.getTopWinWindowID_NS(),v,h,o)}}for(var C=0;C<g.length;C++){if(g[C]!=null){if(g[C].list!=null&&g[C].list.length>0){for(var A in g[C].list){var f=g[C].wobj;if(f!=null&&f&&!f.closed&&"ARProcessEvent" in f){f.ARProcessEvent.Add(g[C].list[A],v,h,o)}}}}}};SearchesMenu.prototype=new Menu();SearchesMenu.prototype.constructor=SearchesMenu;SearchesMenu.superclass=Menu.prototype;function SearchesMenu(b){if(arguments.length){this.init(b)}}SearchesMenu.prototype.init=function(b){var d=[];this.mName=getLocalizedMessage("Searches");SearchesMenu.superclass.init.call(this,b,d)};SearchesMenu.prototype.Open=function(s,A){var o=[];var u=[];var v=[];var z=[];var d=[];var k=[];this.mMenuDef=[];for(var g=0;g<getForm_NS(this.windowID).DefinedSearch.length;g++){o.push({l:getForm_NS(this.windowID).DefinedSearch[g].l.HTMLEncode(),v:"SavedSearches.LoadSearch("+this.windowID+",getForm_NS('"+this.windowID+"').DefinedSearch["+g+"].v, true)"});z.push({l:getForm_NS(this.windowID).DefinedSearch[g].l.HTMLEncode(),v:"SavedSearches.LoadSearch("+this.windowID+",getForm_NS('"+this.windowID+"').DefinedSearch["+g+"].v, false)"})}var b;var y=getuserSearches_NS(this.windowID);for(b in y.Saved){if(search=y.Saved[b].disable==0){var f="SavedSearches.LoadSearch("+this.windowID+",getuserSearches_NS('"+this.windowID+"').Saved['"+b.EscapeQuote().EscapeBackSlashQuote()+"']";f=f.HTMLEncode();u.push({l:b.HTMLEncode(),v:f+", true)"});d.push({l:b.HTMLEncode(),v:f+", false)"})}}for(var h in y.Recent){var w=y.Recent[h].l.HTMLEncode();v.push({l:w,v:"SavedSearches.LoadSearch("+this.windowID+",getuserSearches_NS('"+this.windowID+"').Recent["+h+"].v, true)"});k.push({l:w,v:"SavedSearches.LoadSearch("+this.windowID+",getuserSearches_NS('"+this.windowID+"').Recent["+h+"].v, false)"})}this.mMenuDef.push({l:getLocalizedMessage("Run Defined").JScriptEncode(),v:(o.length==0?"":o),s:(o.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Run My Searches").JScriptEncode(),v:(u.length==0?"":u),s:(u.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Run Recent").JScriptEncode(),v:(v.length==0?"":v),s:(v.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Load Defined").JScriptEncode(),v:(z.length==0?"":z),s:(z.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Load My Searches").JScriptEncode(),v:(d.length==0?"":d),s:(d.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Load Recent").JScriptEncode(),v:(k.length==0?"":k),s:(k.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Save Search ...").JScriptEncode(),v:"SaveSearch",s:(y.lastSearch==null?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Manage My Searches ...").JScriptEncode(),v:"ManageSearch",s:1});return{n:{f:SearchesMenu.superclass.Open,t:this,a:[s,A,30100,false]}}};SearchesMenu.prototype.HandleSelection=function(val){if(val=="SaveSearch"){if(getCurWFC_NS(this.windowID)!=null){return{n:{f:this.OpenSaveSearchPopup,t:this}}}else{new WorkflowContext(this.windowID,{f:this.OpenSaveSearchPopup,t:this})}}else{if(val=="ManageSearch"){if(getCurWFC_NS(this.windowID)!=null){return{n:{f:this.OpenManageSearchPopup,t:this}}}else{new WorkflowContext(this.windowID,{f:this.OpenManageSearchPopup,t:this})}}else{if(getCurWFC_NS(this.windowID)!=null){return{n:{f:function(){return eval(val)},a:[val]}}}else{eval(val)}}}};SearchesMenu.prototype.OpenSaveSearchPopup=function(){var g=[];for(var d in getuserSearches_NS(this.windowID).Saved){g.push(d.HTMLEncode())}var f={};var b=this.windowID;return{n:{f:function(){if("v" in f.result){var h=f.result.v;if(h!=null&&h.length>0){return{n:{f:function(){var o=((h in getuserSearches_NS(b).Saved)?false:true);var k=new NDXSaveSearch(b,h.toString(),ARKWGetStringByIdx(b,7),ARKWGetStringByIdx(b,6),getuserSearches_NS(b).lastSearch.ids,getuserSearches_NS(b).lastSearch.vals,o,false,0,1);if(k.GetResult()){getuserSearches_NS(b).Saved[k.cname]={ids:getuserSearches_NS(b).lastSearch.ids,vals:getuserSearches_NS(b).lastSearch.vals,disable:0};getuserSearches_NS(b).lastSearch=null}}},c:{f:function(){if(getuserSearches_NS(b).lastSearch==null){return{c:{t:getStateMgr_NS(b),f:getStateMgr_NS(b).QueryEntry,a:[100,false]}}}}}}}}},a:[f]},c:{f:function(){return SaveSearchPopup(b,f,g)}}}};SearchesMenu.prototype.OpenManageSearchPopup=function(){var f={};var g={};g.h=[getLocalizedMessage("Search Name"),getLocalizedMessage("State")];g.r=[];var d;for(d in getuserSearches_NS(this.windowID).Saved){g.r.push({i:d,d:[{v:d},{v:(getuserSearches_NS(this.windowID).Saved[d].disable==1?getLocalizedMessage("Disable"):getLocalizedMessage("Enable"))}]})}var b=this.windowID;return{n:{f:function(){if("v" in f.result&&f.result.v!=-1){var h=[];var o={};var k;for(k in getuserSearches_NS(b).Saved){if(!(k in f.result.v)){h.push(k)}else{if(getuserSearches_NS(b).Saved[k].disable!=f.result.v[k]){o[k]=f.result.v[k]}}}if(h.length>0){var u=new NDXDeleteSearch(b,ARKWGetStringByIdx(b,7),ARKWGetStringByIdx(b,6),h);if(u.GetResult()){for(var s=0;s<h.length;s++){delete getuserSearches_NS(b).Saved[h[s]]}}}for(k in o){var u=new NDXSaveSearch(b,k.toString(),ARKWGetStringByIdx(b,7),ARKWGetStringByIdx(b,6),[],[],false,true,o[k],1);if(u.GetResult()){getuserSearches_NS(b).Saved[k].disable=o[k]}}}},a:[f]},c:{f:function(){return ManageSearchPopup(b,f,g)}}}};function SavedSearches(b){this.RecentSize=b}SavedSearches.prototype.lastSearch=null;SavedSearches.prototype.Saved=null;SavedSearches.prototype.Recent=[];SavedSearches.prototype.RecentSize;SavedSearches.PSP=/\${1}[^\$]+\${1}/g;SavedSearches.QBEPSP=/^\${1}[^\$]+\${1}$/g;SavedSearches.prototype.SaveRecent=function(d,w,o,y){this.lastSearch={};this.lastSearch.label="";this.lastSearch.ids=[];this.lastSearch.vals=[];var z=[];var b;var k=true;for(b in w){if(b in getForm_NS(d).displayOnlyFields){continue}var u=F(d,b);this.lastSearch.ids.push(parseInt(b));var B=u.GetScreenValue();this.lastSearch.vals.push(B);if(u instanceof DataField){if(!k){z.push(",")}k=false;var g=u.GLabel();if(g==""){g=u.GName()}z.push(g);z.push("=");z.push(B)}}for(b in o){if(b.isNumeric()){this.lastSearch.ids.push(parseInt(b));this.lastSearch.vals.push("$"+o[b]+"$")}}if(y.length>0){y=F(d,1005).G().toString();this.lastSearch.ids.push(1005);this.lastSearch.vals.push(y);if(!k){z.push(",")}z.push(y)}if(o==null){z=z.join("");var s=z.length;if(s==0){z=getLocalizedMessage("<No Search Criteria>")}else{if(s>65){z=z.substr(0,65)}}this.lastSearch.label=z;var A=false;for(var h=0;h<this.Recent.length;h++){if(this.Recent[h].l==z){if(this.Recent[h].v.ids.length==this.lastSearch.ids.length&&this.Recent[h].v.ids.toString()==this.lastSearch.ids.toString()&&this.Recent[h].v.vals.toString()==this.lastSearch.vals.toString()){A=true;break}}}if(!A){if(this.Recent.length>=this.RecentSize){this.Recent.pop()}this.Recent.splice(0,0,{l:z,v:this.lastSearch});return true}}return false};SavedSearches.LoadSearch=function(b,d,f){if(getCurWFC_NS(b)!=null){return{n:{f:SavedSearches.doSearch,a:[b,d,f]}}}else{new WorkflowContext(b,{f:SavedSearches.doSearch,a:[b,d,f]})}};SavedSearches.doSearch=function(b,d,g){var f={};f.c={f:FormAction_NewSearch,a:[b]};f.n={f:function(){Field_Clear(b,false);for(var h=0;h<d.ids.length;h++){if(d.ids[h] in getFields_NS(b)){var k=getFields_NS(b)[d.ids[h]];if(d.ids[h]==1005){k.SVis(true);k.S(new CharType(d.vals[h]))}else{var o=d.vals[h];if(o.match(SavedSearches.QBEPSP)){k.SetScreenValue(o)}else{var s=null;s=Field.GetQBEOperator(o);if(s!=null){o=o.substring(s.length).trim(1)}o=Datatype_Factory({t:4,v:o,a:{}});k.S(o);if(s!=null){k.SetScreenValue(s+k.GetScreenValAsPrimitive())}}}}}if(g){return FormAction_Query(b)}}};return f};TableSettingsMenu.prototype=new Menu();TableSettingsMenu.prototype.constructor=TableSettingsMenu;TableSettingsMenu.superclass=Menu.prototype;function TableSettingsMenu(b){if(arguments.length){this.init(b)}}TableSettingsMenu.prototype.init=function(b){this.mTableObj=b;this.mName=getLocalizedMessage("Table Settings");TableSettingsMenu.superclass.init.call(this,this.mTableObj.windowID,[])};TableSettingsMenu.prototype.Open=function(d,b){this.mMenuDef=this.BuildDefinition();this.mXAdjust=1;this.mYAdjust=1;return{n:{f:TableSettingsMenu.superclass.Open,t:this,a:[d,b,30100,false]}}};TableSettingsMenu.prototype.BuildDefinition=function(){var d=[];var h=[];var g=[];var k=this.mTableObj.mColDatas;var o=this.mTableObj.mColInfo;for(var f=0;f<k.length;f++){if(!k[f].mVisible){continue}if(this.mTableObj instanceof DPageArray){if(k[f].mWidth==0){d.push({l:o[f].heading.HTMLEncode(),v:"this.showField("+f+")"})}else{h.push({l:o[f].heading.HTMLEncode(),v:"this.hideField("+f+")"})}}else{var b="";if(k[f].mHeader.firstChild){b=k[f].mHeader.firstChild.data.HTMLEncode()}if(k[f].mWidth==0){d.push({l:b,v:"this.showColumn("+f+")"})}else{h.push({l:b,v:"this.hideColumn("+f+")"})}}}Menu_SortLevel(d);Menu_SortLevel(h);if(this.mTableObj instanceof DPageArray){g.push({l:getLocalizedMessage("Add Field").JScriptEncode(),v:(d.length==0?"":d),s:(d.length==0?0:1)});g.push({l:getLocalizedMessage("Remove Field").JScriptEncode(),v:(h.length<=1?"":h),s:(h.length<=1?0:1)})}else{g.push({l:getLocalizedMessage("Add Column").JScriptEncode(),v:(d.length==0?"":d),s:(d.length==0?0:1)});g.push({l:getLocalizedMessage("Remove Column").JScriptEncode(),v:(h.length<=1?"":h),s:(h.length<=1?0:1)})}if(isTableAutoRefreshEnabled){g.push({l:getLocalizedMessage("Set Refresh Interval").JScriptEncode(),v:"this.setInterval()",s:1})}else{g.push({l:getLocalizedMessage("Set Refresh Interval").JScriptEncode(),v:"this.setInterval()",s:0})}g.push({l:getLocalizedMessage("Reset").JScriptEncode(),v:"this.reset()",s:1});g.push({l:getLocalizedMessage("Save").JScriptEncode(),v:"this.save()",s:(gettablePrefs_NS(this.mTableObj.windowID)==null?0:1)});return g};TableSettingsMenu.prototype.HandleSelection=function(val){eval(val)};TableSettingsMenu.prototype.showField=function(b){this.mTableObj.mColDatas[b].mWidth=1;this.mTableObj.ApplyData()};TableSettingsMenu.prototype.hideField=function(b){this.mTableObj.mColDatas[b].mWidth=0;this.mTableObj.ApplyData()};TableSettingsMenu.prototype.showColumn=function(b){var f=this.mTableObj.mColFields[b];if(f&&f.mObj&&"cw" in f.mObj){this.mTableObj.mColDatas[b].mWidth=f.mObj.cw}else{var d=this.mTableObj.GetInitialColumnWidths();this.mTableObj.mColDatas[b].mWidth=(d[b]<0?0:d[b])}if(!this.mTableObj.mHScroll){if(this.mTableObj.mColDatas[b].mOrgWidth>0){this.mTableObj.mColDatas[b].mWidth=this.mTableObj.mColDatas[b].mOrgWidth}this.mTableObj.ScaleSizes()}this.mTableObj.ApplySizes();this.mTableObj.UpdateScrollOffset();var g=this.mTableObj.FishOutTR(0);while(g!=null){g.childNodes[b].firstChild.style.display="";g=g.nextSibling}};TableSettingsMenu.prototype.hideColumn=function(d){if(!this.mTableObj.mHScroll){var b=this.mTableObj.mColDatas[d].mVisible;this.mTableObj.mColDatas[d].mVisible=false;this.mTableObj.ScaleSizes();this.mTableObj.mColDatas[d].mVisible=b}else{var f=this.mTableObj.mColCnt-1;while(f>=0&&(!this.mTableObj.mColDatas[f].mVisible||this.mTableObj.mColDatas[f].mWidth<=0)){--f}if(d==f){var g=d-1;while(g>=0&&(!this.mTableObj.mColDatas[g].mVisible||this.mTableObj.mColDatas[g].mWidth<=0)){g--}this.mTableObj.mColDatas[g].mWidth+=this.mTableObj.mColDatas[d].mWidth}}this.mTableObj.mColDatas[d].mWidth=0;this.mTableObj.ApplySizes();this.mTableObj.UpdateScrollOffset();var h=this.mTableObj.FishOutTR(0);while(h!=null){h.childNodes[d].firstChild.style.display="none";h=h.nextSibling}};TableSettingsMenu.prototype.reset=function(){var b=0;ARRegisterTableRefreshInterval(this.mTableObj.windowID,this.mTableObj,b);this.mTableObj.ResetColData();if(!this.mTableObj.mNotRefreshed){new WorkflowContext(this.mTableObj.windowID,{t:this.mTableObj,f:this.mTableObj.Resort,a:[-2,1]})}this.save()};TableSettingsMenu.prototype.save=function(){var k=[];var u=[];var d=this.mTableObj.mColDatas;var s=this.mTableObj.mColFields;for(var g=0;g<d.length;g++){k.push(s[d[g].mDataCol].mID);u.push(Math.round(d[g].mWidth))}var f=this.mTableObj.mSortOrder;var b="";if(f.length>0){b=(f.length/2)+"|";for(var g=0;g<f.length;g+=2){b+=(f[g+1]<0?"-"+s[f[g]].mID:"+"+s[f[g]].mID)+"|"}}var o=new NDXSaveTableSettings(this.mTableObj.windowID,ARKWGetStringByIdx(this.mTableObj.windowID,7),ARKWGetStringByIdx(this.mTableObj.windowID,6),ARKWGetStringByIdx(this.mTableObj.windowID,17),this.mTableObj.mID,k,u,b,this.mTableObj.mRefreshInterval);var h=gettablePrefs_NS(this.mTableObj.windowID);if(h==null){h={};h.interval=[]}h.interval[this.mTableObj.mID]=this.mTableObj.mRefreshInterval};TableSettingsMenu.prototype.setTableRefreshInterval=function(){var b={};var d=this.mTableObj;return{n:{f:function(){if("v" in b.result){var f=parseInt(b.result.v);if(f!=-1){return{c:{f:ARRegisterTableRefreshInterval,a:[d.windowID,d,f]}}}}},a:[b]},c:{f:function(){var f=d.mRefreshInterval;return TableRefreshPopup(d.windowID,b,f,tableAutoRefreshMinInterval,d.mID)}}}};TableSettingsMenu.prototype.setInterval=function(){new WorkflowContext(this.mTableObj.windowID,{f:this.setTableRefreshInterval,t:this})};TableSettingsMenu.prototype.mTableObj;TableContextMenu.prototype=new TableSettingsMenu();TableContextMenu.prototype.constructor=TableContextMenu;TableContextMenu.superclass=TableSettingsMenu.prototype;function TableContextMenu(b){if(arguments.length){this.init(b)}}TableContextMenu.prototype.mTableObj;TableContextMenu.prototype.init=function(b){TableContextMenu.superclass.init.call(this,b);this.mAnimate=false;this.mCtrlFldId=null};TableContextMenu.prototype.HandleSelection=function(val){if(val.indexOf("new WorkflowContext")!=-1||val.indexOf("this.")!=-1){eval(val)}else{if(this.mCtrlFldId!=null){F(this.windowID,this.mCtrlFldId).S(new CharType(val));var arg="1 "+this.mCtrlFldId;new WorkflowContext(this.windowID,{f:ARProcessActionActiveLink,a:[this.windowID,arg]})}}};TableContextMenu.prototype.BuildCustomContextMenu=function(){var d=this.mTableObj.mID;var b=getARMenus_NS(this.mTableObj.windowID)["artbl"+d];if(typeof b=="undefined"){return}this.BuildSubMenu(b,b[d],this.mMenuDef)};TableContextMenu.prototype.BuildSubMenu=function(w,b,f){for(var o=1;o<b.length;o++){var d=F(this.mTableObj.windowID,b[o]);if(d.mID!=0&&d.GVis()){var s=(d.GAccess()==3?false:true);var u=null;if(d.GMenu()!=null){u=ARMenu_Get(this.mTableObj.windowID,d.GMenu())}if(u!=null&&u.mMenuDef!=null){if(d.mObj.lbl!=""){this.mMenuDef.push({l:d.mObj.lbl.JScriptEncode(),v:u.mMenuDef,s:s,cId:d.mID})}else{var v=u.mMenuDef.length;for(var k=0;k<v;k++){this.mMenuDef.push({l:u.mMenuDef[k].l.JScriptEncode(),v:u.mMenuDef[k].v,s:s,cId:d.mID})}}}else{if(w[d.mID]){var h=[];var g=this.BuildSubMenu(w,w[d.mID],h);f.push({l:d.mObj.lbl.JScriptEncode(),v:g,s:s})}else{f.push({l:d.mObj.lbl.JScriptEncode(),v:"new WorkflowContext ("+d.windowID+", {f:ARProcessActionActiveLink,a:["+d.windowID+",'1 "+d.mID+"']});",s:s})}}}}return f};TableContextMenu.prototype.doEncode=function(){return true};TableContextMenu.prototype.CheckClick=function(){var d=this.mElementStack;this.mCtrlFldId=null;var b=d[d.length-1].mHighlightedElement;if(b!=null&&b.nextSibling!=null){this.mCtrlFldId=b.nextSibling.getAttribute("arbtnid")}TableContextMenu.superclass.CheckClick.call(this)};TableContextMenu.prototype.Open=function(f,b,h){this.mMenuDef=[];var d=1;if(this.mTableObj.mNotRefreshed){d=0}if(this.mTableObj.mBtnRefresh!=null){this.mMenuDef.push({l:this.mTableObj.mBtnRefresh.name.JScriptEncode(),v:"new WorkflowContext ("+this.mTableObj.windowID+", {f:this.mTableObj.Refresh,t:this.mTableObj,a:[-1,0,false]});",s:1})}if(this.mTableObj.mBtnReport!=null){this.mMenuDef.push({l:this.mTableObj.mBtnReport.name.JScriptEncode(),v:"new WorkflowContext ("+this.mTableObj.windowID+", {f:this.mTableObj.Report,t:this.mTableObj});",s:d})}if(this.mTableObj.mBtnSelectAll!=null){this.mMenuDef.push({l:this.mTableObj.mBtnSelectAll.name.JScriptEncode(),v:"new WorkflowContext ("+this.mTableObj.windowID+", {f:this.mTableObj.SelectAll,t:this.mTableObj,a:[true]});",s:d})}if(this.mTableObj.mBtnDeselectAll!=null){this.mMenuDef.push({l:this.mTableObj.mBtnDeselectAll.name.JScriptEncode(),v:"new WorkflowContext ("+this.mTableObj.windowID+", {f:this.mTableObj.SelectAll,t:this.mTableObj,a:[false]});",s:d})}if(this.mTableObj.mBtnPref!=null){var g=this.BuildDefinition();this.mMenuDef.push({l:this.mTableObj.mBtnPref.name.JScriptEncode(),v:g,s:1})}if(this.mTableObj.mID==1020&&this.mTableObj.mBtnDelete!=null){this.mMenuDef.push({l:this.mTableObj.mBtnDelete.name.JScriptEncode(),v:"new WorkflowContext ("+this.mTableObj.windowID+", {f:this.mTableObj.DeleteSelected,t:this.mTableObj});",s:d})}this.BuildCustomContextMenu();this.mXAdjust=h.x;this.mYAdjust=h.y;if(this.mMenuDef.length==0){return}return{n:{f:TableSettingsMenu.superclass.Open,t:this,a:[f,b,30100,false]}}};AttachmentContextMenu.prototype=new Menu();AttachmentContextMenu.prototype.constructor=AttachmentContextMenu;AttachmentContextMenu.superclass=Menu.prototype;function AttachmentContextMenu(b){this.init(b)}AttachmentContextMenu.prototype.mAttachObj;AttachmentContextMenu.prototype.init=function(b){this.mAttachObj=b;AttachmentContextMenu.superclass.init.call(this,b.windowID,[]);this.mAnimate=false};AttachmentContextMenu.prototype.HandleSelection=function(val){eval(val)};AttachmentContextMenu.prototype.Open=function(f,b,g){this.mMenuDef=[];var d=0;if(this.mAttachObj.mPrimaryRowSelection!=null){var h=this.mAttachObj.mRowIdMap[this.mAttachObj.RowNoFromTag(this.mAttachObj.mPrimaryRowSelection)];if(!F(this.mAttachObj.windowID,h).mObj.v.isNull){d=1}}if(this.mAttachObj.mBtnAdd!=null&&this.mAttachObj.mBtnAdd.node.IsVisible()){this.mMenuDef.push({l:this.mAttachObj.mBtnAdd.name.JScriptEncode(),v:"new WorkflowContext (this.mAttachObj.windowID,{f:this.mAttachObj.Add,t:this.mAttachObj,a:[[]]});",s:(this.mAttachObj.mBtnAdd.node.IsDisabled()?0:1)})}if(this.mAttachObj.mBtnDelete!=null&&this.mAttachObj.mBtnDelete.node.IsVisible()){this.mMenuDef.push({l:this.mAttachObj.mBtnDelete.name.JScriptEncode(),v:"new WorkflowContext (this.mAttachObj.windowID,{f:this.mAttachObj.UIDelete,t:this.mAttachObj});",s:d})}if(this.mAttachObj.mBtnDisplay!=null&&this.mAttachObj.mBtnDisplay.node.IsVisible()&&!this.mAttachObj.mBtnDisplay.node.GetAccess()){this.mMenuDef.push({l:this.mAttachObj.mBtnDisplay.name.JScriptEncode(),v:"new WorkflowContext (this.mAttachObj.windowID,{f:this.mAttachObj.UIDisplay,t:this.mAttachObj});",s:d})}else{if(this.mAttachObj.mBtnDisplay!=null&&this.mAttachObj.mBtnDisplay.node.IsVisible()){this.mMenuDef.push({l:this.mAttachObj.mBtnDisplay.name.JScriptEncode(),v:"new WorkflowContext (this.mAttachObj.windowID,{f:this.mAttachObj.UIDisplay,t:this.mAttachObj});",s:0})}}if(this.mAttachObj.mBtnSave!=null){this.mMenuDef.push({l:this.mAttachObj.mBtnSave.name.JScriptEncode(),v:"new WorkflowContext (this.mAttachObj.windowID,{f:this.mAttachObj.UISaveToDisk,t:this.mAttachObj});",s:d})}if(this.mAttachObj.mBtnDeselect!=null&&this.mAttachObj.mBtnDeselect.node.IsVisible()){this.mMenuDef.push({l:this.mAttachObj.mBtnDeselect.name.JScriptEncode(),v:"new WorkflowContext (this.mAttachObj.windowID,{f:this.mAttachObj.UIDeselect,t:this.mAttachObj});",s:1})}this.mXAdjust=g.x;this.mYAdjust=g.y;return{n:{f:AttachmentContextMenu.superclass.Open,t:this,a:[f,b,30100,false]}}};var promptBar=null;function PromptBar(b,d){this.init(b,d)}PromptBar.prototype.init=function(b,d){this.windowID=b;this.mNumDisplayedMessages=0;this.MAX_HEIGHT=d.offsetHeight;this.initialshow=true;this.initialshowsize=2;this.mTableElem=d.firstChild;this.mMsgAlt=new Array(3);this.mMsgAlt[0]=getLocalizedMessage("Prompt Information");this.mMsgAlt[1]=getLocalizedMessage("Prompt Warning");this.mMsgAlt[2]=getLocalizedMessage("Prompt Error");this.mCloseAlt=getLocalizedMessage("Prompt Close");this.mSystemPromptType=getsysMsgPromptType_NS(b);this.mClearOnFirstMessage=null};PromptBar.prototype.getVisibleHeight=function(){return getPromptBarPane_NS(this.windowID).getHeight()};PromptBar.prototype.getWidth=function(){return window.innerWidth};PromptBar.prototype.getPromptDOMObj=function(){return getFormElements_NS(this.windowID)["PromptBar"]};PromptBar.prototype.visibility=function(){return getPromptBarPane_NS(this.windowID).GVis()};PromptBar.prototype.getPromptTable=function(){return this.mTableElem};PromptBar.prototype.getInitialHeight=function(){return this.initialHeight};PromptBar.prototype.getTableHeight=function(){var d=this.mTableElem.parentNode;var b=this.mTableElem.scrollHeight;var g=(document.defaultView.getComputedStyle(d,null).getPropertyValue("padding-top"));if(!isNaN(parseInt(g))){b+=parseInt(g)}var f=(document.defaultView.getComputedStyle(d,null).getPropertyValue("padding-bottom"));if(!isNaN(parseInt(f))){b+=parseInt(f)}return b};PromptBar.prototype.hideNewMessages=function(){var b=this.getPromptDOMObj();if(b.style.overflow=="auto"){b.style.overflow="hidden"}};PromptBar.prototype.newPromptSize=function(){var b=this.getTableHeight();if(b>=this.MAX_HEIGHT){b=this.MAX_HEIGHT}return b};PromptBar.prototype.hide=function(b){if(this.visibility()){this.deleteAllMessages();this.hidePromptbarInternal(b)}};PromptBar.prototype.hidePromptbarInternal=function(d){var b=this.getPromptDOMObj();if(b!=null){var f=0;var g=this.getWidth();if(typeof AnimMgr!="undefined"&&d){AnimMgr.shrinkPromptBar(b,f,g,PromptBar.prototype.hide2Promptbar,promptBar,this.windowID)}else{this.hide2Promptbar()}}};PromptBar.prototype.hide2Promptbar=function(){getPromptBarPane_NS(this.windowID).SVis(false);FormPane.Layout(this.windowID);getPromptBarPane_NS(this.windowID).changeHeight(this.getInitialHeight())};PromptBar.prototype.show=function(){var d=this.newPromptSize();var b=this.getPromptDOMObj();if(this.visibility()){if(d>=promptBar.MAX_HEIGHT){b.style.overflow="auto";b.scrollTop=promptBar.getTableHeight()}else{this.showWithAnimation(false)}}else{this.showWithAnimation(true)}};PromptBar.prototype.showWithAnimation=function(d){var g=this.newPromptSize();getPromptBarPane_NS(this.windowID).changeHeight(g);getPromptBarPane_NS(this.windowID).SVis(true);FormPane.Layout(this.windowID);var b=this.getPromptDOMObj();if(b!=null){var f=g;var h=this.getWidth();if(typeof AnimMgr!="undefined"&&d){AnimMgr.growPromptBar(b,f,h,PromptBar.prototype.show2WithAnimation,promptBar,true,this.windowID)}else{this.show2WithAnimation(false)}}};PromptBar.prototype.show2WithAnimation=function(f){var d=this.newPromptSize();if(f){getPromptBarPane_NS(this.windowID).changeHeight(d);getPromptBarPane_NS(this.windowID).SVis(true);FormPane.Layout(this.windowID)}var b=this.getPromptDOMObj();if(d>=this.MAX_HEIGHT){b.style.overflow="auto";b.scrollTop=this.getTableHeight()}else{b.style.overflow="hidden"}};PromptBar.prototype.getSystemPromptType=function(){return this.mSystemPromptType};PromptBar.prototype.msgContext=function(){var b=0;if((getARStateCurrent_NS(this.windowID)==2)){b=1}else{if(formModalList.PanelDialogVisible()){b=1}}return b};PromptBar.prototype.redirectAtRuntime=function(f){var b=f;if(b==0){if(this.msgContext()==1){b=1}var d=getCurrentWindowID_NS();if(getStateMgr_NS(d).mWindowIsClosed&&getCurrentWindowID_NS()==getTopWinWindowID_NS()){b=1}}return b};PromptBar.prototype.buildMsgforPrompt=function(b,d){return WorkflowContext_StatusToString(b,[d])};PromptBar.prototype.ARTypetoPromptType=function(b){switch(b){case 0:return 0;break;case 1:return 1;break;case 2:return 2;break}};PromptBar.prototype.msgTypeToSysMsgDest=function(b){var d=0;switch(b){case 0:if(this.mSystemPromptType==2){d=1}break;case 1:if(this.mSystemPromptType==2){d=1}break;case 2:if(this.mSystemPromptType==2||this.mSystemPromptType==0){d=1}break}return d};PromptBar.prototype.msgDestination=function(b,f,g){if(f){return g}else{var d=this.ARTypetoPromptType(b);return this.msgTypeToSysMsgDest(d)}};PromptBar.prototype.getIconClass=function(b){switch(b){case 0:return"promptimg promptimginf";break;case 1:return"promptimg promptimgwar";break;case 2:return"promptimg promptimgerr";break}};PromptBar.prototype.createImgCell=function(f,g,b){var d=f.insertCell(g);d.className=this.getIconClass(b);d.title=this.mMsgAlt[b];d.innerHTML="&nbsp;"};PromptBar.prototype.getTextClass=function(b){switch(b){case 0:return"prompttext prompttextinf";break;case 1:return"prompttext prompttextwar";break;case 2:return"prompttext prompttexterr";break}};PromptBar.prototype.createMsgCell=function(f,g,b,d){var h=f.insertCell(g);h.className=this.getTextClass(b);h.innerHTML=d.HTMLEncode()};PromptBar.prototype.createCloseCell=function(d,f,g){var b=d.insertCell(f);if(!g){b.className="promptclosecommon promptclose";b.innerHTML="&nbsp;"}else{b.className="promptclosecommon promptcloseimg";b.innerHTML="&nbsp;";b.title=this.mCloseAlt}};PromptBar.prototype.addRowSep=function(f,g){for(var d=0;d<g;d++){var b=f.insertCell(d);b.className="promptrowspace"}};PromptBar.prototype.sendMsgAutomation=function(b,d){if("external" in top){try{top.external.showPromptMsg(b,d)}catch(f){}}};PromptBar.prototype.addMessage=function(b,d){var g=this.mTableElem.insertRow(-1);if(g!=null){var h=0;this.createImgCell(g,h,b);h++;this.createMsgCell(g,h,b,d);h++;this.createCloseCell(g,h,(this.mNumDisplayedMessages==0));var f=this.mTableElem.insertRow(-1);this.addRowSep(f,h+1);this.mNumDisplayedMessages++;this.sendMsgAutomation(b,d)}return this.mNumDisplayedMessages};PromptBar.prototype.showMessage=function(b,d){if(this.initialshow){getPromptBarPane_NS(this.windowID).changeHeight(this.initialshowsize);getPromptBarPane_NS(this.windowID).SVis(true);FormPane.Layout(this.windowID);getPromptBarPane_NS(this.windowID).SVis(false);this.initialshow=false}if(this.mClearOnFirstMessage){if(this.visibility()){this.hide(false)}this.mClearOnFirstMessage=false}if(this.visibility()){this.hideNewMessages()}this.addMessage(b,d)};PromptBar.prototype.showAllMessages=function(){if(this.mNumDisplayedMessages>0){this.show()}};PromptBar.prototype.deleteTableRow=function(b){this.mTableElem.deleteRow(b)};PromptBar.prototype.deleteAllMessages=function(){var d=this.mTableElem.rows.length-1;for(var b=d;b>0;b=b-2){this.deleteTableRow(b);this.deleteTableRow(b-1);this.mNumDisplayedMessages--}};PromptBar.prototype.setToClear=function(){this.mClearOnFirstMessage=true};PromptBar.prototype.Resize=function(g,d){if(resizeWindow){var b=this.getTableHeight();if(b>d){var f=this.getPromptDOMObj();f.style.overflow="auto"}}};PromptBar.prototype.DOMClick=function(b){if(b.element.className.indexOf("promptcloseimg")!=-1){this.hide(true)}return false};PromptBar.prototype.DOMMouseOver=function(b){if(b.element.className.indexOf("promptcloseimg")!=-1){b.element.className="promptclosecommon promptcloseimgro"}return true};PromptBar.prototype.DOMMouseOut=function(b){if(b.element.className.indexOf("promptcloseimg")!=-1){b.element.className="promptclosecommon promptcloseimg"}return true};function promptAVisible(){return promptBar.visibility()}function promptAGetTable(){return promptBar.getPromptTable()}function SaveSearchPopup(b,g,f){var k=getLocalizedMessage("Save or Redefine Search");var d=getLocalizedMessage("Search Name");var h=getLocalizedMessage("Enter a new name, or select a saved search to redefine");return weOpenModalPopup(b,(AbsContextPath+"resources/html/SaveSearchPopup.html"),"SaveSearch",{title:k,appss:GetAppStyleSheet("../../"),label:d,name:name,menu:f,desc:h,prefs:PREFS,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},g,[400,175])}function ManageSearchPopup(b,d,f){var g=getLocalizedMessage("Manage Search");return weOpenModalPopup(b,(AbsContextPath+"resources/html/ManageSearchPopup.html"),"ManageSearch",{title:g,appss:GetAppStyleSheet("../../"),l:f,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},d,[400,250])}function ParamSearchPopup(d,h,k){var f=getLocalizedMessage("Enter Search Values");var o=getLocalizedMessage("Parameterized Search");var g=0;for(var s in k){g++}var b=(g*25)+150;return weOpenModalPopup(d,(AbsContextPath+"resources/html/ParamSearchPopup.html"),"ParameterizedSearch",{appss:GetAppStyleSheet("../../"),title:o,label:f,fl:k},h,[500,b])}function TableRefreshPopup(d,h,f,k,b){var s=getLocalizedMessage("Table Refresh Interval");var g=getLocalizedMessage("Refresh Interval (minutes)");var o=getLocalizedMessage("Enter the interval at which the table should automatically refresh. Enter 0 to clear the interval.");if(k>0){o=o+getLocalizedMessage("Interval should not be less than minimum value {0} set by Admin.",[k])}return weOpenModalPopup(d,(AbsContextPath+"resources/html/TableRefreshPopup.html"),"TableRefreshInterval",{title:s,appss:GetAppStyleSheet(d,"../../"),label:g,desc:o,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(d,7),schema:ARKWGetStringByIdx(d,6),view:ARKWGetStringByIdx(d,17),interval:f,hasInput:true,fieldID:b},h,[380,175])}function actb(acField){var obj=acField.mInputNode;this.SUGGESTION_SIZE=10;this.showAll=true;this.actb_timeOut=-1;this.actb_lim=10;this.actb_firstText=true;this.actb_mouse=true;this.acField=acField;acField.mInputNode.acField=acField;this.actb_completionListener=null;this.actb_delimiter=new Array();this.actb_startcheck=1;this.actb_hStyle="text-decoration:underline";var actb_delimwords=new Array();var actb_cdelimword=0;var actb_delimchar=new Array();var actb_display=false;var actb_pos=-1;var actb_total=0;var actb_curr=null;var actb_rangeu=0;var actb_ranged=0;var actb_bool=new Array();var actb_pre=0;var actb_toid;var actb_tomake=false;var actb_getpre="";var actb_mouse_on_list=0;var actb_kwcount=0;var actb_caretmove=false;var actb_parent=document.body;this.actb_keywords=new Array();this.actb_lengths=new Array();this.actb_values=new Array();var actb_self=this;actb_curr=obj;if(!this.acField.acdirtyfocus){actb_addEvent(actb_curr,"focus",actb_setup)}function actb_setup(){actb_addEvent(document,"keydown",actb_checkkey);actb_addEvent(actb_curr,"blur",actb_clear);actb_addEvent(document,"keypress",actb_keypress);actb_addEvent(document,"mousedown",actb_mousedown);var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu.getAttribute(menu.cfid,"arautocak")!=0){menu.setAttribute(menu.cfid,"state",0)}}function actb_clear(evt){if(!evt){evt=event}actb_removeEvent(document,"keydown",actb_checkkey);actb_removeEvent(actb_curr,"blur",actb_clear);actb_removeEvent(document,"keypress",actb_keypress);actb_removeEvent(document,"mousedown",actb_mousedown);actb_removedisp()}function actb_mousedown(evt){if(!actb_display){return true}if(evt.srcElement!=actb_curr&&!checkContainerById(evt.srcElement,"AutoCompleteBox")){actb_clear(evt)}return true}function checkContainerById(src,id){var cur=src;while(cur){if(cur.id==id){return true}cur=cur.parentNode}return false}function actb_parse(n){if(actb_self.actb_delimiter.length>0){var t=actb_delimwords[actb_cdelimword].actb_trim().actb_addslashes();var plen=actb_delimwords[actb_cdelimword].actb_trim().length}else{var t=actb_curr.value.actb_addslashes();var plen=actb_curr.value.length}var tobuild="";var tail="";var i;if(actb_self.actb_firstText){var re=new RegExp("^"+t,"i")}else{var re=new RegExp(t,"i")}var gotTag=n.search("<i>");var p=-1;if(gotTag!=-1){var sVal=n.substr(0,(gotTag-1));p=sVal.search(re)}else{p=n.search(re)}if(p<0){p=0;plen=0}for(i=0;i<p;i++){tobuild+=n.substr(i,1)}tobuild+="<font style='"+(actb_self.actb_hStyle)+"'>";for(i=p;i<plen+p;i++){tobuild+=n.substr(i,1)}tobuild+="</font>";var nextChr;for(i=plen+p;i<n.length;i++){nextChr=n.substr(i,1);tobuild+=nextChr}return tobuild}function actb_generate(){var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu==null){handleMenuAbsent(menu_name);return}if(document.getElementById("AutoCompleteBox")){actb_display=false;try{actb_parent.removeChild(document.getElementById("AutoCompleteBox"))}catch(e){}}actb_pos=-1;var a,r,c;a=document.createElement("table");a.cellPadding="2px";a.style.position="absolute";var res=ComputeElementPosition(actb_curr,actb_parent,actb_curr.scrollLeft,actb_curr.scrollTop);a.style.top=eval(res.y+actb_curr.offsetHeight)+"px";a.style.left=res.x+"px";a.style.zIndex=nextZIndex++;a.style.visibility="hidden";a.id="AutoCompleteBox";actb_parent.appendChild(a);if(menu.getAttribute(menu.cfid,"tItems")==0||menu.getAttribute(menu.cfid,"state")<=0){actb_display=false;if(menu.getAttribute(menu.cfid,"state")==0){showACTips(menu,a)}else{if(menu.getAttribute(menu.cfid,"state")!=0&&menu.getAttribute(menu.cfid,"tItems")==0){showEmpty(menu,a);if(menu.getAttribute(menu.cfid,"fText")==""){menu.setAttribute(menu.cfid,"fText",menu.getAttribute(menu.cfid,"acField").mInputNode.value)}}}return}var i;var first=true;var j=1;if(actb_self.actb_mouse){a.onmouseout=actb_table_unfocus;a.onmouseover=actb_table_focus}var len=menu.getAttribute(menu.cfid,"acField").mInputNode.value.length;if(menu.getAttribute(menu.cfid,"state")==1){this.showAll=actb_total==menu.getAttribute(menu.cfid,"tItems")||menu.getAttribute(menu.cfid,"tItems")==0}if((menu.getAttribute(menu.cfid,"state")==2&&!this.showAll)||menu.getAttribute(menu.cfid,"state")==3){this.showAll=true}if(this.showAll){menu.setState(2);if(menu.getAttribute(menu.cfid,"fText")==""){menu.setAttribute(menu.cfid,"fText",menu.getAttribute(menu.cfid,"acField").mInputNode.value)}}else{var titems=menu.getAttribute(menu.cfid,"tItems");menu.setState(1);menu.getAttribute(menu.cfid,"fText","")}var counter=0;var cnt=0;for(i=0;i<actb_self.actb_keywords.length;i++){if(actb_bool[i]){counter++;if(counter>this.SUGGESTION_SIZE){break}if(cnt==0&&!this.showAll&&menu.getAttribute(menu.cfid,"tItems")!=-1){showPartialLabel(a);cnt++}r=a.insertRow(-1);r.className="AutoCompleteNonSelection";r.id="tat_tr"+(j);c=r.insertCell(-1);var keyword=actb_self.actb_keywords[i];if(keyword==""){keyword=actb_self.actb_values[i]}c.innerHTML=actb_parse(keyword);c.id="tat_td"+(j);c.setAttribute("pos",j);c.setAttribute("nowrap","nowrap");if(actb_self.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouseclick;c.onmouseover=actb_table_highlight}j++}if(j-1==actb_self.actb_lim&&j<=actb_total){r=a.insertRow(-1);r.className="AutoCompleteDownArrow";c=r.insertCell(-1);if(actb_self.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouse_down}break}}if(a.innerHTML==""&&menu.getAttribute(menu.cfid,"tItems")!=-1){showEmpty(menu,a);return}actb_rangeu=1;actb_ranged=j-1;actb_display=true;if(res.y+actb_curr.offsetHeight+a.clientHeight>document.documentElement.clientHeight){var highTop=res.y-=a.offsetHeight;a.style.top=highTop+"px"}a.style.visibility="inherit";try{if("external" in top){top.external.ShowAutoComplete()}}catch(e){}if(a.offsetWidth<menu.getAttribute(menu.cfid,"acField").mInputNode.offsetWidth){a.style.width=menu.getAttribute(menu.cfid,"acField").mInputNode.offsetWidth+"px"}menu.setAttribute(menu.cfid,"messageOnly",false)}function showEmpty(menu,a){menu.setAttribute(menu.cfid,"messageOnly",true);var r=a.insertRow(-1);r.className="AutoCompleteNonSelection";var c=r.insertCell(-1);c.innerHTML=getLocalizedMessage("No suggestion was found");c.style.color="blue";actb_rangeu=1;actb_display=true;a.style.visibility="inherit"}function showACTips(menu,a){menu.setAttribute(menu.cfid,"messageOnly",true);var r=a.insertRow(-1);r.className="AutoCompleteNonSelection";var c=r.insertCell(-1);c.innerHTML=getLocalizedMessage("[Please type more to see suggestions]");c.style.color="blue";actb_rangeu=1;actb_display=true;a.style.visibility="inherit"}function showPartialLabel(a){var r=a.insertRow(-1);r.className="AutoCompleteNonSelection";var c=r.insertCell(-1);c.innerHTML=getLocalizedMessage("[Partial result]");c.style.color="blue"}function actb_remake(){var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu==null){handleMenuAbsent(menu_name);return}if(document.getElementById("AutoCompleteBox")!=null){actb_parent.removeChild(document.getElementById("AutoCompleteBox"))}var a,r,c;a=document.createElement("table");a.cellPadding="2px";a.style.position="absolute";var res=ComputeElementPosition(actb_curr,actb_parent,0,0);a.style.top=eval(res.y+actb_curr.offsetHeight)+"px";a.style.left=res.x+"px";a.style.backgroundColor=actb_self.actb_bgColor;a.id="AutoCompleteBox";a.style.zIndex=nextZIndex++;if(actb_kwcount==0||menu.getAttribute(menu.cfid,"state")==0){actb_display=false;if(menu.getAttribute(menu.cfid,"state")==0){showACTips(menu,a)}else{if(menu.getAttribute(menu.cfid,"state")==1&&menu.getAttribute(menu.cfid,"tItems")==0&&actb_self.actb_keywords.length==1){showEmpty(menu,a);if(menu.getAttribute(menu.cfid,"fText")==""){menu.setAttribute(menu.cfid,"fText",menu.getAttribute(menu.cfid,"acField").mInputNode.value)}}}return}if(actb_self.actb_mouse){a.onmouseout=actb_table_unfocus;a.onmouseover=actb_table_focus}actb_parent.appendChild(a);if(menu.getAttribute(menu.cfid,"state")==1){this.showAll=actb_total==menu.getAttribute(menu.cfid,"tItems")||menu.getAttribute(menu.cfid,"tItems")==0}if(menu.getAttribute(menu.cfid,"state")==3){this.showAll=true}if(this.showAll){menu.setState(2);if(menu.getAttribute(menu.cfid,"fText")==""){menu.setAttribute(menu.cfid,"fText",menu.getAttribute(menu.cfid,"acField").mInputNode.value)}}else{showPartialLabel(a);menu.setState(1);menu.getAttribute(menu.cfid,"fText","")}var i;var first=true;var j=1;if(actb_rangeu>1){r=a.insertRow(-1);r.className="AutoCompleteUpArrow";c=r.insertCell(-1);if(actb_self.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouse_up}}for(i=0;i<actb_self.actb_keywords.length;i++){if(actb_bool[i]){if(j>=actb_rangeu&&j<=actb_ranged){r=a.insertRow(-1);r.className="AutoCompleteNonSelection";r.id="tat_tr"+(j);c=r.insertCell(-1);var keyword=actb_self.actb_keywords[i];if(keyword==""){keyword=actb_self.actb_values[i]}c.innerHTML=actb_parse(keyword);c.id="tat_td"+(j);c.setAttribute("pos",j);c.setAttribute("nowrap","nowrap");if(actb_self.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouseclick;c.onmouseover=actb_table_highlight}j++}else{j++}}if(j>actb_ranged){break}}if(j-1<actb_total){r=a.insertRow(-1);r.className="AutoCompleteDownArrow";c=r.insertCell(-1);if(actb_self.actb_mouse){c.style.cursor="pointer";c.onclick=actb_mouse_down}}if(res.y+actb_curr.offsetHeight+a.clientHeight>document.documentElement.clientHeight){var highTop=res.y-=a.offsetHeight;a.style.top=highTop+"px"}}function actb_goup(){if(!actb_display){return}if(actb_pos==1){return}var preSel=document.getElementById("tat_tr"+actb_pos);if(preSel){preSel.className="AutoCompleteNonSelection"}pos_up();if(actb_pos<actb_rangeu){actb_moveup()}document.getElementById("tat_tr"+actb_pos).className="AutoCompleteSelection";if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}}function actb_godown(){if(!actb_display){return}if(actb_pos==actb_total){return}var preSel=document.getElementById("tat_tr"+actb_pos);if(preSel){preSel.className="AutoCompleteNonSelection"}pos_down();if(actb_pos>actb_ranged){actb_movedown()}document.getElementById("tat_tr"+actb_pos).className="AutoCompleteSelection";if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}}function actb_movedown(){actb_rangeu++;actb_ranged++;actb_remake()}function actb_moveup(){actb_rangeu--;actb_ranged--;actb_remake()}function pos_up(){actb_pos--;if(actb_pos<1){actb_pos=1}actb_pos=actb_pos>actb_ranged?actb_ranged:actb_pos}function pos_down(){actb_pos++;if(actb_pos==0){actb_pos=1}actb_pos=actb_pos<actb_rangeu?actb_rangeu:actb_pos}function actb_mouse_down(){var preSel=document.getElementById("tat_tr"+actb_pos);if(preSel){preSel.className="AutoCompleteNonSelection"}var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);menu.setAttribute(menu.cfid,"state",3);actb_movedown();pos_down();document.getElementById("tat_tr"+actb_pos).className="AutoCompleteSelection";actb_curr.focus();actb_mouse_on_list=0;if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}}function actb_mouse_up(evt){if(!evt){evt=event}if(evt.stopPropagation){evt.stopPropagation()}else{evt.cancelBubble=true}document.getElementById("tat_tr"+actb_pos).className="AutoCompleteNonSelection";actb_pos--;var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);menu.setAttribute(menu.cfid,"state",3);actb_moveup();document.getElementById("tat_tr"+actb_pos).className="AutoCompleteSelection";actb_curr.focus();actb_mouse_on_list=0;if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}}function actb_mouseclick(evt){if(!evt){evt=event}if(!actb_display){return}actb_mouse_on_list=0;actb_pos=this.getAttribute("pos");actb_penter()}function actb_table_focus(){actb_mouse_on_list=1}function actb_table_unfocus(){actb_mouse_on_list=0;if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}}function actb_table_highlight(){actb_mouse_on_list=1;var c=document.getElementById("tat_tr"+actb_pos);if(!c){return}c.className="AutoCompleteNonSelection";actb_pos=this.getAttribute("pos");while(actb_pos<actb_rangeu){actb_moveup()}while(actb_pos>actb_ranged){actb_movedown()}document.getElementById("tat_tr"+actb_pos).className="AutoCompleteSelection";if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}}function actb_insertword(a){var str,l;if(actb_self.actb_delimiter.length>0){str="";l=0;for(i=0;i<actb_delimwords.length;i++){if(actb_cdelimword==i){prespace=postspace="";gotbreak=false;for(j=0;j<actb_delimwords[i].length;++j){if(actb_delimwords[i].charAt(j)!=" "){gotbreak=true;break}prespace+=" "}for(j=actb_delimwords[i].length-1;j>=0;--j){if(actb_delimwords[i].charAt(j)!=" "){break}postspace+=" "}str+=prespace;str+=a;l=str.length;if(gotbreak){str+=postspace}}else{str+=actb_delimwords[i]}if(i!=actb_delimwords.length-1){str+=actb_delimchar[i]}}actb_curr.value=str;actb_setCaret(actb_curr,l)}else{actb_curr.value=a;actb_setCaret(actb_curr,actb_curr.value.length)}actb_mouse_on_list=0;actb_removedisp();if(actb_completionListener){actb_completionListener(actb_curr)}}function actb_penter(){if(!actb_display||actb_pos==-1){return}actb_display=false;var word="";var c=0;var len=0;for(var i=0;i<=actb_self.actb_values.length;i++){if(actb_bool[i]){c++}if(c==actb_pos){word=actb_self.actb_values[i];break}}actb_insertword(word);l=actb_getCaretStart(actb_curr);actb_curr.actb_autoCompleted=true}function actb_removedisp(){if(actb_mouse_on_list==0){actb_display=0;if(document.getElementById("AutoCompleteBox")){try{actb_parent.removeChild(document.getElementById("AutoCompleteBox"))}catch(e){}}if(actb_toid){clearTimeout(actb_toid)}}}function actb_keypress(e){if(actb_caretmove){actb_stopEvent(e)}return !actb_caretmove}function actb_checkEnter(evt){if(actb_pos!=0){if(actb_display){actb_penter()}actb_caretmove=1}if((actb_caretmove&&actb_pos>0)){actb_stopEvent(evt)}actb_removedisp()}var chkKeyTimeoutId=-1;function actb_checkkey(evt){if(chkKeyTimeoutId!==-1){clearTimeout(chkKeyTimeoutId)}var a;if(!evt){evt=event}a=evt.keyCode;try{caret_pos_start=actb_getCaretStart(actb_curr)}catch(e){}actb_caretmove=0;var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu==null){handleMenuAbsent(menu_name);return}if(menu.cfid==null){return}switch(a){case 27:actb_clear(evt);actb_curr.actb_autoCompleteEnabled=false;return false;case 38:if(!menu.getAttribute(menu.cfid,"messageOnly")){actb_goup();actb_caretmove=1;return false}break;case 40:if(document.getElementById("AutoCompleteBox")==null){actb_remake();actb_display=true;actb_pos=0}if(!menu.getAttribute(menu.cfid,"messageOnly")){actb_godown();actb_caretmove=1;return false}break;case 9:return true;case 13:if(actb_pos<=0){actb_curr.actb_autoCompleted=false;actb_checkEnter(evt);actb_pos=-1;return true}else{if(document.getElementById("AutoCompleteBox")){actb_curr.actb_autoCompleted=true}setTimeout(function(){actb_curr.actb_autoCompleted=false;actb_checkEnter(evt);actb_pos=-1},1);return true}default:var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu==null){handleMenuAbsent(menu_name);return true}var t=new Date().getTime();menu.checkPause(t);clearTimeout(menu.getAttribute(menu.cfid,"timer"));menu.setAttribute(menu.cfid,"preLen",menu.getAttribute(menu.cfid,"acField").mInputNode.value.length);menu.setAttribute(menu.cfid,"keyCode",a);var timeInterval=500;try{if("external" in top&&typeof top.external.ShowAutoComplete!="undefined"){timeInterval=1}}catch(e){}chkKeyTimeoutId=setTimeout(actb_checkkey_handler,timeInterval);break}}function actb_checkkey_handler(){var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu==null){handleMenuAbsent(menu_name);return}menu.setAttribute(menu.cfid,"direction",menu.getAttribute(menu.cfid,"acField").mInputNode.value.length-menu.getAttribute(menu.cfid,"preLen"));var oldState=menu.getAttribute(menu.cfid,"state");menu.updateState();var newState=menu.getAttribute(menu.cfid,"state");if(menu.getAttribute(menu.cfid,"state")!=1&&!menu.isRecovering()){menu.setAttribute(menu.cfid,"typeState",1);actb_tocomplete(menu.getAttribute(menu.cfid,"keyCode"))}else{if(oldState==1&&newState==1&&menu.getAttribute(menu.cfid,"fText")!=""&&menu.getAttribute(menu.cfid,"acField").mInputNode.value.indexOf(menu.getAttribute(menu.cfid,"fText"))==0){return}if(oldState==2&&newState==1&&menu.getAttribute(menu.cfid,"fText")!=""&&menu.getAttribute(menu.cfid,"acField").mInputNode.value.indexOf(menu.getAttribute(menu.cfid,"fText"))!=0){menu.setAttribute(menu.cfid,"fText","")}menu.setAttribute(menu.cfid,"timer",setTimeout(function(){new WorkflowContext(window.acField.windowID,{f:actb_reloadmenu,a:[menu]})},menu.getAttribute(menu.cfid,"arautoctt")))}}function actb_reloadmenu(menu){if(menu.cfid!=FocusMgr.mCurFocusID){return}menu.setAttribute(menu.cfid,"typeState",1);menu.updateState();menu.reload();actb_tocomplete(menu.getAttribute(menu.cfid,"keyCode"))}function actb_tocomplete(kc){if(kc==38||kc==40||kc==13){return}var word,c;if("actb_autoCompleteEnabled" in actb_curr&&actb_curr.actb_autoCompleteEnabled==false){return}if(acField&&acField.mInputNode&&!acField.mInputNode.hasFocus){return}var i;if(actb_display){word=0;c=0;for(var i=0;i<=actb_self.actb_keywords.length;i++){if(actb_bool[i]){c++}if(c==actb_pos){word=i;break}}actb_pre=word}else{actb_pre=-1}if(actb_curr.value==""){actb_mouse_on_list=0;actb_removedisp();return}if(actb_self.actb_delimiter.length>0){caret_pos_start=actb_getCaretStart(actb_curr);caret_pos_end=actb_getCaretEnd(actb_curr);delim_split="";for(i=0;i<actb_self.actb_delimiter.length;i++){delim_split+=actb_self.actb_delimiter[i]}delim_split=delim_split.actb_addslashes();delim_split_rx=new RegExp("(["+delim_split+"])");c=0;actb_delimwords=new Array();actb_delimwords[0]="";for(i=0,j=actb_curr.value.length;i<actb_curr.value.length;i++,j--){if(actb_curr.value.substr(i,j).search(delim_split_rx)==0){ma=actb_curr.value.substr(i,j).match(delim_split_rx);actb_delimchar[c]=ma[1];c++;actb_delimwords[c]=""}else{actb_delimwords[c]+=actb_curr.value.charAt(i)}}var l=0;actb_cdelimword=-1;for(i=0;i<actb_delimwords.length;i++){if(caret_pos_end>=l&&caret_pos_end<=l+actb_delimwords[i].length){actb_cdelimword=i}l+=actb_delimwords[i].length+1}var ot=actb_delimwords[actb_cdelimword].actb_trim();var t=actb_delimwords[actb_cdelimword].actb_addslashes().actb_trim()}else{var ot=actb_curr.value;var t=actb_curr.value.actb_addslashes()}if(ot.length==0){actb_mouse_on_list=0;actb_removedisp()}if(ot.length<actb_self.actb_startcheck){return this}if(actb_self.actb_firstText){var re=new RegExp("^"+t,"i")}else{var re=new RegExp(t,"i")}actb_total=0;actb_tomake=false;actb_kwcount=0;var menu_name=window.acField.GMenu();var menu=ARMenu.getMenu(window.acField.windowID,menu_name);if(menu==null){handleMenuAbsent(menu_name);return}if(menu.getAttribute(menu.cfid,"tItems")>0||menu.getAttribute(menu.cfid,"state")>1){for(i=0;i<actb_self.actb_keywords.length;i++){actb_bool[i]=false;var match=actb_self.actb_keywords[i];if(match==""){match=actb_self.actb_values[i]}if(actb_self.actb_lengths!=null&&actb_self.actb_lengths.length>0){var length=actb_self.actb_lengths[i];if(length!=-1){match=match.substring(0,length)}}if(re.test(match)){actb_total++;actb_bool[i]=true;actb_kwcount++;if(actb_pre==i){actb_tomake=true}}}}if(actb_toid){clearTimeout(actb_toid)}if(actb_self.actb_timeOut>0){actb_toid=setTimeout(function(){actb_mouse_on_list=0;actb_removedisp()},actb_self.actb_timeOut)}actb_generate()}return this}function actb_addEvent(f,d,b){if(f.attachEvent){f.attachEvent("on"+d,b)}else{f["on"+d]=b}}function actb_removeEvent(f,d,b){if(f.detachEvent){f.detachEvent("on"+d,b)}else{f["on"+d]=null}}function actb_stopEvent(b){b=b?b:window.event;if(b.stopPropagation){b.stopPropagation();b.preventDefault()}else{if(typeof b.cancelBubble!="undefined"){try{b.cancelBubble=true;b.returnValue=false}catch(d){}}}return false}function actb_getCaretEnd(g){if(typeof g.selectionEnd!="undefined"){return g.selectionEnd}else{if(document.selection&&document.selection.createRange){var h=document.selection.createRange();try{var b=h.duplicate();b.moveToElementText(g)}catch(f){var b=g.createTextRange()}b.setEndPoint("EndToEnd",h);var d=b.text.length;if(d>g.value.length){return -1}return d}}}function actb_getCaretStart(g){if(typeof g.selectionStart!="undefined"){return g.selectionStart}else{if(document.selection&&document.selection.createRange){var h=document.selection.createRange();try{var b=h.duplicate();b.moveToElementText(g)}catch(f){var b=g.createTextRange()}try{b.setEndPoint("EndToStart",h)}catch(f){}var d=b.text.length;if(d>g.value.length){return -1}return d}}}function actb_setCaret(d,b){d.focus();d.setSelectionRange(b,b)}function actb_setSelection(f,b,d){f.focus();f.setSelectionRange(b,d)}String.prototype.actb_addslashes=function(){return this.replace(/(["\\\.\|\[\]\^\*\+\?\$\(\)])/g,"\\$1")};String.prototype.actb_trim=function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1")};function actb_isNumber(b){return typeof b=="number"&&isFinite(b)}var globalLogout=false;var licenseTimeout=60;var openWindowCachId="";var closeWindowCachId="";function licenseSessionInit(){licenseSessionOpenWindow();licenseInitialInit=true;tmp=getCookie("lt");if(tmp!=null){licenseTimeout=parseInt(tmp)}var b=getCookie("lr");if(b==null){return}else{signalLicenseReleaseServlet(true)}}function licenseSessionExit(){globalLogout=true;deleteCookie("T","/",null);deleteCookie("w"+window.name,"/",null)}function signalLicenseReleaseServlet(f){var b;b=GET_XML_HTTP();if(f){deleteCookie("lr","/",null);b.open("GET",AbsContextPath+"servlet/LicenseReleaseServlet",true)}else{setCookie("lr",true,null,"/",null);if(AbsContextPath==null){return}b.open("GET",AbsContextPath+"servlet/LicenseReleaseServlet?lr=1",false)}b.setRequestHeader("Content-type","text/plain; charset=UTF-8");try{b.send(null);throw new WorkflowException(0,0,[])}catch(d){}}window.onblur=function(){setTimeout(function(){if(openWindowCachId!==""&&closeWindowCachId!==""&&closeWindowCachId===openWindowCachId){licenseSessionOpenWindow();closeWindowCachId=""}},500)};function licenseSessionOpenWindow(){if(window.name==""){window.name=createARRootWindowName()}var b=0;var d=getCookie("T");var f=getCookie("w"+window.name);if(d!=null){b=parseInt(d)}else{if(f!=null){b=1}}if(f==null){setCookie("w"+window.name,1,null,"/",null);b++}setCookie("T",b,null,"/",null);if(window&&window.location&&window.location.search){openWindowCachId=window.location.search.substring(9,window.location.search.length)}}function licenseSessionCloseWindow(){if(openWindowCachId!=""&&closeWindowCachId!==""&&closeWindowCachId===openWindowCachId){licenseSessionOpenWindow()}loadCookie("T");var k=getCookie("T");var g=parseInt(k);var h=document.cookie.split(";");for(var f=0;f<h.length;f++){var b=h[f].split("=")[0];if(b.indexOf("VF")!=-1){deleteCookie(b,"/",null)}}var d=getCookie("w"+window.name);if(d!=undefined&&d!=""){deleteCookie("w"+window.name,"/",null);g--}if(window&&window.location&&window.location.search){closeWindowCachId=window.location.search.substring(9,window.location.search.length)}if(g>0){setCookie("T",g,null,"/",null);return}if(!globalLogout){deleteCookie("T","/",null);signalLicenseReleaseServlet(false)}}CharEditPopup.prototype=new DIVPopup();CharEditPopup.prototype.constructor=CharEditPopup;CharEditPopup.superclass=DIVPopup.prototype;function CharEditPopup(b){if(arguments.length){this.init(b)}}CharEditPopup.prototype.init=function(f){this.mField=f;CharEditPopup.superclass.init.call(this,f.windowID,false,true,true,true,true);this.mbShowURL=this.mField.mbShowURL;var b=520;var d=500;if(b>=FormContainer.clientWidth){b=FormContainer.clientWidth}if(d>=FormContainer.clientHeight){d=FormContainer.clientHeight}this.SetSize(b,d);if(f.GAccess()==1){this.Buttons=[{t:getLocalizedMessage("Cancel"),id:"ardivpcancel",f:"OnCancel"}]}};CharEditPopup.prototype.SetContents=function(h){if(h==undefined){if(this.mbShowURL){h=this.mField.mDivEditBox.innerHTML}else{h=this.mField.mInputNode.value.HTMLEncode()}}var g=1;var f=[];f.push("<table style='width:100%;height:100%;table-layout:fixed;'>");if(getARStateCurrent_NS(this.windowID)!=1&&getARStateCurrent_NS(this.windowID)!=4&&this.mField instanceof DDiary){var k=this.mField.GetHistory();if(k!=null){this.SetSize(520,540);k=k.HTMLEncode();f.push(CharEditPopup.GetTitleMarkup(getLocalizedMessage("Diary History:")));f.push(CharEditPopup.GetTextareaMarkup("hEditor",g++,true,k,this.mbShowURL,this.mField.mID))}f.push(CharEditPopup.GetTitleMarkup(getLocalizedMessage("Diary Editor:")))}f.push(CharEditPopup.GetTextareaMarkup("editor",g++,this.mField.GAccess()==1,h,this.mbShowURL,this.mField.mID));f.push("</table>");var b=(getARStateCurrent_NS(this.windowID)==4)?getARTitles_NS(this.windowID).pluralLong:getARTitles_NS(this.windowID).singleLong;if(b==""){b=ARKWGetStringByIdx(this.windowID,6)}var d=getLocalizedMessage("{0} -- {1}",[b,this.mField.GLabel()]);CharEditPopup.superclass.SetContents.call(this,d,f.join(""));if(this.mbShowURL){this.oldValue=this.mField.GetValue();if(this.mField.mOrgValue!=this.oldValue){this.mField.SetValue(this.oldValue);this.oldValue=this.mField.innerText();this.mField.mOrgValue=this.oldValue;h=this.mField.mDivEditBox.innerHTML}updateInnerHTML(this.GetEditor(),h);if(getARStateCurrent_NS(this.windowID)!=4&&this.mField instanceof DDiary){var k=this.mField.GetHistory();if(k!=null){convertPlainToFormattedText(k,document.getElementById("hEditor"+this.mField.mID))}}}else{this.oldValue=this.mField.mInputNode.value}};CharEditPopup.GetTextareaMarkup=function(o,f,g,h,k,b){var d=[];d.push("<tr><td>");if(k){d.push("<div class='OverflowAuto' style='overflow:hidden;'>");d.push("<div artb="+f+(g?" readonly":"")+(g?" contenteditable='false'":" contenteditable='true'")+" id='"+o+""+b+"' class='DivEditor "+(g?"readonly'>":"'>"));d.push("</div>")}else{d.push("<div class='OverflowAuto'>");d.push("<textarea artb="+f+(g?" readonly":"")+' rows="5"  id=\''+o+"' class='Editor "+(g?"readonly'>":"'>"));d.push(h);d.push("</textarea>")}d.push("</div>");d.push("</td></tr>");return d.join("")};CharEditPopup.GetTitleMarkup=function(b){return"<tr class='PopupEditorTitle'><td>"+b+"</td></tr>"};CharEditPopup.prototype.KeyDown=function(f){if(f.key==9&&((f.ctrl==true)||(this.__safari__))){if(!checkLength(f,this.mField.windowID,this.GetEditor(),this.mField.mMaxLen)){this.mField.InsertAtCaret(this.GetEditor(),String.fromCharCode(9))}this.__safari__=false;return false}else{if(f.key==9){this.DoTab(f,!f.shift);f.SetKeyCode(505);return false}else{if(f.key==13){if(this.mbShowURL){f.StopDefault();var g=this.GetEditor();var h=g.lastChild.nodeName;if(h.toUpperCase()!="BR"){g.appendChild(document.createElement("br"))}var o=document.createDocumentFragment();var b=document.createElement("br");o.appendChild(b);var k=window.getSelection();var d=k.getRangeAt(0);d.deleteContents();d.insertNode(o);d.collapse(false);d.setStartAfter(b);d.setEndAfter(b);k.removeAllRanges();k.addRange(d);f.element.click();return false}}else{if((f.key==17)||(f.key==18)){this.__safari__=true}else{this.__safari__=false}}}}return true};function checkPasteLength(g,b,f){var d=Window_FromElement(g);if(getARStateCurrent_NS(d)==4){return}if(g.tagName=="DIV"){var h=getInnerText(g);if(b!=0&&h.length>=b){g.innerHTML="";convertPlainToURL(h.substr(0,b),g)}return}if(b!=0&&g.value.length>=b){g.value=g.value.substr(0,b)}}CharEditPopup.prototype.KeyPress=function(b){if(b.key==27){this.HidePopup();return false}if((b.key==13||b.key==32)&&b.element.className.indexOf("btn")!=-1){b.element.click();return false}return checkLength(b,this.mField.windowID,this.GetEditor(),this.mField.mMaxLen)};CharEditPopup.prototype.Click=function(b){if(b.element.tagName=="A"){return true}this.SetFocus(b.element);return false};CharEditPopup.prototype.SetFocus=function(k){if(getCharEditPopups_NS(this.windowID).length<=0){return}var h=false;if((getOpenDIVPopup_NS(this.windowID))||h){var b=getOpenDIVPopup_NS(this.windowID).mDiv.style.zIndex;var d=getCharEditPopups_NS(this.windowID).length;if(d>0){b=parseInt(getCharEditPopups_NS(this.windowID)[d-1].mDiv.style.zIndex);getOpenDIVPopup_NS(this.windowID).mDiv.style.zIndex=b}this.mDiv.style.zIndex=b+1;nextZIndex++;if(k&&k.className&&k.className.indexOf("readonly")<0){var g=this.GetEditor();if(g!=null){g.focus()}}for(var f=0;f<d;f++){if(this==getCharEditPopups_NS(this.windowID)[f]){getCharEditPopups_NS(this.windowID).splice(f,1);d--;f--}}getCharEditPopups_NS(this.windowID).push(this);setOpenDIVPopup_NS(this.windowID,this)}};CharEditPopup.prototype.GetEditor=function(){if(this.mbShowURL){return document.getElementById("editor"+this.mField.mID)}var d=this.mDiv.getElementsByTagName("textarea");for(var b=0;b<d.length;b++){if(d[b].id=="editor"){return d[b]}}return null};CharEditPopup.prototype.ShowCentredPopup=function(d){var g=this.GetPosition();var b=getCharEditPopups_NS(this.windowID).length;g.x+=b*10;g.y+=b*15;getCharEditPopups_NS(this.windowID).push(this);this.ShowPopup(document.body,g.x,g.y,d);if("external" in top){try{top.external.ShowTextEditor()}catch(f){}}};CharEditPopup.prototype.HidePopup=function(b){this.mField.mCharEditBox=null;RemoveClickedPopup(this.windowID,this);CharEditPopup.superclass.HidePopup.call(this,b)};CharEditPopup.prototype.GetOKButton=function(){var d=this.mDiv.getElementsByTagName("button");for(var b=0;b<d.length;b++){if(d[b].id=="ardivpok"){return d[b]}}};CharEditPopup.prototype.ShowPopup=function(g,h,d,b){var u=this.GetOKButton();if(u){u.disabled=true}var s=this.GetEditor();s.onkeydown=function(){if(u){u.disabled=false}};s.onpaste=function(){if(u){u.disabled=false}};var f=this.mDiv.getElementsByTagName("button");var k=getCharEditPopups_NS(this.windowID).length;for(var o=0;o<k;o++){if(this==getCharEditPopups_NS(this.windowID)[o]){getCharEditPopups_NS(this.windowID).splice(o,1);k--;o--}}getCharEditPopups_NS(this.windowID).push(this);CharEditPopup.superclass.ShowPopup.call(this,g,h,d,b)};CharEditPopup.prototype.ShowSingle=function(){return false};CharEditPopup.prototype.OnOK=function(){var d=this.GetEditor();if(d!=null){var b;if(this.mbShowURL){b=this.innerText()}else{b=d.value}if(b!=this.oldValue){if(this.mbShowURL){convertPlainToFormattedText(b,d);this.mField.SetScreenValue(d.innerHTML)}else{this.mField.SetScreenValue(b)}this.mField.SetDirty(this.mField.mInputNode)}}this.HidePopup(true)};CharEditPopup.prototype.OnCancel=function(){this.HidePopup(true)};CharEditPopup.prototype.InitFocus=function(){this.GetEditor().focus()};CharEditPopup.prototype.NewTextAvail=function(){var f=this.GetOKButton();var d=this.GetEditor();if(f&&!f.disabled&&d!=null){var b;if(this.mbShowURL){b=this.innerText()}else{b=d.value}if(b!=this.oldValue){return true}}return false};CharEditPopup.prototype.GetText=function(){var b=this.GetEditor();if(b!=null){if(this.mbShowURL){return this.innerText()}return b.value}return null};CharEditPopup.prototype.SetText=function(b){if(this.mbShowURL){updateInnerHTML(this.GetEditor(),b)}else{this.GetEditor().value=b}};CharEditBoxPopup_UpdateText=function(b,g,f){b.SetText(g);var d=b.GetOKButton();if(d&&f){d.disabled=true}};CharEditBoxPopup_UpdateHistory=function(b,h){if(b.mbShowURL){var g=document.getElementById("hEditor"+b.mField.mID);convertPlainToFormattedText(h,g);return}var f=b.mDiv.getElementsByTagName("textarea");for(var d=0;d<f.length;d++){if(f[d].id=="hEditor"){f[d].value=h;return}}};CharEditBoxPopup_UpdateAccess=function(b){var o=b.mField;var s=o.GAccess();var g=s==3,d=s==1;if(s==1){b.Buttons=[{t:getLocalizedMessage("Cancel"),id:"ardivpcancel",f:"OnCancel"}]}else{b.Buttons=[{t:getLocalizedMessage("OK"),f:"OnOK",id:"ardivpok"},{t:getLocalizedMessage("Cancel"),f:"OnCancel",id:"ardivpcancel"}]}b.SetContents();var k=o.mObj.lastElementChild;if(k==undefined){k=o.mObj.lastChild}var f=k.offsetHeight;if(f==undefined){f=0}if(b.isOldChild!=undefined){b.SetFocus()}else{if(this instanceof TPAChar){b.ShowPopup(k,3,f+3,true)}else{b.ShowPopup(k,0,f,true)}}};CharEditPopup.prototype.innerText=function(){return getInnerText(this.GetEditor())};var rtfLocalized=false;localizeRTFMessages=function(){if(rtfLocalized){return}rtfLocalized=true;YAHOO.widget.Toolbar.prototype.STR_COLLAPSE=getLocalizedMessage("Collapse Toolbar");YAHOO.widget.Toolbar.prototype.STR_SPIN_LABEL=getLocalizedMessage("{VALUE}");YAHOO.widget.Toolbar.prototype.STR_SPIN_UP=getLocalizedMessage("Increase (Ctrl + Shift + Up Arrow)");YAHOO.widget.Toolbar.prototype.STR_SPIN_DOWN=getLocalizedMessage("Decrease (Ctrl + Shift + Down Arrow)");YAHOO.widget.SimpleEditor.prototype.STR_LENGTH=getLocalizedMessage("length");YAHOO.widget.SimpleEditor.prototype.STR_MAX_LENGTH_EXCEEDED=getLocalizedMessage("Maximum Length Exceeded.");YAHOO.widget.SimpleEditor.prototype.STR_LEAVE_EDITOR=getLocalizedMessage("You have left the Rich Text Editor.");YAHOO.widget.SimpleEditor.prototype.STR_BEFORE_EDITOR=getLocalizedMessage("This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Shift + Escape to place focus on the toolbar and navigate between options with your arrow keys. To exit this text editor use the Escape key and continue tabbing. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift L adds an HTML link</li></ul>");YAHOO.widget.SimpleEditor.prototype.STR_TITLE=getLocalizedMessage("Rich Text Area.");YAHOO.widget.SimpleEditor.prototype.STR_IMAGE_HERE=getLocalizedMessage("Image URL Here");YAHOO.widget.SimpleEditor.prototype.STR_IMAGE_URL=getLocalizedMessage("Image URL");YAHOO.widget.SimpleEditor.prototype.STR_LINK_URL=getLocalizedMessage("Link URL");YAHOO.widget.SimpleEditor.prototype.STR_OK=getLocalizedMessage("OK");YAHOO.widget.SimpleEditor.prototype.STR_CANCEL=getLocalizedMessage("Cancel");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_FONT_NAME_AND_SIZE=getLocalizedMessage("Font Name and Size");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_FONT_STYLE=getLocalizedMessage("Font Style");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_FONT_NAME=getLocalizedMessage("Font Name");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_FONT_SIZE=getLocalizedMessage("Font Size");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_LISTS=getLocalizedMessage("Lists");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_INSERT_ITEM=getLocalizedMessage("Insert Item");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_BOLD=getLocalizedMessage("Bold");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_ITALIC=getLocalizedMessage("Italic");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_UNDERLINE=getLocalizedMessage("Underline");YAHOO.widget.SimpleEditor.prototype.STRIKE=getLocalizedMessage("Strike Through");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_FONT_COLOR=getLocalizedMessage("Font Color");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_BACKGROUND_COLOR=getLocalizedMessage("Background Color");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_CREATE_UNORDERED_LIST=getLocalizedMessage("Create an Unordered List");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_CREATE_ORDERED_LIST=getLocalizedMessage("Create an Ordered List");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_HTML_LINK=getLocalizedMessage("HTML Link");YAHOO.widget.SimpleEditor.prototype.STR_LABEL_INSERT_IMAGE=getLocalizedMessage("Insert or Change Image");YAHOO.widget.Editor.prototype.STR_BEFORE_EDITOR=getLocalizedMessage("This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Control + Shift + T to place focus on the toolbar and navigate between option heading names. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift [ aligns text left</li> <li>Control Shift | centers text</li> <li>Control Shift ] aligns text right</li> <li>Control Shift L adds an HTML link</li> <li>To exit this text editor use the keyboard shortcut Control + Shift + ESC.</li></ul>");YAHOO.widget.Editor.prototype.STR_CLOSE_WINDOW=getLocalizedMessage("Close Window");YAHOO.widget.Editor.prototype.STR_CLOSE_WINDOW_NOTE=getLocalizedMessage("To close this window use the Control + Shift + W key");YAHOO.widget.Editor.prototype.STR_IMAGE_PROP_TITLE=getLocalizedMessage("Image Options");YAHOO.widget.Editor.prototype.STR_IMAGE_TITLE=getLocalizedMessage("Description");YAHOO.widget.Editor.prototype.STR_IMAGE_SIZE=getLocalizedMessage("Size");YAHOO.widget.Editor.prototype.STR_IMAGE_ORIG_SIZE=getLocalizedMessage("Original Size");YAHOO.widget.Editor.prototype.STR_IMAGE_COPY=getLocalizedMessage("<span class='tip'><span class='icon icon-info'></span><strong>Note:</strong>To move this image just highlight it, cut, and paste where ever you'd like.</span>");YAHOO.widget.Editor.prototype.STR_IMAGE_PADDING=getLocalizedMessage("Padding");YAHOO.widget.Editor.prototype.STR_IMAGE_BORDER=getLocalizedMessage("Border");YAHOO.widget.Editor.prototype.STR_IMAGE_BORDER_SIZE=getLocalizedMessage("Border Size");YAHOO.widget.Editor.prototype.STR_IMAGE_BORDER_TYPE=getLocalizedMessage("Border Type");YAHOO.widget.Editor.prototype.STR_IMAGE_TEXTFLOW=getLocalizedMessage("Text Flow");YAHOO.widget.Editor.prototype.STR_LOCAL_FILE_WARNING=getLocalizedMessage("<span class='tip'><span class='icon icon-warn'></span><strong>Note:</strong>This image/link points to a file on your computer and will not be accessible to others on the internet.</span>");YAHOO.widget.Editor.prototype.STR_LINK_PROP_TITLE=getLocalizedMessage("Link Options");YAHOO.widget.Editor.prototype.STR_LINK_PROP_REMOVE=getLocalizedMessage("Remove link from text");YAHOO.widget.Editor.prototype.STR_LINK_NEW_WINDOW=getLocalizedMessage("Open in a new window.");YAHOO.widget.Editor.prototype.STR_LINK_TITLE=getLocalizedMessage("Description");YAHOO.widget.Editor.prototype.STR_NONE=getLocalizedMessage("none");YAHOO.widget.Editor.prototype.STR_LABEL_SUBSCRIPT=getLocalizedMessage("Subscript");YAHOO.widget.Editor.prototype.STR_LABEL_SUPERSCRIPT=getLocalizedMessage("Superscript");YAHOO.widget.Editor.prototype.STR_LABEL_REMOVE_FORMATTING=getLocalizedMessage("Remove Formatting");YAHOO.widget.Editor.prototype.STR_LABEL_SHOW_HIDE_HIDDEN_ELEMENTS=getLocalizedMessage("Show/Hide Hidden Elements");YAHOO.widget.Editor.prototype.STR_LABEL_UNDO_REDO=getLocalizedMessage("Undo/Redo");YAHOO.widget.Editor.prototype.STR_LABEL_UNDO=getLocalizedMessage("Undo");YAHOO.widget.Editor.prototype.STR_LABEL_REDO=getLocalizedMessage("Redo");YAHOO.widget.Editor.prototype.STR_LABEL_ALIGNMENT=getLocalizedMessage("Alignment");YAHOO.widget.Editor.prototype.STR_LABEL_ALIGNMENT_LEFT=getLocalizedMessage("Align Left");YAHOO.widget.Editor.prototype.STR_LABEL_ALIGNMENT_CENTER=getLocalizedMessage("Align Center");YAHOO.widget.Editor.prototype.STR_LABEL_ALIGNMENT_RIGHT=getLocalizedMessage("Align Right");YAHOO.widget.Editor.prototype.STR_LABEL_ALIGNMENT_JUSTIFY=getLocalizedMessage("Justify");YAHOO.widget.Editor.prototype.STR_LABEL_PARAGRAPH_STYLE=getLocalizedMessage("Paragraph Style");YAHOO.widget.Editor.prototype.STR_LABEL_INDENT_LIST=getLocalizedMessage("Indenting and Lists");YAHOO.widget.Editor.prototype.STR_LABEL_INDENT=getLocalizedMessage("Indent");YAHOO.widget.Editor.prototype.STR_LABEL_OUTDENT=getLocalizedMessage("Outdent");YAHOO.widget.Editor.prototype.STR_LABEL_LEFT=getLocalizedMessage("Left");YAHOO.widget.Editor.prototype.STR_LABEL_INLINE=getLocalizedMessage("Inline");YAHOO.widget.Editor.prototype.STR_LABEL_BLOCK=getLocalizedMessage("Block");YAHOO.widget.Editor.prototype.STR_LABEL_RIGHT=getLocalizedMessage("Right");YAHOO.widget.Editor.prototype.STR_LABEL_BORDER_COLOR=getLocalizedMessage("Border Color");YAHOO.widget.Editor.prototype.STR_TEXT_SOLID=getLocalizedMessage("Solid");YAHOO.widget.Editor.prototype.STR_TEXT_DASHED=getLocalizedMessage("Dashed");YAHOO.widget.Editor.prototype.STR_TEXT_DOTTED=getLocalizedMessage("Dotted");RichTextWidget.prototype.STR_LABEL_INSERT_TABLE=getLocalizedMessage("Insert or Change Table");RichTextWidget.prototype.STR_LABEL_TABLE=getLocalizedMessage("Table");RichTextWidget.prototype.STR_LABEL_CELL_PROPERTIES=getLocalizedMessage("Cell Properties");RichTextWidget.prototype.STR_TABLE_TITLE=getLocalizedMessage("Table Options");RichTextWidget.prototype.STR_TABLE_COLUMNS=getLocalizedMessage("Columns");RichTextWidget.prototype.STR_TABLE_CELL_SPACING=getLocalizedMessage("Cell Spacing");RichTextWidget.prototype.STR_TABLE_ROWS=getLocalizedMessage("Rows");RichTextWidget.prototype.STR_TABLE_CELL_PADDING=getLocalizedMessage("Cell Padding");RichTextWidget.prototype.STR_TABLE_BORDER=getLocalizedMessage("Table Border");RichTextWidget.prototype.STR_TABLE_BORDER_SIZE=getLocalizedMessage("Table Border Size");RichTextWidget.prototype.STR_TABLE_BORDER_TYPE=getLocalizedMessage("Table Border Type");RichTextWidget.prototype.STR_LABEL_TABLE_BORDER_COLOR=getLocalizedMessage("Table Border Color");RichTextWidget.prototype.STR_TABLE_CELL_BORDER=getLocalizedMessage("Cell Border");RichTextWidget.prototype.STR_TABLE_CELL_BORDER_SIZE=getLocalizedMessage("Cell Border Size");RichTextWidget.prototype.STR_TABLE_CELL_BORDER_TYPE=getLocalizedMessage("Cell Border Type");RichTextWidget.prototype.STR_LABEL_TABLE_CELL_BORDER_COLOR=getLocalizedMessage("Cell Border Color");RichTextWidget.prototype.STR_TABLE_CAPTION=getLocalizedMessage("Table Caption");RichTextWidget.prototype.STR_CELL_PROPERTIES_TITLE=getLocalizedMessage("Cell Options");RichTextWidget.prototype.STR_CELL_HORIZONTAL_ALIGNMENT=getLocalizedMessage("Horizontal Alignment");RichTextWidget.prototype.STR_CELL_VERTICAL_ALIGNMENT=getLocalizedMessage("Vertical Alignment");RichTextWidget.prototype.STR_CELL_BACKGROUND_COLOR=getLocalizedMessage("Background Color");RichTextWidget.prototype.STR_CELL_BORDER=getLocalizedMessage("Border");RichTextWidget.prototype.STR_CELL_BORDER_SIZE=getLocalizedMessage("Border Size");RichTextWidget.prototype.STR_CELL_BORDER_TYPE=getLocalizedMessage("Border Type");RichTextWidget.prototype.STR_CELL_BORDER_COLOR=getLocalizedMessage("Border Color");RichTextWidget.prototype.STR_TEXT_LEFT=getLocalizedMessage("Left");RichTextWidget.prototype.STR_TEXT_CENTER=getLocalizedMessage("Center");RichTextWidget.prototype.STR_TEXT_RIGHT=getLocalizedMessage("Right");RichTextWidget.prototype.STR_TEXT_TOP=getLocalizedMessage("Top");RichTextWidget.prototype.STR_TEXT_BOTTOM=getLocalizedMessage("Bottom");RichTextWidget.prototype.STR_LABEL_SPECIAL=getLocalizedMessage("Insert Special Items");RichTextWidget.prototype.STR_TEXT_HR=getLocalizedMessage("Line Rule - HR");RichTextWidget.prototype.STR_TEXT_EXPAND=getLocalizedMessage("Expand Section");RichTextWidget.prototype.STR_TEXT_EXP_HEADER=getLocalizedMessage("Information Header goes here");RichTextWidget.prototype.STR_TEXT_EXP_TEXT=getLocalizedMessage("Expanded Text goes here");RichTextWidget.prototype.STR_TEXT_SPELLCHECK=getLocalizedMessage("Spell Checker");RichTextWidget.prototype.STR_LABEL_CUT=getLocalizedMessage("Cut");RichTextWidget.prototype.STR_LABEL_COPY=getLocalizedMessage("Copy");RichTextWidget.prototype.STR_LABEL_PASTE=getLocalizedMessage("Paste");RichTextWidget.prototype.STR_TEXT_CCP_MESSAGE=getLocalizedMessage("This browser does not support this functionality, please use the keyboard shortcuts");RichTextWidget.prototype.STR_NO_BOOKMARKS=getLocalizedMessage("No Bookmarks...");RichTextWidget.prototype.STR_BOOKMARKS_TOOLTIP=getLocalizedMessage("List of Bookmarks found on this page.");RichTextWidget.prototype.STR_ANCHOR_URL=getLocalizedMessage("Bookmark Name");RichTextWidget.prototype.STR_LABEL_ANCHOR_LINK=getLocalizedMessage("Insert or Change Bookmark");RichTextWidget.prototype.STR_ANCHOR_PROP_TITLE=getLocalizedMessage("Bookmark Options");RichTextWidget.prototype.STR_MISSING_BOOKMARK_WARNING='<span class="tip"><span class="icon icon-warn"></span><strong>'+getLocalizedMessage("Note:")+"</strong>"+getLocalizedMessage("This link points to a missing bookmark and may do nothing.")+"</span>";RichTextWidget.prototype.STR_DUPLICATE_BOOKMARK_WARNING='<span class="tip"><span class="icon icon-warn"></span><strong>'+getLocalizedMessage("Note:")+"</strong>"+getLocalizedMessage("A Bookmark with the same name already exists.")+"</span>"};rtfGetBookmarkList=function(d){var b=[];$(document).find("a").each(function(h,g){var k=$(g).attr("name");if(k&&k.length>0){var f=true;if(d&&$(d).attr("id")){f=$(this).parents("#"+$(d).attr("id")).length<=0}if(f){b.push(k)}}});return b};updateRtfHtml=function(f,v,o,h,k){if(!v||v.length==0){return""}if(typeof h=="undefined"||h==null){h=ARKWGetStringByIdx(f,7)}if(typeof k=="undefined"||k==null){k=ARKWGetStringByIdx(f,6)}if(typeof o=="undefined"||o==null){var u=getFields_NS(f)[1];o=null;if(u&&u.mObj&&u.mObj.v&&u.mObj.v.mValue){o=u.mObj.v.mValue}}var d=document.createElement("temp");var b=v;d.innerHTML=v;if(d!=null){var g=null;var s=false;$(d).find("img").each(function(B,J){if(J){var I=$(J).attr("arattid");if(I!=null&&I.length>0){var E=parseInt(I);var K=true;I=$(J).attr("arschema");if(I&&I.length>0){K=(I===k);k=I}var R=$(J).attr("arentryid");if(K||!R||R.length===0){o=o}else{if(R!=null&&R.length>0){o=R}}var G=$(J).attr("arqual");if(G&&G.length>0){try{var w=new FieldList(f);var H=new NDXParseAndEncodeQualifier(f,h,k,"",G).result;var C=q={qual:H,fieldids:[],fieldvals:[],fieldtypes:[],fieldexterns:[]};w.Query(h,k,C,3,2,[1]);var D=w.F(1);if(D&&!D.isNull){o=D.toChar()}}catch(P){}}var L=(AbsContextPath+"resources/javascript/8.0.00/YUI/assets/skins/sam/brokenimage.png");var O=false;if(E>0){var y=false;var A=true;if(E in getFields_NS(f)){var N=getFields_NS(f)[E];A=false;if(N!=null&&N instanceof JAttachment&&N.IsDirty()&&N.mObj&&N.mObj.v&&N.mObj.v.mDataKey&&N.mObj.v.mDataKey.length>0){var Q=JAttachment.getAttachServletURL()+"/"+new Date().getTime();var S=JAttachment.getURLParams("1",N.mObj.v.mDataKey);var z=Q+"?ATTKey="+S;L=z;y=true;O=true}}if(!y&&o!=null&&o.length>0){L=AbsContextPath+"sharedresources/attachment/"+k+"/"+E+"/"+o+"?server="+h+"&?timestamp="+new Date().getTime();O=true}if(O){J.setAttribute("src",L);if(o!=null&&o.length>0){J.setAttribute("arentryid",o+"")}else{J.setAttribute("arentryid","")}if(k!=null&&k.length>0){J.setAttribute("arschema",k+"")}else{J.setAttribute("arschema","")}if(E>0){J.setAttribute("arattid",E+"")}else{J.setAttribute("arattid","")}s=true}}}}});$(d).find("a").each(function(J,E){if(E){var G=-1;var C=ARKWGetStringByIdx(f,7);var D=ARKWGetStringByIdx(f,6);var H=null;var N=null;var I=null;var B=null;I=$(E).attr("arqual");if(I&&I.length>0){H=I}I=$(E).attr("arentryid");if(I&&I.length>0){N=I}if((H!=null&&H.length)||(N!=null&&N.length>0)){if(H&&H.length){H=decodeURIComponent(H);if(H.indexOf("&apos;")>=0){H=H.replace(/[&]apos[;]/gi,"'")}if(H.indexOf("&#39;")>=0){H=H.replace(/[&][#]39[;]/gi,"'")}}I=$(E).attr("arattid");if(I&&I.length>0){G=parseInt(I)}I=$(E).attr("arschema");if(I&&I.length>0){D=I}else{D=ARKWGetStringByIdx(f,6)}I=$(E).attr("arserver");if(I&&I.length>0){C=I}else{C=ARKWGetStringByIdx(f,7)}I=$(E).attr("arvui");if(I&&I.length>0){B=I}var w="";if(G>0){if(H&&H.length>0){try{var L=new FieldList(f);var A=new NDXParseAndEncodeQualifier(f,C,D,"",H).result;var z=q={qual:A,fieldids:[],fieldvals:[],fieldtypes:[],fieldexterns:[]};L.Query(C,D,z,3,2,[1]);var y=L.F(1);if(y&&!y.isNull){N=y.toChar()}}catch(K){}}if(N&&N.length>0){w=AbsContextPath+"sharedresources/attachment/"+D+"/"+G+"/"+N+"?server="+C+"&?timestamp="+new Date().getTime()}}else{if(N&&N.length>0){w=AbsContextPath+"forms/"+((C&&C.length>0)?(C+"/"):"")+D+"/"+((B&&B.length>0)?(B+"/"):"")+"?eid="+N}else{if(H&&H.length>0){w=AbsContextPath+"forms/"+((C&&C.length>0)?(C+"/"):"")+D+"/"+((B&&B.length>0)?(B+"/"):"")+"?qual="+encodeURIComponent(H)}}}if(w&&w.length>0){E.setAttribute("href",w);E.setAttribute("src","javascript:");s=true}}}});if(s){b=d.innerHTML}}return b};stripImgHtml=function(f){if(!f||f.length==0){return""}else{if(f.search(/[<][ ]*img[ ]/)<0){return f}}var b=document.createElement("temp");var d=f;b.innerHTML=f;if(b!=null){var h=null;var g=false;$(b).find("img").each(function(k,s){if(s){var o=$(s).attr("arattid");if(o!=null&&o.length>0){$(s).attr("src","");g=true}}});if(g){d=b.innerHTML}}return d};compareHtml=function(g,h){if((g&&!h)||(!g&&h)){return false}else{if((!g&&!h)||(g.length==0&&h.length==0)){return true}}var d=stripImgHtml(g);var f=stripImgHtml(h);var b=document.createElement("temp");b.innerHTML=d;d=b.innerHTML;b=document.createElement("temp");b.innerHTML=f;f=b.innerHTML;return(d==f)};RichTextWidget=function(d,g,f,k,h){localizeRTFMessages();this.MTYPE=g;this.rtfInPlaceID=((h==null)?null:h.id);this.windowID=d;RichTextWidget.superclass.constructor.call(this,g,f);var b=YAHOO.util.Event;this.setAttachmentPoolField(k)};RichTextWidget.isCSSloaded=false;RichTextWidget.loadSkinCSS=function(){if(!RichTextWidget.isCSSloaded){var b=RelContextPath+"resources/javascript/"+ARKWGetByName(0,"VERSION").toString()+"/YUI/assets/skins/sam/";b+="skin.css";createStyleTag(b);RichTextWidget.isCSSloaded=true}};if(YAHOO!=null&&YAHOO.widget!=null&&YAHOO.widget.Editor!=null){YAHOO.extend(RichTextWidget,YAHOO.widget.Editor,{STR_IMAGE_HERE_ATTACH:getLocalizedMessage("Insert URL or click the Browse button (...) to attach an image."),STR_IMAGE_HERE_ORIG:getLocalizedMessage("Image URL Here"),_lastAttachFieldID:-1,_attachmentPoolField:null,_oldZIndex:null,_keyExtMap:{CREATE_TABLE:{key:84,mods:["ctrl"]},CELL_PROPERTIES:{key:67,mods:["ctrl"]}},_render:function(){if(!RichTextWidget.isCSSloaded){var d=RelContextPath+"resources/javascript/"+ARKWGetByName(0,"VERSION").toString()+"/YUI/assets/skins/sam/";d+="skin.css";createStyleTag(d);RichTextWidget.isCSSloaded=true}RichTextWidget.superclass._render.call(this);var b=this;var g=((this.rtfInPlaceID||typeof this.rtfInPlaceID=="undefined")?"":"&nbsp;");var f={group:"table",label:g,buttons:[{type:"push",label:b.STR_LABEL_INSERT_TABLE+" (Ctrl + Shift + T)",value:"createtable"},{type:"push",label:b.STR_LABEL_CELL_PROPERTIES+" (Ctrl + Shift + C)",value:"cellproperties",disabled:true}]};b.toolbar.addSeparator();b.toolbar.addButtonGroup(f);b.toolbar.on("createtableClick",b._handleCreateTableClick,b,true);b.on("windowcreatetableClose",b._handleCreateTableWindowClose,b,true);b.toolbar.on("cellpropertiesClick",b._handleCellPropertiesClick,b,true);b.toolbar.on("spellchkClick",b._handleSpellCheckClick,b,true);b.on("windowspellcheckerClose",b._handleSpellCheckWindowClose,b,true);b.on("windowcellpropertiesClose",b._handleCellPropertiesWindowClose,b,true);this.on("beforeEditorKeyDown",function(u){if(this._isNonEditable(u.ev)){return false}this._setCurrentEvent(u.ev);if(this.currentWindow){this.closeWindow()}if(this.currentWindow){this.closeWindow()}switch(u.ev.keyCode){case b._keyExtMap.CREATE_TABLE.key:if(b._checkKey(this._keyExtMap.CREATE_TABLE,u.ev)){var s=true;if(b.get("limitCommands")){if(!b.toolbar.getButtonByValue("createtable")){s=false}}if(s){b.execCommand("createtable","");b.toolbar.fireEvent("createtableClick",{type:"createtableClick",target:b.toolbar});b.fireEvent("afterExecCommand",{type:"afterExecCommand",target:b});doExec=false}return false}break;case b._keyExtMap.CELL_PROPERTIES.key:if(b._checkKey(this._keyExtMap.CREATE_TABLE,u.ev)){var h=true;if(b.get("limitCommands")){if(!b.toolbar.getButtonByValue("cellproperties")){h=false}}if(h){b.execCommand("cellproperties","");b.toolbar.fireEvent("cellpropertiesClick",{type:"cellpropertiesClick",target:b.toolbar});b.fireEvent("afterExecCommand",{type:"afterExecCommand",target:b});doExec=false}return false}break;case 46:case 8:if(!b._hasSelection()){var k=b._getRange(b._getSelection());if(k){var o=null;if(u.ev.keyCode==8&&k.startOffset==0&&k.startContainer){o=k.startContainer.previousSibling;if(o==null&&k.startContainer.parentNode){o=k.startContainer.parentNode.previousSibling}}else{if(u.ev.keyCode==46&&k.startContainer&&k.startOffset==k.startContainer.length){o=k.startContainer.nextSibling;if(o==null&&k.startContainer.parentNode){o=k.startContainer.parentNode.previousSibling}}}if(o&&o.parentNode&&o.tagName=="TABLE"){o.parentNode.removeChild(o);return false}}}break}return true});this.on("beforeEditorDoubleClick",function(s){if(this._isNonEditable(s.ev)){return false}var k=YAHOO.util.Event;b._setCurrentEvent(s.ev);var u=k.getTarget(s.ev);var v=false;var o=b._hasParent(u,"table");this._table=null;this._tableCell=null;if(o&&o.className!="expTable"){this._table=o;this._table.cells=this._table.getElementsByTagName("td");if(!b._hasParent(u,"td")){b.currentElement[0]=u;b.toolbar.fireEvent("createtableClick",{type:"createtableClick",target:b.toolbar});b.fireEvent("afterExecCommand",{type:"afterExecCommand",target:b});v=true}else{this._tableCell=this._hasParent(u,"td");b.currentElement[0]=b._hasParent(u,"td");b.toolbar.fireEvent("cellpropertiesClick",{type:"cellpropertiesClick",target:b.toolbar});b.fireEvent("afterExecCommand",{type:"afterExecCommand",target:b});v=true}}if(b._isElement(u,"img")){var h=u.getAttribute("id");if(h!=null&&h.indexOf("img_expSection")!=-1){v=true}}if(v){b.nodeChange();b.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:b,ev:s.ev});return false}return true});this.on("afterNodeChange",function(){if(!b.get("disabled")){var y=b.toolbar.getButtonByValue("createtable");var v=b._getSelectedElement();if(y){var u=true;if(b.currentWindow&&(b.currentWindow.name=="createtable")){u=false}else{if(v&&b._isElement(v,"table")||b._hasParent(v,"table")){u=true}}if(u){b.toolbar.enableButton(y)}else{b.toolbar.disableButton(y)}}var D=b.toolbar.getButtonByValue("cellproperties");if(D){var A=false;if((v&&b._isElement(v,"td")||b._hasParent(v,"td"))&&b._hasParent(v,"table").getAttribute("id")!="expandTable"){A=true}if(A){b.toolbar.enableButton(D)}else{b.toolbar.disableButton(D)}}var k=b.toolbar.getButtonByValue("special");if(k){if(k.isActive()){k._hideMenu();k._activationButtonPressed=false}}if(this._hasSelection()){var s=this._getRange();var h=false;var C=false;if(s&&s.cloneContents){var o=s.cloneContents();for(var z=0;o.childNodes&&!h&&!C&&z<o.childNodes.length;z++){h=($(o.childNodes[z]).hasClass("expTable")||$(o.childNodes[z]).find(".expTable").length>0)&&($(o.childNodes[z]).hasClass("expDataA")||$(o.childNodes[z]).find(".expDataA").length>0);C=!h&&($(o.childNodes[z]).hasClass("expTitle")||$(o.childNodes[z]).find(".expTitle").length>0)}}if(h||C){var E=["createlink","insertunorderedlist","insertorderedlist","indent","outdent","subscript","superscript","strikethrough"];var w=["insertimg","bold","underline","italic","createtable","cellproperties","insertimage","special","cut","copy","paste"];for(var z=0;(h||C)&&z<E.length;z++){var B=this.toolbar.getButtonByValue(E[z]);if(B){this.toolbar.disableButton(B)}}for(var z=0;C&&z<w.length;z++){var B=this.toolbar.getButtonByValue(w[z]);if(B){this.toolbar.disableButton(B)}}}}return true}})},init:function(d,b){this._table=null;this._tableCell=null;this._defaultTableToolbarConfig={rtl:false,buttonType:"advanced",buttons:[{group:"columns",label:this.STR_TABLE_COLUMNS+":",buttons:[{type:"spin",label:"0",value:"columns",range:[1,100]}]},{type:"separator"},{group:"cellspacing",label:this.STR_TABLE_CELL_SPACING+":",buttons:[{type:"spin",label:"0",value:"cellspacing",range:[0,100]}]},{type:"separator"},{group:"rows",label:this.STR_TABLE_ROWS+":",buttons:[{type:"spin",label:"0",value:"rows",range:[1,100]}]},{type:"separator"},{group:"cellpadding",label:this.STR_TABLE_CELL_PADDING+":",buttons:[{type:"spin",label:"0",value:"cellpadding",range:[0,100]}]},{type:"separator"},{group:"tableborder",label:this.STR_TABLE_BORDER+":",buttons:[{type:"select",title:this.STR_CELL_BORDER_SIZE,label:this.STR_TABLE_BORDER_SIZE,value:"tablebordersize",menu:[{text:this.STR_NONE,value:"0",checked:true},{text:"1px",value:"1"},{text:"2px",value:"2"},{text:"3px",value:"3"},{text:"4px",value:"4"},{text:"5px",value:"5"}]},{type:"select",title:this.STR_CELL_BORDER_TYPE,label:this.STR_TABLE_BORDER_TYPE,value:"tablebordertype",disabled:true,menu:[{text:this.STR_TEXT_SOLID,value:"solid",checked:true},{text:this.STR_TEXT_DASHED,value:"dashed"},{text:this.STR_TEXT_DOTTED,value:"dotted"}]},{type:"color",label:this.STR_LABEL_TABLE_BORDER_COLOR,value:"tablebordercolor",disabled:true}]},{type:"separator"},{group:"tablecellborder",label:this.STR_TABLE_CELL_BORDER+":",buttons:[{type:"select",title:this.STR_CELL_BORDER_SIZE,label:this.STR_TABLE_CELL_BORDER_SIZE,value:"tablecellbordersize",menu:[{text:this.STR_NONE,value:"0",checked:true},{text:"1px",value:"1"},{text:"2px",value:"2"},{text:"3px",value:"3"},{text:"4px",value:"4"},{text:"5px",value:"5"}]},{type:"select",title:this.STR_CELL_BORDER_TYPE,label:this.STR_TABLE_CELL_BORDER_TYPE,value:"tablecellbordertype",disabled:true,menu:[{text:this.STR_TEXT_SOLID,value:"solid",checked:true},{text:this.STR_TEXT_DASHED,value:"dashed"},{text:this.STR_TEXT_DOTTED,value:"dotted"}]},{type:"color",label:this.STR_LABEL_TABLE_CELL_BORDER_COLOR,value:"tablecellbordercolor",disabled:true}]}]};this._defaultCellToolbarConfig={rtl:false,buttonType:"advanced",buttons:[{group:"cellborder",label:this.STR_CELL_BORDER+":",buttons:[{type:"select",title:this.STR_CELL_BORDER_SIZE,label:this.STR_CELL_BORDER_SIZE,value:"cellbordersize",menu:[{text:this.STR_NONE,value:"0",checked:true},{text:"1px",value:"1"},{text:"2px",value:"2"},{text:"3px",value:"3"},{text:"4px",value:"4"},{text:"5px",value:"5"}]},{type:"select",title:this.STR_CELL_BORDER_TYPE,label:this.STR_CELL_BORDER_TYPE,value:"cellbordertype",disabled:true,menu:[{text:this.STR_TEXT_SOLID,value:"solid",checked:true},{text:this.STR_TEXT_DASHED,value:"dashed"},{text:this.STR_TEXT_DOTTED,value:"dotted"}]},{type:"color",label:this.STR_CELL_BORDER_COLOR,value:"cellbordercolor",disabled:true}]},{type:"separator"},{type:"separator"},{group:"halignment",label:this.STR_CELL_HORIZONTAL_ALIGNMENT+":",buttons:[{type:"select",label:this.STR_CELL_HORIZONTAL_ALIGNMENT,value:"cellhalignment",disabled:false,menu:[{text:this.STR_TEXT_LEFT,value:"left",checked:true},{text:this.STR_TEXT_CENTER,value:"center"},{text:this.STR_TEXT_RIGHT,value:"right"}]}]},{type:"separator"},{group:"valignment",label:this.STR_CELL_VERTICAL_ALIGNMENT+":",buttons:[{type:"select",label:this.STR_CELL_VERTICAL_ALIGNMENT,value:"cellvalignment",disabled:false,menu:[{text:this.STR_TEXT_TOP,value:"top",checked:true},{text:this.STR_TEXT_CENTER,value:"middle"},{text:this.STR_TEXT_BOTTOM,value:"bottom"}]}]},{type:"separator"},{group:"cellbackgroundcolor",label:this.STR_CELL_BACKGROUND_COLOR+":",buttons:[{type:"color",label:this.STR_CELL_BACKGROUND_COLOR,value:"cellbackgroundcolor",disabled:false}]},{type:"separator"},{group:"insert",label:getLocalizedMessage("Insert")+":",buttons:[{type:"select",title:"Insert Location",label:this.STR_NONE,value:"insert",disabled:false,menu:[{text:getLocalizedMessage("Column to the right"),value:"insertColumnsRight",checked:true},{text:getLocalizedMessage("Column to the left"),value:"insertColumnsLeft"},{text:getLocalizedMessage("Row Above"),value:"insertRowsAbove"},{text:getLocalizedMessage("Row Below"),value:"insertRowsBelow"}]}]}]};RichTextWidget.superclass.init.call(this,d,b)},_renderPropertyWindows:function(){RichTextWidget.superclass._renderPropertyWindows.call(this);this._renderCreateTableWindow();this._renderCellPropertiesWindow();if(this.get("enableSpellChecker")){this._renderSpellCheckWindow()}},setAttachmentPoolField:function(b){if(typeof b=="undefined"||b==null){this._attachmentPoolField=null;this.STR_IMAGE_HERE=this.STR_IMAGE_HERE_ORIG}else{this._attachmentPoolField=b;this.STR_IMAGE_HERE=this.STR_IMAGE_HERE_ATTACH}},setTarget:function(b){if(typeof b=="undefined"||b==null||typeof b.id=="undefined"||b.id==null){this.rtfInPlaceID=null}else{this.rtfInPlaceID=b.id}},setRTFDirty:function(){var d=this.rtfInPlaceID;if(d){d=d.replace(/arid_WIN_[0-9]_/gi,"");var b=getFields_NS(0)[d];if(b){b.SetDirty(b.mInputNode)}}},fixWidget:function(){if(this.toolbar.get("disabled")){this.toolbar.set("disabled",false)}},getAttachmentPoolField:function(){return this._attachmentPoolField},setText:function(d){this.setEditorHTML(d);var b=this;b.imgIndex=0;b.imgSizes=new Array();if(d&&d.length>0){setTimeout(function(){$(b._getDoc().body).find("img").each(function(f,g){b.imgIndex++;g.id="imgRtf"+b.imgIndex;b.imgSizes[b.imgIndex]=""+g.width+","+g.height})},100)}},updateText:function(v){var s=v.trim(1|2);if(s.length>0){s=this._fixQuotes(s);s=updateRtfHtml(this.windowID,s)}var f=YAHOO.util.Dom;var o=this.get("id");if(this.currentWindow&&this.currentWindow.name==="createlink"){if(s.length>0){var b=document.createElement("div");try{b.innerHTML=s}catch(h){}f.get(o+"_createlink_url").removeAttribute("disabled");f.get(o+"_createlink_url").parentNode.removeAttribute("disabled");f.get(o+"_createlink_target").removeAttribute("disabled");f.get(o+"_createlink_target").parentNode.removeAttribute("disabled");if(b.firstChild&&this._isElement(b.firstChild,"a")){var u=b.firstChild.getAttribute("title");if(u){f.get(o+"_createlink_title").value=u}var k=b.firstChild.getAttribute("target");f.get(o+"_createlink_target").checked=k!==null&&k.length>0?true:false;var g=b.firstChild.getAttribute("href",2).indexOf("javascript")===0;var d=b.firstChild.getAttribute("arschema")||b.firstChild.getAttribute("arttid")||b.firstChild.getAttribute("arentryid")||b.firstChild.getAttribute("arqual");if(g||d){if(g){f.get(o+"_createlink_url").value=b.firstChild.getAttribute("href",2);f.get(o+"_createlink_target").setAttribute("disabled","disabled");f.get(o+"_createlink_target").parentNode.setAttribute("disabled","disabled");f.get(o+"_createlink_target").checked=false}else{f.get(o+"_createlink_url").value=s}f.get(o+"_createlink_bookmarks_selection").setAttribute("disabled","disabled");f.get(o+"_createlink_bookmarks").setAttribute("disabled","disabled");f.get(o+"_createlink_url").setAttribute("disabled","disabled")}else{f.get(o+"_createlink_url").value=b.firstChild.getAttribute("href",2)}}else{f.get(o+"_createlink_url").value=s;f.get(o+"_createlink_target").checked=true}}}else{if(this.currentWindow&&this.currentWindow.name==="insertimage"){f.get(o+"_insertimage_url").value=s;if(s.length>0){f.get(o+"_insertimage_url").setAttribute("disabled","disabled");f.get(o+"_insertimage_url").parentNode.setAttribute("disabled","disabled")}else{f.get(o+"_insertimage_url").removeAttribute("disabled");f.get(o+"_insertimage_url").parentNode.removeAttribute("disabled")}}}},getText:function(){var b=this.cleanHTML();if(b==null){return""}return b},_fixQuotes:function(b){if(b&&b.length>0){b=b.replace(/[\u201C\u201D]/gi,'"');b=b.replace(/[\u2018\u2019]/gi,"'")}return b},_setInitialContent:function(){var f=((this._textarea)?this.get("element").value:this.get("element").innerHTML);var b=f;if(f.length>0){b=updateRtfHtml(this.windowID,f)}if(this._textarea){this.get("element").value=b}else{this.get("element").innerHTML=b}RichTextWidget.superclass._setInitialContent.call(this);var d=this;d.imgIndex=0;d.imgSizes=new Array();if(f&&f.length>0){setTimeout(function(){$(d._getDoc().body).find("img").each(function(g,h){d.imgIndex++;h.id="imgRtf"+d.imgIndex;d.imgSizes[d.imgIndex]=""+h.width+","+h.height})},100)}},_handleAttachmentCompleted:function(b){if(this._lastAttachFieldID>0&&this._lastAttachFieldID in getFields_NS(this.windowID)){var f=getFields_NS(this.windowID)[this._lastAttachFieldID];var k=YAHOO.util.Dom;if(f&&f.mObj&&f.mObj.v&&f.mObj.v.mDataKey){var d=JAttachment.getAttachServletURL()+"/"+new Date().getTime();var h=JAttachment.getURLParams("1",f.mObj.v.mDataKey);var g=d+"?ATTKey="+h;var o=k.get(this.get("id")+"_insertimage_url");o.value=g;this._handleImageURLChange()}}},_verifyAttachments:function(b){if(b==null){b=this._getDoc()}GlobalVerifyAttachments(this.windowID,b,this._attachmentPoolField)},_handleInsertImageButton:function(o){var k=YAHOO.util.Dom;var d=YAHOO.util.Event;this._lastAttachFieldID=-1;if(this._attachmentPoolField!=null||this._attachmentPoolField!="undefined"){var h=[];h=this._attachmentPoolField.GetEmptyRowIds();if(h.length>0){var b=h[0];var g=this;if(b in getFields_NS(this.windowID)){var f=getFields_NS(this.windowID)[b];g._lastAttachFieldID=b;new WorkflowContext(this.windowID,{f:function(){var u={};var s=f.Add(u);var v=s.n.f;s.n.f=function(w){v.call(f,w);g._handleAttachmentCompleted(w);if(!g.browser.ie){g.focus()}};return s}})}}}},_handleInsertImageClick:function(){this.showInsertImageButton(this._attachmentPoolField!=null);if(this._attachmentPoolField!=null){var b=this;setTimeout(function(){b._verifyAttachments();var f=b._attachmentPoolField.GetEmptyRow();var d=f>-1&&!((getARStateCurrent_NS(b.windowID)==3)||(getARStateCurrent_NS(b.windowID)==4));b.enableInsertImageButton(d)},0)}return RichTextWidget.superclass._handleInsertImageClick.call(this)},destroy:function(){_attachmentPoolField=null;return RichTextWidget.superclass.destroy.call(this)},_handleInsertImageWindowClose:function(){var b=YAHOO.util.Dom;var f=b.get(this.get("id")+"_insertimage_url"),G=b.get(this.get("id")+"_insertimage_title"),k=b.get(this.get("id")+"_insertimage_link"),E=b.get(this.get("id")+"_insertimage_target"),d=arguments[0].win.el;if(f&&f.value&&(f.value!=this.STR_IMAGE_HERE)){var v="?ATTKey";var u="servlet/AttachServlet";var s="sharedresources/attachment";var o=G.value;if(f.value.indexOf(v)>=0||f.value.indexOf(u)>=0||f.value.indexOf(s)>=0){if(this._lastAttachFieldID>0&&this._lastAttachFieldID in getFields_NS(this.windowID)){d.setAttribute("arattid",this._lastAttachFieldID+"");d.setAttribute("arschema",ARKWGetStringByIdx(this.windowID,6));d.setAttribute("arentryid","");if(o==null||o.length==0){var A=getFields_NS(this.windowID)[this._lastAttachFieldID];if(A!=null&&A instanceof JAttachment&&A.mObj&&A.mObj.v&&A.mObj.v.mFileName){o=getLocalizedMessage("Attachment Image: ");o+=A.mObj.v.mFileName}}}}else{d.setAttribute("arattid","");d.setAttribute("arschema","");if(f.value&&f.value.length>0){var h=(f.value.indexOf("\\")>=0?f.value.lastIndexOf("\\"):f.value.lastIndexOf("/"));if(h>=0&&h<f.value.length&&(o==null||o.length==0)){o=getLocalizedMessage("Image: ");o+=f.value.substring(h)}}}d.setAttribute("src",f.value);d.setAttribute("alt",o);d.setAttribute("title",o);var y=d.parentNode;if(k.value){var C=k.value;if((C.indexOf("://")==-1)&&(C.substring(0,1)!="/")&&(C.substring(0,6).toLowerCase()!="mailto")){if((C.indexOf("@")!=-1)&&(C.substring(0,6).toLowerCase()!="mailto")){C="mailto:"+C}else{C="http://"+C}}if(y&&this._isElement(y,"a")){y.setAttribute("href",C);if(E.checked){y.setAttribute("target",E.value)}else{y.setAttribute("target","")}}else{var g=this._getDoc().createElement("a");g.setAttribute("href",C);if(E.checked){g.setAttribute("target",E.value)}else{g.setAttribute("target","")}d.parentNode.replaceChild(g,d);g.appendChild(d)}}else{if(y&&this._isElement(y,"a")){y.parentNode.replaceChild(d,y)}}}else{var z="";if(d.getAttribute("src")){z=d.getAttribute("src",2)}if(z.indexOf(this.get("blankimage"))!=-1||f==null||f.value==null||f.value==this.STR_IMAGE_HERE){d.parentNode.removeChild(d)}}this._lastAttachFieldID=-1;b.get(this.get("id")+"_insertimage_url").value="";b.get(this.get("id")+"_insertimage_title").value="";b.get(this.get("id")+"_insertimage_link").value="";b.get(this.get("id")+"_insertimage_target").checked=false;b.get(this.get("id")+"_insertimage_width").value=0;b.get(this.get("id")+"_insertimage_height").value=0;this._defaultImageToolbar.resetAllButtons();var w=this.currentElement[0];this.currentElement=[];this.nodeChange();try{if(window.getSelection){var B=window.getSelection();range=w.ownerDocument.createRange();range.setStartAfter(w);range.setEndAfter(w);B.removeAllRanges();B.addRange(range)}else{range=w.ownerDocument.body.createTextRange();range.moveToElementText(w);range.collapse(false);range.select()}}catch(D){}},_handleCreateLinkWindowClose:function(){var k=YAHOO.util.Dom;var b=k.get(this.get("id")+"_createlink_url"),v=k.get(this.get("id")+"_createlink_target"),z=k.get(this.get("id")+"_createlink_title"),g=arguments[0].win.el,A=g;if(b&&b.value){if(g){g.removeAttribute("arentryid");g.removeAttribute("arattid");g.removeAttribute("arschema");g.removeAttribute("arserver");g.removeAttribute("arqual");g.removeAttribute("src");g.removeAttribute("href");k.removeClass(g,"yui-url-sync")}var u=b.value;u=u.trim(1|2);if(u.indexOf("#")==0){g.setAttribute("href",u);g.removeAttribute("target","")}else{if(u.indexOf("<a ")==0||u.indexOf("<A ")==0){var h=document.createElement("div");$(h).html(u);var d=["src","href","target","title","path","arentryid","arattid","arschema","arserver","arqual"];for(var y in d){var f=d[y];var o=$(h.firstChild).attr(f);if(o){$(g).attr(f,o)}}if(v.checked){g.setAttribute("target",v.value)}else{g.setAttribute("target","")}}else{if((u.indexOf("://")==-1)&&(u.substring(0,1)!="/")&&(u.substring(0,6).toLowerCase()!="mailto")&&(u.substring(0,10).toLowerCase()!="javascript")){if((u.indexOf("@")!=-1)&&(u.substring(0,6).toLowerCase()!="mailto")){u="mailto:"+u}else{if((u.indexOf("\\\\")!=-1)){u="file://"+u}else{if(u.substring(0,1)!="#"){u="http://"+u}}}g.setAttribute("href",u);if(v.checked){g.setAttribute("target",v.value)}else{g.setAttribute("target","")}}else{g.setAttribute("href",u);if(v.checked){g.setAttribute("target",v.value)}else{g.setAttribute("target","")}}}}g.setAttribute("title",((z.value)?z.value:""))}else{var w=g.getAttribute("href");if((w==null||w=="")||(w!=null&&(b==null||b.value==null||b.value==""))){var s=this._getDoc().createElement("span");s.innerHTML=g.innerHTML;k.addClass(s,"yui-non");g.parentNode.replaceChild(s,g)}}k.removeClass(b,"warning");if(!this.browser.ie){var C=$(g).text();if(u==C||C.indexOf(u)>=0||u.indexOf(C)>=0){$(g).addClass("yui-url-sync")}}k.get(this.get("id")+"_createlink_url").value="";var B=k.get(this.get("id")+"_createlink_bookmarks_selection");B.length=0;B.options[0]=new Option("None...","None...");k.get(this.get("id")+"_createlink_bookmarks_selection").setAttribute("disabled","disabled");k.get(this.get("id")+"_createlink_title").value="";k.get(this.get("id")+"_createlink_target").checked=false;this.nodeChange();this.currentElement=[]},closeWindow:function(b){if(this.currentWindow){RichTextWidget.superclass.closeWindow.call(this,b)}},resizeWindow:function(k,b){var u=this.get("element_cont").get("element");if(u&&u.parentNode){RichTextWidget.superclass.hide.call(this);var s=this.get("animate");if(s){this.set("animate",false)}if(u.parentNode.clientWidth>0){this.set("width",u.parentNode.clientWidth+"px")}var f=u.parentNode.clientHeight,g=(this.toolbar.get("element").clientHeight),o=0;if(this.dompath){if(this.dompath.clientHeight>0){o=(this.dompath.clientHeight)}else{o=18}}var d=(f-g-o);if(d>0){this.set("height",d+"px");this.get("element_cont").setStyle("height","")}if(s){this.set("animate",s)}RichTextWidget.superclass.show.call(this)}},show:function(d){this._removeEditorEvents();this._clearUndo();if(d){this._oldZIndex=d.parentNode.style.zIndex;d.parentNode.style.zIndex=10000;var f=this.get("element_cont").get("element");d.parentNode.replaceChild(f,d)}var b=this;setTimeout(function(){b._setDesignMode("on");b._initEditorEvents();RichTextWidget.superclass.show.call(b)},1)},focus:function(d){this._setDesignMode("on");this._getWindow().focus();var b=this;setTimeout(function(){try{if(b._getWindow()!=null){b._setDesignMode("on");b._getWindow().focus();if(d&&b.browser.ie){setTimeout(function(){var g=b._getDoc().body.createTextRange();g.collapse(true);g.select()},5)}}}catch(f){}},50)},hide:function(b){this._removeEditorEvents();this._clearUndo();RichTextWidget.superclass.hide.call(this);var d=this.get("element_cont").get("element");if(d.parentNode){d.parentNode.style.zIndex=this._oldZIndex;if(b){d.parentNode.replaceChild(b,d)}else{d.parentNode.removeChild(d)}}},prependTo:function(d){this._removeEditorEvents();var f=this.get("element_cont").get("element");$(f).prependTo(d);var b=this;setTimeout(function(){b._setInitialContent.call(b);window.setTimeout(function(){RichTextWidget.superclass._setDesignMode.call(b,"on");RichTextWidget.superclass._initEditorEvents.call(b);window.setTimeout(function(){b.setEditorHTML("")},1)},1)},1)},removeFrom:function(b){this._removeEditorEvents();this._clearUndo();var d=this.get("element_cont").get("element");if(d){$(d).appendTo("body")}},_handleCreateTableClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("createtable")){return false}}var b=function(){var g=YAHOO.util.Dom,C=YAHOO.util.Event,v=YAHOO.lang;var D=this._getDoc().getElementsByTagName("table");if(D&&D.length){for(var h=0;h<D.length;h++){this._table=D[h];this._table.cells=this._table.getElementsByTagName("td");if(this._table&&this._table.className=="temp_table"){this._table.className="";this.currentElement[0]=this._table;this._selectNode(this._table);break}else{this._table=null}}}if(this._table&&this._isElement(this._table,"table")){var z=new YAHOO.widget.EditorWindow("createtable",{width:"450px"});z.setFooter(" ");var w=null;if(this._windows.createtable&&this._windows.createtable.body){w=this._windows.createtable.body}else{w=this._renderCreateTableWindow()}z.setHeader(this.STR_TABLE_TITLE);z.setBody(w);tbar=this._defaultTableToolbar;tbar.editor_el=this._table;g.get(this.get("id")+"_createtable_width").value=parseInt(this._table.style.width,10);g.get(this.get("id")+"_createtable_height").value=parseInt(this._table.style.height,10);var B=tbar.getButtonByValue("columns");B.set("label",this._getColumnCount(this._table)+"");var B=tbar.getButtonByValue("rows");B.set("label",this._getRowCount(this._table)+"");B=tbar.getButtonByValue("cellspacing");var u=this._table.getAttribute("cellSpacing");if(u==null||typeof u=="undefined"){u="0"}B.set("label",u);B=tbar.getButtonByValue("cellpadding");var u=this._table.getAttribute("cellPadding");if(u==null||typeof u=="undefined"){u="0"}B.set("label",u);var y=g.get(this.get("id")+"_createtable_caption");y.checked=this._table.caption!=null;if("defaultChecked" in y){y.defaultChecked=(this._table.caption!=null)}var s=this._getTableStyle(this._table);var B=tbar.getButtonByValue("tablebordersize");var o=((parseInt(s.size,10)>0)?"":this.STR_NONE);B.set("label",'<span class="yui-toolbar-tablebordersize-'+s.size+'">'+o+"</span>");this._updateMenuChecked("tablebordersize",s.size,tbar);var A=tbar.getButtonByValue("tablebordertype");A.set("label",'<span class="yui-toolbar-tablebordertype-'+s.type+'">asdfa</span>');this._updateMenuChecked("tablebordertype",s.type,tbar);if(parseInt(s.size,10)>0){tbar.enableButton(A);tbar.enableButton("tablebordercolor")}else{tbar.disableButton(A);tbar.disableButton("tablebordercolor")}var k="0",f="solid";var d=this._getTableCellStyle(this._table);if(d&&d.size){k=parseInt(d.size,10)}if(d&&d.type){f=d.type}B=tbar.getButtonByValue("tablecellbordersize");o=((parseInt(k,10)>0)?"":this.STR_NONE);B.set("label",'<span class="yui-toolbar-tablecellbordersize-'+k+'">'+o+"</span>");this._updateMenuChecked("tablecellbordersize",k,tbar);A=tbar.getButtonByValue("tablecellbordertype");A.set("label",'<span class="yui-toolbar-tablecellbordertype-'+f+'">asdfa</span>');this._updateMenuChecked("tablecellbordertype",f,tbar);if(parseInt(k,10)>0){tbar.enableButton(A);tbar.enableButton("tablecellbordercolor")}else{tbar.disableButton(A);tbar.disableButton("tablecellbordercolor")}this.openWindow(z)}this.unsubscribe("afterExecCommand",b,this,true)};this.on("afterExecCommand",b,this,true)},_addRemoveRowHeader:function(g,b){var f=g[g.length-1].rows;var d={};for(i=0;i<f.length;i++){if(b==2){if(f[i].firstChild.nodeName=="TD"){d=document.createElement("th");d.innerHTML="<strong>Row "+(i+1)+"</strong>";f[i].replaceChild(d,f[i].firstChild)}}else{d=document.createElement("th");d.innerHTML="<strong>Row "+(i+1)+"</strong>";f[i].insertBefore(d,f[i].firstChild)}}},_handleCreateTableWindowClose:function(){this.nodeChange();if(this.rtfInPlaceID){this.setRTFDirty()}},_handleSpellCheckClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("spellchecker")){return false}}else{if(!this.get("enableSpellChecker")){return false}}var b=function(){var h=YAHOO.util.Dom,f=YAHOO.util.Event,k=YAHOO.lang;if(bSpellFetched){var o=new YAHOO.widget.EditorWindow("spellchecker",{width:"225px"});var d=null;if(this._windows.spellchecker&&this._windows.spellchecker.body){d=this._windows.spellchecker.body}else{d=this._renderSpellCheckWindow()}o.setHeader(this.STR_TEXT_SPELLCHECK);o.setBody(d);tbar=this._defaultSpellCheckToolbar;tbar.editor_el=this._spellcheck;var g=this.get("id");f.onAvailable(g+"_spellchecker_rw",function(){var s=g;window.setTimeout(function(){try{YAHOO.util.Dom.get(g+"_spellchecker_rw").focus()}catch(u){}},50)},this,true);this.openWindow(o);this.convertWindowToProperty()}this.unsubscribe("afterExecCommand",b,this,true)};this.on("afterExecCommand",b,this,true)},_handleCellPropertiesClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("cellproperties")){return false}}this.toolbar.set("disabled",false);var b=function(){var g=this.currentElement[0];var k=YAHOO.util.Dom,B=YAHOO.util.Event,u=YAHOO.lang;if(this._table&&(this._table.tagName=="TABLE"||this._table.tagName=="table")&&this._tableCell&&(this._tableCell.tagName=="TD"||this._tableCell.tagName=="td")&&this._table.getAttribute("id")!="expandTable"){var y=new YAHOO.widget.EditorWindow("cellproperties",{width:"250px"});y.setFooter(" ");var v=null;if(this._windows.cellproperties&&this._windows.cellproperties.body){v=this._windows.cellproperties.body}else{v=this._renderCellPropertiesWindow()}y.setHeader(this.STR_CELL_PROPERTIES_TITLE);y.setBody(v);tbar=this._defaultCellToolbar;tbar.editor_el=g;var s="0",f="solid";var d=this._getTableCellStyle(this._table,this._tableCell);if(d&&d.size){s=parseInt(d.size,10)}if(d&&d.type){f=d.type}var A=tbar.getButtonByValue("cellbordersize");var o=((parseInt(s,10)>0)?"":this.STR_NONE);A.set("label",'<span class="yui-toolbar-cellbordersize-'+s+'">'+o+"</span>");this._updateMenuChecked("cellbordersize",s,tbar);bt_button=tbar.getButtonByValue("cellbordertype");bt_button.set("label",'<span class="yui-toolbar-cellbordertype-'+f+'">asdfa</span>');this._updateMenuChecked("cellbordertype",f,tbar);if(parseInt(s,10)>0){tbar.enableButton(bt_button);tbar.enableButton("cellbordercolor")}else{tbar.disableButton(bt_button);tbar.disableButton("cellbordercolor")}var h=this.STR_TEXT_CENTER,w=this.STR_TEXT_LEFT,z="";z=this._tableCell.align;if(z==null||z==""){z="left"}switch(z){case"left":w=this.STR_TEXT_LEFT;break;case"center":w=this.STR_TEXT_CENTER;break;case"right":w=this.STR_TEXT_RIGHT;break}A=tbar.getButtonByValue("cellhalignment");A.set("label",'<span class="yui-toolbar-cellhalignment-right">'+w+"</span>");this._updateMenuChecked("cellhalignment",z,tbar);z=this._tableCell.vAlign;if(z==null||z==""){z="middle"}switch(z){case"top":h=this.STR_TEXT_TOP;break;case"middle":h=this.STR_TEXT_CENTER;break;case"bottom":h=this.STR_TEXT_BOTTOM;break}A=tbar.getButtonByValue("cellvalignment");A.set("label",'<span class="yui-toolbar-cellvalignment-right">'+h+"</span>");this._updateMenuChecked("cellvalignment",z,tbar);A=tbar.getButtonByValue("insert");A.set("label","<span>"+getLocalizedMessage("none")+"</span>");this.openWindow(y)}this.unsubscribe("afterExecCommand",b,this,true)};this.on("afterExecCommand",b,this,true)},_handleCellPropertiesWindowClose:function(){this.nodeChange()},_handleSpellCheckWindowClose:function(){SpellChecker(false);this.nodeChange()},_updateCellBorderProperties:function(s){var v=this._getTableCellStyle(this._table,s);if(v!=null){var b=v.style;var w=v.size+"px ";var k=v.type+" ";var f=v.color;var y=w+k+f;var h=this._getColumnCount(this._table);var d=Math.round(100/h)+"%";var u=null;var o=null;var g=null;if(s){u=$(s).height();o=s.vAlign;g=s.align}this._setTableCellStyle(false,this._table,b,y,d,u,o,g)}},_renderCreateTableWindow:function(){var h=YAHOO.util.Dom,z=YAHOO.util.Event,s=YAHOO.lang;var y="ltr";if(this.get("rtl")){y="rtl"}var v=this.get("id");var d=this.currentElement[0];var w='<div class="yui-toolbar-group yui-toolbar-group-height-width height-width"><label for="'+v+'_createtable_size"><strong>'+this.STR_IMAGE_SIZE+":</strong>";w+='<span tabIndex="-1"><input type="text" size="3" value="" id="'+v+'_createtable_width"> x <input type="text" size="3" value="" id="'+v+'_createtable_height"></span>';w+="</label></div>";this._defaultTableToolbarConfig.rtl=this.get("rtl");var b={};var g=document.createElement("div");g.style.width="100%";g.id=v+"_tble_toolbar";s.augmentObject(b,this._defaultTableToolbarConfig);var f=new YAHOO.widget.Toolbar(g,b);f.editor_el=d;this._defaultTableToolbar=f;var C=f.get("cont");z.onAvailable(v+"_createtable_width",function(){z.on(v+"_createtable_width","blur",function(){var D=h.get(v+"_createtable_width");if(this._table){var o=/(^-?\d\d*$)/;if(o.test(D.value)){var E=parseInt(D.value,10);if(E>=200){this._table.style.width=E+"px";if(D.nextSibling.tagName=="SPAN"){D.nextSibling.style.display="none";D.nextSibling.parentNode.removeChild(D.nextSibling)}}else{if(E<200){if(D.nextSibling.tagName!="SPAN"){var G=document.createElement("span");G.innerHTML="Enter a number greater than or equal to 200";G.style.color="red";D.parentNode.insertBefore(G,D.nextSibling)}else{return}}}}else{if(D.nextSibling.tagName!="SPAN"){var G=document.createElement("span");G.innerHTML="Enter a number greater than or equal to 200";G.style.color="red";D.parentNode.insertBefore(G,D.nextSibling)}else{return}}this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k})}},this,true)},this,true);z.onAvailable(v+"_createtable_height",function(){z.on(v+"_createtable_height","blur",function(){var G=h.get(v+"_createtable_height");if(this._table){var o=/(^-?\d\d*$)/;if(o.test(G.value)){var D=parseInt(G.value,10);if(D>=100){this._table.style.height=D+"px";if(G.nextSibling!=null){if(G.nextSibling.tagName=="SPAN"){G.nextSibling.style.display="none";G.nextSibling.parentNode.removeChild(G.nextSibling)}}}else{if(D<100){if(G.nextSibling==null){var E=document.createElement("span");E.innerHTML="Please Enter a number greater than or equal to 100";E.style.color="red";G.parentNode.insertBefore(E,G.nextSibling)}else{return}}}}else{if(G.nextSibling==null){var E=document.createElement("span");E.innerHTML="Please Enter a number greater than or equal to 100";E.style.color="red";G.parentNode.insertBefore(E,G.nextSibling)}else{return}}this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k})}},this,true)},this,true);z.onAvailable(v+"_createtable_caption",function(){z.on(v+"_createtable_caption","click",function(){if(this._table){var o=h.get(v+"_createtable_caption").checked;this._addRemoveTableCaption(this._table,o);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k})}},this,true)},this,true);z.onAvailable(v+"_deleteTable",function(){z.on(v+"_deleteTable","click",function(){if(this._table){var D=this._table.parentNode;if(D!=null){var o=this._table.nextSibling;if(o!=null&&o.tagName=="P"){D.removeChild(o)}o=null;this._table.style.display="none";D.removeChild(this._table);this._table=null;this.currentElement[0]=null;this.closeWindow()}}},this,true)},this,true);f.on("colorPickerClicked",function(H){h.get(this.get("id")+"_createtable_width").value=parseInt(this._table.style.width,10);h.get(this.get("id")+"_createtable_height").value=parseInt(this._table.style.height,10);if(H.button=="tablebordercolor"){var G=this._getTableStyle(this._table);if(G!=null){var D=G.size+"px "+G.type+" #"+H.color;this._setTableStyle(this._table,D,null,null);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k})}}else{if(H.button=="tablecellbordercolor"){var E=this._getTableCellStyle(this._table);if(E!=null){var D=E.size+"px "+E.type+" #"+H.color;this._setTableCellStyle(true,this._table,null,D,null,null,null,null);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k})}}}},this,true);f.on("buttonClick",function(D){var P=D.button.value,E="";if(D.button.menucmd){P=D.button.menucmd}switch(P){case"tablecellbordersize":var U=this._getTableCellStyle(this._table);if(U!=null){E=parseInt(D.button.value,10)+"px "+U.type+" "+U.color;this._setTableCellStyle(true,this._table,null,E,null,null,null,null);if(parseInt(D.button.value,10)>0){f.enableButton("tablecellbordertype");f.enableButton("tablecellbordercolor")}else{f.disableButton("tablecellbordertype");f.disableButton("tablecellbordercolor")}this._updateMenuChecked("tablecellbordersize",P,f);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k})}break;case"tablebordersize":var H=this._getTableStyle(this._table);E=parseInt(D.button.value,10)+"px "+H.type+" "+H.color;this._setTableStyle(this._table,E,null,null);if(parseInt(D.button.value,10)>0){f.enableButton("tablebordertype");f.enableButton("tablebordercolor")}else{f.disableButton("tablebordertype");f.disableButton("tablebordercolor")}this._updateMenuChecked("tablebordersize",P,f);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break;case"tablebordertype":var H=this._getTableStyle(this._table);E=H.size+"px "+D.button.value+" "+H.color;this._setTableStyle(this._table,E,null,null);this._updateMenuChecked("tablebordertype",P,f);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break;case"tablecellbordertype":var U=this._getTableCellStyle(this._table);if(U!=null){E=U.size+"px "+D.button.value+" "+U.color;this._setTableCellStyle(true,this._table,null,E,null,null,null,null)}this._updateMenuChecked("tablecellbordertype",P,f);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break;case"columns":var S=f.getButtonById(D.button.id);var R=parseInt(S.get("label"),10);var I=this._getColumnCount(this._table);var V=R;if(I>0){V=R-I}var Q=this._getTableCellPos(this._tableCell).column;if(Q>=0){Q=Q+1}this._addRemoveColumns(this._table,V,Q);this._updateCellBorderProperties(this._tableCell);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break;case"rows":var S=f.getButtonById(D.button.id);var K=parseInt(S.get("label"),10);var O=this._getRowCount(this._table);var N=K;if(O>0){N=K-O}var J=0;if(this._tableCell){J=this._getTableCellPos(this._tableCell).row}if(J>=0){J=J+1}this._addRemoveRows(this._table,N,J);this._updateCellBorderProperties(this._tableCell);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break;case"cellspacing":var S=f.getButtonById(D.button.id);var G=parseInt(S.get("label"),10);var H=this._getTableStyle(this._table);E=H.size+"px "+H.type+" "+H.color;this._setTableStyle(this._table,E,null,G);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break;case"cellpadding":var S=f.getButtonById(D.button.id);var L=parseInt(S.get("label"),10);var H=this._getTableStyle(this._table);E=H.size+"px "+H.type+" "+H.color;this._setTableStyle(this._table,E,L,null);this.fireEvent("afterTablePropertiesChanged",{type:"afterTablePropertiesChanged",panel:this.get("panel"),body:k});break}h.get(this.get("id")+"_createtable_width").value=parseInt(this._table.style.width,10);h.get(this.get("id")+"_createtable_height").value=parseInt(this._table.style.height,10);f.selectButton(D.button.value);if(P!=="padding"){this.moveWindow()}},this,true);var k=document.createElement("div");k.innerHTML=w;k.appendChild(g);var u=document.createElement("label");u.setAttribute("for",v+"_createtable_caption_label");u.innerHTML='<input type="checkbox" name="'+v+'_createtable_caption_" id="'+v+'_createtable_caption" value="_blank" class="insertimage_target"> '+this.STR_TABLE_CAPTION;k.appendChild(u);var A=v+"_deleteTable";var B=document.createElement("div");B.innerHTML='<span id="'+A+'" class="yui-button yui-push-button"> <span class="first-child"> <a href="#" tabindex="-1">'+getLocalizedMessage("Delete Table")+"</a></span></span> ";k.appendChild(B);this._windows.createtable={};this._windows.createtable.body=k;this.get("panel").editor_form.appendChild(k);this.fireEvent("windowCreateTableRender",{type:"windowCreateTableRender",panel:this.get("panel"),body:k});return k},_renderSpellCheckWindow:function(){var h=YAHOO.util.Dom,y=YAHOO.util.Event,s=YAHOO.lang;var w="ltr";if(this.get("rtl")){w="rtl"}var u=this.get("id");this.currentElement[0]=this._getDoc().body;var v="";var d={};var g=document.createElement("div");g.style.width="100%";g.id=u+"_spellcheck_toolbar";var f=new YAHOO.widget.Toolbar(g,d);f.editor_el=this.currentElement[0];this._defaultSpellCheckToolbar=f;var z=f.get("cont");var k=document.createElement("div");v='<table><tr><td width="30%"><label for="flikr_search">'+getLocalizedMessage("Replace with")+":</label></td>";v+='<td width="60%><input type="text" value="" id="flickr_search"><input size="20" id="'+u+'_spellchecker_rw" name="RW" type="text" onKeyUp="updateSpellingButtons()" onchange="updateSpellingButtons()"></td></tr>';v+='<tr><td><label for="suggestion">'+getLocalizedMessage("Suggestion")+": </label></td><td>";v+='<select id="'+u+'_spellchecker_select" width="10" size="5" name="ListSuggestions" style="width: 90%">';v+="<option>"+getLocalizedMessage("Checking...")+"</option></select></td></tr></table><br><br>";v+='<input style="width:120px" onclick="replaceWord(4)" value="'+getLocalizedMessage("Ignore Once")+'" type="button" class="button"><br>';v+='<input style="width:120px" onclick="replaceWord(3)" value="'+getLocalizedMessage("Ignore All")+'"type="button" class="button"><br>';v+='<input style="width:120px" onclick="replaceWord(2)" id="ChangeOnceButton" value="'+getLocalizedMessage("Change Once")+'"type="button" class="button">';v+='<input onclick="SetReplaceOption(2)" id="ReplaceOnce" name="ReplaceOnce" type="checkbox">';v+='<label for="ReplaceOnce" style="width: 75px;float: right;">'+getLocalizedMessage("One-Click")+"</label><br>";v+='<input style="width:120px" onclick="replaceWord(1)"  id="ChangeAllButton"value="'+getLocalizedMessage("Change All")+'" type="button" class="button">';v+='<input checked="true" onclick="SetReplaceOption(1)" id="ReplaceAll" name="ReplaceAll" type="checkbox">';v+='<label for="ReplaceAll"style="width: 75px;float: right;margin-top: -20px;">'+getLocalizedMessage("One-Click")+"</label>";k.innerHTML=v;var b=false;y.onAvailable(u+"_spellchecker_select",function(){y.on(u+"_spellchecker_select","click",function(){if(!b){h.get(u+"_spellchecker_select").disabled=true;b=true;newSelection();b=false}},this,true)},this,true);this._windows.spellchecker={};this._windows.spellchecker.body=k;this.get("panel").editor_form.appendChild(k);this.fireEvent("windowspellcheckerRender",{type:"windowspellcheckerRender",panel:this.get("panel"),body:k});return k},cmd_createtable:function(d){var b=this._getSelectedElement();this._table=null;this._tableCell=null;if(this._hasParent(b,"table")&&this._hasParent(b,"table").getAttribute("id")!="expandTable"){this.currentElement[0]=this._hasParent(b,"table");this._table=this.currentElement[0];this._table.className="temp_table";this._tableCell=this._hasParent(b,"td")}else{var f='<p><table class="temp_table" border="1" cellSpacing="0" cellPadding="0" style="border: 1px solid rgb(0, 0, 0); width: 200px; height: 100px;"><tbody><tr><td style="font-size:13px;" vAlign="middle" scope="row" width="50%"></td><td style="font-size:13px;" vAlign="middle" width="50%"></td></tr><tr><td style="font-size:13px;" vAlign="middle" scope="row" width="50%"></td><td style="font-size:13px;" vAlign="middle" width="50%"></td></tr></tbody></table>&nbsp;</p>&nbsp;';this._insertIntoEmptyElement(f)}return[false]},cmd_cellproperties:function(d){var b=this._getSelectedElement();this._table=null;this._tableCell=null;if(this._hasParent(b,"table")&&this._hasParent(b,"td")){this.currentElement[0]=this._hasParent(b,"td");this._table=this._hasParent(b,"table");this._table.cells=this._table.getElementsByTagName("td");this._tableCell=this._hasParent(b,"td")}return[false]},cmd_spellchk:function(d){var b=this._getSelectedElement();this._spellcheck=null;this.currentElement[0]=this._getDoc().body;this._spellcheck=this.currentElement[0];return[false]},_getColumnCount:function(d){if(d==null||d.tagName!="TABLE"){return -1}var b=0;var f=d.rows;for(r=0;r<f.length;r++){if(b<f[r].cells.length){b=f[r].cells.length}}return b},_getRowCount:function(b){if(b==null||b.tagName!="TABLE"){return -1}return(b.rows?b.rows.length:0)},_getTableCellPos:function(b){if(b==null||b.tagName!="TD"){return{column:-1,row:-1}}var f=b.cellIndex;var d=b.parentNode.rowIndex;return{column:f,row:d}},_addRemoveTableCaption:function(f,d){if(f==null||f.tagName!="TABLE"){return}if(d){if(f.caption){return}var b=f.createCaption();b.style.fontSize=16;b.style.fontWeight="bold";b.innerHTML=this.STR_TABLE_CAPTION;if(f.style!=null&&f.style.border){b.style.border=f.style.border}}else{if(f.caption){f.deleteCaption()}}},_addRemoveColumns:function(k,h,f){if(k==null||k.tagName!="TABLE"||h==0){return}var o=k.rows;var d=$(k).width();var g=0;if(h>0){for(r=0;r<o.length;r++){var s=o[r];for(c=0;c<h;c++){var b=null;if(f&&typeof f=="number"&&f>=0&&f<s.cells.length){b=s.insertCell(f)}else{b=s.insertCell(s.cells.length-1)}if(g<=0){g=$(b).width()}b.className="temp_cell"}}}else{for(r=0;r<o.length;r++){var s=o[r];for(c=h;c<0&&s.cells&&s.cells.length>1;c++){var b=null;if(f&&typeof f=="number"&&f>=0&&f<s.cells.length){b=s.deleteCell(f)}else{b=s.deleteCell(s.cells.length-1)}if(g<=0){g=-$(b).width()}}}}$(k).width((d+g)+"px")},_addRemoveRows:function(k,h,f){if(k==null||k.tagName!="TABLE"||h==0){return}if(k.rows==null||(h<0&&k.rows.length<=1)){return}var d=$(k).height();if(h<0){for(r=h;r<0&&k.rows.length>1;r++){var o=null;if(f&&typeof f=="number"&&f>=0&&f<k.rows.length){o=k.rows[f];d-=$(o).height();k.deleteRow(f)}else{o=k.rows[k.rows.length-1];d-=$(o).height();k.deleteRow(k.rows.length-1)}}}else{var g=this._getColumnCount(k);for(r=0;r<h;r++){var o=null;if(f&&typeof f=="number"&&f>=0&&f<k.rows.length){o=k.insertRow(f)}else{o=k.insertRow(k.rows.length-1)}for(c=0;c<g&&o;c++){var b=o.insertCell(0);b.className="temp_cell"}if(o){d+=$(o).height()}}}$(k).height(d+"px")},_getTableBody:function(b){if(b==null||b.tagName!="TABLE"||b.tBodies==null||b.tBodies.length<=0){return null}return b.tBodies[0]},_getTableStyle:function(k){if(k==null||k.tagName!="TABLE"){return null}var b="1",d="solid",o="black";if(k.style.borderLeftWidth){b=parseInt(k.style.borderLeftWidth,10)}if(k.style.borderLeftStyle){d=k.style.borderLeftStyle}if(k.style.borderLeftColor){o=k.style.borderLeftColor}var s=b+"px "+d+" #"+o;var h=k.getAttribute("cellPadding");var g=k.getAttribute("cellSpacing");var f={size:b,type:d,color:o,cellpadding:h,cellspacing:g,borderstring:s,width:k.style.width,height:k.style.height};return f},_setTableStyle:function(d,b,g,f){if(d==null||d.tagName!="TABLE"){return}if(b!=null){d.style.border=b}if(g!=null&&typeof g!="undefined"){d.setAttribute("cellPadding",g+"")}if(f!=null&&typeof f!="undefined"){d.setAttribute("cellSpacing",f+"")}if(d.caption&&d.caption.tagName=="CAPTION"){d.caption.style.border=b}},_getTableCellStyle:function(A,h){if(A==null||A.tagName!="TABLE"){return null}var y="1",s="solid",u="black";var g="",b="",k="",o="",f="",C="";var w=null;if(h!=null&&typeof h!="undefined"&&h.tagName=="TD"){w=h}else{if(A.rows){var d=A.rows.length;if(d>0){var B=A.rows[d-1];var z=B.cells.length;if(z>0){w=B.cells[z-1]}}}}if(w!=null){g=w.getAttribute("style");k=w.getAttribute("width");o=w.getAttribute("height");f=w.vAlign;C=w.align;if(w.style.borderLeftWidth){y=parseInt(w.style.borderLeftWidth,10)}if(w.style.borderLeftStyle){s=w.style.borderLeftStyle}if(w.style.borderLeftColor){u=w.style.borderLeftColor}_borderstring=y+"px "+s+" #"+u}var v={style:g,borderString:b,width:k,height:o,valign:f,halign:C,size:y,type:s,color:u};return v},_setTableCellStyle:function(h,v,b,f,d,s,k,g){if(v==null||v.tagName!="TABLE"){return}var u=v.cells;for(c=0;c<u.length;c++){var o=u[c];if(h||o.className=="temp_cell"){o.className="";if(b){o.setAttribute("style",b);if(o.style.fontSize.length==0){o.style.fontSize=b.fontSize}}o.style.border=f;if(k!=null){o.vAlign=k}if(g!=null){o.align=g}}if(d!=null){o.setAttribute("width",d)}if(s!=null){o.setAttribute("height",s)}}},_renderCellPropertiesWindow:function(){var s=YAHOO.util.Dom,z=YAHOO.util.Event,v=YAHOO.lang;var y="ltr";if(this.get("rtl")){y="rtl"}var w=this.get("id");var d=this.currentElement[0];this._defaultTableToolbarConfig.rtl=this.get("rtl");var b={};var k=document.createElement("div");k.style.width="100%";k.id=w+"_cell_toolbar";v.augmentObject(b,this._defaultCellToolbarConfig);var g=new YAHOO.widget.Toolbar(k,b);g.editor_el=d;this._defaultCellToolbar=g;var B=g.get("cont");g.on("colorPickerClicked",function(E){if(E.button=="cellbackgroundcolor"){this._tableCell.style.backgroundColor="#"+E.color}else{if(E.button=="cellbordercolor"){var D=this._getTableCellStyle(this._table,this._tableCell);if(D!=null){var C=D.size+"px "+D.type+" #"+E.color;this._tableCell.style.border=C}}}},this,true);z.onAvailable(w+"_deleteRows",function(){z.on(w+"_deleteRows","click",function(){if(!this._tableCell){return}var D=this._getTableCellPos(this._tableCell).row;var o=$(this._table).height();var C=null;if(this._table.rows.length==1){this._table.style.display="none";this._table.parentNode.removeChild(this._table);this.closeWindow();return}C=this._table.rows[this._table.rows.length-1];o-=$(C).height();this._table.deleteRow(D);$(this._table).css("height",o+"px");this.closeWindow()},this,true)},this,true);z.onAvailable(w+"_deleteColumns",function(){z.on(w+"_deleteColumns","click",function(){if(!this._tableCell){return}var D=this._getTableCellPos(this._tableCell).column;var C=$(this._table).width();var G=this._table.rows;var I=0;for(r=0;r<G.length;r++){var H=G[r];var o=null;if(H.cells.length==1){this._table.style.display="none";this._table.parentNode.removeChild(this._table);this.closeWindow();return}var E=0;if(D&&typeof D=="number"&&D>=0&&D<H.cells.length){E=$(H.cells[D]).width();o=H.deleteCell(D)}else{E=$(H.cells[H.cells.length-1]).width();o=H.deleteCell(H.cells.length-1)}if(I<E){I=E}}C-=I;$(this._table).css("width",C+"px");this.closeWindow()},this,true)},this,true);g.on("buttonClick",function(D){if(!this._tableCell){return}var O=D.button.value;var E="";if(D.button.menucmd){O=D.button.menucmd}var J=0;var G=0;switch(O){case"cellbordersize":var S=this._getTableCellStyle(this._table,this._tableCell);if(S!=null){E=parseInt(D.button.value,10)+"px "+S.type+" "+S.color;this._tableCell.style.border=E;if(parseInt(D.button.value,10)>0){g.enableButton("cellbordertype");g.enableButton("cellbordercolor")}else{g.disableButton("cellbordertype");g.disableButton("cellbordercolor")}}this._updateMenuChecked("cellbordersize",D.button.value,g);break;case"cellbordertype":var K=this._getTableCellStyle(this._table,this._tableCell);E=K.size+"px "+D.button.value+" "+K.color;this._tableCell.style.border=E;this._updateMenuChecked("cellbordertype",D.button.value,g);break;case"cellvalignment":var R=g.getButtonById(D.button.id);var H="";switch(D.button.value){case"top":H="top";break;case"center":H="middle";break;case"bottom":H="bottom";break}this._tableCell.vAlign=H;this._updateMenuChecked("cellvalignment",H,g);break;case"cellhalignment":var R=g.getButtonById(D.button.id);var H="";switch(D.button.value){case"left":H="left";break;case"center":H="center";break;case"right":H="right";break}this._tableCell.align=H;this._updateMenuChecked("cellhalignment",H,g);break;case"insert":var R=g.getButtonById(D.button.id);var H="";switch(D.button.value){case"insertColumnsLeft":case"insertColumnsRight":var C=D.button.value=="insertColumnsLeft"?-1:0;var I=$(this._tableCell).width();var L=$(this._table).width();J=this._getTableCellPos(this._tableCell).column;colindexPos=J+1;var V=this._table.rows;for(r=0;r<V.length;r++){var U=V[r];var Q=null;Q=U.insertCell(colindexPos+C);Q.className="temp_cell"}L+=I;$(this._table).width(L+"px");H=D.button.value;this._updateCellBorderProperties(this._tableCell);break;case"insertRowsAbove":case"insertRowsBelow":if(this._tableCell){var C=D.button.value=="insertRowsAbove"?-1:0;rowIndex=this._getTableCellPos(this._tableCell).row;var N=$(this._table).height();rowIndex=rowIndex+1;var U=null;U=this._table.insertRow(rowIndex+C);var P=this._getColumnCount(this._table);for(c=0;c<P&&U;c++){var Q=U.insertCell(0);Q.className="temp_cell"}if(U){N+=$(U).height()}$(this._table).height(N+"px")}H=D.button.value;this._updateCellBorderProperties(this._tableCell);break}break}this._updateMenuChecked("insert",H,g);g.selectButton(D.button.value);if(O!=="padding"){this.moveWindow()}},this,true);var u=document.createElement("div");u.appendChild(k);var A=document.createElement("div");A.innerHTML="<br/>";u.appendChild(A);var h=document.createElement("div");h.innerHTML='<span id="'+w+'_deleteRows" class="yui-button yui-push-button"> <span class="first-child"> <a href="#" tabindex="-1">'+getLocalizedMessage("Delete Row")+"</a></span></span>";u.appendChild(h);var A=document.createElement("div");A.innerHTML="<br/>";u.appendChild(A);var f=document.createElement("div");f.innerHTML='<span id="'+w+'_deleteColumns" class="yui-button yui-push-button"> <span class="first-child"> <a href="#" tabindex="-1">'+getLocalizedMessage("Delete Column")+"</a></span></span>";u.appendChild(f);this._windows.cellproperties={};this._windows.cellproperties.body=u;this.get("panel").editor_form.appendChild(u);this.fireEvent("windowcellpropertiesRender",{type:"windowcellpropertiesRender",panel:this.get("panel"),body:u});return u},_insertIntoEmptyElement:function(k){var o=this._getRange();var v=$(this._getDoc().body);var s=$(v).css("color");var g=$(v).css("backgroundColor");var u=$(v).css("fontFamily");var w=$(v).css("fontSize");var h="text-decoration:none;font-weight:normal;color:"+s+";background-color:"+g+";font-family:"+u+";font-size:"+w;if(!this.browser.ie||this.browser.ie>=11){var d='<span style="'+h+'">'+k+"</span><br>";this.execCommand("inserthtml",d)}else{var d='<span id="yui_new_insert_item" style="'+h+'">TEMP</span><br> ';this.execCommandSpecial("inserthtml",d);if(o.item){o=this._getRange()}o.pasteHTML(d);var b=this._getDoc().body;var f=$(b).find("#yui_new_insert_item");if(f&&f.length){while(f.length>1){$(f[f.length-1]).remove();f=$(b).find("#yui_new_insert_item")}o=b.createTextRange();o.moveToElementText(f[0]);o.select();if($(f).parents("strike,s").length>0){this._getDoc().execCommand("strikethrough")}if($(f).parents("u").length>0){this._getDoc().execCommand("underline")}if($(f).parents("em,i").length>0){this._getDoc().execCommand("italic")}if($(f).parents("strong,b").length>0){this._getDoc().execCommand("bold")}$(f).empty();$(f).html(k);setTimeout(function(){var y=$(f).next();if(y&&y.length){o.moveToElementText($(y)[0]);o.collapse(true)}else{o.moveToElementText($(f)[0]);o.collapse(false)}o.select()},0);$(f).attr("id","")}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange()},this,true);this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this})}},_fixExpandSections:function(){$(this._getDoc()).find("td.expTitleText div").replaceWith(function(){return"<span>"+$(this).html()+"</span>"});$(this._getDoc()).find("td.expDataA div").replaceWith(function(){return"<span>"+$(this).html()+"</span>"})},_isSpecialURL:function(b){if(!b||!this._isElement(b,"a")){return false}return(b.getAttribute("arschema")!==null&&b.getAttribute("arschema").length>0&&((b.getAttribute("arentryid")!=null&&b.getAttribute("arentryid").length>0)||(b.getAttribute("arqual")!=null&&b.getAttribute("arqual").length>0)))},_isElementURLBookmark:function(g){if(g&&this._isElement(g,"a")){var d=g.getAttribute("href",2);var b=AbsDocumentPath+"#";if(d&&d.indexOf(b)==0){var f=d.substring(AbsDocumentPath.length);d=f;g.setAttribute("href",d)}return(d&&d.indexOf("#")==0)}return false},_getElementURLSpecial:function(b){return $(b).clone().wrap("<div>").parent().html()},convertWindowToProperty:function(){if(!this.currentWindow){return false}var b=YAHOO.util.Dom;var z=this.get("iframe");var H=z.get("element");var G=parseInt(H.clientWidth,10);var s=parseInt(H.clientHeight,10);var E=b.getXY(H);var g=this.currentWindow,u=this.get("panel"),y=(parseInt(g.attrs.width,10)/2),w=u.cfg.getProperty("xy")||[0,0],d=u.editor_knob,B=0,o=0,A=false,k=-parseInt(g.attrs.width,10);if(this.get("rtl")&&this.browser.ie){k=G}var h=[k,0],C=[(h[0]+E[0]),(h[1]+E[1])];try{B=(C[0]-w[0]);o=(C[1]-w[1])}catch(D){}var v=E[1]+parseInt(this.get("height"),10);var f=E[0]+parseInt(this.get("width"),10);if(C[1]>v){C[1]=v}B=((B<0)?(B*-1):B);o=((o<0)?(o*-1):o);if(((B>10)||(o>10))){d.style.visibility="hidden";u.cfg.setProperty("xy",C)}return true},_getWarningImage:function(){return RelContextPath+"resources/javascript/"+ARKWGetByName(0,"VERSION").toString()+"/YUI/assets/skins/sam/editor-sprite.gif"},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return""}var b="";var d=new RegExp('"',"g");if(!this._blankImageLoaded){if(YAHOO.widget.EditorInfo.blankImage){this.set("blankimage",YAHOO.widget.EditorInfo.blankImage);this._blankImageLoaded=true}else{var f=RelContextPath+"resources/javascript/"+ARKWGetByName(0,"VERSION").toString()+"/YUI/assets/skins/sam/blankimage.png";this.set("blankimage",f);this._blankImageLoaded=true;YAHOO.widget.EditorInfo.blankImage=f}}else{b=this.get("blankimage")}return b}})}var ckeconfig=null;RichTextWidgetCK=function(f,h,g,s,o,d){this.idprefix="rtf_text_";this.fieldid=d;this.maxLength;this.externalURLFieldID;this.externalURLFieldLabel;this.externalURLFieldWidth;this._attachmentPoolField;this.bookmarks;this.rtfInPlaceID=((o==null)?null:o.id);this.windowID=f;this.setAttachmentPoolField(s);ckeconfig=g;if(h.indexOf("maintextareadiv_rtf")>-1){CKEDITOR.replace(h,g)}else{var b=$("div#arid_WIN_"+f+"_"+d);var k=$(b).find("#"+h);CKEDITOR.replace(k[0],g)}};RichTextWidgetCK.prototype.initCKEditor=function(b){CKEDITOR.replace(cktarget,ckeconfig)};RichTextWidgetCK.prototype.set=function(d,b){if(d=="maxLength"){this.maxLength=b}if(d=="externalURLFieldID"){this.externalURLFieldID=b}if(d=="externalURLFieldLabel"){this.externalURLFieldLabel=b}if(d=="externalURLFieldWidth"){this.externalURLFieldWidth=b}if(d=="bookmarks"){this.bookmarks=b}};RichTextWidgetCK.prototype.getInstance=function(d){if(CKEDITOR.instances["maintextareadiv_rtf_"+this.fieldid]!=undefined){return CKEDITOR.instances["maintextareadiv_rtf_"+this.fieldid]}var b=this.idprefix+this.fieldid;return CKEDITOR.instances[b]};RichTextWidgetCK.prototype.closeCKEditor=function(b){if(b!=undefined){CKEDITOR.instances[b].updateElement();CKEDITOR.instances[b].destroy();rtfEditor=null}else{for(var d in CKEDITOR.instances){var f=d;CKEDITOR.instances[f].updateElement();try{CKEDITOR.instances[f].destroy();rtfEditor=null}catch(g){}break}}};RichTextWidgetCK.prototype._verifyAttachments=function(b){if(b==null){b=this.getInstance().document.$}GlobalVerifyAttachments(this.windowID,b,this._attachmentPoolField)};RichTextWidgetCK.prototype.updateField=function(b){this.getInstance().updateElement()};RichTextWidgetCK.prototype.setText=function(g){var d=document.createElement("div");d.innerHTML=g;var k=$(d).find("img");if(k.length>0){for(var b=0;k.length>b;b++){var h=k[b].attributes;for(a=0;h.length>a;a++){if(h[a].name.indexOf("resizertfimage")>-1){k[b].removeAttribute(h[a].name)}}if(k[b].className!="expTitleImage"&&!(k[b].src.indexOf("ckeditor/plugins/smiley")>-1)){k[b].setAttribute("onload","resizeRTFImage("+this.windowID+","+this.fieldid+")")}else{k[b].removeAttribute("onload")}}}g=d.innerHTML;g=g.replace(/<font/g,"<span");g=g.replace(/<\/font/g,"</span");var f=this;this.getInstance().setData(g,{callback:function(){f.setAutoResize()}})};RichTextWidgetCK.prototype.setAutoResize=function(){if(!(this.getInstance().name.indexOf("maintextareadiv")>-1)){var d=F(this.windowID,this.fieldid);if(d.mAutoSizeHeight){var b=$(this.getInstance().document.$.documentElement).find(".cke_editable").height()+10;var g=0;if(d.mRTFAdvanced&&$(d.mInputNode).height()>135&&$(d.mInputNode).width()>420){g=60}if(b>d.mMinHeight){if(b>d.mMaxHeight&&d.mMaxHeight!=0){$("#arid_WIN_"+this.windowID+"_"+this.fieldid).height(d.mMaxHeight+g);$("#arid_WIN_"+this.windowID+"_"+this.fieldid).parent().height(d.mMaxHeight+g);$("#"+this.getInstance().id+"_contents").height(d.mMaxHeight)}else{$("#arid_WIN_"+this.windowID+"_"+this.fieldid).height(b+g);$("#arid_WIN_"+this.windowID+"_"+this.fieldid).parent().height(b+g);$("#"+this.getInstance().id+"_contents").height(b)}}else{if(b<d.mMinHeight){$("#arid_WIN_"+this.windowID+"_"+this.fieldid).height(d.mMinHeight+g);$("#arid_WIN_"+this.windowID+"_"+this.fieldid).parent().height(d.mMinHeight+g);$("#"+this.getInstance().id+"_contents").height(d.mMinHeight)}}}if(d.mAutoSizeWidth){var f=$(this.getInstance().document.$.documentElement).find(".cke_editable")[0].scrollWidth;$(this.getInstance().document.$.documentElement).find(".cke_editable").css("overflow","hidden");if(f>d.mMinWidth){if(f>d.mMaxWidth&&d.mMaxWidth!=0){$("#arid_WIN_"+this.windowID+"_"+this.fieldid).width(d.mMaxWidth);$("#arid_WIN_"+this.windowID+"_"+this.fieldid).parent().width(d.mMaxWidth+30);$("#"+this.getInstance().id+"_contents").width(d.mMaxWidth)}else{$("#arid_WIN_"+this.windowID+"_"+this.fieldid).width(f);$("#arid_WIN_"+this.windowID+"_"+this.fieldid).parent().width(f+30);$("#"+this.getInstance().id+"_contents").width(f)}}else{if(f<d.mMinWidth){$("#arid_WIN_"+this.windowID+"_"+this.fieldid).width(d.mMinWidth);$("#arid_WIN_"+this.windowID+"_"+this.fieldid).parent().width(d.mMinWidth+30);$("#"+this.getInstance().id+"_contents").width(d.mMinWidth)}}}}};RichTextWidgetCK.prototype.getText=function(){return this.getInstance().getData()};RichTextWidgetCK.prototype.updateText=function(k){var b=k.trim(1|2);if(b.length>0){b=b.replace(/[\u201C\u201D]/gi,'"');b=b.replace(/[\u2018\u2019]/gi,"'");b=updateRtfHtml(this.windowID,b);if(CKEDITOR.dialog._){var s=CKEDITOR.dialog._.currentTop;if(s){var d=s.definition.dialog._;if(d){if(d.name=="link"){var g=document.createElement("div");try{g.innerHTML=b}catch(h){}if(g.firstChild){var f=g.firstChild.getAttribute("href",2);var o=d.contents.info.url;o.setValue(f)}}}}}}};RichTextWidgetCK.prototype.GetEditor=function(b){return this.getInstance()};RichTextWidgetCK.prototype.clearEditorDoc=function(){};RichTextWidgetCK.prototype.setExternalURLButton=function(b){this.externalURLFieldID=b.getExternalURLFieldID();this.externalURLFieldLabel=b.getExternalURLFieldLabel();this.externalURLFieldWidth=b.getExternalURLFieldWidth()};RichTextWidgetCK.prototype.ExternalLinksClick=function(f,g){var d=this.externalURLFieldID;if(d&&d>0){var b=[];b.push({f:ExecuteWorkflow,a:[this.windowID,1,d]});new WorkflowContext(this.windowID,b)}};var rtfLastAttachFieldID=-1;RichTextWidgetCK.prototype.handleInsertImageButton=function(h){rtfLastAttachFieldID=-1;if(this._attachmentPoolField!=null||this._attachmentPoolField!="undefined"){var g=[];g=this._attachmentPoolField.GetEmptyRowIds();if(g.length>0){var b=g[0];var f=this;if(b in getFields_NS(this.windowID)){var d=getFields_NS(this.windowID)[b];rtfLastAttachFieldID=b;new WorkflowContext(this.windowID,{f:function(){var o={};var k=d.Add(o);var s=k.n.f;k.n.f=function(u){s.call(d,u);f.buildImageURL(u)};return k}})}}else{alert(getLocalizedMessage("The maximum number of image attachments for this field has already been reached ({0}).",[this._attachmentPoolField.mRowsPresent]))}}};RichTextWidgetCK.prototype.buildImageURL=function(b){if(rtfLastAttachFieldID>0&&rtfLastAttachFieldID in getFields_NS(this.windowID)){var f=getFields_NS(this.windowID)[rtfLastAttachFieldID];if(f&&f.mObj&&f.mObj.v&&f.mObj.v.mDataKey){var d="../../../../servlet/AttachServlet/"+new Date().getTime();var h=JAttachment.getURLParams("1",f.mObj.v.mDataKey);var g=d+"?ATTKey="+h;CKEDITOR.dialog.getCurrent().setValueOf("info","txtUrl",g)}}};RichTextWidgetCK.prototype.getImageURL=function(){return this.imageURL};RichTextWidgetCK.prototype.handleInsertImageWindowClose=function(g){var d=g.src;if(d){var k="?ATTKey";var h="servlet/AttachServlet";var f="sharedresources/attachment";var o=null;if(d.indexOf(k)>=0||d.indexOf(h)>=0||d.indexOf(f)>=0){if(rtfLastAttachFieldID>0&&rtfLastAttachFieldID in getFields_NS(this.windowID)){g.setAttribute("arattid",rtfLastAttachFieldID+"");g.setAttribute("arschema",ARKWGetStringByIdx(this.windowID,6));g.setAttribute("arentryid","");if(o==null||o.length==0){var b=getFields_NS(this.windowID)[rtfLastAttachFieldID];if(b!=null&&b instanceof JAttachment&&b.mObj&&b.mObj.v&&b.mObj.v.mFileName){o=getLocalizedMessage("Attachment Image: ");o+=b.mObj.v.mFileName}}}}else{g.setAttribute("arattid","");g.setAttribute("arschema","");if(d&&d.length>0){var s=(d.indexOf("\\")>=0?d.lastIndexOf("\\"):d.lastIndexOf("/"));if(s>=0&&s<d.length&&(o==null||o.length==0)){o=getLocalizedMessage("Image: ");o+=d.substring(s)}}}g.setAttribute("alt",o);g.setAttribute("title",o)}else{}rtfLastAttachFieldID=-1};RichTextWidgetCK.prototype.ToolbarVisible=function(b){};RichTextWidgetCK.prototype.setAttachmentPoolField=function(b){if(typeof b=="undefined"||b==null){this._attachmentPoolField=null;this.STR_IMAGE_HERE=this.STR_IMAGE_HERE_ORIG}else{this._attachmentPoolField=b;this.STR_IMAGE_HERE=this.STR_IMAGE_HERE_ATTACH}};RichTextWidgetCK.prototype.setTarget=function(b){if(typeof b=="undefined"||b==null||typeof b.id=="undefined"||b.id==null){this.rtfInPlaceID=null}else{this.rtfInPlaceID=b.id}};RichTextWidgetCK.prototype.fixWidget=function(){};RichTextWidgetCK.prototype.updateStatusBar=function(b){var u=this.getText();var o=u.length;var f="";var s=(this.maxLength==0?"Unlimited":this.maxLength);if(this.maxLength!=0&&o>this.maxLength){f="<a tabindex='-1' class='cke_path_item' role='button' hidefocus='true' href='javascript:void(0)' style='color:#ff0000'>";f=f+getLocalizedMessage("Total Length Exceeded! {0} (Max: {1})",[o,s])}else{f="<a tabindex='-1' class='cke_path_item' role='button' hidefocus='true' href='javascript:void(0)'>";f=f+getLocalizedMessage("Total Length: {0} (Max: {1})",[o,s])}f=f+"</a>";$("#"+this.getInstance().id+"_path").html(f);var g=$("#popup"+this.fieldid+"_"+b);var h;if(g.length>0){h=g.find("td.DIVPopupButtons")}else{h=$("div[id^='popup"+this.fieldid+"']").find("td.DIVPopupButtons")}var k=h.find("#ckeditor_status_div");if(k.length==0){var d="<div id='ckeditor_status_div' style='position:absolute;left:1px'></div>";h.prepend(d);k=h.find("#ckeditor_status_div")}k.html(f)};RichTextWidgetCK.prototype.focus=function(b){this.getInstance().focus()};RichTextWidgetCK.prototype.closeWindow=function(b){if(this.currentWindow){this.focus(false)}};RichTextWidgetCK.prototype._fixExpandSections=function(){};getRTFBookmarksCK=function(o){var f=o.editable();var z=(f.isInline()&&!o.plugins.divarea)?o.document:f;var v=z.getElementsByTag("a");var b=[];var g=0;var w;while((w=v.getItem(g++))){if(w.data("cke-saved-name")||w.hasAttribute("name")){b.push({name:w.data("cke-saved-name")||w.getAttribute("name"),id:w.getAttribute("id")})}}var d=o.name.substring(o.name.lastIndexOf("_")+1,o.name.length);var k=$("[id^=rtf_text_]").not("#rtf_text_"+d).find("a");for(var u=0;k.length>u;u++){if(k[u].name&&k[u].name.length>0){var h=false;for(var s=0;b.length>s;s++){if(b[s].name==k[u].name){h=true}}if(!h){b.push({name:k[u].name,id:k[u].id})}}}return b};RichTextEditor.prototype.constructor=RichTextEditor;function RichTextEditor(b,d){if(arguments.length){this.init(b,d)}}RichTextEditor.prototype.init=function(b,d){this.mEditor=null;this.mEditing=null;this.mID=d;this.mSingleLine=false;this.mField=null;this.mShift=false;this.mHidden=false;this.mTarget=null;this.firstKeyUp=false;this.windowID=b;this.mShowToolbar=true;this.mOriginalVal=""};RichTextEditor.prototype.OnBeforeEditorKeyDown=function(d){if(d!=null&&d.ev!=null){switch(d.ev.keyCode){case 27:var b=this;setTimeout(function(){b.Close(true)},5);return false;case 13:if(this.mSingleLine){YAHOO.util.Event.stopEvent(d.ev);return false}break;case 16:this.mShift=true;break;case 9:var f=this.mField;if(f!=null){var b=this;setTimeout(function(){if(FocusMgr!=null){var g=new FormEvent(f.windowID,f.mID);if(b.mShift){g.shift=true;FocusMgr.SetFocusToPrevious(g)}else{g.shift=false;FocusMgr.SetFocusToNext(g);RTF_Close(true)}}},5)}YAHOO.util.Event.stopEvent(d.ev);return false}return true}};RichTextEditor.prototype.OnBeforeEditorKeyPress=function(b){if(b!=null&&b.ev!=null){switch(b.ev.keyCode){case 13:if(this.mSingleLine){YAHOO.util.Event.stopEvent(b.ev);return false}break}return true}};RichTextEditor.prototype.OnBeforeEditorKeyUp=function(b){if(b!=null&&b.ev!=null){switch(b.ev.keyCode){case 16:this.mShift=false;break;case 13:if(this.mSingleLine){YAHOO.util.Event.stopEvent(b.ev);this._handleEnterKey(b);return false}break;case 9:YAHOO.util.Event.stopEvent(b.ev);return false}return true}};RichTextEditor.prototype.OnEditorKeyUp=function(b){var d=false;if(b&&b.ev){var f=b.ev.keyCode;if((f>=110&&f<=123)||f==10||f==19||f==91||f==145||(f>=33&&f<=46)){d=true}}if(!d&&this.mField&&this.mField.mInputNode&&!this.firstKeyUp){this.mField.SetDirty(this.mField.mInputNode);this.firstKeyUp=true}this._handleEnterKey(b)};RichTextEditor.prototype.OnEditorKeyDown=function(b){};RichTextEditor.prototype.AfterExecCommand=function(){var b=this.mEditor.currentElement[0];if(this.mField&&this.mField.mInputNode){if(this.mEditor._hasParent(b,"table")){this.mField.SetDirty(this.mField.mInputNode)}}};RichTextEditor.prototype.CreateRTFWidget=function(s,o){if(!useLegacyRTFEditor){var b="en";var k=localeInfo.name.replace("_","-").toLowerCase();if(CKEDITOR.lang.languages[k]==1){b=k}else{if(CKEDITOR.lang.languages[k.substring(0,2)]==1){b=k.substring(0,2)}}var g='Arial/Arial,sans-serif;Arial Black/Arial Black,sans-serif;Calibri/Calibri;Comic Sans MS/Comic Sans MS;Courier New/Courier New;Garamond/Garamond,serif;Georgia/Georgia,serif;Impact/Impact,sans-serif;Lucida Sans Unicode/Lucida Sans Unicode,sans-serif;Tahoma/Tahoma,sans-serif;Times New Roman/Times New Roman,serif;Trebuchet/Trebuchet MS,sans-serif;Verdana/"Verdana",sans-serif;';var u;if(ARMTGetBrowserTypeString()=="ie"){u="8/8pt;9/9pt;10/10pt;11/11pt;12/12pt;14/14pt;16/16pt;18/18pt;20/20pt;22/22pt;24/24pt;26/26pt;28/28pt;36/36pt;48/48pt;72/72pt"}else{u="8/8.0pt;9/9.0pt;10/10.0pt;11/11.0pt;12/12.0pt;14/14.0pt;16/16.0pt;18/18.0pt;20/20.0pt;22/22.0pt;24/24.0pt;26/26.0pt;28/28.0pt;36/36.0pt;48/48.0pt;72/72.0pt"}var h={colorButton_colors:"000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,2C3E50,B22222,A52A2A,E67E22,006400,16A085,0000CD,800080,808080,4E5F70,C0392B,D35400,FF8C00,008000,1ABC9C,00F,8E44AD,999,7F8C8D,F00,E74C3C,FFA500,27AE60,2980B9,ADD8E6,9B59B6,A9A9A9,95A5A6,FFA07A,DAA520,F39C12,2ECC71,3498DB,AFEEEE,EE82EE,BDC3C7,DDD,FFFF00,FFD700,F1C40F,00FF00,40E0D0,0FF,DDA0DD,D3D3D3,ECF0F1,FFFFE0,FFF0F5,FAEBD7,F0FFF0,F0F8FF,F0FFFF,E6E6FA,FFF,FFF",colorButton_colorsPerRow:9,language:b,skin:"moono",enterMode:CKEDITOR.ENTER_BR,pasteFromWordPromptCleanup:true,disableNativeSpellChecker:false,resize_enabled:false,image_previewText:" ",linkShowAdvancedTab:false,linkShowTargetTab:false,smiley_path:RelContextPath+"resources/javascript/ckeditor/plugins/smiley/images/",baseFloatZIndex:nextZIndex,fontSize_sizes:u,font_names:g,fontSize_defaultLabel:"8",font_defaultLabel:"Font (Unknown)",extraAllowedContent:"div{text-align};table(*)[*]{*};tr(*)[*]{*};td(*)[*]{*};colgroup(*)[*]{*};col(*)[*]{*};span(*)[*];img(*)[*]{*};a(*)[*]{*};ul{*};ol{*};li{*};object(*)[*];s h1 h2 h3 h4 h5 h6 pre address ol hr sub sup;",disallowedContent:"span[lang];",toolbar:[{name:"styles",items:["Font","FontSize"]},{name:"basicstyles",items:["Bold","Italic","Underline"]},{name:"colors",items:["TextColor2","BGColor2"]},{name:"insert",items:["Table"]}],extraPlugins:"tableresize,colorbutton2",removeButtons:"",};var y=new RichTextWidgetCK(this.windowID,this.mID,h,null,s,o);this.mEditor=y;var d=this.windowID;var w=this;this.mEditor.GetEditor().on("paste",function(A){if(ARMTGetBrowserTypeString()!="ie"){if(A.data.dontFilter){var D=A.data.dataValue;var z=document.createElement("div");z.innerHTML=D;var C=false;if(z.firstElementChild&&z.firstElementChild.tagName=="SPAN"){var B=z.firstElementChild.attributes;for(a=0;B.length>a;a++){if(B[a].name.indexOf("font-size")>-1){C=true}}}if(!C){D='<span style="font-size:11.0pt;font-family:Calibri">'+D+"</span>";A.data.dataValue=D}}}},this.mEditor.GetEditor().element.$);this.mEditor.GetEditor().on("afterPaste",function(z){resizeRTFImage(d,o,100)});this.mEditor.GetEditor().on("key",function(z){if(z.data.keyCode==13){resizeRTFImage(d,o,10)}});this.mEditor.GetEditor().on("insertElement",function(B){var z=B.data.getName();if(z=="img"){var A=B.data.$;y.handleInsertImageWindowClose(A);if(w.mField&&(w.mField.mAutoSizeHeight||w.mField.mAutoSizeWidth)){setTimeout(function(){var C=w.mField.mInputNode;RTF_Close(true);setTimeout(function(){C.focus()},250)},5)}}if(z=="table"){resizeRTFImage(d,o,10)}});CKEDITOR.on("dialogDefinition",function(D){var E=D.data.name;var G=D.data.definition;var A=G.dialog;if(E=="link"){var z=G.getContents("target");var C=G.getContents("info");var B=z.get("linkTargetType");if(C.get("linkTargetType")==null){C.add(B)}if(C.get("bmcExternalLinks")!=null){C.remove("bmcExternalLinks")}}if(E=="image"){G.removeContents("advanced");G.removeContents("Link");var C=G.getContents("info");if(C.get("htmlPreview")!=null){C.get("htmlPreview").style="width:100%;"}}})}else{var f=YAHOO.util.Dom;var v=YAHOO.util.Event;var h={maxUndo:30,floatingEditor:true,insertImageButton:true,css:"html{height: 95%;} body{height: 100%; background-color: #fff; font:8pt arial,helvetica,clean,sans-serif;} p, table, pre {margin: 0;} p:empty { height: 1px;} a{color: blue;text-decoration: underline;cursor: pointer;} .warning-localfile{border-bottom: 1px dashed red !important;} .yui-busy{cursor: wait !important;} img.selected{border: 2px dotted #808080;} img{cursor: pointer !important; border: none;}",extracss:".expTable {border-color:white; border-style:solid; border-width:1; border-collapse:collapse; width: 99.7%} .expTitle, .expTitleText {cursor:pointer; font-weight:bold; color:#4E728C; border-color:white ; border-bottom-style:solid; border-bottom-width:1;} .expTitleText {width:100%} .expTitleImage {cursor: pointer} .expTitleMin {background-color:#cccccc;} .expTitleMout {background-color:#dddddd;} .expDataA {display:;padding-left:32px;} .expDataB {display:none}  font.fnt1,font.fnt1 * {font-size: 10px;} font.fnt2,font.fnt2 * {font-size: 13px;} font.fnt3,font.fnt3 * {font-size: 16px;} font.fnt4,font.fnt4 * {font-size: 18px;} font.fnt5,font.fnt5 * {font-size: 24px;} font.fnt6 ,font.fnt6 * {font-size: 32px;} font.fnt7,font.fnt7 * {font-size: 48px;} .yui-anchor {padding:1px;background-color:yellow;border-color:blue; border-style:dashed; border-width:1px;} .yui-warning-icon {background-image: url('"+RelContextPath+"resources/javascript/"+ARKWGetByName(0,"VERSION").toString()+"/YUI/assets/skins/sam/editor-sprite.gif'); background-position: 2px -1296px;background-clip: border-box; background-origin: padding-box;background-size:auto; display: inline-block; height: 18px; width: 18px;cursor: pointer}",height:"100%",width:"100%",animate:false,resize:true,dompath:true,dompathfull:false,focusAtStart:false,limitCommands:false,toolbar:{titlebar:false,collapse:true,buttons:[{group:"fontstyle",label:"",buttons:[{type:"select",title:"Font Name",label:"Arial",value:"fontname",disabled:false,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",title:"Font Size",label:"14",value:"fontsize",range:[9,75],disabled:false}]},{type:"separator"},{group:"textstyle",label:"",buttons:[{type:"push",label:getLocalizedMessage("Bold")+" (Ctrl + Shift + B)",value:"bold"},{type:"push",label:getLocalizedMessage("Italic")+" (Ctrl + Shift + I )",value:"italic"},{type:"push",label:getLocalizedMessage("Underline")+" (Ctrl + Shift + U)",value:"underline"},{type:"separator"},{type:"color",label:getLocalizedMessage("Font Color"),value:"forecolor",disabled:false},{type:"color",label:getLocalizedMessage("Background Color"),value:"backcolor",disabled:false}]}]}};YAHOO.widget.Toolbar.prototype.STR_COLLAPSE=getLocalizedMessage("Click to close the editor.");this.mEditor=new RichTextWidget(this.windowID,this.mID,h,null,s);var w=this;this.mEditor.on("toolbarLoaded",function(){this.on("editorMouseUp",function(G){var A=this._getSelectedElement();var E=this._getDoc();var z=A.getAttribute("id");if(z&&z.length>15&&z.substr(0,15)=="img_expSection_"){var C=findEXPCOLTD(A);var D=z.substr(15);if(C!=null){collapse_twisty(D,C);var B=$(A).parents(".expTable:first");if(B&&B.length>0){B=B[0];this._placeCursor(B,false)}}}},this,true);this.toolbar.on("toolbarCollapsed",function(){w.Close(true);f.removeClass(this.toolbar.get("cont").parentNode,"yui-toolbar-container-collapsed")},this,true)},this.mEditor,true);this.mEditor.on("beforeEditorKeyDown",w.OnBeforeEditorKeyDown,this,true);this.mEditor.on("beforeEditorKeyUp",w.OnBeforeEditorKeyUp,this,true);this.mEditor.on("editorKeyUp",w.OnEditorKeyUp,this,true);this.mEditor.on("afterTablePropertiesChanged",w.AfterExecCommand,this,true);this.mEditor.on("afterOpenWindow",w.AfterOpenWindow,this,true);this.mEditor.on("externalLinkClick",w.ExternalLinksClick,this,true);this.mEditor.on("editorContentLoaded",function(){this._fixExpandSections()},this.mEditor,true);this.mEditor.render();this.mHidden=false}};RichTextEditor.prototype.ExternalLinksClick=function(f,g){var d=this.mEditor.get("externalURLFieldID");if(d&&d>0){var b=[];b.push({f:ExecuteWorkflow,a:[this.windowID,1,d]});new WorkflowContext(this.windowID,b)}};RichTextEditor.prototype.AfterOpenWindow=function(h,d){var g=h.panel;var f=g.element;if(h!=null&&g!=null&&f!=null){if(parseInt(f.style.left)<0){f.style.left="5px"}var b=this.mEditor.toolbar.get("element").clientHeight;if(parseInt(f.style.top)<b){b=b+10;f.style.top=b+"px"}}};RichTextEditor.prototype.RTFValChanged=function(b){return this.mOriginalVal!==b};RichTextEditor.prototype.Close=function(f){if(this.IsVisible()){if(useLegacyRTFEditor){GlobalFindURL(this.mEditor)}var d=this.GetText();if(!useLegacyRTFEditor){this.GetEditor().closeCKEditor()}var b=this;if(f&&this.mField!=null&&this.mField.mInputNode!=null&&this.RTFValChanged(d)){this.mField.SetScreenValue(d);this.mField.SetDirty(this.mField.mInputNode)}this.Replace(null);this.HideWindow()}this.mEditing=null;this.mField=null};RichTextEditor.prototype.GetEditor=function(){return this.mEditor};RichTextEditor.prototype.GetWidgetEditor=function(){if(useLegacyRTFEditor){return this.mEditor.get("element_parent_cont").get("element")}else{return $(document.body).find("cke_rtf_editor")}};RichTextEditor.prototype.GetCurrentTarget=function(){return this.mEditing};RichTextEditor.prototype.SetHeight=function(b){var d="";if(!(typeof b=="string")){d=b+"px"}else{d=b}this.mEditor.set("height",d)};RichTextEditor.prototype.HideWindow=function(){if(!this.mHidden){this.mEditor.closeWindow(false);var b=this.GetWidgetEditor();$(b).css({visibility:"hidden",top:-9999,left:-9999});if(getFormContext(this.windowID)){if(getSplitterPane_NS(this.windowID)!=null){getSplitterPane_NS(this.windowID).ResetZIndex()}if(getResultsListPane_NS(this.windowID)!=null){getResultsListPane_NS(this.windowID).ResetZIndex()}if(getToolBarPane_NS(this.windowID)!=null){getToolBarPane_NS(this.windowID).ResetZIndex()}}this.mHidden=true}};RichTextEditor.prototype.UpdateText=function(b){if(!this.mHidden){this.mEditor.updateText(b)}};RichTextEditor.prototype.SetText=function(d){if(!this.mHidden){this.mEditor.setText(d);var b=this;this.mEditor._fixExpandSections();setTimeout(function(){b.mOriginalVal=b.mEditor.getText()},5)}};RichTextEditor.prototype.GetText=function(){var b=this.mEditor.getText();return b};RichTextEditor.prototype.ShowWindow=function(){if(this.mHidden){var b=this.GetWidgetEditor();if(this.mTarget!=null){$(b).css("zIndex",++nextZIndex)}else{var d=$(b).css("zIndex");if(!d||d.length==0||d=="auto"||parseInt(d)<nextZIndex){$(b).css("zIndex",++nextZIndex)}}if(getSplitterPane_NS(this.windowID)!=null){getSplitterPane_NS(this.windowID).SetNewZIndex(++nextZIndex)}if(getResultsListPane_NS(this.windowID)!=null){getResultsListPane_NS(this.windowID).SetNewZIndex(++nextZIndex)}if(getToolBarPane_NS(this.windowID)!=null){getToolBarPane_NS(this.windowID).SetNewZIndex(++nextZIndex)}$(b).css("visibility","visible");this._FixWidthAndHeights();this.mHidden=false}};RichTextEditor.prototype.SetWidth=function(d){var b="";if(!(typeof d=="string")){b=d+"px"}else{b=d}this.mEditor.set("width",b)};RichTextEditor.prototype.SetXY=function(f){var d=YAHOO.util.Dom;var b=this.GetWidgetEditor();if(editDiv==null){b=this.mEditor.get("element_cont").get("element")}if(b!=null){$(b).css({position:"absolute",left:f[0]+"px",top:f[1]+"px"})}};RichTextEditor.prototype.Focus=function(){if(!this.mHidden){this.mEditor.focus(true)}};RichTextEditor.prototype.UpdatePos=function(b,s,g,d,o,k,h,f){this._FixWidthAndHeights(b,s,g,d,o,k,h,f)};RichTextEditor.prototype.Show=function(h,o){if(this.mEditing==h){this.mEditor.focus(true);return}this.HideWindow();this.firstKeyUp=false;this.mShift=false;this.mField=o;var b=this.mField.GetScreenValue();var k=o.isRTFAdvanced();if(typeof k!="boolean"||k==null){k=false}this.mShowToolbar=k;this.windowID=o.windowID;this.mEditor.windowID=o.windowID;var f=o.getRTFAttachmentFieldID();var g=null;if(f>0&&f in getFields_NS(this.windowID)){g=getFields_NS(this.windowID)[f]}this.mEditor.setAttachmentPoolField(g);this.mEditor.set("maxLength",parseInt(o.mMaxLen),true);this.mEditor.set("externalURLFieldID",o.getExternalURLFieldID());this.mEditor.set("externalURLFieldLabel",o.getExternalURLFieldLabel());this.mEditor.set("externalURLFieldWidth",o.getExternalURLFieldWidth());var u=rtfGetBookmarkList(this.mField?this.mField.mInputNode:null);this.mEditor.set("bookmarks",u);this.mSingleLine=$(h).is(".sr");this.mEditor.set("singleline",this.mSingleLine);this.mEditor.setTarget(h);if(!$(h).is("#div")&&$(h).is(".rtf")){this.mEditing=h;this.SetToolbarVisible(k);var s=this;var d=null;if(ShowWaitCursor()){d=new NDXRequest();d.showRunning();weDisableStuff(this.windowID)}setTimeout(function(){s.ShowWindow();s.Replace(h);setTimeout(function(){if(b==null){b=""}s.mEditor.fixWidget();setTimeout(function(){s.SetText(b);if(d!=null){d.hideRunning();weEnableStuff(s.windowID)}s.mEditor.focus(true)},5)},5)},5)}};RichTextEditor.prototype.SetToolbarVisible=function(f){if(useLegacyRTFEditor){var d="";if(!f){d="none"}var b=this.mEditor.toolbar.get("element");if(b!=null&&b.style.display!=d){b.style.display=d}if(this.mEditor.dompath&&this.mEditor.dompath.style.display!=d){this.mEditor.dompath.style.display=d}}this.mShowToolbar=f};RichTextEditor.prototype.IsVisible=function(){return this.mEditing!=null};RichTextEditor.prototype.Replace=function(b){if(this.mTarget!=null){this.Reset()}this.mTarget=b};RichTextEditor.prototype.Reset=function(){this.mOriginalVal="";this.mEditor.clearEditorDoc()};RichTextEditor.prototype._handleEnterKey=function(d){if(d!=null&&d.ev!=null&&d.ev.keyCode==13){var b=this;new WorkflowContext(b.windowID,{f:function(f){var g=b.mField.mInputNode;var h=false;if("actb_autoCompleted" in g){if(g.actb_autoCompleted){h=true;g.actb_autoCompleted=false}}if(!h){promptBar.setToClear();return ExecuteWorkflow(b.windowID,2,b.mField.mID)}},t:b.mField,a:[d]})}};RichTextEditor.prototype._FixWidthAndHeights=function(o,k,w,s,E,v,z,B){if(typeof this.mEditing=="undefined"||this.mEditing==null){return}var b=this.mEditing;var g=$(this.GetWidgetEditor());if(g&&g.length>0){var f=this._getVisibleRectForElement(b);var d=$(b).offset();if(o==null||typeof o=="undefined"){if(f){o=f.left}else{o=d.left}}if(k==null||typeof k=="undefined"){if(f){k=f.top}else{k=d.top}}if(E==null||typeof E=="undefined"){E=$(b).width()+2}if(v==null||typeof v=="undefined"){v=$(b).height()+2}if(w==null||typeof w=="undefined"){w=E;if(f){w=f.right-f.left;w+=2}}if(s==null||typeof s=="undefined"){s=v+2;if(f){s=f.bottom-f.top;s+=2}}if(z==null||typeof z=="undefined"){z=0;if(f){z=d.left-f.left}}if(B==null||typeof B=="undefined"){B=0;if(f){B=d.top-f.top}}var h="visible";if(z<0||B<0||E!=w||v!=s||!f){h="hidden";this.mEditor.closeWindow()}var A=(f==null||s==0||w==0)?"hidden":"visible";g.css({visibility:A,left:o+"px",top:k+"px",height:s+"px",width:w+"px",overflow:h});g.find("div.yui-editor-container").css({left:z+"px",top:B+"px",height:v+"px",width:E+"px",position:"absolute"});g.find("div.first-child").css({height:"100%",width:"100%"});var D=v;var G=this.mShowToolbar;if(this.mShowToolbar){var C=v*E;if(v<136||E<370||C<50320){D=v;this.SetToolbarVisible(false);$(this.mEditor.dompath).css("display","none");G=false}else{$(this.mEditor.dompath).css("display","");D=D-$(g).find("div#rtf_editor_toolbar").height();D=D-$(g).find("div#rtf_editor_dompath").height();D=D-8}}g.find("div.yui-editor-editable-container").css({width:"100%",height:(G?D+"px":"100%")});this.mEditor.set("height",(G?D+"px":"100%"));var u=this;g.find("iframe#rtf_editor_editor").each(function(y,H){$(H).parent().css({overflow:(u.mSingleLine?"hidden":"visible")});$(H).attr("scrolling",(u.mSingleLine?"no":"auto"));$(H).css({height:(G?D+"px":"100%"),overflow:"visible",width:(u.mSingleLine?"800%":"100%")})})}};RichTextEditor.prototype.IsEditing=function(b){return this.IsVisible()&&this.mField&&this.mField.mID===b};RichTextEditor.prototype._getVisibleRectForElement=function(g){var v={left:0,top:0,bottom:Infinity,right:Infinity};var h=document.body;var d=false;var s=false;var w=false;var y=null;s=true;if(!s&&document.documentElement){y=document.documentElement}else{y=document.body}var k=$(g).offset();v.left=k.left;v.top=k.top;v.right=k.left+$(g).innerWidth();v.bottom=k.top+$(g).innerHeight();var z;for(var b=$(g).offsetParent();$(b).length>0&&$(b)[0]&&$(b)[0]!=h&&$(b)[0].nodeName.toLowerCase()!="html";b=$(b).offsetParent()){var f=$(b)[0];if((!d||f.clientWidth!=0)&&(!s||f.clientHeight!=0||f!=h)&&(f.scrollWidth!=f.clientWidth||f.scrollHeight!=f.clientHeight)&&$(f).css("overflow")!="visible"){k=$(f).offset();v.top=Math.max(v.top,k.top);v.right=Math.min(v.right,k.left+f.clientWidth);v.bottom=Math.min(v.bottom,k.top+f.clientHeight);v.left=Math.max(v.left,k.left);z=z||f!=y}}var u=y.scrollLeft;var o=y.scrollTop;if(s){v.left+=u;v.top+=o}else{v.left=Math.max(v.left,u);v.top=Math.max(v.top,o)}if(!z||s){v.right+=u;v.bottom+=o}v.right=Math.min(v.right,u+$(window).width());v.bottom=Math.min(v.bottom,o+$(window).height());return v.top>=0&&v.left>=0&&v.bottom>v.top&&v.right>v.left?v:null};RichTextEditPopup.prototype=new DIVPopup();RichTextEditPopup.prototype.constructor=RichTextEditPopup;RichTextEditPopup.superclass=DIVPopup.prototype;var currentRTFPopup=null;var currentEditorDoc=null;var currentEditor=null;var bSpellFetched=false;var spellSelectedID=0;var spellSelectedPos=0;var spellWordCollection=[];var spellCount=0;var spellArWordHL=[];var spellArWordID=[];function GlobalFindURL(d){if(d!=null&&d!="undefined"){var b=d._getSelectedElement();if(b!=null&&typeof b!="undefined"&&typeof b.innerHTML!="undefined"){d._findURL(b);d.innerHTML=b.innerHTML}}}function GetRTFPopup(b){if(currentRTFPopup==null){currentRTFPopup=new RichTextEditPopup(b);currentRTFPopup.SetOrigin();currentRTFPopup.SetContents()}else{if(currentRTFPopup.IsVisible()){currentRTFPopup.OnOK()}currentRTFPopup.RefreshContents(b)}return currentRTFPopup}RichTextEditPopup.prototype.CreateRTFWidget=function(h,d){if(this.popupEditor){return}var f=null;var b=[];b.push({f:function(){if(ShowWaitCursor()){f=new NDXRequest();f.showRunning()}return{}},t:this});var g=rtfGetBookmarkList(this.mField?this.mField.mInputNode:null);b.push({f:function(){var s=this.mField.mID;var w=YAHOO.util.Dom;var o=YAHOO.util.Event;var v={bookmarks:g,externalURLFieldID:this.mField.getExternalURLFieldID(),externalURLFieldLabel:this.mField.getExternalURLFieldLabel(),externalURLFieldWidth:this.mField.getExternalURLFieldWidth(),enableSpellChecker:true,maxUndo:30,insertImageButton:true,css:"body{font:8pt arial,helvetica,clean,sans-serif;} p, table, pre {margin: 0;} p:empty { height: 1px;}",animate:false,dompath:true,dompathfull:false,resize:true,focusAtStart:true,height:"100%",width:"100%",extracss:".hover {background-color:yellow} .expTable {display:inline-block; border-color:red; border-style:dashed; border-width:1px; border-collapse:collapse; width: 99.7%} .expTitle, .expTitleText {font-weight:bold; color:#4E728C; border-color:red ; border-bottom-style:dashed; border-bottom-width:1px; } .expTitleText {width:100%} .expTitleImage {cursor: pointer} .expTitleMin {background-color:#dddddd;} .expTitleMout {background-color:#dddddd;} .expDataA {display:;padding-left:32px;} .expDataB {display:none} .MisspelledHighlight {background-color:red; color:#cccccc; font-weight:bold; cursor:pointer}   .MisspelledCurrent{background-color:red; color:#cccccc; font-weight:bold; cursor:pointer; border:solid green 5px} font.fnt1,font.fnt1 * {font-size: 10px;} font.fnt2,font.fnt2 * {font-size: 13px;} font.fnt3,font.fnt3 * {font-size: 16px;} font.fnt4,font.fnt4 * {font-size: 18px;} font.fnt5,font.fnt5 * {font-size: 24px;} font.fnt6 ,font.fnt6 * {font-size: 32px;} font.fnt7,font.fnt7 * {font-size: 48px;}  .yui-anchor {padding:1px;background-color:yellow;border-color:blue; border-style:dashed; border-width:1px;} .yui-warning-icon {background-image: url('"+RelContextPath+"resources/javascript/"+ARKWGetByName(0,"VERSION").toString()+"/YUI/assets/skins/sam/editor-sprite.gif'); background-position: 2px -1296px;background-clip: border-box; background-origin: padding-box;background-size:auto; display: inline-block; height: 18px; width: 18px;cursor: pointer}"};var k=this.mField?this.mField.windowID:this.windowID;var u=new RichTextWidget(k,h,v,null);this.popupEditor=u;u._defaultToolbar.buttonType="advanced";u.on("afterOpenWindow",function(E,z){var D=E.panel;var B=D.element;if(E!=null&&D!=null&&B!=null){var C=B.style;if(parseInt(C.left)<0){C.left="1px"}var y=this.toolbar.get("element").clientHeight;if(parseInt(C.top)<y){y=y+20;C.top=y+"px"}}var A=(E&&E.win&&E.win.name)?E.win.name:"";if(A.length>0&&A!="spellchecker"&&currentRTFPopup&&currentRTFPopup.IsVisible()){currentRTFPopup.EnableOKButton(true)}},u,true);u.on("editorContentLoaded",function(){u.unsubscribeAll("editorContentLoaded");if(f){f.hideRunning()}u.setText(d);var z=this.get("element_cont").get("element");$(z).css({left:"0px",top:"0px","border-left":"0px","border-right":"0px","border-top":"0px","border-bottom":"0px"});$(this.dompath).css({"background-color":"#dee0e0"});$(z).find("iframe.yui-editor-editable").css({"background-color":"#ffffff"});this._fixExpandSections();var y=0;u.on("dompathContentChanged",function(){var A=$(this.dompath).height();if(A!=y){y=A;currentRTFPopup.FixWidthAndHeights(null)}},this,true);this.on("editorKeyDown",function(){currentRTFPopup.EnableOKButton(true)},this,true);this.on("externalLinkClick",function(){var B=this.get("externalURLFieldID");if(B&&B>0){var A=[];A.push({f:ExecuteWorkflow,a:[currentRTFPopup.mField.windowID,1,B]});new WorkflowContext(currentRTFPopup.mField.windowID,A)}},this,true);setTimeout(function(){u.resizeWindow();u.focus(true)},5)},u,true);u.on("toolbarLoaded",function(){var C={type:"push",label:this.STRIKE,value:"strikethrough",disabled:true};this.toolbar.addButtonToGroup(C,"textstyle");this._disabled.push("strikethrough");var z={group:"ccp",label:"&nbsp;",buttons:[{type:"push",label:this.STR_LABEL_CUT+" (Ctrl + X)",value:"cut",disabled:true},{type:"push",label:this.STR_LABEL_COPY+" (Ctrl + C)",value:"copy",disabled:true},{type:"push",label:this.STR_LABEL_PASTE+" (Ctrl + V)",value:"paste"}]};this.toolbar.addSeparator();this.toolbar.addButtonGroup(z);this._disabled.push("cut");this._disabled.push("copy");var B=" (Ctrl+X, Ctrl+C, Ctrl+V)";this.toolbar.on("cutClick",function(G){alert(this.STR_TEXT_CCP_MESSAGE+B)},this,true);this.toolbar.on("copyClick",function(G){alert(this.STR_TEXT_CCP_MESSAGE+B)},this,true);this.toolbar.on("pasteClick",function(G){alert(this.STR_TEXT_CCP_MESSAGE+B)},this,true);var E={type:"menu",label:this.STR_LABEL_SPECIAL,value:"special",menu:[{text:this.STR_TEXT_HR,value:"hl"},{text:this.STR_TEXT_EXPAND,value:"es"},{text:"&#162;",value:"162"},{text:"&#163;",value:"163"},{text:"&#165;",value:"165"},{text:"&#166;",value:"166"},{text:"&#169;",value:"169"},{text:"&#174;",value:"174"},{text:"&#176;",value:"176"},{text:"&#177;",value:"177"},{text:"&#183;",value:"183"},{text:"&#171;",value:"171"},{text:"&#187;",value:"187"},{text:"&#188;",value:"188"},{text:"&#189;",value:"189"},{text:"&#190;",value:"190"},{text:"&#247;",value:"247"},{text:"&#8224;",value:"8224"},{text:"&#8225;",value:"8225"},{text:"&#8364;",value:"8364"},{text:"&#8482;",value:"8482"}]};this.toolbar.addButtonToGroup(E,"insertitem");this.toolbar.on("hlClick",function(G){this.execCommand("inserthtml","<p><hr/></p>")},this,true);this.toolbar.on("162Click",function(G){this.execCommand("inserthtml","&#162;")},this,true);this.toolbar.on("163Click",function(G){this.execCommand("inserthtml","&#163;")},this,true);this.toolbar.on("165Click",function(G){this.execCommand("inserthtml","&#165;")},this,true);this.toolbar.on("166Click",function(G){this.execCommand("inserthtml","&#166;")},this,true);this.toolbar.on("169Click",function(G){this.execCommand("inserthtml","&#169;")},this,true);this.toolbar.on("174Click",function(G){this.execCommand("inserthtml","&#174;")},this,true);this.toolbar.on("176Click",function(G){this.execCommand("inserthtml","&#176;")},this,true);this.toolbar.on("177Click",function(G){this.execCommand("inserthtml","&#177;")},this,true);this.toolbar.on("183Click",function(G){this.execCommand("inserthtml","&#183;")},this,true);this.toolbar.on("171Click",function(G){this.execCommand("inserthtml","&#171;")},this,true);this.toolbar.on("187Click",function(G){this.execCommand("inserthtml","&#187;")},this,true);this.toolbar.on("188Click",function(G){this.execCommand("inserthtml","&#188;")},this,true);this.toolbar.on("189Click",function(G){this.execCommand("inserthtml","&#189;")},this,true);this.toolbar.on("190Click",function(G){this.execCommand("inserthtml","&#190;")},this,true);this.toolbar.on("247Click",function(G){this.execCommand("inserthtml","&#247;")},this,true);this.toolbar.on("8224Click",function(G){this.execCommand("inserthtml","&#8224;")},this,true);this.toolbar.on("8225Click",function(G){this.execCommand("inserthtml","&#8225;")},this,true);this.toolbar.on("8364Click",function(G){this.execCommand("inserthtml","&#8364;")},this,true);this.toolbar.on("8482Click",function(G){this.execCommand("inserthtml","&#8482;")},this,true);this.toolbar.on("esClick",function(G){theNumber=0;var I;if(this._getDoc().getElementsByClassName){I=this._getDoc().getElementsByClassName("expTable")}else{I=this._getDoc().getElementsByName("expandTable")}for(x=0;x<I.length;x++){if(Number(I[x].getAttribute("count"))>theNumber){theNumber=Number(I[x].getAttribute("count"))}}newCount=theNumber+1;var J=this.STR_TEXT_EXP_HEADER;var L=this.STR_TEXT_EXP_TEXT;var H='width="100%"';H="";var K='<table class="expTable" id="expandTable" count="'+newCount+'" width="100%" style="table-layout:fixed;"><tr class="expTitleMout" onmouseover="className=\'expTitleMin\'" onmouseout="className=\'expTitleMout\'"><td class="expTitle" width="18" valign="top"><span width="100%" contenteditable="false" ><img id="img_expSection_'+newCount+'" class="expTitleImage" src="'+(AbsContextPath+"resources/images/twisty-down-blue.gif")+'"></span></td><td '+H+' class="expTitleText"><span>'+J+'</span></td></tr><tr><td class="expDataA" id="expSection_'+newCount+'" colspan="2"><span>'+L+"</span></td></tr></table>";K+="<br>";this._insertIntoEmptyElement(K)},this,true);var y=this;this.on("editorMouseUp",function(L){var H=this._getSelectedElement();if(H&&$(H).is("img.expTitleImage")){var G=H.getAttribute("id");if(G&&G.length>15&&G.substr(0,15)=="img_expSection_"){var J=findEXPCOLTD(H);var K=G.substr(15);if(J!=null){collapse_twisty(K,J);var I=$(H).parents(".expTable:first");if(I&&I.length>0){I=I[0];this._placeCursor(I,false)}currentRTFPopup.EnableOKButton(true)}}}$(y._getDoc().body).find("img").each(function(O,Q){var P=Q.id.substring("imgRtf".length);P=parseInt(P);var N=""+Q.width+","+Q.height;if(N!=y.imgSizes[P]){currentRTFPopup.EnableOKButton(true)}})},this,true);var A={type:"push",label:this.STR_TEXT_SPELLCHECK,value:"spellchk"};this.toolbar.addButtonToGroup(A,"insertitem");var D=false;this.toolbar.on("spellchkClick",function(G){currentEditor=this;currentEditorDoc=this._getDoc();SpellChecker(true,this.windowID,this._getDoc())},this,true);this.toolbar.on("buttonClick",function(H){if(currentRTFPopup&&currentRTFPopup.IsVisible()){var G=(H&&H.button&&H.button.label)?H.button.label:"";if(G!="Spell Checker"){currentRTFPopup.EnableOKButton(true)}return true}},this,true);this.toolbar.on("colorPickerClicked",function(){if(currentRTFPopup&&currentRTFPopup.IsVisible()){currentRTFPopup.EnableOKButton(true);return true}},this,true);this.toolbar.on("fontsizeClick",function(){if(currentRTFPopup&&currentRTFPopup.IsVisible()){currentRTFPopup.EnableOKButton(true);return true}},this,true)},u,true);u.render();if(this.mField){currentRTFPopup.UpdateAttachmentField(this.mField.windowID,this.mField.getRTFAttachmentFieldID())}return{}},t:this});new WorkflowContext(this.windowID,b)};function RichTextEditPopup(b){if(arguments.length){this.init(b)}}RichTextEditPopup.prototype.PopupBodyStyle="DIVPopupBodyNoBorder";RichTextEditPopup.prototype.init=function(b){this.mTarget=null;this.popupEditor=null;this.mField=b;this.mTXTAreaDiv=null;this.mIFrameDiv=null;this.mIFrame=null;this.mReadOnly=b.GAccess()==1;this.mOKEnabled=false;RichTextEditPopup.superclass.init.call(this,0,false,true,true,true,true);this.SetSize(720,385)};RichTextEditPopup.prototype.IsVisible=function(){return(this.mDiv&&this.mDiv.style.visibility=="visible")};RichTextEditPopup.prototype.RefreshContents=function(y){var o="popup";var u="handle";var k="title";if(this.mField!=null){var A=this.mField.mID;var g=this.mField.windowID;if(A==0){A=this.mField.mInputNode.id}var d=A+"_"+g;o+=d;u+=d;k+=d}var s=$(this.mDiv).find("#"+o);var f=$(this.mDiv).find("#"+u);var w=$(this.mDiv).find("#"+k);this.mField=y;this.mReadOnly=(y.GAccess()==1);if(this.mField!=null){var A=this.mField.mID;var g=this.mField.windowID;if(A==0){A=this.mField.mInputNode.id}var d=A+"_"+g;$(s).attr("id","popup"+d);$(f).attr("id","handle"+d);$(w).attr("id","title"+d);this.windowID=g;if(this.popupEditor){this.popupEditor.windowID=g}}var b=(getARStateCurrent_NS(this.windowID)==4)?getARTitles_NS(this.windowID).pluralLong:getARTitles_NS(this.windowID).singleLong;if(b==""){b=ARKWGetStringByIdx(this.windowID,6)}var v=getLocalizedMessage("{0} -- {1}",[b,this.mField.GLabel()]);this.ChangeTitle(v);var z=this.mField.GetScreenValue();if(z==null){z=""}if(!this.mReadOnly){if(this.mField){this.UpdateAttachmentField(this.windowID,this.mField.getRTFAttachmentFieldID());this.popupEditor.set("externalURLFieldID",this.mField.getExternalURLFieldID())}var B=rtfGetBookmarkList(this.mField?this.mField.mInputNode:null);this.popupEditor.set("bookmarks",B);this.SetText(z);var h=this.popupEditor;h.fixWidget();setTimeout(function(){h.resizeWindow()},2)}else{this.SetText(z)}};RichTextEditPopup.prototype.SetContents=function(){var h=this.mField.GetScreenValue();if(h==null){h=""}var g=1;var f=[];var k="editor_popup";this.mTextId=k;f.push(RichTextEditPopup.GetTextareaMarkup(k,g++,this.mReadOnly,(this.mReadOnly?h:"")));var b=(getARStateCurrent_NS(this.windowID)==4)?getARTitles_NS(this.windowID).pluralLong:getARTitles_NS(this.windowID).singleLong;if(b==""){b=ARKWGetStringByIdx(this.windowID,6)}var d=getLocalizedMessage("{0} -- {1}",[b,this.mField.GLabel()]);RichTextEditPopup.superclass.SetContents.call(this,d,f.join(""));this.mDiv.style.overflow="visible";this.mTXTAreaDiv=document.getElementById("maintextareadiv_rtf");this.mIFrameDiv=document.getElementById("ronlyiframediv_rtf");if(this.popupEditor==null){this.mDiv.style.visibility="hidden";this.CreateRTFWidget(k,h);this.mDiv.style.visibility="visible";this.mTarget=null}if(this.mReadOnly){this.SetText(h)}};RichTextEditPopup.prototype.UpdateAttachmentField=function(b,f){var d=null;if(f>0&&f in getFields_NS(b)){d=getFields_NS(b)[f]}this.popupEditor.setAttachmentPoolField(d);this.popupEditor.set("maxLength",parseInt(this.mField.mMaxLen),true)};RichTextEditPopup.prototype.OnResize=function(d,f,g,b){if(g!=b||f!=d){this.FixWidthAndHeights(null)}RichTextEditPopup.superclass.OnResize.call(d,f,g,b)};RichTextEditPopup.prototype.OnStartDrag=function(){RichTextEditPopup.superclass.OnStartDrag.call()};RichTextEditPopup.prototype.OnEndDrag=function(){RichTextEditPopup.superclass.OnEndDrag.call()};RichTextEditPopup.prototype.ChangeTitle=function(b){var d="title";if(this.mField!=null){if(this.mField.mID!=0){d+=this.mField.mID+"_"+this.mField.windowID}else{d+=this.mField.mInputNode.id}}$("#"+d).find(".title").html(b.HTMLEncode()+"&nbsp;&nbsp;&nbsp;")};RichTextEditPopup.GetTextareaMarkup=function(h,d,f,g){var b=[];b.push("<div id='maintextareadiv_rtf_container' style='z-index:100001;overflow:visible;position:relative;width:100%;height:314px;'>");b.push("<div id='maintextareadiv_rtf' style='z-index:100001;overflow:visible;position:absolute;top:0px;left:0px;width:100%;height:100%;'>");b.push("<textarea id='"+h+"' name='"+h+"' style='width:100%;height:100%;'>");b.push(g);b.push("</textarea>");b.push("</div>");b.push("<div id='ronlyiframediv_rtf' class='text rtf' style='z-index:0;overflow:auto;position:absolute;top:0px;left:0px;width:100%;height:100%;visibility:hidden'>");b.push("</div>");b.push("</div>");return b.join("")};RichTextEditPopup.prototype.Click=function(b){this.SetFocus();if((b.element.parentNode.id||b.element.id)=="ardivpcancel"){this.OnCancel()}return false};RichTextEditPopup.prototype.SetFocus=function(){if(getOpenDIVPopup_NS(this.windowID)!=this&&getOpenDIVPopup_NS(this.windowID)!=null){var d=getCharEditPopups_NS(this.windowID).length;var b=0;if(d>0){b=parseInt(getCharEditPopups_NS(this.windowID)[d-1].mDiv.style.zIndex)}getOpenDIVPopup_NS(this.windowID).mDiv.style.zIndex=b;this.mDiv.style.zIndex=b+1;for(var f=0;f<d;f++){if(this==getCharEditPopups_NS(this.windowID)[f]){getCharEditPopups_NS(this.windowID).splice(f,1);d--;f--}}getCharEditPopups_NS(this.windowID).push(this)}setOpenDIVPopup_NS(this.windowID,this)};RichTextEditPopup.prototype.GetEditor=function(){return this.popupEditor};RichTextEditPopup.prototype.ShowCentredPopup=function(d){var g=this.GetPosition();var b=getCharEditPopups_NS(this.windowID).length;g.x+=b*10;g.y+=b*15;getCharEditPopups_NS(this.windowID).push(this);this.ShowPopup(document.body,g.x,g.y,d);if("external" in top){try{top.external.ShowTextEditor()}catch(f){}}};RichTextEditPopup.prototype.HidePopup=function(b){this.mField.mRichTextEditBox=null;RemoveClickedPopup(this.windowID,this);if(this.popupEditor!=null){this.Reset()}$(this.mDiv).css({visibility:"hidden",top:-999,left:-999});$(this.mDiv).find("div#maintextareadiv_rtf_container").css({visiblity:"hidden",height:"314px"});$(this.mDiv).find("button#ardivpok").css({visiblity:"hidden"})};RichTextEditPopup.prototype.GetOKButton=function(){var d=this.mDiv.getElementsByTagName("button");for(var b=0;b<d.length;b++){if(d[b].id=="ardivpok"){return d[b]}}};RichTextEditPopup.prototype.EnableOKButton=function(b){if(this.mOKEnabled!=b){var d=this.GetOKButton();if(d){d.disabled=!b}this.mOKEnabled=b}};RichTextEditPopup.prototype.GetCancelButton=function(){var d=this.mDiv.getElementsByTagName("button");for(var b=0;b<d.length;b++){if(d[b].id=="ardivpcancel"){return d[b]}}};RichTextEditPopup.prototype.KeyPress=function(b){if(b.key==27){this.OnCancel()}return true};RichTextEditPopup.prototype.KeyDown=function(b){return true};RichTextEditPopup.prototype.ShowPopup=function(h,g,d,f){var k=this.GetOKButton();var o=this.GetCancelButton();$(this.mDiv).find("button").each(function(s,u){if($(u).is("#ardivpcancel")){$(u).click(function(v){})}});var b=getCharEditPopups_NS(this.windowID).length;getCharEditPopups_NS(this.windowID).push(this);RichTextEditPopup.superclass.ShowPopup.call(this,h,g,d,f);if(k){k.disabled=true;this.mOKEnabled=false}if(o){o.disabled=false}$(k).css("visibility",(this.mReadOnly?"hidden":"visible"));$(this.mDiv).css("overflow","visible");if(!this.IsVisible()){$(this.mDiv).css({visibility:"visible",display:""})}};RichTextEditPopup.prototype.ShowSingle=function(){return false};RichTextEditPopup.prototype.OnOK=function(){var f=this.popupEditor;if(f!=null){f._verifyAttachments();GlobalFindURL(f);f.closeWindow(false);var d=this.GetText();var b=this.mField.GetScreenValue();if(b==null){b=""}if(d!=b){this.mField.SetScreenValue(d);this.mField.SetDirty(this.mField.mInputNode)}this.mField.mInputNode.focus()}this.HidePopup(false)};RichTextEditPopup.prototype.OnCancel=function(){if(this.popupEditor!=null){try{var d=this.mField.GetIFrameDoc();if(d!=null){this.popupEditor._verifyAttachments(d)}}catch(b){}this.popupEditor.closeWindow(false)}this.HidePopup(false)};RichTextEditPopup.prototype.InitFocus=function(){};RichTextEditPopup.prototype.NewTextAvail=function(){var d=this.GetOKButton();var b=this.popupEditor;if(d&&!d.disabled&&b!=null){if(this.GetText()!=this.mField.mInputNode.value){return true}}return false};RichTextEditPopup.prototype.GetText=function(){if(this.mReadOnly){return this.GetReadOnlyVal()}else{if(this.popupEditor!=null){var b=this.popupEditor.getText();return b}}return null};RichTextEditPopup.prototype.BringIFrameToTop=function(){this.InitReadOnlyFrame();$(this.mTXTAreaDiv).css({visibility:"hidden",display:"none","z-index":0});$(this.mIFrameDiv).css({visibility:"visible",display:"inline","z-index":++nextZIndex})};RichTextEditPopup.prototype.BringTextareaToTop=function(){$(this.mTXTAreaDiv).css({visibility:"visible",display:"inline","z-index":++nextZIndex});$(this.mIFrameDiv).css({visibility:"hidden",display:"none","z-index":0})};RichTextEditPopup.prototype.SetText=function(d){if(this.mReadOnly){this.BringIFrameToTop();this.SetReadOnlyVal(d)}else{if(this.popupEditor!=null){this.BringTextareaToTop();var b=this.popupEditor;setTimeout(function(){if(d==null){d=""}b.setText(d);b._fixExpandSections();b.focus(true)},50)}}};RichTextEditPopup.prototype.UpdateText=function(b){if(this.mReadOnly){this.SetReadOnlyVal(b)}else{if(this.popupEditor!=null){this.popupEditor.updateText(b)}}};RichTextEditPopup.prototype.Replace=function(b){if(this.mTarget!=null){this.Reset()}this.popupEditor.show(b);this.mTarget=b};RichTextEditPopup.prototype.Reset=function(){this.popupEditor.clearEditorDoc();if(this.mTarget){this.popupEditor.hide(this.mTarget);this.mTarget=null}};RichTextEditPopup.prototype.SetReadOnlyVal=function(d){if(this.mReadOnly){this.InitReadOnlyFrame();var b=this.GetIFrameDoc();if(b){if(b.tagName!="DIV"){b.body.innerHTML=d}else{b.firstChild.innerHTML=d}}this.mReadOnlyVal=d}};RichTextEditPopup.prototype.GetReadOnlyVal=function(){if(this.mReadOnly){if(typeof this.mReadOnlyVal!="undefined"&&this.mReadOnlyVal){return this.mReadOnlyVal}var b=this.GetIFrameDoc();if(b){if(b.tagName!="DIV"){return b.body.innerHTML}else{return b.firstChild.innerHTML}}}return""};RichTextEditPopup.prototype.GetIFrameDoc=function(){if(this.mReadOnly&&typeof this.mIFrame!="undefined"&&this.mIFrame!=null){if(this.mIFrame.tagName=="IFRAME"){if(this.mIFrame.contentWindow){if(this.mIFrame.contentWindow.document){return this.mIFrame.contentWindow.document}}}else{return this.mIFrame}}return null};RichTextEditPopup.prototype.InitReadOnlyFrame=function(){if(this.mReadOnly){var d=YAHOO.util.Dom,b=YAHOO.util.Event,f=YAHOO.lang;if(this.mIFrameDiv==null||this.mIFrame!=null){return}this.mIFrameDiv.innerHTML="";this.mIFrame=CreateDIVRTF("ronlyiframediv_rtf_content",false);this.mIFrameDiv.appendChild(this.mIFrame);this.mIFrame.innerHTML='<div class="rtf_text" style=background-color:#fff;></div>'}};RichTextEditPopup.prototype.CreateIFrame=function(g){var f=YAHOO.util.Dom,b=YAHOO.util.Event,k=YAHOO.lang;var o=document.createElement("iframe");o.id=this.mField.mID+"_iframe";var s="ltr";var d={title:g,dir:s,border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",rightMargin:"3px",leftMargin:"2px",topMargin:"3px",bottomMargin:"0px",allowTransparency:"true",srcVal:"javascript:;"};var h={width:"100%",height:"100%",display:"none",visibility:"visible"};$(o).attr(d);$(o).css(h);return o};RichTextEditPopup.prototype.IsEditing=function(b){return this.IsVisible()&&this.mField&&this.mField.mID===b};RichTextEditPopup.prototype.FixWidthAndHeights=function(f){var d=this.mDiv;var b=$(d).find("div#maintextareadiv_rtf_container");if(b.length>0){if(f==null||f==undefined||f<=0){f=$(b).height()}else{if(typeof f=="string"){f=parseInt(f)}}$(b).css({height:f+"px",width:"100%"});$(b).find("div#editor_popup_container").css({width:"100%",height:"100%"});$(b).find("div.first-child").css({height:"100%",width:"100%"});$(b).find("iframe.yui-editor-editable").css({height:"100%",width:"100%"});var g=f;g=g-$(b).find("div#editor_popup_toolbar").height();g=g-$(b).find("div#editor_popup_dompath").height();$(b).find("div.yui-editor-editable-container").css({width:"100%",height:g+"px"});this.popupEditor.set("height",g+"px")}};function SpellChecker(f,g){var d=getLocalizedMessage("Checking...");if(!f){bSpellFetched=false;unHighlight();for(i=spellArWordID.length-1;i>0;i--){spellArWordID[i]=null}for(i=spellArWordHL.length-1;i>0;i--){spellArWordHL[i]=null}var o=document.getElementsByName("RW")[0];o.length=0;document.getElementsByName("RW")[0].value="";var h=document.getElementsByName("ListSuggestions")[0];if(h.length>0){h.length=0}spellSelectedID=0;spellSelectedPos=0;spellWordCollection=[];spellCount=0;spellArWordHL=[];spellArWordID=[];setTimeout(function(){currentEditor.closeWindow()},5)}else{spellSelectedID=0;spellSelectedPos=0;spellWordCollection=[];spellCount=0;spellArWordHL=[];spellArWordID=[];var b=[];var k=null;bSpellFetched=true;b.push({f:function(){setTimeout(function(){if(ShowWaitCursor()){k=new NDXRequest();k.showRunning();weDisableStuff(g);if(!currentEditor._hasSelection()){if(currentEditorDoc&&currentEditorDoc.body&&currentEditorDoc.body.normalize){$(currentEditorDoc.body).children().each(function(){$(this)[0].normalize()})}}}setTimeout(function(){var N="";var R,Q;var z;var v="";var E="";var y;var O=" ";var w;var G=false;G=true;var B=null;if(currentEditor._hasSelection()){B=currentEditor._getRange();currentEditor._clearSelection();if(B&&B.text){v=" "+B.text+" "}else{var I=currentEditor._getSelection();if(I&&I.toString){v=" "+I.toString()+" "}else{if(B&&B.toString){v=" "+B.toString()+" "}}}}else{v="";var C=function(S){$(S).contents().each(function(U,V){if(V.nodeType==3||$(V).is("a")||$(V).is("img")){v+=" "+$(V).text()+" "}else{C(V)}})};C(currentEditorDoc.body)}var L=[];var s=parseRTFText(v);if(s&&s.length>0){var H="<words>";for(var K=0;K<s.length;K++){if(allowWord(s[K])){L.push(s[K])}if(((K+1)%1000)==0||K==(s.length-1)){var J="";var D=new NDXSpellChecker(g,L,J);if(D&&D.result){var P=D.result.xml;if(P&&P.length>15){H+=P.substring(7,P.length-9)}}L=[]}}H+="</words>";var u=new DOMParser();var A=u.parseFromString(H,"text/xml");bSpellFetched=true;processData(A,B,true)}else{setTimeout(function(){currentEditor.closeWindow()},5)}if(k){k.hideRunning();weEnableStuff(g);k=null;setTimeout(function(){updateSpellingButtons()},1)}},1)},1)}});new WorkflowContext(g,b)}}function allowWord(f){if(!f||f.length<=0){return false}var d=[/^([a-zA-Z0-9_\.\-])+\@([a-zA-Z0-9\-])+$/,/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,/^((ftp|www|http|https|gopher|mailto|news|nntp|telnet|wais|files|prospero|aim|webcal)[:.A-Za-z0-9\/](([A-Za-z0-9$_.+!*\[\]\'(),;\/?:@&~=-])|%[A-Fa-f0-9]{2})+)$/];for(var b=0;b<d.length;b++){if(d[b].test(f)){return false}}return true}function eliminateDuplicates(g){if(!g||g.length<=0){return[]}var b=[],f={};for(var d=0;d<g.length;d++){f[g[d]]=0}for(d in f){b.push(d)}return b}function parseRTFText(k){var h=k.match(/[^\s-]+/g);var f=new RegExp("[0-9]");var o=new RegExp("^[<>?/\\!@#$%^&*{}[](),.;:'\"\u201D\u201C\u2019\u2018\u00B4\u0060]+$");var b=new RegExp("^[!@#$%^&*()<>?/\\,.;:'\"\u201D\u201C\u2019\u2018\u00B4\u0060]+[^!@#$%^&*()<>?/\\,.;:'\"\u201D\u201C\u2019\u2018\u00B4\u0060]+");var g=new RegExp("[^!@#$%^&*()<>?/\\,.;:'\"\u201D\u201C\u2019\u2018\u00B4\u0060]+[!@#$%^&*()<>?/\\,.;:'\"\u201D\u201C\u2019\u2018\u00B4\u0060]+$");if(h&&h.length>0){for(var d=0;d<h.length;d++){if(h[d].match(o)||h[d].match(f)){h[d]=""}else{while(h[d].match(g)){h[d]=h[d].substr(0,h[d].length-1)}while(h[d].match(b)){h[d]=h[d].substr(1)}}h[d]=h[d].replace(/\xA0/g,"");h[d]=h[d].trim(1|2,true)}return eliminateDuplicates(h)}return[]}function processData(g,k,b){if(bSpellFetched){spellWordCollection=g.getElementsByTagName("word");if(!spellWordCollection||spellWordCollection.length==0){if(b){var h=getLocalizedMessage("There are no misspelled words");setTimeout(function(){alert(h);SpellChecker(false)},5)}}else{highlightWord(k,currentEditorDoc.body,spellWordCollection);spellCount=1;wordPos();spellSelectedID=1;firstWord=currentEditorDoc.getElementById(spellArWordID[0]);if(spellArWordID.length!=0){if(firstWord){selectWord(firstWord.id.slice(5),0,firstWord.getAttribute("wc"))}}else{var f=document.getElementById("errorSpellCheck");if(f){var d=f.value;alert(d)}SpellChecker(false)}}}}function wordInRange(d,g){if(!d||!d.getBoundingClientRect||!g||!g.getBoundingClientRect){return true}var b=d.getBoundingClientRect();var f=g.getBoundingClientRect();return(b.top>=f.top&&b.left>=f.left&&b.right<=f.right&&b.bottom<=f.bottom)}function searchAndReplaceMisspelledWords(d,z,w,b,s,f){var g=w;var h=null;if(!f){f=0}var u=0;while(b&&b.length>0&&u<g.length&&g.indexOf(b,u)>=0){var y=getWordIndex((u>0?g.substring(u):g),b)+u;if(y>-1){var v="";var k="";var o="";if(d){h=currentEditorDoc.createRange();h.setStart(z,f+y);h.setEnd(z,f+y+b.length);if(!wordInRange(h,d)){u=y+b.length;continue}}v=g.substring(0,y);k=g.substring(y,y+b.length);o=searchAndReplaceMisspelledWords(d,z,g.substring(y+b.length),b,s,f+y+b.length);g=v+'<span class="MisspelledHighlight" wc="'+s+'" id="word_'+spellCount+'" pos="'+spellCount+'">'+k+"</span>"+o;spellCount++;break}else{break}}return g}function highlightWord(f,b,d){$(b).contents().filter(function(){return(this.nodeType==3&&$(this).text().trim(1|2).length>2)}).each(function(){var u=$(this).text();var s=u;var h=false;for(var g=0;g<d.length;g++){var k=g;var o=d[g].getAttribute("word");u=searchAndReplaceMisspelledWords(f,$(this)[0],u,o,k)}if(u.length!=s.length){$(this).replaceWith(u)}}).end().filter(function(){return this.nodeType!==3&&processNode(this)&&$(this).text().length>0}).each(function(){highlightWord(f,this,d)})}function getWordIndex(w,b){if(!w||w.length<=0||!b||b.length<=0){return -1}else{if(w==b){return 0}}var v=0;for(var h=0;h<w.length;h++){if(w.charCodeAt(h)==32||w.charCodeAt(h)==160){v++}else{break}}if(v>0){w=w.trim(1);if(w==b){return v}}var k="";for(var h=0;h<b.length;h++){k+="["+b.charAt(h)+"]"}var g="([ \u00A0!#$%^&*()<>?/\\,.;:'~`\"\u201D\u201C\u2019\u2018\u00B4\u0060\r\n])"+k+"([ \u00A0!#$%^&*()<>?/\\,.;:'\"~`\u201D\u201C\u2019\u2018\u00B4\u0060\r\n])";var f="(^)"+k+"([ \u00A0!#$%^&*()<>?/\\,.;:'\"~`\u201D\u201C\u2019\u2018\u00B4\u0060\r\n])";var d="([ \u00A0!#$%^&*()<>?/\\,.;:'~`\"\u201D\u201C\u2019\u2018\u00B4\u0060\r\n])"+k+"($)";var u=w.search(g);var s=w.search(f);var o=w.search(d);if(s>-1){s+=v;return s}else{if(u>-1){u++;u+=v;return u}else{if(o>-1){o++;o+=v;return o}}}return -1}function processNode(b){return !$(b).is(".MisspelledHighlight, script, button")}function wordPos(){var d=0;spanCollection=currentEditorDoc.getElementsByTagName("span");for(var b=0;spanCollection&&b<spanCollection.length;b++){if(spanCollection[b].className=="MisspelledHighlight"){spanCollection[b].setAttribute("pos",d);spellArWordID[d]=spanCollection[b].id;spellArWordHL[d]=1;d++}}}function findTOPPos(d){var b=0;if(d.offsetParent){do{b+=d.offsetTop}while(d=d.offsetParent)}return b}function findLEFTPos(b){var d=0;if(b.offsetParent){do{d+=b.offsetLeft}while(b=b.offsetParent)}return d}function selectWord(d,u,h){var g=currentEditorDoc.getElementById("word_"+spellSelectedID);if(g){g.className="MisspelledHighlight"}var v=currentEditorDoc.getElementById("word_"+d);if(v){v.className="MisspelledCurrent";if(currentEditor&&currentEditor._getWindow()){var f=currentEditor._getWindow();var b=$(f).scrollLeft();var k=($(v).width()*2)+findLEFTPos(v);var o=$(f).width()+$(f).scrollLeft();var s=k-o;if(s!=0){b+=s}b=Math.max(0,b);currentEditor._getWindow().scrollTo(b,findTOPPos(v))}}spellSelectedID=d;spellSelectedPos=u;suggestedWords(h)}function suggestedWords(g){var f=document.getElementsByName("ListSuggestions")[0];var k=document.getElementsByName("RW")[0];var d=[];if(spellWordCollection&&(spellWordCollection.length>g)&&spellWordCollection[g]){d=spellWordCollection[g].getElementsByTagName("suggest")}if(f){f.length=0}f.disabled=d.length<=0;f.setAttribute("suggestions",d.length+"");if(d.length>0){for(var b=0;b<d.length;b++){if(d[b].getAttribute("word")){theWord=d[b].getAttribute("word");f[b]=new Option(theWord,theWord)}}if(d[0].getAttribute("word")){k.value=d[0].getAttribute("word")}else{k.value=""}}else{var h=getLocalizedMessage("No suggestions...");f[0]=new Option(h,h);k.value=""}}function isValidWord(f,d){var g=false;var b=d.duplicate();b.moveEnd("character",-1);if(f.isEqual(d)){g=true}else{if(f.isEqual(b)&&d.text.charAt(d.text.length-1)==" "){g=true}else{if(d.text.charAt(f.text.length)=="'"){g=true}else{if(d.text.trim(1|2)===f.text.trim(1|2)){g=true}}}}return g}function newSelection(){var h=document.getElementsByName("RW");var b=document.getElementsByName("ListSuggestions");if(h&&h.length>0&&b&&b.length>0){var f=b[0].value.toString();if(!f||f.length===0){b[0].disabled=false;return}h[0].value=f}var g=document.getElementsByName("ReplaceAll");var d=document.getElementsByName("ReplaceOnce");if(g&&g.length>0&&g[0].checked){replaceWord(1)}else{if(d&&d.length>0&&d[0].checked){replaceWord(2)}}updateSpellingButtons()}function replaceWord(d){var f="word_"+spellSelectedID;var g=document.getElementsByName("RW")[0].value;spellArWordHL[spellSelectedPos]=0;var b=currentEditorDoc.getElementById(f);var k=false;if(d==1){if(b){allWords(b.getAttribute("wc"),g);k=true}}else{if(d==2){if(b){changeAndUnHighlight(b,g);k=true}}else{if(d==3){if(b){allWords(b.getAttribute("wc"),$(b).text())}}else{if(d==4){if(b){changeAndUnHighlight(b,$(b).text())}}}}}if(k&&currentRTFPopup&&currentRTFPopup.IsVisible()){currentRTFPopup.EnableOKButton(true)}var h=-1;while((h=xnextWord())!=-1){nextWord=currentEditorDoc.getElementById(spellArWordID[h]);if(nextWord){selectWord(nextWord.id.slice(5),h,nextWord.getAttribute("wc"),currentEditorDoc);updateSpellingButtons();return}else{spellSelectedPos=h;spellSelectedID=h;spellArWordHL[h]=null}}SpellChecker(false)}function SetReplaceOption(d){var f=document.getElementsByName("ReplaceAll");var b=document.getElementsByName("ReplaceOnce");if(d==1&&f&&f.length>0&&f[0].checked){if(b&&b.length>0){b[0].checked=false}}if(b&&b.length>0&&b[0].checked){if(f&&f.length){f[0].checked=false}}}function allWords(d,f){var g=0;spanCollection=currentEditorDoc.getElementsByTagName("span");for(var b=spanCollection.length-1;b>=0;b--){if(spanCollection[b].getAttribute("wc")==d){spellArWordHL[spanCollection[b].getAttribute("pos")]=0;changeAndUnHighlight(spanCollection[b],f)}}}function xnextWord(){var b=0;var f=0;var d;for(var b=0;b<spellArWordHL.length-spellSelectedPos;b++){f+=spellArWordHL[b+spellSelectedPos];if(spellArWordHL[b+spellSelectedPos]==1){break}}d=spellSelectedPos+b;if(f==0){for(var b=0;b<spellArWordHL.length;b++){f+=spellArWordHL[b];if(spellArWordHL[b]==1){break}}d=b}if(f==0){return -1}else{return d}}function unHighlight(){$(currentEditorDoc).find(".MisspelledCurrent").replaceWith(function(){return $(this).contents()});$(currentEditorDoc).find(".MisspelledHighlight").replaceWith(function(){return $(this).contents()})}function outerHTML(b){if(b){return $(b).clone().wrap("<div></div>").parent().html()}}function changeAndUnHighlight(o,s){var g=$(o).parent().html();var k=outerHTML(o);if(g&&g.length>0&&k&&k.length>0){var h="";for(var d=0;d<k.length;d++){if(k[d]==="["){h+="[\\[]"}else{if(k[d]==="]"){h+="[\\]]"}else{h+="["+k[d]+"]"}}}var b=new RegExp(h,"ig");var f=g.replace(b,s);if(f&&f.length>0&&f!==g){$(o).parent().html(f)}}}function updateSpellingButtons(){var g=document.getElementById("ChangeOnceButton");var o=document.getElementById("ChangeAllButton");var s=document.getElementById("ReplaceAll");var f=document.getElementById("ReplaceOnce");var k=document.getElementsByName("RW");var d=document.getElementsByName("ListSuggestions");var h=false;if(d&&d.length>0){if(d[0].getAttribute("suggestions")=="0"){h=true}else{h=false}d[0].disabled=h;for(var b=0;b<d[0].childNodes.length;b++){d[0].childNodes[b].disabled=h}if(s){s.disabled=h}if(f){f.disabled=h}}if(k&&k.length>0&&g&&o){h=k[0].value.length<=0||k[0].value===getLocalizedMessage("Checking...");g.disabled=h;o.disabled=h}}RichTextEditPopupCK.prototype=new DIVPopup();RichTextEditPopupCK.prototype.constructor=RichTextEditPopupCK;RichTextEditPopupCK.superclass=DIVPopup.prototype;var currentRTFPopup=null;var currentEditorDoc=null;var currentEditor=null;var bSpellFetched=false;var spellSelectedID=0;var spellSelectedPos=0;var spellWordCollection=[];var spellCount=0;var spellArWordHL=[];var spellArWordID=[];function GlobalFindURLCK(b){}function GetRTFPopupCK(b){if(currentRTFPopup==null){currentRTFPopup=new RichTextEditPopupCK(b);currentRTFPopup.SetOrigin();currentRTFPopup.SetContents()}else{if(currentRTFPopup.IsVisible()){currentRTFPopup.OnOK()}currentRTFPopup.RefreshContents(b)}return currentRTFPopup}var popupEditor;RichTextEditPopupCK.prototype.CreateRTFWidget=function(o,g){if(this.popupEditor){return}for(var d in CKEDITOR.instances){var f=d;CKEDITOR.instances[f].updateElement();CKEDITOR.instances[f].destroy();rtfEditor=null}var h=null;var b=[];b.push({f:function(){if(ShowWaitCursor()){h=new NDXRequest();h.showRunning()}return{}},t:this});var k=rtfGetBookmarkList(this.mField?this.mField.mInputNode:null);b.push({f:function(){var C=this.mField.mID;var v=this.mField?this.mField.windowID:this.windowID;var s=this.windowID;var u="en";var z=localeInfo.name.replace("_","-").toLowerCase();if(CKEDITOR.lang.languages[z]==1){u=z}else{if(CKEDITOR.lang.languages[z.substring(0,2)]==1){u=z.substring(0,2)}}var w='Arial/Arial,sans-serif;Arial Black/Arial Black,sans-serif;Calibri/Calibri;Comic Sans MS/Comic Sans MS;Courier New/Courier New;Garamond/Garamond,serif;Georgia/Georgia,serif;Impact/Impact,sans-serif;Lucida Sans Unicode/Lucida Sans Unicode,sans-serif;Tahoma/Tahoma,sans-serif;Times New Roman/Times New Roman,serif;Trebuchet/Trebuchet MS,sans-serif;Verdana/"Verdana",sans-serif;';var A;if(ARMTGetBrowserTypeString()=="ie"){A="8/8pt;9/9pt;10/10pt;11/11pt;12/12pt;14/14pt;16/16pt;18/18pt;20/20pt;22/22pt;24/24pt;26/26pt;28/28pt;36/36pt;48/48pt;72/72pt"}else{A="8/8.0pt;9/9.0pt;10/10.0pt;11/11.0pt;12/12.0pt;14/14.0pt;16/16.0pt;18/18.0pt;20/20.0pt;22/22.0pt;24/24.0pt;26/26.0pt;28/28.0pt;36/36.0pt;48/48.0pt;72/72.0pt"}var y={colorButton_colors:"000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,2C3E50,B22222,A52A2A,E67E22,006400,16A085,0000CD,800080,808080,4E5F70,C0392B,D35400,FF8C00,008000,1ABC9C,00F,8E44AD,999,7F8C8D,F00,E74C3C,FFA500,27AE60,2980B9,ADD8E6,9B59B6,A9A9A9,95A5A6,FFA07A,DAA520,F39C12,2ECC71,3498DB,AFEEEE,EE82EE,BDC3C7,DDD,FFFF00,FFD700,F1C40F,00FF00,40E0D0,0FF,DDA0DD,D3D3D3,ECF0F1,FFFFE0,FFF0F5,FAEBD7,F0FFF0,F0F8FF,F0FFFF,E6E6FA,FFF,FFF",colorButton_colorsPerRow:9,language:u,skin:"moono",enterMode:CKEDITOR.ENTER_BR,pasteFromWordPromptCleanup:true,disableNativeSpellChecker:false,resize_enabled:false,image_previewText:" ",linkShowAdvancedTab:false,linkShowTargetTab:false,smiley_path:RelContextPath+"resources/javascript/ckeditor/plugins/smiley/images/",baseFloatZIndex:nextZIndex,fontSize_sizes:A,font_names:w,fontSize_defaultLabel:"8",font_defaultLabel:"Font (Unknown)",extraAllowedContent:"img(*)[*];table(*)[*]{*};tr(*)[*]{*};td(*)[*]{*};colgroup(*)[*]{*};col(*)[*]{*};span(*)[*];ul{*};ol{*};object(*)[*];",disallowedContent:"span[lang];",removePlugins:"elementspath",toolbar:[{name:"styles",items:["Format","Font","FontSize"]},{name:"colors",items:["TextColor2","BGColor2"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","Subscript","Superscript","RemoveFormat"]},{name:"editing",items:["Find","Replace"]},"/",{name:"paragraph",items:["Outdent","Indent","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"paragraph",items:["NumberedList","BulletedList"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"insert",items:["Image","Table","expandcollapse","HorizontalRule","Smiley","SpecialChar"]},{name:"clipboard",items:["Cut","Copy","Paste","-","Undo","Redo"]},],extraPlugins:"expandcollapse,tableresize,colorbutton2",removeButtons:"",};popupEditor=new RichTextWidgetCK(v,"maintextareadiv_rtf_"+C,y,null,null,C);this.popupEditor=popupEditor;this.UpdateAttachmentField(v,this.mField.getRTFAttachmentFieldID());popupEditor.setExternalURLButton(this.mField);popupEditor.setText(g);var B=this.mReadOnly;popupEditor.GetEditor().on("instanceReady",function(){popupEditor.GetEditor().on("change",function(){popupEditor.updateStatusBar(s)},popupEditor.GetEditor(),true);popupEditor.GetEditor().on("beforeCommandExec",function(E){var D=E.data.name;var G=popupEditor.GetEditor().getSelection().getSelectedText();if(D=="link"&&G.length<1){alert(getLocalizedMessage("Please select link text"));E.cancel()}},popupEditor.GetEditor(),true);setTimeout(function(){var D=$("div#maintextareadiv_rtf_container");if(B){var G=D.height()+"px";$(D).find("span.cke_top").height("0px");$(D).find("span.cke_top").css("padding-top","0px");$(D).find("span.cke_top").css("padding-bottom","0px");$(D).find(".cke_contents").height(G);$(D).find("iframe.cke_wysiwyg_frame").height(G);popupEditor.GetEditor().setReadOnly(true)}else{var E=$(D).find("span.cke_top").height();var G=D.height()-E-10+"px";$(D).find(".cke_contents").height(G);$(D).find("iframe.cke_wysiwyg_frame").height(G);$("span.cke_combo__font > a").css("word-wrap","normal");$("span.cke_combo__font > a").css("width","120px");$("span.cke_combo__font > a > span.cke_combo_text").css("width","90px");popupEditor.GetEditor().focus()}},5)},popupEditor.GetEditor(),true);popupEditor.GetEditor().on("paste",function(E){if(ARMTGetBrowserTypeString()!="ie"){if(E.data.dontFilter){var I=E.data.dataValue;var D=document.createElement("div");D.innerHTML=I;var H=false;if(D.firstElementChild&&D.firstElementChild.tagName=="SPAN"){var G=D.firstElementChild.attributes;for(a=0;G.length>a;a++){if(G[a].name.indexOf("font-size")>-1){H=true}}}if(!H){I='<span style="font-size:11.0pt;font-family:Calibri">'+I+"</span>";E.data.dataValue=I}}}},popupEditor.GetEditor().element.$);popupEditor.GetEditor().on("afterPaste",function(D){});popupEditor.GetEditor().on("dialogHide",function(D){if(D.data.getName()=="image"){}});popupEditor.GetEditor().on("insertElement",function(G){var D=G.data.getName();if(D=="img"){var E=G.data.$;popupEditor.handleInsertImageWindowClose(E)}});popupEditor.GetEditor().on("contentDom",function(){this.document.$.onclick=function(G){G.preventDefault();var E=G.target;var D=E.getAttribute("id");var I=(E.tagName=="IMG"&&(E.className.indexOf("expTitleImage")!=-1||(D!=null&&D.substr(0,15)=="img_expSection_")));if(I){var H=findEXPCOLTD(E);if(H!=null){collapse_twisty(0,H,popupEditor.windowID,popupEditor.fieldid,false,true)}}}},popupEditor.GetEditor(),true);CKEDITOR.on("dialogDefinition",function(P){var G=P.data.name;var K=P.data.definition;var N=K.dialog;N.on("ok",function(X){if(G=="link"){var aa=CKEDITOR.dialog.getCurrent().getValueOf("info","url");var Z=CKEDITOR.dialog.getCurrent().getValueOf("info","linkType");if(aa.indexOf("OpenExternalArticle")>-1){CKEDITOR.dialog.getCurrent().setValueOf("info","linkTargetType","_parent")}if(Z=="anchor"){CKEDITOR.dialog.getCurrent().setValueOf("info","linkTargetType","_self")}var Y=CKEDITOR.dialog.getCurrent().getValueOf("info","linkTargetType");CKEDITOR.dialog.getCurrent().setValueOf("target","linkTargetType",Y)}});N.on("cancel",function(X){});if(G=="link"){var Q=P.data.definition.getContents("info").get("url"),O=Q.validate;Q.validate=function(){if((/javascript\:/).test(this.getValue())){return true}return O.call(this)};var H=K.getContents("target");var D=K.getContents("info");var S=H.get("linkTargetType");if(D.get("linkTargetType")==null){D.add(S)}if(D.get("bmcExternalLinks")==null){if(popupEditor.externalURLFieldID>-1){D.add({type:"button",label:popupEditor.externalURLFieldLabel,id:"bmcExternalLinks",onClick:function(X){nextZIndex=N.getElement().getFirst().$.style.zIndex+1;popupEditor.ExternalLinksClick()}},"linkType")}}var L=H.get("linkTargetType");var R=D.get("linkTargetType");R.items=R.items.filter(function(X){return(X[1]=="_blank"||X[1]=="_parent")});L.items=R.items;L["default"]="_blank";R["default"]="_blank";var W=K.getContents("info").get("linkType");if(infoLinkTypeOnChangeFunc==null){infoLinkTypeOnChangeFunc=W.onChange}W.onChange=function(X){infoLinkTypeOnChangeFunc.call(this);var Y=N.getContentElement("info","linkTargetType").domId;if(this.getValue()=="email"||this.getValue()=="anchor"){$("#"+Y).css("display","none")}else{$("#"+Y).css("display","block")}return}}if(G=="image"){K.removeContents("advanced");K.removeContents("Link");var D=K.getContents("info");if(D.get("htmlPreview")!=null){D.get("htmlPreview").style="width:100%;"}if(D.get("bmcBrowse")==null){if(popupEditor._attachmentPoolField!=null&&popupEditor._attachmentPoolField!="undefined"&&!(getARStateCurrent_NS(v)==4)){D.add({type:"button",label:"Browse...",id:"bmcBrowse",onClick:function(X){nextZIndex=N.getElement().getFirst().$.style.zIndex+1;popupEditor.handleInsertImageButton()}},"txtAlt")}}else{if(popupEditor._attachmentPoolField==null||popupEditor._attachmentPoolField=="undefined"||(getARStateCurrent_NS(v)==4)){D.remove("bmcBrowse")}}}if(G=="bulletedListStyle"||G=="numberedListStyle"){var E=N.getParentEditor().lang;var D=K.getContents("info");if(D.get("bmcColorTextButton")==null){var J=N.getParentEditor().config.fontSize_sizes;var V=[];V[0]=[E.liststyle.notset,""];var U=J.split(";");for(var I=0;I<U.length;I++){V[I+1]=U[I].split("/")}D.add({type:"select",id:"bmcListSize",label:E.font.fontSize.label,style:"width:150px",align:"center",items:V,setup:function(X){var Y=X.getStyle("font-size");if(Y.indexOf("pt")>-1){Y=Y.substring(Y,Y.indexOf("pt"))}this.items.forEach(function(Z){if(Z[0]==Y){Y=Z[1]}});this.setValue(Y)},commit:function(X){var Y=this.getValue();if(Y){X.setStyle("font-size",Y)}else{X.removeStyle("font-size")}}});D.add({type:"hbox",id:"bmcColorTextButton",padding:0,widths:["80%","20%"],onLoad:function(){this.getElement().getParent().setStyle("horizontal-align","center");this.getElement().$.align="center"},children:[{type:"text",label:E.colordialog.title,id:"bmcColorText",setup:function(X){var Y=X.getStyle("color");this.setValue(Y)},commit:function(X){var Y=this.getValue();if(Y){X.setStyle("color",Y)}else{X.removeStyle("color")}}},{type:"button",label:E.table.cell.chooseColor,id:"bmcColorChoose",onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(X){this.getDialog().getParentEditor().getColorFromDialog(function(Y){if(Y){this.getDialog().getContentElement("info","bmcColorText").setValue(Y)}this.focus()},this)}}]})}}});return{}},t:this});new WorkflowContext(this.windowID,b);if(h){h.hideRunning()}currentRTFPopup.EnableOKButton(true)};var infoLinkTypeOnChangeFunc=null;function RichTextEditPopupCK(b){if(arguments.length){this.init(b)}}RichTextEditPopupCK.prototype.PopupBodyStyle="DIVPopupBodyNoBorder";RichTextEditPopupCK.prototype.init=function(b){this.mTarget=null;this.popupEditor=null;this.mField=b;this.mTXTAreaDiv=null;this.mIFrameDiv=null;this.mIFrame=null;this.mReadOnly=b.GAccess()==1;this.mOKEnabled=false;RichTextEditPopupCK.superclass.init.call(this,0,false,true,true,true,true);this.SetSize(720,385)};RichTextEditPopupCK.prototype.IsVisible=function(){return(this.mDiv&&this.mDiv.style.visibility=="visible")};RichTextEditPopupCK.prototype.RefreshContents=function(y){var o="popup";var u="handle";var k="title";if(this.mField!=null){var A=this.mField.mID;var g=this.mField.windowID;if(A==0){A=this.mField.mInputNode.id}var d=A+"_"+g;o+=d;u+=d;k+=d}var s=$(this.mDiv).find("#"+o);var f=$(this.mDiv).find("#"+u);var w=$(this.mDiv).find("#"+k);this.mField=y;this.mReadOnly=(y.GAccess()==1);if(this.mField!=null){var A=this.mField.mID;var g=this.mField.windowID;if(A==0){A=this.mField.mInputNode.id}var d=A+"_"+g;$(s).attr("id","popup"+d);$(f).attr("id","handle"+d);$(w).attr("id","title"+d);this.windowID=g;if(this.popupEditor){this.popupEditor.windowID=g}}var b=(getARStateCurrent_NS(this.windowID)==4)?getARTitles_NS(this.windowID).pluralLong:getARTitles_NS(this.windowID).singleLong;if(b==""){b=ARKWGetStringByIdx(this.windowID,6)}var v=getLocalizedMessage("{0} -- {1}",[b,this.mField.GLabel()]);this.ChangeTitle(v);var z=this.mField.GetScreenValue();if(z==null){z=""}if(!this.mReadOnly){if(this.mField){this.UpdateAttachmentField(this.windowID,this.mField.getRTFAttachmentFieldID());this.popupEditor.set("externalURLFieldID",this.mField.getExternalURLFieldID())}var B=rtfGetBookmarkList(this.mField?this.mField.mInputNode:null);this.popupEditor.set("bookmarks",B);this.SetText(z);var h=this.popupEditor;h.fixWidget()}else{this.SetText(z)}};RichTextEditPopupCK.prototype.SetContents=function(){var h=this.mField.GetScreenValue();if(h==null){h=""}var g=1;var f=[];var k="editor_popup";this.mTextId=k;f.push(RichTextEditPopupCK.GetTextareaMarkup(k,g++,this.mReadOnly,(this.mReadOnly?h:""),this.mField.mID));var b=(getARStateCurrent_NS(this.windowID)==4)?getARTitles_NS(this.windowID).pluralLong:getARTitles_NS(this.windowID).singleLong;if(b==""){b=ARKWGetStringByIdx(this.windowID,6)}var d=getLocalizedMessage("{0} -- {1}",[b,this.mField.GLabel()]);RichTextEditPopupCK.superclass.SetContents.call(this,d,f.join(""));this.mDiv.style.overflow="visible";this.mTXTAreaDiv=document.getElementById("maintextareadiv_rtf");this.mIFrameDiv=document.getElementById("ronlyiframediv_rtf");if(this.popupEditor==null){this.mDiv.style.visibility="hidden";this.CreateRTFWidget(k,h);this.mDiv.style.visibility="visible";this.mTarget=null}if(this.mReadOnly){this.SetText(h)}};RichTextEditPopupCK.prototype.UpdateAttachmentField=function(b,f){var d=null;if(f>0&&f in getFields_NS(b)){d=getFields_NS(b)[f]}this.popupEditor.setAttachmentPoolField(d);this.popupEditor.set("maxLength",parseInt(this.mField.mMaxLen),true)};RichTextEditPopupCK.prototype.OnResize=function(d,f,g,b){if(g!=b||f!=d){this.FixWidthAndHeights(null)}RichTextEditPopupCK.superclass.OnResize.call(d,f,g,b)};RichTextEditPopupCK.prototype.OnStartDrag=function(){RichTextEditPopupCK.superclass.OnStartDrag.call()};RichTextEditPopupCK.prototype.OnEndDrag=function(){RichTextEditPopupCK.superclass.OnEndDrag.call()};RichTextEditPopupCK.prototype.ChangeTitle=function(b){var d="title";if(this.mField!=null){if(this.mField.mID!=0){d+=this.mField.mID+"_"+this.mField.windowID}else{d+=this.mField.mInputNode.id}}$("#"+d).find(".title").html(b.HTMLEncode()+"&nbsp;&nbsp;&nbsp;")};RichTextEditPopupCK.GetTextareaMarkup=function(k,f,g,h,b){var d=[];d.push("<div id='maintextareadiv_rtf_container' style='z-index:100001;overflow:visible;position:relative;width:100%;height:314px;'>");d.push("<div id='maintextareadiv_rtf_"+b+"' style='z-index:100001;overflow:visible;position:absolute;top:0px;left:0px;width:100%;height:100%;'>");d.push("<textarea id='"+k+"' name='"+k+"' style='width:100%;height:100%;'>");d.push(h);d.push("</textarea>");d.push("</div>");d.push("<div id='ronlyiframediv_rtf' class='text rtf' style='z-index:0;overflow:auto;position:absolute;top:0px;left:0px;width:100%;height:100%;visibility:hidden'>");d.push("</div>");d.push("</div>");return d.join("")};RichTextEditPopupCK.prototype.Click=function(b){this.SetFocus();if((b.element.parentNode.id||b.element.id)=="ardivpcancel"){this.OnCancel()}return false};RichTextEditPopupCK.prototype.SetFocus=function(){if(getOpenDIVPopup_NS(this.windowID)!=this&&getOpenDIVPopup_NS(this.windowID)!=null){var d=getCharEditPopups_NS(this.windowID).length;var b=0;if(d>0){b=parseInt(getCharEditPopups_NS(this.windowID)[d-1].mDiv.style.zIndex)}getOpenDIVPopup_NS(this.windowID).mDiv.style.zIndex=b;this.mDiv.style.zIndex=b+1;for(var f=0;f<d;f++){if(this==getCharEditPopups_NS(this.windowID)[f]){getCharEditPopups_NS(this.windowID).splice(f,1);d--;f--}}getCharEditPopups_NS(this.windowID).push(this)}setOpenDIVPopup_NS(this.windowID,this)};RichTextEditPopupCK.prototype.GetEditor=function(){return this.popupEditor};RichTextEditPopupCK.prototype.ShowCentredPopup=function(d){var g=this.GetPosition();var b=getCharEditPopups_NS(this.windowID).length;g.x+=b*10;g.y+=b*15;getCharEditPopups_NS(this.windowID).push(this);this.ShowPopup(document.body,g.x,g.y,d);if("external" in top){try{top.external.ShowTextEditor()}catch(f){}}};RichTextEditPopupCK.prototype.HidePopup=function(b){this.mField.mRichTextEditBox=null;RemoveClickedPopup(this.windowID,this);if(this.popupEditor!=null){this.Reset()}$(this.mDiv).css({visibility:"hidden",top:-999,left:-999});$(this.mDiv).find("div#maintextareadiv_rtf_container").css({visiblity:"hidden",height:"314px"});$(this.mDiv).find("button#ardivpok").css({visiblity:"hidden"})};RichTextEditPopupCK.prototype.GetOKButton=function(){var d=this.mDiv.getElementsByTagName("button");for(var b=0;b<d.length;b++){if(d[b].id=="ardivpok"){return d[b]}}};RichTextEditPopupCK.prototype.EnableOKButton=function(b){if(this.mOKEnabled!=b){var d=this.GetOKButton();if(d){$(d).removeAttr("disabled",false)}this.mOKEnabled=b}};RichTextEditPopupCK.prototype.GetCancelButton=function(){var d=this.mDiv.getElementsByTagName("button");for(var b=0;b<d.length;b++){if(d[b].id=="ardivpcancel"){return d[b]}}};RichTextEditPopupCK.prototype.KeyPress=function(b){if(b.key==27){this.OnCancel()}return true};RichTextEditPopupCK.prototype.KeyDown=function(b){return true};RichTextEditPopupCK.prototype.ShowPopup=function(h,g,d,f){var k=this.GetOKButton();var o=this.GetCancelButton();$(this.mDiv).find("button").each(function(s,u){if($(u).is("#ardivpcancel")){$(u).click(function(v){})}});var b=getCharEditPopups_NS(this.windowID).length;getCharEditPopups_NS(this.windowID).push(this);RichTextEditPopupCK.superclass.ShowPopup.call(this,h,g,d,f);if(k){this.mOKEnabled=false}if(o){o.disabled=false}$(k).css("visibility",(this.mReadOnly?"hidden":"visible"));$(this.mDiv).css("overflow","visible");if(!this.IsVisible()){$(this.mDiv).css({visibility:"visible",display:""})}};RichTextEditPopupCK.prototype.ShowSingle=function(){return false};RichTextEditPopupCK.prototype.OnOK=function(){var f=this.popupEditor;if(f!=null){f._verifyAttachments();GlobalFindURLCK(f);var d=this.GetText();var b=this.mField.GetScreenValue();if(b==null){b=""}if(d!=b){this.mField.SetScreenValue(d);this.mField.SetDirty(this.mField.mInputNode)}var g=this.mField.mInputNode;if(this.mField&&(this.mField.mAutoSizeHeight||this.mField.mAutoSizeWidth)){setTimeout(function(){g.focus()},250)}else{g.focus()}}this.HidePopup(false)};RichTextEditPopupCK.prototype.OnCancel=function(){if(this.popupEditor!=null){try{var d=this.mField.GetIFrameDoc();if(d!=null){this.popupEditor._verifyAttachments(d)}}catch(b){}this.popupEditor.closeWindow(false)}this.HidePopup(false)};RichTextEditPopupCK.prototype.InitFocus=function(){};RichTextEditPopupCK.prototype.NewTextAvail=function(){var d=this.GetOKButton();var b=this.popupEditor;if(d&&!d.disabled&&b!=null){if(this.GetText()!=this.mField.mInputNode.value){return true}}return false};RichTextEditPopupCK.prototype.GetText=function(){if(this.mReadOnly){return this.GetReadOnlyVal()}else{if(this.popupEditor!=null){var b=this.popupEditor.getText();return b}}return null};RichTextEditPopupCK.prototype.BringTextareaToTop=function(){$(this.mTXTAreaDiv).css({visibility:"visible",display:"inline","z-index":++nextZIndex});$(this.mIFrameDiv).css({visibility:"hidden",display:"none","z-index":0})};RichTextEditPopupCK.prototype.SetText=function(d){if(this.popupEditor!=null){this.BringTextareaToTop();var b=this.popupEditor;setTimeout(function(){if(d==null){d=""}b.setText(d);b._fixExpandSections();b.focus(true)},50)}};RichTextEditPopupCK.prototype.UpdateText=function(b){if(this.mReadOnly){this.SetReadOnlyVal(b)}else{if(this.popupEditor!=null){this.popupEditor.updateText(b)}}};RichTextEditPopupCK.prototype.Replace=function(b){if(this.mTarget!=null){this.Reset()}this.popupEditor.show(b);this.mTarget=b};RichTextEditPopupCK.prototype.Reset=function(){currentRTFPopup=null};RichTextEditPopupCK.prototype.SetReadOnlyVal=function(d){if(this.mReadOnly){this.InitReadOnlyFrame();var b=this.GetIFrameDoc();if(b){if(b.tagName!="DIV"){b.body.innerHTML=d}else{b.firstChild.innerHTML=d}}this.mReadOnlyVal=d}};RichTextEditPopupCK.prototype.GetReadOnlyVal=function(){if(this.mReadOnly){if(typeof this.mReadOnlyVal!="undefined"&&this.mReadOnlyVal){return this.mReadOnlyVal}var b=this.GetIFrameDoc();if(b){if(b.tagName!="DIV"){return b.body.innerHTML}else{return b.firstChild.innerHTML}}}return""};RichTextEditPopupCK.prototype.GetIFrameDoc=function(){if(this.mReadOnly&&typeof this.mIFrame!="undefined"&&this.mIFrame!=null){if(this.mIFrame.tagName=="IFRAME"){if(this.mIFrame.contentWindow){if(this.mIFrame.contentWindow.document){return this.mIFrame.contentWindow.document}}}else{return this.mIFrame}}return null};RichTextEditPopupCK.prototype.InitReadOnlyFrame=function(){if(this.mReadOnly){var d=YAHOO.util.Dom,b=YAHOO.util.Event,f=YAHOO.lang;if(this.mIFrameDiv==null||this.mIFrame!=null){return}this.mIFrameDiv.innerHTML="";this.mIFrame=CreateDIVRTF("ronlyiframediv_rtf_content",false);this.mIFrameDiv.appendChild(this.mIFrame);this.mIFrame.innerHTML='<div class="rtf_text" style=background-color:#fff;></div>'}};RichTextEditPopupCK.prototype.CreateIFrame=function(g){var f=YAHOO.util.Dom,b=YAHOO.util.Event,k=YAHOO.lang;var o=document.createElement("iframe");o.id=this.mField.mID+"_iframe";var s="ltr";var d={title:g,dir:s,border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",rightMargin:"3px",leftMargin:"2px",topMargin:"3px",bottomMargin:"0px",allowTransparency:"true",srcVal:"javascript:;"};var h={width:"100%",height:"100%",display:"none",visibility:"visible"};$(o).attr(d);$(o).css(h);return o};RichTextEditPopupCK.prototype.IsEditing=function(b){return this.IsVisible()&&this.mField&&this.mField.mID===b};RichTextEditPopupCK.prototype.FixWidthAndHeights=function(f){var d=this.mDiv;var b=$(d).find("div#maintextareadiv_rtf_container");if(b.length>0){if(f==null||f==undefined||f<=0){f=$(b).height()}else{if(typeof f=="string"){f=parseInt(f)}}$(b).css({height:f+"px",width:"100%"});$(b).find("div#editor_popup_container").css({width:"100%",height:"100%"});$(b).find("div.first-child").css({height:"100%",width:"100%"});$(b).find("iframe.yui-editor-editable").css({height:"100%",width:"100%"});if(!useLegacyRTFEditor){var h=$(b).find("span.cke_top").height();var k=b.height()-h-(this.mReadOnly?2:10)+"px";$(b).find(".cke_contents").height(k);$(b).find("iframe.cke_wysiwyg_frame").height(k)}else{var g=f;g=g-$(b).find("div#editor_popup_toolbar").height();g=g-$(b).find("div#editor_popup_dompath").height();$(b).find("div.yui-editor-editable-container").css({width:"100%",height:g+"px"})}this.popupEditor.set("height",g+"px")}};FileEditPopup.prototype=new DIVPopup();FileEditPopup.prototype.constructor=FileEditPopup;FileEditPopup.superclass=DIVPopup.prototype;var FileEditPopups;function FileEditPopup(b){if(arguments.length){this.init(b)}}FileEditPopup.prototype.init=function(b){this.mField=b;FileEditPopup.superclass.init.call(this,b.windowID,true,true,true,false,true);this.SetSize(400,140)};FileEditPopup.prototype.SetContents=function(){var k=this.mField.G();var h=1;var f=h++;var g=[];g.push('<form class="FileForm" enctype="multipart/form-data" method="post" action="">');g.push('<span class="FileSelect">File Path:</span>');g.push('<div class="OverflowAuto">');g.push('<input type="file" name="fupload" id="fupload" size="50" artb='+f+(this.mField.GAccess()==1?" readonly":"")+" class='"+(this.mField.GAccess()==1?"readonly'>":"'>"));g.push("</div>");g.push("</form>");var b=(getARStateCurrent_NS(this.windowID)==4)?getARTitles_NS(this.windowID).pluralLong:getARTitles_NS(this.windowID).singleLong;if(b==""){b=ARKWGetStringByIdx(this.windowID,6)}var d=getLocalizedMessage("{0} -- {1}",[b,this.mField.GLabel()]);FileEditPopup.superclass.SetContents.call(this,d,g.join(""));this.mDiv.style.width="auto"};FileEditPopup.GetTitleMarkup=function(b){return"<Div class='PopupEditorTitle'><span>"+b+"</span></Div>"};FileEditPopup.prototype.Click=function(b){if(b.element.id=="fupload"){return true}return false};FileEditPopup.prototype.SetFocus=function(){var b=this.GetEditor();if(b!=null){b.focus()}};FileEditPopup.prototype.GetEditor=function(){var d=this.mDiv.getElementsByTagName("input");for(var b=0;b<d.length;b++){if(d[b].id=="fupload"){return d[b]}}return null};FileEditPopup.prototype.KeyDown=function(b){return true};FileEditPopup.prototype.KeyPress=function(b){if(b.key==27){this.HidePopup();return false}if(b.key==13||b.key==32){b.element.click();return false;return}};FileEditPopup.prototype.ShowCentredPopup=function(b){var f=this.GetPosition();this.ShowPopup(document.body,f.x,f.y,b);if("external" in top){try{top.external.ShowFileEditor()}catch(d){}}};FileEditPopup.prototype.HidePopup=function(b){this.mField.mFileEditBox=null;FileEditPopup.superclass.HidePopup.call(this,true)};FileEditPopup.prototype.OnOK=function(){var d=this.GetEditor();if(d!=null){var b=d.value;if(b!=this.mField.mInputNode.value){this.mField.SetScreenValue(b);this.mField.SetDirty(this.mField.mInputNode)}}this.HidePopup(true)};FileEditPopup.prototype.ShowPopup=function(g,f,b,d){FileEditPopup.superclass.ShowPopup.call(this,g,f,b,d);if("external" in top){try{top.external.ShowFileEditor()}catch(h){}}};FileEditPopup.prototype.InitFocus=function(){this.GetEditor().focus()};QuickReportsMenu.prototype=new Menu();QuickReportsMenu.prototype.constructor=QuickReportsMenu;QuickReportsMenu.superclass=Menu.prototype;function QuickReportsMenu(b){if(arguments.length){this.init(b)}}QuickReportsMenu.prototype.init=function(b){var d=[];this.mName=getLocalizedMessage("My Reports");QuickReportsMenu.superclass.init.call(this,b,d)};QuickReportsMenu.prototype.Open=function(g,b){var d=[];this.mMenuDef=[];var f;for(f in getquickReportsExisting_NS(this.windowID)){if(getquickReportsExisting_NS(this.windowID)[f].d==0){d.push({l:f.HTMLEncode(),v:(" new WorkflowContext ("+this.windowID+",{f:QuickReports.RunReport, a:["+this.windowID+",'"+f.EscapeQuote()+"']})")})}}this.mMenuDef.push({l:getLocalizedMessage("Run ...").JScriptEncode(),v:(d.length==0?"":d),s:(d.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Save ...").JScriptEncode(),v:"CreateQuickReport",s:(quickReportParamURL.length==0?0:1)});this.mMenuDef.push({l:getLocalizedMessage("Manage ...").JScriptEncode(),v:"ManageQuickReport",s:(getquickReportsExisting_NS(this.windowID).length==0?0:1)});return{n:{f:QuickReportsMenu.superclass.Open,t:this,a:[g,b,30100,false]}}};QuickReports.prototype.lastRun=null;var quickReportParamURL="";var quickReportParamSearch="";var quickReportRegularSearch="";var quickReportAdvancedSearchQual="";var quickReportSchema="";function QuickReports(b){this.RecentSize=b}QuickReportsMenu.prototype.HandleSelection=function(val){if(val=="CreateQuickReport"){if(getCurWFC_NS(this.windowID)!=null){return{n:{f:this.OpenSaveQuickReportsPopup,t:this}}}else{new WorkflowContext(this.windowID,{f:this.OpenSaveQuickReportsPopup,t:this})}}else{if(val=="ManageQuickReport"){if(getCurWFC_NS(this.windowID)!=null){return{n:{f:this.OpenManageQuickReportsPopup,t:this}}}else{new WorkflowContext(this.windowID,{f:this.OpenManageQuickReportsPopup,t:this})}}else{if(getCurWFC_NS(this.windowID)!=null){return{n:{f:eval,a:[val],t:this}}}else{eval(val)}}}};QuickReportsMenu.prototype.OpenSaveQuickReportsPopup=function(){var g={};var f=[];for(var d in getquickReportsExisting_NS(this.windowID)){f.push(d.HTMLEncode())}var b=this.windowID;return{n:{f:function(){if(g.result.v&&g.result.v!=-1){var s=g.result.v;var w=(s in getquickReportsExisting_NS(b))?false:true;var h=quickReportParamURL.indexOf("\\");var o=quickReportParamURL.substr(0,h-2);var y=quickReportParamURL.substring(h-1,quickReportParamURL.length-2);var k=(y.length+"").length;o=quickReportParamURL.substr(0,h-2-k);var u=quickReportParamSearch+";"+quickReportRegularSearch+";"+quickReportAdvancedSearchQual;var v=new NDXSaveQuickReport(b,s.toString(),quickReportSchema,ARKWGetStringByIdx(b,7),o+";"+u,w,false,false,new Array());if(v.result==1){quickReportParamURL="";quickReportParamSearch="";quickReportRegularSearch="";if(getcurQuickReportSize_NS(b)<getmaxQuickReportSize_NS(b)){getquickReportsExisting_NS(b)[s]={d:0,u:o+";"+u};getUDDHolderById(b).curQuickReportSize++}else{getquickReportsExisting_NS(b)[s]={d:0}}}}},a:[g]},c:{f:function(){return SaveQuickReportPopup(b,g,f)}}}};QuickReportsMenu.prototype.OpenManageQuickReportsPopup=function(){var g={};var f=[];var h={};h.h=[getLocalizedMessage("Report Name"),getLocalizedMessage("State")];h.r=[];var d;for(d in getquickReportsExisting_NS(this.windowID)){h.r.push({i:d,d:[{v:d},{v:(getquickReportsExisting_NS(this.windowID)[d].d==1?getLocalizedMessage("Disable"):getLocalizedMessage("Enable"))}]})}var b=this.windowID;return{n:{f:function(){if("v" in g.result&&g.result.v!=-1){var u={};var k=[];for(d in getquickReportsExisting_NS(b)){if(typeof g.result.v[d]!="undefined"&&getquickReportsExisting_NS(b)[d].d!=g.result.v[d]){u[d]=g.result.v[d]}if(!(d in g.result.v)){k.push(d)}}var s=[],o=[];for(d in u){getquickReportsExisting_NS(b)[d].d=u[d];s.push(d);o.push(u[d])}if(s.length>0){var w=new NDXModifyQuickReport(b,ARKWGetStringByIdx(b,7),ARKWGetStringByIdx(b,6),s,o)}if(k.length>0){var w=new NDXDeleteQuickReport(b,ARKWGetStringByIdx(b,7),ARKWGetStringByIdx(b,6),k);if(w.result==1){for(var v=0;v<k.length;v++){if(getquickReportsExisting_NS(b)[k[v]].u.length>0){getUDDHolderById(b).curQuickReportSize--}delete getquickReportsExisting_NS(b)[k[v]]}}}}},a:[g]},c:{f:function(){return ManageQuickReportPopup(b,g,h)}}}};QuickReports.getInputSaveToFile=function(d){var b=d.split(";");return b[0]};QuickReports.RunReport=function(windowID,reportname){var reporturl=getquickReportsExisting_NS(windowID)[reportname.toString()].u;var result={};if((typeof reporturl=="undefined")||((typeof reporturl!="undefined")&&reporturl.length==0)){var req=new NDXSaveQuickReport(windowID,reportname.toString(),ARKWGetStringByIdx(windowID,6),ARKWGetStringByIdx(windowID,7),"",false,true,false,[]);result=req.result}else{result.a=reporturl}var res={};var menuDef=[];if(result!=null){var params=result.a.split(";");return{n:{f:function(){var regfl={};var searchStr1="",searchStr2="";if(params[2]&&params[2].length>0){var curpos=0,paramArr=[],curStr=params[2],remainStr="";do{var begin=curStr.indexOf("/");var id=curStr.substring(0,begin);paramArr.push(id);remainStr=curStr.substr(begin+1);var second=remainStr.indexOf("/");var strlen=remainStr.substring(0,second);curpos=second+parseInt(strlen);var value=remainStr.substring(second+1,curpos+1);regfl[id]=value;curStr=remainStr.substr(curpos+2)}while(curStr.length>0);var obj=new NDXSaveQuickReport(windowID,reportname.toString(),ARKWGetStringByIdx(windowID,6),ARKWGetStringByIdx(windowID,7),"",false,false,false,paramArr).result;obj=eval(obj);searchStr1=qbeMatchString(windowID,obj.a,regfl,0)}if(res&&res.result&&res.result.v&&res.result.v!=null){var paramArr=[];for(id in res.result.v){var f=getFields_NS(windowID)[id];var v=res.result.v[id].toString();if(f){paramArr.push(id)}else{var reg=new RegExp("\\$"+id+"\\$","g");params[3]=params[3].replace(reg,v);delete res.result.v[id]}}var obj=new NDXSaveQuickReport(windowID,reportname.toString(),ARKWGetStringByIdx(windowID,6),ARKWGetStringByIdx(windowID,7),"",false,false,false,paramArr).result;obj=eval(obj);if(obj&&obj.a){searchStr2=qbeMatchString(windowID,obj.a,res.result.v,1)}}var searchStr=(searchStr1.length>0)?(searchStr1+(searchStr2.length>0?" AND "+searchStr2:"")):(searchStr2);searchStr=(searchStr.length>0)?(params[3].length>0?searchStr+" AND "+params[3]:searchStr):(params[3].length>0?params[3]:"");searchStr=new NDXParseAndEncodeQualifier(windowID,ARKWGetStringByIdx(windowID,7),ARKWGetStringByIdx(windowID,6),ARKWGetStringByIdx(windowID,17),searchStr).result;result.a=MakeReportKey(ARKWGetStringByIdx(windowID,6))+MakeReportKey(ARKWGetStringByIdx(windowID,7))+MakeReportKey(ARKWGetStringByIdx(windowID,17))+params[0]+searchStr.length+"/"+searchStr+"0/";if(result.a.search(/to-screen/)!=-1){return{c:{f:ReportToScreen,a:[windowID,true,result.a,ARKWGetStringByIdx(windowID,7)]}}}else{if(result.a.search(/to-file/)!=-1){var toFileStr="to-file: ";var initFn=QuickReports.getReportFileName(result.a);return{n:{f:function(){if("v" in res.result&&res.result.v!=-1){var url;var reportFile=QuickReports.getInputSaveToFile(res.result.v);var firstpart=result.a;if(reportFile==initFn){url=result.a}else{var initPart=firstpart.split(toFileStr);var firstPartBeforeToFile=initPart[0];var secondPart=initPart[1];var initFnLoc=secondPart.indexOf(initFn);var initFnLen=initFnLoc+initFn.length;secondPart=secondPart.substring(initFnLen);var curtofileLength=initFn.length+toFileStr.length;var curtofileLengthStr=curtofileLength+"";var curtofileLength=curtofileLength+curtofileLengthStr.length+1;var tofileLoc=firstpart.lastIndexOf(toFileStr);tofileLoc-=curtofileLengthStr.length+1;firstpart=firstpart.substring(0,tofileLoc);var newtofileLength=toFileStr.length+reportFile.length;var newtofileLengthStr=newtofileLength+"";var newtofileStr=newtofileLengthStr+"/"+toFileStr+reportFile;url=firstpart+newtofileStr+secondPart}return{c:{f:ReportToFile,a:[windowID,url,ARKWGetStringByIdx(windowID,7)]}}}},a:[res]},c:{f:function(){return ReportToFilePopup(windowID,res,menuDef,initFn)}}}}else{return{c:{f:ReportToScreen,a:[windowID,true,result.a,ARKWGetStringByIdx(windowID,7)]}}}}},a:[res]},c:{f:function(){var paramfl;if(params[1]||params[3]){if(params[1].length>0){var tokens=params[1].split("/");var len=tokens.length;for(var i=0;i<len;){var vals=tokens[i+1].split("$");if(vals!=null){if(paramfl==null){paramfl={}}paramfl[tokens[i]]=vals[1]}i=i+2}}if(params[3].length>0){var tok=params[3].match(SavedSearches.PSP);if(tok!=null){for(var i=0;i<tok.length;i++){var val=tok[i];val=val.substring(1,val.length-1);if(!ARKWIsKeywordOrEscapedKeyword(windowID,val)){if(paramfl==null){paramfl=new Object()}paramfl[val]=val}}}}if(paramfl){return ParamSearchPopup(windowID,res,paramfl)}else{return}}else{return}}}}}};function qbeMatchString(h,k,b,v){var g="",u=0;for(id in b){var d=0;var s=F(h,id);var o=true;if(s.mDataType==2||s.mDataType==3||s.mDataType==10){o=false}if(id in k){d=k[id]}var w="";if(d==1){w="'"+id+"' LIKE \"%"+b[id]+'%"'}else{if(d==2){w="'"+id+"' LIKE \""+b[id]+'%"'}else{if(o){w="'"+id+"' = \""+b[id]+'"'}else{w="'"+id+"' = "+b[id]}}}if(u!=0){g+=" AND "}g+=w;u++}return g}var start=0;QuickReports.getReportFileName=function(d){var b="to-file:";var h=true;var k="";while(h){pStr=QuickReports.next(d);if(pStr.search(/to-file/)!=-1){var g=pStr.indexOf(b,0);var f=g+b.length;k=pStr.substring(f);return k.trim(1|2)}}return k};QuickReports.next=function(g){var f=g.indexOf("/",start);var b=0;b=g.substring(start,f);f++;start=Number(f)+Number(b);var d=g.substring(f,start);return d};function SaveQuickReportPopup(b,g,f){var k=getLocalizedMessage("Save or Redefine My Report");var d=getLocalizedMessage("My Report Name");var h=getLocalizedMessage("Enter a new name, or select existing report to redefine");return weOpenModalPopup(b,(AbsContextPath+"resources/html/SaveQuickReportPopup.html"),"SaveQuickReport",{title:k,appss:GetAppStyleSheet("../../"),label:d,name:name,menu:f,desc:h,prefs:PREFS,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},g,[400,175])}function ReportToFilePopup(d,h,g,b){var o=getLocalizedMessage("Save or Redefine My Report");var f=getLocalizedMessage("Report File Name");var k=getLocalizedMessage("Enter a report file name to save as a file");return weOpenModalPopup(d,(AbsContextPath+"resources/html/SaveQuickReportPopup.html"),"ReportToFileQuickReport",{title:o,appss:GetAppStyleSheet("../../"),label:f,name:name,menu:g,desc:k,ifname:b,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(d,7),schema:ARKWGetStringByIdx(d,6),view:ARKWGetStringByIdx(d,17)},h,[400,150])}function ManageQuickReportPopup(b,d,f){var g=getLocalizedMessage("Manage My Report");return weOpenModalPopup(b,(AbsContextPath+"resources/html/ManageSearchPopup.html"),"ManageQuickReport",{title:g,appss:GetAppStyleSheet("../../"),l:f,AbsContextPath:AbsContextPath,server:ARKWGetStringByIdx(b,7),schema:ARKWGetStringByIdx(b,6),view:ARKWGetStringByIdx(b,17),cacheid:getFormDataHolderById(b).cacheid},d,[400,250])}YAHOO.util.DragDropMgr.clickTimeThresh=2147483647;function MidTierDDProxy(f,b,d){this.stopPropagationOld=null;this.lastDropTarget=null;MidTierDDProxy.superclass.constructor.apply(this,arguments)}MidTierDDProxy.startDragHandler=function(b){var d=Field_FromElement(b.element);MidTierDragDropMgrInst.lastDragSourceElement=null;if(d){MidTierDragDropMgrInst.setLastDragSourceFieldID(""+d.mID);MidTierDragDropMgrInst.lastDragSourceWinID=d.windowID;new WorkflowContext(d.windowID,{f:function(){var f={};f.c={t:d,f:d.DOMDragStart,a:[b]};return f}})}return true};YAHOO.extend(MidTierDDProxy,YAHOO.util.DDProxy,{handleMouseDown:function(d,b){if(MidTierDragDropMgrInst.currentDownedElement==false){MidTierDDProxy.superclass.handleMouseDown.apply(this,arguments)}},onMouseDown:function(f){this.stopPropagationOld=YAHOO.util.DragDropMgr.stopPropagation;YAHOO.util.DragDropMgr.stopPropagation=false;var b=Window_FromElement(f);var d=new FormEvent(b,f);MidTierDragDropMgrInst.lastMouseDownFormEvent=d;MidTierDragDropMgrInst.lastMouseDownElement=d.element;MidTierDragDropMgrInst.currentDownedElement=true},onMouseUp:function(b){MidTierDragDropMgrInst.currentDownedElement=false;FormEvent.lastMouseDownEvent=null;MidTierDragDropMgrInst.lastMouseDownFormEvent=null;if(this.stopPropagationOld!=null){YAHOO.util.DragDropMgr.stopPropagation=this.stopPropagationOld;this.stopPropagationOld=null}},startDrag:function(s,k){if(this.targets!=null){return}var b=MidTierDragDropMgrInst.lastMouseDownElement;MidTierDragDropMgrInst.lastDragSourceElement=b;FormEvent.lastMouseDownEvent.element=MidTierDragDropMgrInst.lastDragSourceElement;MidTierDDProxy.startDragHandler(FormEvent.lastMouseDownEvent);var d=Field_FromElement(b);this.mExecuteDragWorkflow(d);var g=this.getDragEl();MidTierDragDropMgrInst.setDragProxyValidDrop(false);this.iPageX=s;this.iPageY=k;YAHOO.util.Dom.addClass(g,"dndproxy");YAHOO.util.Dom.setStyle(g,"width","");YAHOO.util.Dom.setStyle(g,"height","");this.originalStyles=[];var o=YAHOO.util.DDM.getRelated(this,true);this.targets=[];this.targetsToUnlock=[];for(var h=0;h<o.length;h++){var f=o[h];var v=f.getEl();var u=Field_FromElement(v);if(!u.IsDOMVisible()){if(!f.isLocked()){this.targetsToUnlock.push(f);f.lock()}continue}if(u instanceof DView){MidTierDragDropMgrInst.createDropTargetProxy(v)}if(f.isLocked()){continue}this.targets.push(f);this.originalStyles[v.id]={borderBottomStyle:v.style.borderBottomStyle,borderLeftStyle:v.style.borderLeftStyle,borderRightStyle:v.style.borderRightStyle,borderTopStyle:v.style.borderTopStyle,borderBottomWidth:v.style.borderBottomWidth,borderLeftWidth:v.style.borderLeftWidth,borderRightWidth:v.style.borderRightWidth,borderTopWidth:v.style.borderTopWidth,borderBottomColor:v.style.borderBottomColor,borderLeftColor:v.style.borderLeftColor,borderRightColor:v.style.borderRightColor,borderTopColor:v.style.borderTopColor};YAHOO.util.Dom.setStyle(v,"border","2px solid");YAHOO.util.Dom.setStyle(v,"border-color","#2188C9 #196697 #196697 #2188C9")}},mExecuteDragWorkflow:function(d){var b=[];b.push({f:ExecuteWorkflow,a:[d.windowID,134217728,d.mID]});if(getCurWFC_NS(d.windowID)){getCurWFC_NS(d.windowID).execute(b)}else{promptBar.setToClear();new WorkflowContext(d.windowID,b)}},endDrag:function(g){if(this.targets==null){this.lastDropTarget=null;return}if(this.lastDropTarget!=null){this.animateValidDrop();MidTierDragDropMgrInst.setLastDropTargetFieldID(""+this.lastDropTarget.mID);this.mExecuteDropWorkflow(this.lastDropTarget);this.lastDropTarget=null}else{this.animateInvalidDrop()}MidTierDragDropMgrInst.removeDropTargetProxies();var d=this.getDragEl();YAHOO.util.Dom.setStyle(d,"visibility","visible");for(var b=0;b<this.targets.length;b++){var h=this.targets[b].getEl();var k=this.originalStyles[h.id];h.style.borderBottomStyle=k.borderBottomStyle;h.style.borderLeftStyle=k.borderLeftStyle;h.style.borderRightStyle=k.borderRightStyle;h.style.borderTopStyle=k.borderTopStyle;h.style.borderBottomWidth=k.borderBottomWidth;h.style.borderLeftWidth=k.borderLeftWidth;h.style.borderRightWidth=k.borderRightWidth;h.style.borderTopWidth=k.borderTopWidth;h.style.borderBottomColor=k.borderBottomColor;h.style.borderLeftColor=k.borderLeftColor;h.style.borderRightColor=k.borderRightColor;h.style.borderTopColor=k.borderTopColor}this.targets=null;for(var b=0;b<this.targetsToUnlock.length;b++){var f=this.targetsToUnlock[b];f.unlock()}this.targetsToUnlock=null},onDragDrop:function(h,o){var d=Window_FromElement(h);var g=new FormEvent(d,h);if(g.element.id.indexOf("proxy")!=-1){var f=g.element.id.substring(5,g.element.id.length);if(o!=f){return}}else{var b=Field_FromElement(MidTierDragDropMgrInst.lastMouseUpElement);if(b!=null){if(o!=b.mObj.id){return}}}var k=document.getElementById(o);this.lastDropTarget=Field_FromElement(k)},mExecuteDropWorkflow:function(d){var b=[];b.push({f:ExecuteWorkflow,a:[d.windowID,268435456,d.mID]});if(getCurWFC_NS(d.windowID)){getCurWFC_NS(d.windowID).execute(b)}else{new WorkflowContext(d.windowID,b)}},onInvalidDrop:function(b){this.animateInvalidDrop()},animateValidDrop:function(){var d=this.getDragEl();var b=d.offsetWidth;var g=d.offsetHeight;var f=new YAHOO.util.Anim(d,{width:{from:b,to:0},height:{from:g,to:0}},0.15,YAHOO.util.Easing.easeNone);f.animate();f.onComplete.subscribe(function(h){YAHOO.util.Dom.setStyle(d,"visibility","hidden");YAHOO.util.Dom.setStyle(d,"width","");YAHOO.util.Dom.setStyle(d,"height","")})},animateInvalidDrop:function(){var d=this.getDragEl();YAHOO.util.Dom.setStyle(d,"visibility","visible");var b=YAHOO.util.Dom.getXY(d);var f=new YAHOO.util.Anim(d,{left:{from:b[0],to:this.iPageX},top:{from:b[1],to:this.iPageY}},0.15,YAHOO.util.Easing.easeOut);f.animate();f.onComplete.subscribe(function(g){YAHOO.util.Dom.setStyle(d,"visibility","hidden")})},alignElWithMouse:function(b,f,d){YAHOO.util.Dom.setXY(b,[f+5,d+15],false)},onDragEnter:function(b,d){this.onDragEnterOverHelper(b,d)},onDragOver:function(b,d){this.onDragEnterOverHelper(b,d)},onDragEnterOverHelper:function(h,k){var g;var d=MidTierDragDropMgrInst.lastMouseOverElement.id;if(d.indexOf("proxy")!=-1){var f=d.substring(5,d.length);g=MidTierDragDropMgrInst.getDropTargetHandleById(f)!=null}else{var b=Field_FromElement(MidTierDragDropMgrInst.lastMouseOverElement);g=b!=null&&MidTierDragDropMgrInst.getDropTargetHandleByNode(b.mObj)!=null}MidTierDragDropMgrInst.setDragProxyValidDrop(g)},onDragOut:function(b,d){MidTierDragDropMgrInst.setDragProxyValidDrop(false)}});function MidTierDDTarget(f,b,d){MidTierDDTarget.superclass.constructor.apply(this,arguments)}YAHOO.extend(MidTierDDTarget,YAHOO.util.DDTarget,{});function MidTierDragDropMgr(){this.dragSourceHandles=[];this.dropTargetHandles=[];this.dropTargetProxies=[];this.lastDragSourceFieldID=null;this.lastDragSourceWinID=null;this.lastDropTargetFieldID=null;this.currentDownedElement=false;this.lastDragSourceElement=null;this.lastMouseUpElement=null;this.lastMouseDownElement=null;this.lastMouseDownFormEvent=null;this.lastMouseOverElement=null;this.dndproxy=document.getElementById("dndproxy");this.dndproxyValidImgSingle=document.getElementById("dndproxyValidImgSingle");this.dndproxyInvalidImgSingle=document.getElementById("dndproxyInvalidImgSingle");this.dndproxyValidImgMultiple=document.getElementById("dndproxyValidImgMultiple");this.dndproxyInvalidImgMultiple=document.getElementById("dndproxyInvalidImgMultiple");this.dndproxylabel=document.getElementById("dndproxylabel");this.dndproxyValidDrop=null}MidTierDragDropMgr.prototype.init=function(){this.dndproxy=document.getElementById("dndproxy");this.dndproxyValidImgSingle=document.getElementById("dndproxyValidImgSingle");this.dndproxyInvalidImgSingle=document.getElementById("dndproxyInvalidImgSingle");this.dndproxyValidImgMultiple=document.getElementById("dndproxyValidImgMultiple");this.dndproxyInvalidImgMultiple=document.getElementById("dndproxyInvalidImgMultiple");this.dndproxylabel=document.getElementById("dndproxylabel")};MidTierDragDropMgr.prototype.getLastDragSourceFieldID=function(){return this.lastDragSourceFieldID};MidTierDragDropMgr.prototype.setLastDragSourceFieldID=function(b){this.lastDragSourceFieldID=b};MidTierDragDropMgr.prototype.setLastDropTargetFieldID=function(b){this.lastDropTargetFieldID=b};MidTierDragDropMgr.prototype.getLastDropTargetFieldID=function(){return this.lastDropTargetFieldID};MidTierDragDropMgr.prototype.setDragSourceEnabled=function(f,b){var d=this.getDragSourceHandleByNode(f);if(b){if(d&&d.isLocked()){d.unlock()}else{if(!d&&f.id&&f.id!=""){this.registerDragSource(f);this.registerDropTargetRefresh(f)}}}else{if(d&&!d.isLocked()){d.lock()}}};MidTierDragDropMgr.prototype.registerDragSource=function(h){var s=new MidTierDDProxy(h.id,"default_"+h.arwindowid,{dragElId:"dndproxy",resizeFrame:false,isTarget:false});s.removeInvalidHandleType("a");var b=Field_FromElement(h);var k=b.getNoDragDropStyleClasses();if(k!=null){var o=k.length;for(var g=0;g<o;g++){s.addInvalidHandleClass(k[g])}}var f=b.getDragHandlePrefixes();if(f!=null){var d=f.length;for(var g=0;g<d;g++){s.setHandleElId(f[g]+b.mID)}}this.dragSourceHandles[""+h.id]=s};MidTierDragDropMgr.prototype.getDragSourceHandleById=function(b){return this.dragSourceHandles[""+b]};MidTierDragDropMgr.prototype.getDragSourceHandleByNode=function(b){return this.getDragSourceHandleById(b.id)};MidTierDragDropMgr.prototype.setDropTargetEnabled=function(d,b){var f=this.getDropTargetHandleByNode(d);if(b){if(f&&f.isLocked()){f.unlock()}else{if(!f){this.registerDropTarget(d)}}}else{if(f&&!f.isLocked()){f.lock()}}};MidTierDragDropMgr.prototype.registerDropTarget=function(b){var d=new MidTierDDTarget(b.id,"default_"+b.arwindowid,{});this.dropTargetHandles[""+b.id]=d};MidTierDragDropMgr.prototype.unregisterDropTarget=function(b){delete this.dropTargetHandles[""+b]};MidTierDragDropMgr.prototype.registerDropTargetRefresh=function(b){var d=this.getDropTargetHandleByNode(b);if(d){d.initTarget(b.id,"default_"+b.arwindowid,{})}};MidTierDragDropMgr.prototype.getDropTargetHandleById=function(b){return this.dropTargetHandles[""+b]};MidTierDragDropMgr.prototype.getDropTargetHandleByNode=function(b){return this.getDropTargetHandleById(b.id)};MidTierDragDropMgr.prototype.createDropTargetProxy=function(d){var b=d.parentNode;var f=document.createElement("DIV");f.id="proxy"+d.id;f.style.top=d.offsetTop;f.style.left=d.offsetLeft;f.style.width=d.offsetWidth;f.style.height=d.offsetHeight;f.style.border="2px solid";f.style.zIndex=d.style.zIndex;f.style.backgroundColor="black";f.style.opacity=0;f.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";this.dropTargetProxies.push(f);b.appendChild(f)};MidTierDragDropMgr.prototype.removeDropTargetProxy=function(b){b.parentNode.removeChild(b)};MidTierDragDropMgr.prototype.removeDropTargetProxies=function(){for(var b=0;b<this.dropTargetProxies.length;b++){this.removeDropTargetProxy(this.dropTargetProxies[b])}this.dropTargetProxies=[]};MidTierDragDropMgr.prototype.setDragProxyValidDrop=function(d){this.dndproxy.style.backgroundColor="#E0E3F9";var b=getSelectedCount();var g="",h="";var f="";if(b>0){if("rl" in getDefaults_NS(MidTierDragDropMgrInst.lastDragSourceWinID)[MidTierDragDropMgrInst.lastDragSourceFieldID]){g=getDefaults_NS(MidTierDragDropMgrInst.lastDragSourceWinID)[MidTierDragDropMgrInst.lastDragSourceFieldID].rl}if("rlp" in getDefaults_NS(MidTierDragDropMgrInst.lastDragSourceWinID)[MidTierDragDropMgrInst.lastDragSourceFieldID]){h=getDefaults_NS(MidTierDragDropMgrInst.lastDragSourceWinID)[MidTierDragDropMgrInst.lastDragSourceFieldID].rlp}if(b==1){f="  "+(g.length>0?("  "+g.replaceArgs(b)):g)}else{f="  "+(h.length>0?("  "+h.replaceArgs(b)):h)}}if(!d){if(b>1){this.dndproxyInvalidImgMultiple.style.display="";this.dndproxyInvalidImgSingle.style.display="none";this.dndproxyValidImgMultiple.style.display="none";this.dndproxyValidImgSingle.style.display="none"}else{this.dndproxyInvalidImgMultiple.style.display="none";this.dndproxyInvalidImgSingle.style.display="";this.dndproxyValidImgMultiple.style.display="none";this.dndproxyValidImgSingle.style.display="none"}}else{if(b>1){this.dndproxyInvalidImgMultiple.style.display="none";this.dndproxyInvalidImgSingle.style.display="none";this.dndproxyValidImgMultiple.style.display="";this.dndproxyValidImgSingle.style.display="none"}else{this.dndproxyInvalidImgMultiple.style.display="none";this.dndproxyInvalidImgSingle.style.display="none";this.dndproxyValidImgMultiple.style.display="none";this.dndproxyValidImgSingle.style.display=""}}this.dndproxyValidDrop=d;this.dndproxylabel.innerHTML=f};var MidTierDragDropMgrInst=new MidTierDragDropMgr();function DragField_Init(d){var g=getFormDataHolderById(d).dragFields;for(var f=0;f<g.length;f++){var b=g[f];var k=getFields_NS(d)[b];var h=k.mObj;if(k.GAccess()!=3){MidTierDragDropMgrInst.registerDragSource(h)}}}function DropField_Init(b){var d=getFormDataHolderById(b).dropFields;for(var f=0;f<d.length;f++){var k=d[f];var h=getFields_NS(b)[k];var g=h.mObj;if(h.GAccess()!=3){MidTierDragDropMgrInst.registerDropTarget(g)}}}function getSelectedCount(){var h=MidTierDragDropMgrInst.lastDragSourceFieldID;if(h==null||h=="undefined"||h.length==0){return""}var b=F(MidTierDragDropMgrInst.lastDragSourceWinID,h);var f=b.mRowSelections;var g=0;for(var d in f){g++}return g}function MenuBoxPopup(f,g,k,b,h){var o="";if(k.length>0){o=getLocalizedMessage("Menu for {0}",[k])}else{o=getLocalizedMessage("Menu")}if(typeof(AbsContextPath)=="undefined"){AbsContextPath="../../"}var d=weOpenModalPopup(f,(AbsContextPath+"resources/html/MenuBoxPopup.html"),"Editor",{title:o,arg:b,appss:GetAppStyleSheet("../../")},h,[640,480]);return d}var MenuPopupList=new Array();(function(v){var o,f,s=v.document,b=v.document.referrer,g,k,u;if(v.parent!=v){g=true}if(typeof v.TIMELINE==="undefined"){v.TIMELINE={}}TIMELINE=v.TIMELINE;TIMELINE.window=v;TIMELINE.enabled=function(){return("undefined"!=typeof(rti)&&rti==true)};o={initialized:false,isPageComplete:false,page_state:0,bwExpiry:86400,transactions:{pageload:null,completedTxs:{latest:[]},currentTx:null,bmr:{isComputing:false}},init:function(){this.startPageLoad();this.initialized=true},startPageLoad:function(){this.startTx("page_load",TIMELINE.baseForm,!g,"PAGE_START","PAGE_END."+TIMELINE.baseForm);this.markStarts()},endPageLoad:function(){},markStarts:function(){var d=this.w3cTiming()||this.gToolbar()||this.startCookie();if(d){this.mark("PAGE_START",d)}},startTx:function(d,A,z,y,w){if(this.transactions.currentTx!=null){if(this.transactions.currentTx.queue.length>0){return}this.endCurrTx()}this.transactions.currentTx={startMark:y,endMark:w,marks:{},name:d,base:z,frm:A,events:[],queue:[],ended:false,server:{},network:{},hasNetworkOperation:false,hasFormLoad:false,summary:{}}},endCurrTx:function(){if(this.transactions.currentTx==null){return false}var d=this.clone(this.transactions.currentTx);if(this.transactions.currentTx.name==="page_load"){this.isPageComplete=true;this.transactions.currentTx.server.svrHead=this.fetchSvrHeadTime();this.transactions.currentTx.server.svrHtml=this.fetchSvrHtmTime();this.summarize(d);this.transactions.pageload=d;BOOMR.sendBeacon()}else{if(d.hasNetworkOperation||d.hasFormLoad){this.summarize(d);this.transactions.completedTxs.latest.push(d)}}this.transactions.currentTx=null;return d.hasNetworkOperation||d.hasFormLoad||d.name==="page_load"},summarize:function(z){var B={svr:0,net:0,br:0,trt:0,nm:z.startMark,form:z.frm};if(z.endMark.match(/FORM_LOAD/)){B.nm=z.endMark}B.trt=z.marks[z.endMark+".end"]-(z.marks[z.startMark+".start"]||z.marks[z.startMark]);if(z.name==="page_load"){B.trt=z.marks[z.endMark+".end"]-(z.marks.PAGE_START||z.marks.AR_FB);if(z.base){B.nm=getLocalizedMessage("Base Page Load [ ")+TIMELINE.baseForm+" ]"}else{B.nm=getLocalizedMessage("Page Load [ ")+TIMELINE.baseForm+" ]"}B.svr+=parseInt(z.server.svrHead||0);B.svr+=parseInt(z.server.svrHtml||0);var y=z.marks.AR_ONLOAD-z.marks.AR_FB;var d=0;$.each(z.marks,function(E,D){if(E.match(/uddStart/)){d+=parseInt((z.marks[E.replace(/Start/,"End")]-z.marks[E])||0)}})}for(i=0;i<z.events.length;i++){var w=z.events[i];var C=z.marks[w.uid+".end"]-(z.marks[w.uid+".start"]||z.marks[w.uid]);B.svr+=parseInt(w.svrTime||0);if(C>w.svrTime){if(w.event.match(/NDX/)){B.net+=parseInt((C-w.svrTime)||0)}}}if(B.nm.match(/WORKFLOW/)){B.nm=B.nm.replace(/\d+/g,"");B.title=getLocalizedMessage("Workflow")}else{if(B.nm.match(/FORM_LOAD/)){B.title=getLocalizedMessage("Form Load");B.form=z.formLoaded}}if(B.net==0){B.net=Math.floor(0.1*B.svr)}var A=B.svr+B.net;if(A>B.trt){B.br=Math.floor(0.1*A);B.trt=A+B.br}else{B.br=B.trt-A}z.summary=B},getTx:function(d){if(d==="page_load"){return page_load}else{if(latest.length>0){for(var w=0;w<latest.length;++w){if(latest[w].nm===d){return latest[w]}}}}},handleEvent:function(d){var w=(d.event.match(/NDX/g)?d.event:d.event+"."+d.frm);if(d.type==="START"){this.mark(w+".start")}else{if(d.type==="END"){this.mark(w+".end");this.checkInQueue(w);if(this.transactions.currentTx.endMark===w){this.transactions.currentTx.ended=true;if(w.match(/FORM_LOAD/)){this.transactions.currentTx.formLoaded=d.frm}}if(w.match(/NDX/)){this.transactions.currentTx.hasNetworkOperation=true}if(w.match(/FORM_LOAD/)){this.transactions.currentTx.hasFormLoad=true}d.uid=w;this.transactions.currentTx.events.push(d)}else{if(d.type==="QUEUE"){this.mark(w+".queue");this.transactions.currentTx.queue.push(w);this.transactions.currentTx.endMark=w}else{if(d.type==="PAUSE"){this.mark(w+".pause")}else{if(d.type==="RESUME"){this.mark(w+".resume")}}}}}},checkInQueue:function(w){var d=$.inArray(w,this.transactions.currentTx.queue);if(d!=-1){this.transactions.currentTx.queue.splice(d,1)}},mark:function(d,w){if(!d||this.transactions.currentTx==null){return}this.transactions.currentTx.marks[d]=parseInt(w||new Date().getTime())},size:function(y){if(null==y||"object"!=typeof y){return 0}var w=0;for(var d in y){if(y.hasOwnProperty(d)){w++}}return w},isCurrTxComplete:function(){return(this.transactions.currentTx.ended==true&&this.transactions.currentTx.queue.length===0)},w3cTiming:function(){var d=undefined;var w=window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance;if("undefined"!=typeof(w)&&"undefined"!=typeof(w.timing)){d=w.timing.navigationStart||w.timing.fetchStart}return d},gToolbar:function(){var d=undefined;if("undefined"!=typeof(window.external)&&"undefined"!=typeof(window.external.pageT)){d=(new Date().getTime())-window.external.pageT}else{if("undefined"!=typeof(window.gtbExternal)&&"undefined"!=typeof(window.gtbExternal.pageT)){d=(new Date().getTime())-window.gtbExternal.pageT()}else{if("undefined"!=typeof(window.chrome)&&"undefined"!=typeof(window.chrome.csi)){d=(new Date().getTime())-window.chrome.csi().pageT}}}return d},startCookie:function(){var C=document.cookie.split(" ");for(var z=0;z<C.length;z++){if(0===C[z].indexOf("TIMELINE=")){var d=C[z].substring("TIMELINE=".length).split("&");var A,B;for(var w=0;w<d.length;w++){if(0===d[w].indexOf("s=")){A=d[w].substring(2)}else{if(0===d[w].indexOf("r=")){var y=d[w].substring(2);B=(escape(document.referrer)==y)}}}if(B&&A){return A}}}return undefined},clone:function(w){if(null==w||"object"!=typeof w){return w}var y=w.constructor();for(var d in w){if(w.hasOwnProperty(d)){y[d]=w[d]}}return y},fetchSvrHeadTime:function(){var d=null;try{if(enableResTimeIndicator){var w=GET_XML_HTTP();w.open("GET",AbsContextPath+"servlet/ResponseTimeServlet?act=end",false);w.send(null);d=w.getResponseHeader("sum")}}catch(y){}return d},fetchSvrHtmTime:function(){var w=null;try{w=getCookie("spt","/"+RelContextPath);deleteCookie("spt","/"+RelContextPath)}catch(d){}return w},BOOMRInit:function(){var d=k.load("bw");if("undefined"!=typeof(BOOMR)){BOOMR.init({user_ip:window.location.hostname,auto_run:false,BW:{base_url:""+RelContextPath+"resources/images/",cookie:null}});BOOMR.subscribe("before_beacon",TIMELINE.BOOMRCallback);if("undefined"===d||null===d){this.transactions.bmr.isComputing=true;BOOMR.plugins.BW.run()}else{this.transactions.bmr=d;this.transactions.bmr.isComputing=false}}}};u={rtiHtml:"",txs:null,rti:null,rtidefault:null,rtidefaultimage:null,rtisummary:null,rtisummaryimage:null,rtidetails:null,rtidetailsclose:null,rtirefresh:null,buildDom:function(){var w=""+RelContextPath+"resources/images/";var d="";d+="<div id='rtidefault' class='rtidefault' style='display:none&#59;'>";d+="<img id='rtiperfmonimage' src='"+w+"perf_monitor.png' title='"+getLocalizedMessage("Response Time Monitor")+"' />";d+="</div>";d+="<div id='rtisummary' class='rtisummary' style='display:none&#59;'>";d+="<img id='rtiperfmonimage' src='"+w+"perf_monitor.png' title='"+getLocalizedMessage("Response Time Monitor")+"' />";d+="<div id='rtisummarytext' class='rtisummarytext'>";d+="<span id='pLoadTime' class='summarytitle'>"+getLocalizedMessage("Page Load Time")+" (ms): ";d+="<span id='pLoadTimeVal' class='summaryval'>NA</span></span>";d+="<span id='pBandwidth' class='summarytitle'>, "+getLocalizedMessage("Bandwidth")+":  ";d+="<span id='pBwValue' class='summaryval'>NA</span></span>";d+="<span id='pLatency' class='summarytitle'>, "+getLocalizedMessage("Latency")+": ";d+="<span id='pLatValue' class='summaryval'>NA</span></span>";d+="<span id='pLatestTx' class='summarytitle'>, "+getLocalizedMessage("Last Transaction")+" (ms): ";d+="<span id='pLatestTxVal' class='summaryval'>NA</span></span>";d+="</div>";d+="</div>";d+="<div id='rtidetails' class='rtidetails' style='display:none&#59;'>";d+="<div id='rtidetailswrapper' class='rtidetailswrapper' style='position: relative&#59;'> </div>";d+="<img class='rticloseimage' src='"+w+"perf-monitor-close-btn.png'/>";d+="<div id='bandwidth' class='bandwidth'>";d+="<div id='bandwidthtitle'>"+getLocalizedMessage("Users Bandwidth to Server:");d+="<img class='rtirefreshimage' src='"+w+"perf-monitor-refresh-btn.png' /></div>";d+="<div id='bw'>"+getLocalizedMessage("Bandwidth")+": <div id ='bwValue' class='inlinevalues' style='position:absolute'></div></div>";d+="<div id='lat'>"+getLocalizedMessage("Latency")+": <div id ='latValue' class='inlinevalues' style='position:absolute'></div></div>";d+="</div>";d+="<div id='pageload' class='pageload'>";d+="<div class='pagetitle'>"+getLocalizedMessage("Base Page[")+" <span id='pageName' class='truncate' title='' style='max-width:55%;font-weight:bold;' ></span>]</div>";d+="<div id='resptime' class='pagetitle'>"+getLocalizedMessage("Page Load Time")+": <div id='pageTime'></div></div>";d+="<div id='ntwk' class='header'>"+getLocalizedMessage("Network Time")+":<div id='networkTime' class='inlinevalues' style='position:absolute'></div></div>";d+="<div id='svr' class='header'>"+getLocalizedMessage("Server Time")+":<div id='serverTime' class='inlinevalues' style='position:absolute'></div></div>";d+="<div id='browser' class='header'>"+getLocalizedMessage("Browser Time")+":<div id='browserTime' class='inlinevalues' style='position:absolute'></div></div>";d+="</div>";d+="<div id='transactions' class='transactions line-separator'>";d+="<div class='txtitle'>"+getLocalizedMessage("Last 3 Transactions")+"</div>";d+="<div id='latestTxs'></div>";d+="</div>";d+="</div>";this.rtiHtml=d},initDOMVars:function(){this.rti=$(".rti");this.rti.html(this.rtiHtml);this.rtidefault=$(".rtidefault");this.rtidefaultimage=$(".rtidefault > #rtiperfmonimage");this.rtisummary=$(".rtisummary");this.rtisummaryimage=$(".rtisummary > #rtiperfmonimage");this.rtidetails=$(".rtidetails");this.rtidetailsclose=$(".rtidetails > .rticloseimage");this.rtirefresh=$(".rtirefreshimage");this.bandwidth.init();this.pagetime.init();this.latest.init()},activateAnimation:function(){this.rti.show();var d=k.load("rticlick");if("undefined"!=d&&null!=d&&d==true){this.rtidefault.hide();this.rtisummary.show()}else{this.rtidefault.show()}this.rtidefaultimage.click(function(){u.rtidefault.hide();u.rtisummary.show();k.save("rticlick",true,60);return false});this.rtisummaryimage.click(function(){u.rtisummary.hide();u.rtidefault.show();k.save("rticlick",false,60);return false});this.rtisummary.click(function(){u.rtisummary.hide();u.rtidefault.hide();u.rtidetails.show();k.save("rticlick",false,60);return false});this.rtidetailsclose.click(function(){u.rtidetails.hide();u.rtisummary.hide();u.rtidefault.show();return false});this.rtirefresh.click(function(){TIMELINE.refreshBandwidth();return false})},init:function(d){this.txs=d;this.buildDom();this.initDOMVars();this.activateAnimation();this.updateTimeLine()},updateTimeLine:function(){if(this.txs!=null){this.bandwidth.update(this.txs.bmr);this.pagetime.update(this.txs.pageload);this.latest.update(this.txs.completedTxs.latest,this.txs.pageload)}},bandwidth:{bw:null,lat:null,bwS:null,latS:null,computeMsg:null,naMsg:null,init:function(){this.bw=$("div#bwValue");this.lat=$("div#latValue");this.bwS=$("span#pBwValue");this.latS=$("span#pLatValue");this.computeMsg=getLocalizedMessage("computing...");this.naMsg=getLocalizedMessage("NA")},update:function(y){if(y.isComputing==true){this.bw.html(this.computeMsg);this.bwS.html(this.computeMsg);this.lat.html(this.computeMsg);this.latS.html(this.computeMsg)}else{var d=!isNaN(y.bw)?(parseInt(y.bw*8/1024)+"kbps ( &plusmn "+parseInt(y.bw_err*100/y.bw)+"%)"):this.naMsg;var w=!isNaN(y.lat)?(parseInt(y.lat)+" &plusmn"+y.lat_err+"ms"):this.naMsg;this.bw.html(d);this.bwS.html(d);this.lat.html(w);this.latS.html(w)}}},pagetime:{pTime:null,pTimeDet:null,svrTime:null,netTime:null,brTime:null,pName:null,init:function(){this.pTime=$("span#pLoadTimeVal");this.pTimeDet=$("div#pageTime");this.svrTime=$("div#serverTime");this.netTime=$("div#networkTime");this.brTime=$("div#browserTime");this.pName=$("span#pageName")},update:function(d){if(d){this.pTime.html(d.summary.trt);this.pTimeDet.html(d.summary.trt+" ms");this.svrTime.html(d.summary.svr);this.netTime.html(d.summary.net);this.brTime.html(d.summary.br);this.pName.html(d.frm);this.pName.attr("title",d.frm)}}},latest:{pLatest:null,latestDetails:null,init:function(){this.latestDetails=$("div#latestTxs");this.pLatest=$("span#pLatestTxVal")},update:function(w,A){if(w!=null&&w.length>0){var C=w[w.length-1];this.pLatest.html(C.summary.trt);this.latestDetails.html("");var z=w.length;var B=0;while(z--&&B<3){var d=w[z];var y=this.buildTx(d);this.latestDetails.append(y);B++}}else{this.pLatest.html(A?A.summary.trt:getLocalizedMessage("NA"))}},buildTx:function(d){var w="<div class='tx'><span>"+getLocalizedMessage(d.summary.title)+"[<span title='"+d.summary.form+"' class='truncate'>";w+=d.summary.form+"</span>] : <div style='position:absolute' class='txinlinevalue'>"+d.summary.trt+" ms</div></span></div>";return w}}};k={isLocalStorage:function(){return("localStorage" in window&&window.localStorage!==null)},isSessionStorage:function(){return("sessionStorage" in window&&window.sessionStorage!==null)},save:function(z,A,w){if(!this.isLocalStorage()){return false}var d=w*60*1000;var y={value:JSON.stringify(A),timestamp:new Date().getTime()+d};localStorage.setItem(z,JSON.stringify(y));return A},load:function(w){if(!this.isLocalStorage()){return false}var d=JSON.parse(localStorage.getItem(w));if(!d){return null}return((new Date().getTime()<d.timestamp)?JSON.parse(d.value):null)}};TIMELINE.init=function(d){if(!TIMELINE.enabled()||o.initialized){return}TIMELINE.baseForm=d;o.init();TIMELINE.processQ();if(!g){u.init(o.transactions);o.BOOMRInit()}};TIMELINE.processQ=function(){if(!TIMELINE.enabled()){return}var d=TIMELINE.q.length;for(var w=0;w<d;w++){var z=TIMELINE.q[w];var y=z[0];if("mark"===y){TIMELINE.mark(z[1],z[2])}}};TIMELINE.mark=function(d,w){if(!TIMELINE.enabled()){return}else{if(!o.initialized){TIMELINE.q.push(["mark",d,w||new Date().getTime()]);return}}o.mark(d,w)};TIMELINE.start=function(C,B,A){if(!TIMELINE.enabled()){return}var w=getCurrentWindowID_NS();var z=getFormContext(w);if("undefined"==typeof(z)||z===null){return}var y=B?B:z.formName;if(("undefined"!=typeof(A)&&A==true)){o.startTx(C,B,false,C+"."+B,C+"."+B)}if(o.transactions.currentTx==null){if(C.match(/WORKFLOW/)){o.startTx(C,B,false,C+"."+B,C+"."+B)}else{return}}var d={event:C,frm:y,type:"START"};o.handleEvent(d)};TIMELINE.end=function(D,B,C){if(!TIMELINE.enabled()){return}var y=parseInt(C||0);if(o.transactions.currentTx==null){return}var w=getCurrentWindowID_NS();var A=getFormContext(w);if("undefined"==typeof(A)||A===null){return}var z=B?B:A.formName;var d={event:D,frm:z,type:"END",svrTime:y};o.handleEvent(d);if(o.isCurrTxComplete()){if(o.endCurrTx()){drawTimeline()}}};TIMELINE.pause=function(B,A){if(!TIMELINE.enabled()){return}if(o.transactions.currentTx==null){return}var w=getCurrentWindowID_NS();var z=getFormContext(w);if("undefined"==typeof(z)||z===null){return}var y=A?A:z.formName;var d={event:B,frm:A,type:"PAUSE"};o.handleEvent(d)};TIMELINE.resume=function(B,A){if(!TIMELINE.enabled()){return}if(o.transactions.currentTx==null){return}var w=getCurrentWindowID_NS();var z=getFormContext(w);if("undefined"==typeof(z)||z===null){return}var y=A?A:z.formName;var d={event:B,frm:y,type:"RESUME"};o.handleEvent(d)};TIMELINE.queue=function(B,A){if(!TIMELINE.enabled()){return}if(o.transactions.currentTx==null){return}var w=getCurrentWindowID_NS();var z=getFormContext(w);if("undefined"==typeof(z)||z===null){return}var y=A?A:z.formName;var d={event:B,frm:A,type:"QUEUE"};o.handleEvent(d)};TIMELINE.refreshBandwidth=function(){o.transactions.bmr.isComputing=true;BOOMR.plugins.BW.rerun();u.bandwidth.update(o.transactions.bmr)};timelineDomReady=function(){$(".PageLoadBar").show();$(".PageLoadBar").css({right:"20px"});$(".PageLoad_Results").hide();$(".page_load_image").click(function(){$(".PageLoadBar").hide();$(".PageLoad_Results").show();$(".PageLoad_Results").css({right:"20px"})});$(".PageLoad_Results").click(function(){$(".PageLoad_Results").hide();$(".PageLoadBar").show();$(".PageLoadBar").css({right:"20px"})})};timelineDomReadyNew=function(){u.init(o.transactions)};TIMELINE.BOOMRCallback=function(d){o.transactions.bmr=o.clone(d);o.transactions.bmr.isComputing=false;u.bandwidth.update(o.transactions.bmr);k.save("bw",o.transactions.bmr,o.bwExpiry)};var h=0;drawOldTimeline=function(){h++;html="";if(o.transactions.bmr!=null){var B=o.transactions.bmr;if(!isNaN(B.bw)&&!isNaN(B.lat)){html+="<h3>&nbsp; Users Bandwidth To Server (only calculated once in a day)</h3> <ul> <li> Bandwidth: "+parseInt(B.bw*8/1024)+"kbps (&#x00b1; "+parseInt(B.bw_err*100/B.bw)+"%)</li> <li> Latency: "+parseInt(B.lat)+"&#x00b1;"+B.lat_err+"ms</li> </ul>"}else{html+="<h3>&nbsp; Bandwidth and Latency Cannot be determined right now </h3>"}}else{html+="<h3>&nbsp; Bandwidth and Latency, Currently Not Available </h3>"}html+="<h3>&nbsp; Page Load</h3><ul>";if(o.transactions.pageload!=null){var A=o.transactions.pageload;html+="<li>&nbsp; "+A.frm+": Total (ms) ("+A.summary.trt+") ,Browser: ("+A.summary.br+"),Network: "+A.summary.net+", Server:"+A.summary.svr+" </li>"}else{html+="<li>&nbsp; Page Loading Data Currently not Available</li>"}html+="</ul>";var w=o.transactions.completedTxs.latest;if(w!=null&&w.length>0){html+="<h3>&nbsp; Latest Transactions</h3><ul>";for(var y=0;y<w.length;y++){var d=w[y];html+="<li>&nbsp; "+d.summary.nm+": Total(ms): ("+d.summary.trt+"),Browser: "+d.summary.br+",Network: "+d.summary.net+",Server:"+d.summary.svr+"</li>"}html+="</ul>"}var z=document.getElementById("PageLoad_Results");z.innerHTML=html};drawTimeline=function(){u.updateTimeLine()}}(window));